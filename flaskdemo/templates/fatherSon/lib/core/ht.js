!function(t,S,Y){"use strict";function C(l,h){if("function"!=typeof h&&null!==h)throw new TypeError("Super expression must either be null or a function");l.prototype=S.create(h&&h.prototype,{constructor:{value:l,writable:!0,configurable:!0}}),h&&Zq(l,h)}function j(W){var I=S.prototype.toString.call(W);return"Array]"===I.substring(I.length-6)}function h(Z,S,q,O,w,W){S=S||[],q=q||[],O=O||[];try{S.push(Z);var L=Function.apply(0,S);return q[q.length]="return "+L,Function.apply(0,q).apply(0,O)}catch(C){return W&&W(C),w}}function l(T){var E={};return{get:function(C){if(E[C]!==Y)return E[C];var y;switch(C){case"WEBGL_depth_texture":y=T.getExtension("WEBGL_depth_texture")||T.getExtension("MOZ_WEBGL_depth_texture")||T.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":y=T.getExtension("EXT_texture_filter_anisotropic")||T.getExtension("MOZ_EXT_texture_filter_anisotropic")||T.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":y=T.getExtension("WEBGL_compressed_texture_s3tc")||T.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||T.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":y=T.getExtension("WEBGL_compressed_texture_pvrtc")||T.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":y=T.getExtension("WEBGL_compressed_texture_etc1");break;default:y=T.getExtension(C)}return E[C]=y,y}}}function X(D,q,U){function R(){if(w!==Y)return w;var l=q.get("EXT_texture_filter_anisotropic");return w=null!==l?D.getParameter(l.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function O(e){if("highp"===e){if(D.getShaderPrecisionFormat(D.VERTEX_SHADER,D.HIGH_FLOAT).precision>0&&D.getShaderPrecisionFormat(D.FRAGMENT_SHADER,D.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&D.getShaderPrecisionFormat(D.VERTEX_SHADER,D.MEDIUM_FLOAT).precision>0&&D.getShaderPrecisionFormat(D.FRAGMENT_SHADER,D.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var w;U=U||{};var Z="undefined"!=typeof WebGL2RenderingContext&&D instanceof WebGL2RenderingContext,h=U.precision!==Y?U.precision:"highp",o=O(h);o!==h&&(console.warn("WebGL:",h,"not supported, using",o,"instead."),h=o);var g=U.logarithmicDepthBuffer===!0,z=D.getParameter(D.MAX_TEXTURE_IMAGE_UNITS),s=D.getParameter(D.MAX_VERTEX_TEXTURE_IMAGE_UNITS),t=D.getParameter(D.MAX_TEXTURE_SIZE),Q=D.getParameter(D.MAX_CUBE_MAP_TEXTURE_SIZE),n=D.getParameter(D.MAX_VERTEX_ATTRIBS),b=D.getParameter(D.MAX_VERTEX_UNIFORM_VECTORS),G=D.getParameter(D.MAX_VARYING_VECTORS),F=D.getParameter(D.MAX_FRAGMENT_UNIFORM_VECTORS),W=s>0,y=Z||!!q.get("OES_texture_float"),m=(Z||!!q.get("OES_element_index_uint"))&&"undefined"!=typeof Uint32Array,I=W&&y,u=Z?D.getParameter(D.MAX_SAMPLES):0;return{getMaxAnisotropy:R,getMaxPrecision:O,precision:h,logarithmicDepthBuffer:g,maxTextures:z,maxVertexTextures:s,maxTextureSize:t,maxCubemapSize:Q,maxAttributes:n,maxVertexUniforms:b,maxVaryings:G,maxFragmentUniforms:F,vertexTextures:W,floatFragmentTextures:y,elementTypeUint:m,floatVertexTextures:I,maxSamples:u}}function p(c,Y){return c.z!==Y.z?Y.z-c.z:c.id-Y.id}var q="ht";if(!t[q]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),t.performance&&t.performance.now||function(){var L=Date.now();t.performance||(t.performance={}),t.performance.now=function(){return Date.now()-L}}();for(var I=Date.now(),d=16,G=["ms","moz","webkit","o"],D=0;D<G.length&&!t.requestAnimationFrame;++D)t.requestAnimationFrame=t[G[D]+"RequestAnimationFrame"],t.cancelAnimationFrame=t[G[D]+"CancelAnimationFrame"]||t[G[D]+"CancelRequestAnimationFrame"];t.requestAnimationFrame||(t.requestAnimationFrame=function(C){var w=Date.now(),V=d+I-w;return 0>V&&(V=0),I=w,t.setTimeout(function(){I=Date.now(),C(performance.now())},V)}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(s){return t.clearTimeout(s)}),S.assign===Y&&(S.assign=function(s){if(s===Y||null===s)throw new TypeError("Cannot convert undefined or null to object");for(var I=S(s),T=1;T<arguments.length;T++){var h=arguments[T];if(h!==Y&&null!==h)for(var v in h)S.prototype.hasOwnProperty.call(h,v)&&(I[v]=h[v])}return I}),t.btoa===Y&&(t.btoa=function(Y){for(var I,r,l=String(Y),p=0,b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",K="";l.charAt(0|p)||(b="=",p%1);K+=b.charAt(63&I>>8-8*(p%1))){if(r=l.charCodeAt(p+=.75),r>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");I=I<<8|r}return K})}();var g,E,y,i,v=t.location,M=v&&t.document,F=null,D=Y,R=t[q]={},U=t[q+"config"],x=R.Default=U&&U.Default||{},Q=R.Style=U&&U.Style||{},I=R.Attr=U&&U.Attr||{},u=function(){return!0},H=function(){return!1},$=function(J){return J},e=function(P){return!P},K=R.Color=U&&U.Color||{},G=R.IsGetter=U&&U.IsGetter||{};!function(){var m=!1;try{var k=S.defineProperty({},"passive",{get:function(){return m=!0,Y}});v&&(y=g=v)&&t.addEventListener("test",k,k),v&&(i=E=v)&&t.removeEventListener("test",k,k)}catch(e){m=!1}x.passiveSupported=m}();var c,n,w,W,b=x.passiveSupported,s=x.eventListenerOptionsFalse=b?{passive:!1,capture:!1}:!1,k=x.eventListenerOptionsTrue=b?{passive:!1,capture:!0}:!0,B=function(P,t,v,Z){P.addEventListener(t,v,Z?k:s)},V=function(W,F,i,h){W.removeEventListener(F,i,h?k:s)},T=Math,m=T.round,Z=T.floor,N=T.ceil,z=T.sqrt,O=T.max,r=T.min,P=T.abs,a=T.cos,J=T.acos,A=T.sin,L=T.pow,f=T.asin,_=T.exp,d=T.PI,o=2*d,Ie=d/2,ld=T.tan,jm=T.atan2,me=T.random,yq=T.log,nh=function(q,P,G){return Math.max(P,Math.min(G,q))},Yo=L(2,1),jn=!1,Ld=t.parseInt||global.parseInt,Il="2021-12-15",zp=v&&(t.navigator?t.navigator.platform.indexOf("Win")>-1:!1),dc=function(L){return L*L},bg=v&&t.setTimeout,ee=v&&t.clearTimeout,vk=v&&(t.navigator?t.navigator.userAgent.toLowerCase():""),Mf=function(w){return w.test(vk)},to=Mf(/msie/),_r=Mf(/msie/)||Mf(/trident/),_k=Mf(/msie 10/),km=Mf(/edge/),Og=Mf(/firefox/),Qd=Mf(/mac/),Er=Mf(/mscAndroid/),Mc=x.isTouchable===Y?zp?!1:M?"ontouchend"in M:!1:x.isTouchable,vb="default",Xf="single",Xp="multiple",Cn="front",Cb="back",Qi="left",Me="right",En="top",Mr="bottom",Dq="center",mh="eye",Pk="middle",nm="east",xe="west",Ui="north",wo="none",Oq="px",bl="absolute",ej="border",Dj="triangle",Gj="rect",Tc="circle",Nc="cylinder",ad="shape",wg="items",of="normal",Pq="remove",Wk="clear",jf="width",xn="height",Sn="ingroup",$h="check",Ge="uncheck",Vd="radio",Xe="radioOn",dr="radioOff",Kn="points",Rm="values",Dd="series",no="body",Vq="label",el="label2",Jk="note",vs="note2",Th="icons",gp="labelFont",kq="labelColor",Sb="labelSelectColor",ol="note.expanded",Gb="note2.expanded",lg="edge.expanded",cm="edge.points",Lf="edge.type",$o="rotation",Ff="hidden",Fi="visible",ne="tuv",gl="no",Rc="draw",mk="select",Ii="currentSubGraph",ji="selectBackground",Re="autoMakeVisible",af="autoHideScrollBar",pi="scrollBarColor",_l="scrollBarSize",Zp="indent",$l="rowHeight",ul="columnLineColor",am="rowLineColor",Ob="columnLineVisible",Mb="rowLineVisible",Ue="visibleFunc",sm="expandIcon",mf="collapseIcon",oq="checkMode",Kl="sortFunc",Te="editable",yk="batchEditable",go="tristate",dm="asc",Vg="desc",Pl="position",Xm="__",ri="elevation",ui="children",Nl="translateX",Tk="translateY",Br="dataModel",Pm="maxSize",Xl="enc",gh="state",Db=Xl+"o"+"de",$b="shape3d",$q="shape3d.resolution",Nd="shape3d.visible",Xn="shape3d.from.visible",ab="shape3d.to.visible",Li="shape3d.top.visible",kl="shape3d.bottom.visible",nk="repeat.uv.length",dq="serializeValue",Ho="deserializeValue",op="centerUniform",Wo="uniform",Ab="rgba(255,255,255,0)",vm="style",wh="attr",Wm="field",ud="string",nn="boolean",cb="color",ae="int",Kp="number",Tr="ew-resize",rk="ns-resize",fj="pointer",Nf="auto",Pc="mousedown",id="mousemove",uh="mouseup",If="mouseout",mg="touchstart",Ak="touchmove",xq="touchend",wb="keydown",md="keyup",Rk=["DOMMouseScroll","mousewheel"],Kj=Og?Rk[0]:Rk[1],Uk=Xm+q+Xm+Db,nl=[mg,Ak,xq],de=[Pc,id,uh,If,Kj,"wheel","mouseenter","mouseleave","mouseover"],Wq=[wb,md,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"],De=Mc?nl.concat(Wq):de.concat(Wq),bn=F,ub=F,bf=F,Wn=F,Cr=!0,tb=uh.length,_m=function(){bf&&(ee(bf.timeout),bf=F)},Zm=function(){bf&&rg(bf.e,bf.info)};t.addEventListener&&(D=v)&&(Mc||(B(t,If,function(){_m()}),B(t,Kj,function(){Qf()})),B(t,md,function(z){91===z.keyCode?Qm={}:delete Qm[z.keyCode]},!0),B(t,wb,function(L){Qm[L.keyCode]=!0},!0),B(t,"blur",function(){Qm={}}));var Zi,pr,ls,ci=0,Tf=F,qs=function(_,A){var q=bg(function(){delete Tf[q],un(Tf)&&(Tf=F),_()},A);return q},_b=F,rs=F,ah={},gj={},hm={},Ze={},Ae={},Qm={},kr={},Hc={},oi={},Pp={},Om=/.json$/,oj=/\.(json|bin)$/,On=/^data:image\/svg\+xml/,ck={},uk=[],Qj={},Hi=F,ns=F,Ko=function(){},fn=function(){throw"Oops!"},kp=[0,0,0],be={x:0,y:0,width:0,height:0},ig=F,ym=F,co=F,Yb=function(I,d){gj[I]=d,d&&d.comps&&!d.uuid&&(d.uuid=R.Math.generateUUID()),Dm[I]&&(d.cacheRule=Dm[I],delete Dm[I])},Ql=function(e){ym&&!e._72O&&(co||(co={}),co[e._72O=dh()]=e),Zi!=F?Fc()<.05&&W&&!pr&&(zg=_m):zg=Um},li=function(Y,d,z,b){ym||(ym={});var V=ym[Y];if(V){if(V.url===d)return;V.image?(V.image.onload=Ko,V.image.onerror=Ko):V.request&&(V.request.onload=Ko,V.request.onerror=Ko)}if(Om.test(d)){var g=new wq;if(ym[Y]={request:g,url:d},d=x.beforeLoadURL(d,Y),d.data){var X=x.parse(d.data);zm(Y,X),x.handleImageLoaded(Y,X)}else{g.onload=function(){if(200===this.status||0===this.status){var Q=x.parse(g.getResponseText());zm(Y,Q),x.handleImageLoaded(Y,Q)}else zm(Y,x.handleUnfoundImage(Y,d)||F)},g.onerror=function(){zm(Y,x.handleUnfoundImage(Y,d)||F)};var E={};E.url=encodeURI(d),E.sync=!1,g.send(E)}}else{var X=new Image;ym[Y]={image:X,url:d},/^data:image/.test(d)||(d=x.beforeLoadURL(d,Y),d=x.appendTimeStamp(d),d=encodeURI(d),X.crossOrigin=x.crossOrigin),x.convertImageSrc(d,function(W){_r&&(d.toLowerCase().indexOf(".svg")>0||On.test(d))?(M.body.appendChild(X),X.style.visibility="hidden",X.onload=function(){bg(function(){if(z&&(X.width=z),b&&(X.height=b),!X.width||!X.height){var i=X.width||X.clientWidth,t=X.height||X.clientHeight;X.width=i,X.height=t}x.handleImageLoaded(Y,X),zm(Y,X),M.body.removeChild(X),X.style.visibility=""},180)},X.onerror=function(){zm(Y,x.handleUnfoundImage(Y,d)||F),M.body.removeChild(X),X.style.visibility=""}):(X.onload=function(){z&&(X.width=z),b&&(X.height=b),x.handleImageLoaded(Y,X),zm(Y,X)},X.onerror=function(){zm(Y,x.handleUnfoundImage(Y,d)||F)}),X.src=W})}},zm=function(W,y){if(Yb(W,y),delete ym[W],un(ym)&&(ym=F,co)){for(var L in co){var r=co[L];r._2O&&r._2O[W]&&(r.deleteTexture(W),delete r._2O[W]),r.invalidateAll&&r.invalidateAll(Y,"imageLoaded",W),r.redraw&&r.redraw(),r.iv(),y&&y.layoutAttach&&nf(r.dm)&&r.dm().updateLayoutAttach(W),delete r._72O}co=F}if(y&&co)for(var L in co){var r=co[L];r.invalidateAll&&r.invalidateAll(Y,"imageLoading",W),r.redraw&&r.redraw(),r.iv(),y.layoutAttach&&nf(r.dm)&&r.dm().updateLayoutAttach(W)}},wi=function(){return yq=T&&Date,function(){return t.performance&&t.performance.now?t.performance.now():Date.now()}}(),Bj=function(s,j,f){return{width:s,height:j,comps:Ub(f)?f:[f]}},Dn=function(f,q){return{type:Tc,rect:[f,q,1.6,1.6],borderWidth:1,borderColor:xg,gradient:Ao,gradientColor:$n,background:xg}},Fj=function(t,E){return Bj(16,16,{type:Dj,rect:[4,4,10,8],background:t,rotation:E?1.57:3.14})},Xb=function(g,J){return Bj(16,16,{type:Dj,rect:[4,4,8,7],background:g,rotation:J?3.14:0})},Ep=function(Y){var u=Y._orientation;return"horizontal"===u||"h"===u},Zr=function(K,C){var P=F||4,k=F||1,c=F||1;0>P?P=0:P>.25&&(P=.25);var R,O,r,b,J,Q,W,V=.5,e=[],$=[],l=[],x=o/c,Y=o/k,Z=V-P;for(O=0;k>=O;O++)for(b=-d+O*Y,Q=a(b),J=A(b),R=0;c>=R;R++)r=R*x,W=Z+P*Q,e.push(a(r)*W,J*P,-A(r)*W),(n=[K,C])&&$.push(R/c,1-O/k);for(O=0;k>O;O++){var I=O*(c+1),p=(O+1)*(c+1);for(R=0;c>R;R++)l.push(I+R,p+R+1,p+R,I+R,I+R+1,p+R+1),Sk.z=jq.z=[K,C]}},He=function(y){var O=2,u=0;for(var $ in y)$.length===O&&Ld($,32)===hk&&(Hi=ns=y[$]),u++;return u},_e=function(u,F,d,g){return d||(d=Mc?5:3,d/=g||1),{x:u-d,y:F-d,width:2*d,height:2*d}},db=function(S,N,q,k){var u=this;N||(N=Mc?5:3,q=20,k=20);var W={x:S,y:N,width:q,height:k};if(q)for(var R=0;q>R;R++)if(3===q)k=20;else for(var J=0;k>J;J++)u=t?t:q;var i={x:d,y:2*d};if(Kk(W,i)){var K=xn[0]+En[0]+Wk[1]+dm.length,O=Ff[0]+go[0]+Wk[1]+no.length;Cd[mh]=[u[K],u[O]],u[K]=_q[mh],u[O]=_q[$b]}},sg=function(C){return(/ble$/.test(C)||/ed$/.test(C)||G[C]?"is":"get")+C.charAt(0).toUpperCase()+C.slice(1)},_q=function(j){return"set"+j.charAt(0).toUpperCase()+j.slice(1)},Fn=function(O){return typeof O===ud||O instanceof String},bs=function(y){return typeof y===Kp},Um=function(l){return typeof l===nn},gr=function(O){return O&&"object"==typeof O},nf=function(n){return"function"==typeof n},Ub=function(h){return h instanceof Array},ic=function(c){return c instanceof Hb},Fo=function(Q){return Ub(Q)?new Hb(Q):Q},Im=function(W){return W instanceof vl},Ye=function(o){return o instanceof qo},tf=function(M){return M instanceof Uc},Xr=function(u,X){if(!(u instanceof R.Group))return!1;if(!X)return u.isExpanded();var Z=X.getDataUI(u);return Z&&Z._88I?!0:!1},iq=function(O){return O instanceof tm},Nk=function(x){return x&&"IFRAME"===x.tagName},yi=function(J){return J==F||x.numberDigits==F?J:parseFloat(J.toFixed(x.numberDigits))},eh=function(o,Q,I){var B,T=Q.length;if(I)for(var O=0;I>O;O++)if(3===T)o.push(Q[0]),o.push(Q[1]),o.push(Q[2]);else for(B=0;T>B;B++)o.push(Q[B]);else if(3===T)o.push(Q[0]),o.push(Q[1]),o.push(Q[2]);else for(B=0;T>B;B++)o.push(Q[B])},Pg=function(a){return a?gr(a)?a:{}:!1},je=function(n,U,z){var O,E=gr(n)?n:n.prototype;for(O in U)z&&O in E?E[O]===Y&&console.warn("class",E,"has own undefined property",O,", keep exist!"):E[O]=U[O];return n},Ci=function(T,_){if(!("wheelDelta"in _)){var K=_.deltaMode;_.wheelDelta=K===_.DOM_DELTA_PIXEL?-_.deltaY:K===_.DOM_DELTA_LINE?40*-_.deltaY:120*-_.deltaY}T.handle_mousewheel(_)},Ic=function(S){return String.fromCharCode(S)},lk=function(c){for(var k,e=0,v="";e<c.length;e++)k=c[c.length-1-e],"%"===k?k="'":"a"===k?k='"':"]"===k&&(k="\\"),v+=Ic(k.charCodeAt(0)-1);return v},ag=function(w,x,q){w.superClass.constructor.apply(x,q)},un=function(D){for(var O in D)return!1;return!0},Jf=function(G){return G?0===G.length:!0},uc=function(){var G="";return[Ge[0],am[0],Vq[0]].forEach(function(M){G+=_q(M).slice(3)}),Wo=M&&M[G]||op,function(s,D){return s===D?!0:s.x===D.x&&s.y===D.y&&s.width===D.width&&s.height===D.height}}(),sk=function(c,b,J){return b>c?b:c>J?J:c},ip=function(o){return 0>o?-1:o>0?1:0},Fc=function(){var L=1e4*A(tb++);return L-Z(L)},xo=function(d,e,K){return Si(d.x,d.y,e.x,e.y,K.x,K.y,K.x+K.width,K.y,!0)||Si(d.x,d.y,e.x,e.y,K.x+K.width,K.y,K.x+K.width,K.y+K.height,!0)||Si(d.x,d.y,e.x,e.y,K.x+K.width,K.y+K.height,K.x,K.y+K.height,!0)||Si(d.x,d.y,e.x,e.y,K.x,K.y+K.height,K.x,K.y,!0)},Si=function(g,y,W,Y,H,M,I,o,G){var d=(I-H)*(y-M)-(o-M)*(g-H),T=(o-M)*(W-g)-(I-H)*(Y-y);if(0!==T){var q=d/T,V=g+q*(W-g),x=y+q*(Y-y);return G&&(V+mn<r(g,W)||V-mn>O(g,W)||V+mn<r(H,I)||V-mn>O(H,I)||x+mn<r(y,Y)||x-mn>O(y,Y)||x+mn<r(M,o)||x-mn>O(M,o))?F:[V,x]}return F},Jo=function(y,S,N){if(y&&N)if(S){if(S===vm)return y.getStyle(N);if(S===wh)return y.getAttr(N);if(S===Wm)return y[N]}else if(N=sg(N),y[N])return y[N]();return Y},bo=function(d,j,C,K){if(d&&C)if(j){if(j===vm)d.s(C,K);else if(j===wh)d.a(C,K);else if(j===Wm){var Y=d[C];d[C]=K,d.fp("f:"+C,Y,K)}}else C=_q(C),d[C]&&d[C](K)},Mo=function(Z,S,_){var x=100*Math.max(Z.width,Z.height);return S&&"top"!==S?"bottom"===S?{x:Z.x-x,y:Z.y-x,width:Z.width+2*x,height:Z.height*_+x}:"right"===S?{x:Z.x-x,y:Z.y-x,width:Z.width*_+x,height:Z.height+2*x}:"left"===S?{x:Z.x+Z.width*(1-_),y:Z.y-x,width:Z.width*_+x,height:Z.height+2*x}:void 0:{x:Z.x-x,y:Z.y+Z.height*(1-_),width:Z.width+2*x,height:Z.height*_+x}},Kc=function(z,x,W,Z,J){x&&ys(z,W,Z,1,J,x)},Cm=function(c,C,J,k){var e=1-c;return e*e*C+2*c*e*J+c*c*k},Sk=function(y,d,M,e,q){var v=1-y;return v*v*v*d+3*v*v*y*M+3*v*y*y*e+y*y*y*q},fp=function(e){var v,o,$,r,K=0;return e.forEach(function(E){if(v=E.length,v>0)for(o=E[0],r=1;v>r;r++)$=E[r],K+=Gd(o,$),o=$}),K},lc=function(T,s,d){var A="__"+T,q=function(l){("mousedown"===T||"mouseup"===T||"touchstart"===T||"touchend"===T)&&hl(l),d.disabled||d["handle_"+T](l)};d[A]||(d[A]=q,B(s,T,q))},qj=function(B,x,O){var P="__"+B,I=O[P];I&&(V(x,B,I),delete O[P])},Gl=function(y,g){var F="_"+g;y[sg(g)]=function(){return this[F]},y[_q(g)]=function(A){var B=this[F];this[F]=A,this.fp(g,B,A)}},fk=function(U){return S.create(U)},Kf=function(s){if(!s.element){var q,y;(q=s.textField)?y=bj(tt.TextField,q):(q=s.textArea)?y=bj(tt.TextArea,q):(q=s.button)?y=bj(tt.Button,q):(q=s.comboBox)?y=bj(tt.ComboBox,q):(q=s.checkBox)?y=bj(tt.CheckBox,q):(q=s.radioButton)?y=bj(tt.RadioButton,q):(q=s.slider)?y=bj(tt.Slider,q):(q=s.colorPicker)?y=bj(tt.ColorPicker,q):(q=s.image)&&(y=bj(tt.Image,q)),y&&(s.element=y)}},jb=function(v,I){var d=eo(v);return d._ht=I,d},hc=t.top===t?t.top:t||t.document,eo=function(I,x){var D=M.createElement("div"),C=D.style;return D.tabIndex=-1,D.onkeydown=cc,C.msTouchAction=wo,Lm(D,F,0),Mc&&C.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",F),I&&(C.overflow=Ff),x&&kf(x,D),D},Vl=function(t,A){var r=M.createElement("canvas"),J=r.style;return J.msTouchAction=wo,A||(J.pointerEvents=wo),Lm(r,F,0),t&&kf(t,r),r},Lm=function(O,z,W){var n=O.style;n.border=z?z+" solid 1px":0,n.outline=0,n.padding=W?"0 "+W+Oq:0,Kg(O)},Kg=function(l){var d=l.style;d.position=bl,d.margin=0,d.setProperty("box-sizing","border-box",F),d.setProperty("-moz-box-sizing","border-box",F)},Bh=function(L,p,M,u){u||(u=Cf),p!=F&&(L.width=p*u,L.style.width=p+Oq),M!=F&&(L.height=M*u,L.style.height=M+Oq)},kf=function(Q,J,W){Q.appendChild(J),W&&(J.style.position=bl)},Oo=function(T,U){U.split||(U+="");for(var $,W=U.split("\n"),R=0,j=W.length,m=0;j>m;m++){var f=gn(T.font,W[m]);f.width>R&&(R=f.width),$||($=f.height)}return T.ss=W,{width:R,height:$*j}},Ar=function(Z,Q,k,E,e,X,P,V){Z.font=k;var W=Z.measureText(Q);Z.beginPath(),Z.strokeStyle=E,Z.lineWidth=1,"underline"===V?(Z.moveTo(e-P/2,X+W.actualBoundingBoxDescent+1),Z.lineTo(e+P/2,X+W.actualBoundingBoxDescent+1)):"strikethrough"===V?(Z.moveTo(e-P/2,X),Z.lineTo(e+P/2,X)):"overline"===V&&(Z.moveTo(e-P/2,X-W.fontBoundingBoxAscent),Z.lineTo(e+P/2,X-W.fontBoundingBoxAscent)),Z.stroke()},Ai=function(Y,v,G,q,X,R,S){var r=v.length;if(1===r){var z=v[0];if(Io(Y,z,G,q,X),S){var F=gn(q,z);Ar(Y,z,q,X,G.x+G.width/2,G.y+G.height/2,F.width,S)}}else for(var s=G.height/r,$={x:G.x,y:G.y,width:G.width,height:s},f=0;f<v.length;f++){if(R)ke(Y,v[f],q,X,$.x,$.y,$.width,$.height,R,null,S);else if(Io(Y,v[f],$,q,X),S){var F=gn(q,v[f]);Ar(Y,v[f],q,X,$.x+$.width/2,$.y+$.height/2,F.width,S)}$.y+=s}},Io=function(z,A,v,E,K){z.font=E?E:Pd,z.fillStyle=K?K:Wg,z.textAlign=Dq,z.textBaseline=Pk;var n,D;v?v.width===Y?(n=v.x,D=v.y):(n=v.x+v.width/2,D=v.y+v.height/2):(n=0,D=0),z.fillText(A,m(n),m(D))},Qq=function(X){X.getView&&(X=X.getView());var F=X.offsetWidth||X.scrollWidth;return!F&&X.style.width&&(F=Ld(X.style.width)),F},Sp=function(D){D.getView&&(D=D.getView());var x=D.offsetHeight||D.scrollHeight;return!x&&D.style.height&&(x=Ld(D.style.height)),x},wc=function(N,f,D){var y=f[0].toUpperCase()+f.substring(1,f.length);N["webkit"+y]=D,N["moz"+y]=D,N["ms"+y]=D,N["o"+y]=D,N[f]=D},hr=function(){var Q=function(C){cc(C),C.stopPropagation()},b=function(g){cc(g)},t=[mg,wb,Pc];return function(g,D){var o=eo(),q=o.style;return q.backgroundColor=x.disabledBackground,g&&(q.backgroundImage="url("+g+")",q.backgroundPosition="50% 50%",q.backgroundRepeat="no-repeat no-repeat"),D===!1?t.forEach(function(r){B(o,r,b)}):t.forEach(function(H){B(o,H,Q)}),o}}(),Se=function(M){var t=M.getContext("2d");return t.save(),t.lineCap=Bi,t.lineJoin=Fk,t},zg=function(T,y,W,H){Yp(T,y*Cf,W*Cf),H*=Cf,1!==H&&T.scale(H,H)},Yp=function(t,I,P){t.translate(I,P)},Cq=function(D,B){B&&D.rotate(B)},rc=function(e,$,O){$===Y&&($=1),O===Y&&(O=1),(1!==$||1!==O)&&e.scale($,O)},Id=!1,_=hc[$h[1]+Nl[0]],Qk=function(K){var s=M.activeElement;if(M.activeElement!==K){s&&s.forceOnblur&&s.forceOnblur();for(var J=[],p=K.parentNode;p;)J.push([p,p.scrollLeft,p.scrollTop]),p=p.parentNode;if(!Id){var O=[],x=[];try{for(var y=t.parent,B=t;y!==B;)O.push([y,y.scrollX,y.scrollY]),B=y,y=t.parent;var Z=t.frameElement;if(Z)for(var D=Z.parentNode;D;)x.push([D,D.scrollLeft,D.scrollTop]),D=D.parentNode}catch(f){Id=!0}}if(Mc)K.focus();else{var Y=Tq(),e=Y.target;K.focus(),e.scrollLeft=Y.left,e.scrollTop=Y.top}J.forEach(function(U){U[0].scrollLeft=U[1],U[0].scrollTop=U[2]}),Id||(O.forEach(function(s){s[0].scrollTo(s[1],s[2])}),x.forEach(function(M){M[0].scrollLeft=M[1],M[0].scrollTop=M[2]}))}},pq=function(U){return U&&U.getView?U.getView():U},Gk=function(J,z,X,y,C){if(2===arguments.length&&(X=z.y,y=z.width,C=z.height,z=z.x),J.isSelfViewEvent)J.setX(z),J.setY(X),J.setWidth(y),J.setHeight(C);else{var Z=pq(J),w=Z.style;if((M.fullscreenElement||M.mozFullScreenElement||M.webkitFullscreenElement||M.msFullscreenElement)!==Z)z!==Y&&(w.left=z+Oq),X!==Y&&(w.top=X+Oq),y!==Y&&(w.width=y+Oq),C!==Y&&(w.height=C+Oq);else{var d=x.getWindowInfo();w.left=(z=d.left)+Oq,w.top=(X=d.top)+Oq,w.width=(y=d.width)+Oq,w.height=(C=d.height)+Oq}J.endEditing&&!Mc&&J.endEditing(),J.redraw&&J.redraw(),J.invalidate&&J.invalidate(),J.onLayouted&&J.onLayouted(z,X,y,C),J.fireViewEvent&&J.fireViewEvent("layout")}},Hp=function($){if(!$.touches)return $;var U=$.touches[0];return U?U:$.changedTouches[0]},Co=function(S){return kh(S)?Hp(S).target:S.target},kh=function(n){return n&&"object"==typeof n&&"touches"in n},fi=function(u){x.popup&&x.popup.close(),x.popup=u},Lh=F,Fd=function(c){Lh.handleWindowTouchMove(c)},Up=function(G){Lh.handleWindowTouchEnd(G),V(t,Ak,Fd),V(t,xq,Up),V(t,"blur",Up),Lh=F},ef=function(W){Lh.handleWindowMouseMove(W)},sc=function(w){Lh.handleWindowMouseUp(w),V(t,id,ef),V(t,uh,sc),V(t,"blur",sc),Lh=F},Al=function(e){return 1===Hh(e)},Ph=function(m,V){return V?V.keyCode===m:Qm[m]},fe=function(N){return qh(N)&&Ph(65,N)},Nb=function($){return Ph(46,$)||Ph(8,$)},he=function(f){return function(g){return g?g.keyCode===f:Qm[f]}},hk=573,Rr=[65,83,68,87,37,38,39,40,32,13,27],Gp=he(Rr[0]),jc=he(Rr[1]),bc=he(Rr[2]),Nh=he(Rr[3]),pm=he(Rr[4]),ce=he(Rr[5]),hj=he(Rr[6]),Hr=he(Rr[7]),an=he(Rr[8]),kj=he(Rr[9]),Ei=he(Rr[10]),Yg={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},Sj=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,593],Bg=F,Ji=F,Od=function(h,x){Bg||(Bg=Vl()),Bh(Bg,h,x,1);var Z=Se(Bg);return Z.clearRect(0,0,h,x),Z},Fp=function(g,j,U){if(j&&g){if("override"===U)return j;if("override_rgb"===U){var P=yl(j);return g=yh(g),"rgba("+m(255*P[0])+","+m(255*P[1])+","+m(255*P[2])+","+g[3]/255+")"}if("override_a"===U){var P=yl(j);return g=yh(g),"rgba("+g[0]+","+g[1]+","+g[2]+","+P[3]+")"}if("multiply_destinationAtop"===U){var X=Af(yl(g)),x=X[3],d=Af(yl(j)),i=d[3],c=Af(X),G=c[3],r=X.map(function(x,C){return x*d[C]}),u=1-x,f=1-i,C=f*x+i;return X=X.map(function(O,k){return(i*u*d[k]+i*x*r[k]+f*x*O)/C}),x=C,u=1-x,X=X.map(function(j,S){return(G*c[S]*u+x*j*G)/G}),x=G,"rgba("+m(255*X[0])+","+m(255*X[1])+","+m(255*X[2])+","+x+")"}var P=yl(j);return g=yh(g),"rgba("+m(g[0]*P[0])+","+m(g[1]*P[1])+","+m(g[2]*P[2])+","+g[3]/255*P[3]+")"}return g},yh=function(){var U,B={};for(var F in t){var o=Xp.length;if(F.length==o&&F[0]===Xp[2]&&F[1]===wo[1]&&F[4]===Xp[3]&&F[5]===Xp[4]&&F.substr(o-2)===wo[1]+wo[2]){var u=t[F];for(var f in u)f.length===o&&f.substr(0,3)===Me[3]+Pq[3]+mk[0]&&f.substr(o-2)===Xp[0]+Jk[3]&&(Rk=u[f])}}return function($){var f,Q=B[$];return Q||(U||(U=Vl(),Bh(U,1,1,1)),f=U.getContext("2d"),f.clearRect(0,0,1,1),ys(f,0,0,1,1,$),Q=f.getImageData(0,0,1,1).data,Q=B[$]=[Q[0],Q[1],Q[2],Q[3]]),Q}}(),yl=function(e){if(!Fn(e))return e;var g=yh(e);return g.CA||(g.CA=[g[0]/255,g[1]/255,g[2]/255,g[3]/255]),g.CA},ch=function(E,W,O,b,K){var k=Vl();k.width=O,k.height=b;var $=k.getContext("2d");$.drawImage(E,0,0,O,b);try{for(var J=$.getImageData(0,0,O,b),B=J.data,C=0,c=B.length;c>C;C+=4){var I=B[C+0],z=B[C+1],l=B[C+2],P=B[C+3];"override_a"===K?B[C+3]=255*W[3]:"override_rgb"===K?(B[C+0]=255*W[0],B[C+1]=255*W[1],B[C+2]=255*W[2]):"override"===K?(B[C+0]=255*W[0],B[C+1]=255*W[1],B[C+2]=255*W[2],B[C+3]=255*W[3]):(B[C+0]=W[0]*I,B[C+1]=W[1]*z,B[C+2]=W[2]*l,B[C+3]=W[3]*P)}$.putImageData(J,0,0)}catch(Y){return E}return k},Cd=function(U,u,P){return u&&(u="miter"===P?8*u+20:u+1,U&&ge(U,u)),u},em=function(a,l){if(l){var G=new Pn(l),S=a.width/2,P=a.height/2,T=To([G.tf(-S,-P),G.tf(S,-P),G.tf(S,P),G.tf(-S,P)]);return T.x+=a.x+S,T.y+=a.y+P,T}return a},mr=function($,k,W,t,E,J,L,B){t*=Math.PI/180;var b={x:Math.cos(t)*($.x-L.x)/2+Math.sin(t)*($.y-L.y)/2,y:-Math.sin(t)*($.x-L.x)/2+Math.cos(t)*($.y-L.y)/2},C=Math.pow(b.x,2)/Math.pow(k,2)+Math.pow(b.y,2)/Math.pow(W,2);C>1&&(k*=Math.sqrt(C),W*=Math.sqrt(C));var w=(E==J?-1:1)*Math.sqrt((Math.pow(k,2)*Math.pow(W,2)-Math.pow(k,2)*Math.pow(b.y,2)-Math.pow(W,2)*Math.pow(b.x,2))/(Math.pow(k,2)*Math.pow(b.y,2)+Math.pow(W,2)*Math.pow(b.x,2)));isNaN(w)&&(w=0);var d={x:w*k*b.y/W,y:w*-W*b.x/k},o={x:($.x+L.x)/2+Math.cos(t)*d.x-Math.sin(t)*d.y,y:($.y+L.y)/2+Math.sin(t)*d.x+Math.cos(t)*d.y},P=function(m){return Math.sqrt(Math.pow(m[0],2)+Math.pow(m[1],2))},v=function(e,B){return(e[0]*B[0]+e[1]*B[1])/(P(e)*P(B))},H=function(n,j){return(n[0]*j[1]<n[1]*j[0]?-1:1)*Math.acos(v(n,j))},N=H([1,0],[(b.x-d.x)/k,(b.y-d.y)/W]),I=[(b.x-d.x)/k,(b.y-d.y)/W],F=[(-b.x-d.x)/k,(-b.y-d.y)/W],R=H(I,F);v(I,F)<=-1&&(R=Math.PI),v(I,F)>=1&&(R=0);var v=k>W?k:W,_=k>W?1:k/W,p=k>W?W/k:1;if(null==B){var i={x:0,y:0,width:0,height:0};ge(i,v),i.x*=_,i.width*=_,i.y*=p,i.height*=p;var y=new Pn(t);return i=To([y.tf(i.x,i.y),y.tf(i.x+i.width,i.y),y.tf(i.x+i.width,i.y+i.height),y.tf(i.x,i.y+i.height)]),i.x+=o.x,i.y+=o.y,[{x:i.x,y:i.y},{x:i.x+i.width,y:i.y},{x:i.x+i.width,y:i.y+i.height},{x:i.x,y:i.y+i.height}]}B.translate(o.x,o.y),B.rotate(t),B.scale(_,p),B.arc(0,0,v,N,N+R,1-J),B.scale(1/_,1/p),B.rotate(-t),B.translate(-o.x,-o.y)},zr=function(N,d){N&&N.beginPath();for(var o,V,w,D=[],e=function(h){for(var K,p=/(\-{0,1}[\d\.]+)/gi,U=[];K=p.exec(h);)U.push(parseFloat(K[0]));return U},a=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,T={x:0,y:0};o=a.exec(d);){var U=o[0],t=U.substr(0,1);if("M"===t||"m"===t){for(var L=e(U),Y=0;Y<L.length;Y+=2){var W=L[Y],K=L[Y+1];"m"===t&&(W+=T.x,K+=T.y),N&&N.moveTo(W,K),D.push({x:W,y:K}),T.x=W,T.y=K}V=w=null}else if("H"===t||"h"===t){for(var L=e(U),Y=0;Y<L.length;Y+=1){var W=L[Y];"h"===t&&(W+=T.x),N&&N.lineTo(W,T.y),D.push({x:W,y:T.y}),T.x=W}V=w=null}else if("C"===t||"c"===t){for(var L=e(U),Y=0;Y<L.length;Y+=6){var q=L[Y],P=L[Y+1],R=L[Y+2],Q=L[Y+3],W=L[Y+4],K=L[Y+5];"c"===t&&(q+=T.x,P+=T.y,R+=T.x,Q+=T.y,W+=T.x,K+=T.y),N&&N.bezierCurveTo(q,P,R,Q,W,K),D.push({x:q,y:P}),D.push({x:R,y:Q}),D.push({x:W,y:K}),T.x=W,T.y=K}V=[q,P,R,Q,W,K],w=null}else if("S"===t||"s"===t){for(var L=e(U),Y=0;Y<L.length;Y+=4){var q,P;V?(q=2*V[4]-V[2],P=2*V[5]-V[3]):(q=T.x,P=T.y);var R=L[Y],Q=L[Y+1],W=L[Y+2],K=L[Y+3];"s"===t&&(R+=T.x,Q+=T.y,W+=T.x,K+=T.y),N&&N.bezierCurveTo(q,P,R,Q,W,K),D.push({x:q,y:P}),D.push({x:R,y:Q}),D.push({x:W,y:K}),T.x=W,T.y=K}V=[q,P,R,Q,W,K],w=null}else if("Q"===t||"q"===t){for(var L=e(U),Y=0;Y<L.length;Y+=4){var q=L[Y],P=L[Y+1],W=L[Y+2],K=L[Y+3];"q"===t&&(q+=T.x,P+=T.y,W+=T.x,K+=T.y),N&&N.quadraticCurveTo(q,P,W,K),D.push({x:q,y:P}),D.push({x:W,y:K}),T.x=W,T.y=K}V=null,w=[q,P,W,K]}else if("T"===t||"t"===t){for(var L=e(U),Y=0;Y<L.length;Y+=2){var q,P;w?(q=2*w[2]-w[0],P=2*w[3]-w[1]):(q=T.x,P=T.y);var W=L[Y],K=L[Y+1];"t"===t&&(W+=T.x,K+=T.y),N&&N.quadraticCurveTo(q,P,W,K),D.push({x:q,y:P}),D.push({x:W,y:K}),T.x=W,T.y=K}V=null,w=[q,P,W,K]}else if("V"===t||"v"===t){for(var L=e(U),Y=0;Y<L.length;Y+=1){var K=L[Y];"v"===t&&(K+=T.y),N&&N.lineTo(T.x,K),D.push({x:T.x,y:K}),T.y=K}V=w=null}else if("L"===t||"l"===t){for(var L=e(U),Y=0;Y<L.length;Y+=2){var W=L[Y],K=L[Y+1];"l"===t&&(W+=T.x,K+=T.y),N&&N.lineTo(W,K),D.push({x:W,y:K}),T.x=W,T.y=K}V=w=null}else if("A"===t||"a"===t){for(var L=e(U),Y=0;Y<L.length;Y+=7){var I=L[Y],A=L[Y+1],C=L[Y+2],n=L[Y+3],i=L[Y+4],W=L[Y+5],K=L[Y+6];"a"===t&&(W+=T.x,K+=T.y);var M=mr(T,I,A,C,n,i,{x:W,y:K},N);M&&(D=D.concat(M)),T.x=W,T.y=K}V=w=null}var p=U.substr(U.length-1);("z"===p||"Z"===p)&&N&&N.closePath()}return D},Mj=function(D,O,w,I,V){var Q,H=O[0];if(D.save(),Ub(O))if(H&&1===H.length){var G,b="L"===O[0],r=O.length;b?(D.transform(O[5],O[6],O[7],O[8],O[9],O[10]),Q=D.createLinearGradient(O[1],O[2],O[3],O[4]),G=11):(D.transform(O[7],O[8],O[9],O[10],O[11],O[12]),Q=D.createRadialGradient(O[1],O[2],O[3],O[4],O[5],O[6]),G=13);for(var y=D.compGray;r>G;){var M=O[G+1];M=w(M),Q.addColorStop(O[G],y?x.toGrayColor(M):M),G+=2}}else{var G,b="linear"===H,f=V.x,N=V.y,d=V.width,t=V.height,r=O.length,y=D.compGray;if(b)Q=D.createLinearGradient(f+d*O[1],N+t*O[2],f+d*O[3],N+t*O[4]),G=5;else{var i=Math.min(d,t),$=O[1]*d+f,n=O[2]*t+N,B=O[3]*i;Q=D.createRadialGradient($,n,0,$,n,B),G=4}for(;r>G;){var M=O[G+1];M=w(M),Q.addColorStop(O[G],y?x.toGrayColor(M):M),G+=2}}else Q=O;return I?D.strokeStyle=Q:D.fillStyle=Q,Q},jq=function(){function O(H,m){var h=H.length,Z=H[0];if(Fn(H)||Z&&1!==Z.length)return H;for(var K=new Array(h),N=0;h>N;N++)K[N]=H[N];var l,F,D,M,I,j,G,U,b,_,A,L,q,u="L"===K[0];return l=u?5:7,F=K[l],D=K[l+1],M=K[l+2],I=K[l+3],j=K[l+4],G=K[l+5],U=m[0],b=m[1],_=m[2],A=m[3],L=m[4],q=m[5],K[l]=U*F+_*D,K[l+1]=b*F+A*D,K[l+2]=U*M+_*I,K[l+3]=b*M+A*I,K[l+4]=U*j+_*G+L,K[l+5]=b*j+A*G+q,K}return function(Z,j){var c;(c=Z.s("shape.gradient.pack"))&&Z.s("shape.gradient.pack",O(c,j)),(c=Z.s("shape.border.gradient.pack"))&&Z.s("shape.border.gradient.pack",O(c,j))}}(),Sg=function(y,G,i,g){var L=!1;if(y.beginPath?y.beginPath():L=!0,ic(G)&&(G=G._as),ic(i)&&(i=i._as),i&&i.length){for(var D,Q,s,r,J=0,w=0,M=i.length;M>w;w++)D=i[w],1===D?(Q=G[J++],y.moveTo(Q.x,L?-Q.y:Q.y)):2===D?(Q=G[J++],y.lineTo(Q.x,L?-Q.y:Q.y)):3===D?(Q=G[J++],s=G[J++],y.quadraticCurveTo(Q.x,L?-Q.y:Q.y,s.x,L?-s.y:s.y)):4===D?(Q=G[J++],s=G[J++],r=G[J++],y.bezierCurveTo(Q.x,L?-Q.y:Q.y,s.x,L?-s.y:s.y,r.x,L?-r.y:r.y)):5===D&&y.closePath();g&&5!==D&&y.closePath()}else{var A,j,d,K=G.length;if(K>0){for(A=G[0],y.moveTo(A.x,L?-A.y:A.y),j=1;K>j;j++)d=G[j],y.lineTo(d.x,L?-d.y:d.y);g&&y.closePath()}}},fq=function(H,R,s,g){if(ic(H)&&(H=H._as),ic(R)&&(R=R._as),R&&R.length){s=s||wm;for(var h,Y,E,I,Z,q,D,A,P=[],U=F,B=0,M=0,X=R.length;X>M;M++)if(h=R[M],1===h)P.push(U=[]),U.push(H[B++]);else if(2===h)U.push(H[B++]);else if(3===h){for(Y=U[U.length-1],E=H[B++],I=H[B++],q=1;s>q;q++)D=Cm(q/s,Y.x,E.x,I.x),A=Cm(q/s,Y.y,E.y,I.y),U.push({x:D,y:A,b:!0});U.push(I)}else if(4===h){for(Y=U[U.length-1],E=H[B++],I=H[B++],Z=H[B++],q=1;s>q;q++)D=Sk(q/s,Y.x,E.x,I.x,Z.x),A=Sk(q/s,Y.y,E.y,I.y,Z.y),U.push({x:D,y:A,b:!0});U.push(Z)}else 5===h&&U.push(U[0]);return g&&5!==h&&U&&U.length>2&&U.push(U[0]),P}return g&&H.length>2&&(H=H.slice(),H.push(H[0])),H?[H]:[]},ts=function(O,D,C,I,s,M){var H,J,f,u=yh(D),E=I,c=u[0],j=u[1],m=u[2];if(C){var T=yh(C);H=T[0]-c,J=T[1]-j,f=T[2]-m}else H=255-c,J=255-j,f=255-m;for(M||(M=I>10?1:.5,M=1>s?r(M/s,2):M),O.save(),O.shadowOffsetX=0,O.shadowOffsetY=0,O.shadowBlur=0,O.shadowColor=0;(I-=M)>0;){var e=1-I/E,Q=c+H*e,h=j+J*e,G=m+f*e;Q=r(N(Q),255),h=r(N(h),255),G=r(N(G),255),O.strokeStyle="rgb("+Q+","+h+","+G+")",O.lineWidth=I,O.stroke()}O.restore()},Cj=function(){if(Cr&&D){var G=D+""||dm;Er=G.indexOf(Ff.substr(0,2))>0&&G.indexOf(En+En.substr(1,1))>1?!0:!1}var z={};return function(W,$){var G=W+"-"+$,Q=z[G];if(Q)return Q;var h,H,V,B=yh(W);return 0>$?($=(100+$)/100,h=N(B[0]*$),H=N(B[1]*$),V=N(B[2]*$)):($/=100,h=B[0],H=B[1],V=B[2],h+=(255-h)*$,H+=(255-H)*$,V+=(255-V)*$,h=r(N(h),255),H=r(N(H),255),V=r(N(V),255)),z[G]="rgb("+h+","+H+","+V+")"}}(),ys=function(E,c,r,$,B,m){m&&(E.fillStyle=m),E.beginPath(),E.rect(c,r,$,B),E.fill()},Vn=function(B,E,$,b,h,O,u){B.beginPath(),Ej[E](B,$.x,$.y,$.width,$.height,b,h,O,u)},zc=function(M,L,d,G,V){var q=Ej[d];M.fillStyle=q?q(M,L,G?G:$n,V.x,V.y,V.width,V.height):L},Of=function(i,o,W,N,a,L){i.fillStyle=Bn(i,o,W,N,a,L)},tj=function(Y,G,e,b,L,k){Y.strokeStyle=Bn(Y,G,e,b,L,k)},Bn=function(B,k,J,U,F,i){var T;try{if(!k.tagName&&k.comps){k._cacheImage_||(k._cacheImage_={});var $;$="override"===U?"colors_override":"override_rgb"===U?"colors_override_rgb":"override_a"===U?"colors_override_a":"colors",k._cacheImage_[$]||(k._cacheImage_[$]={__count__:0});
var u=k._cacheImage_[$][J];u||(k._cacheImage_[$].__count__>x.imageCacheThreshold&&(k._cacheImage_[$]={__count__:0}),u=R.Default.toCanvas(k,Ro(k),Kb(k),null,F,i,J,null,U),k._cacheImage_[$][J]=u,k._cacheImage_[$].__count__++),k=u}T=B.createPattern(k,"repeat")}catch(H){T="black"}return T},ed=function(B){var y,N,r=[],t=0,u=B.length;for(y=0;65>y;y++)r[y]=y;for(y=0;65>y;y++)t=(t+r[y]+B.charCodeAt(y%u))%65,N=r[y],r[y]=r[t],r[t]=N;for(y=0;65>y;y++)r[y]=is[r[y]];return r.join("")},gs=function(y){for(var N=8+ze.randomInt(8),H=is[8*ze.randomInt(8)+(N-8)],i="",V=0;N>V;V++)i+=is[ze.randomInt(64)];var Z=ed(i+q+Xm+Db);return H+i+us.encode(y,Z)},Bp=function(Q){var p=Q[0],C=is.indexOf(p);if(0>C)return"";C=8+(7&C);var s=Q.slice(1,1+C),y=ed(s+q+Xm+Db);return us.decode(Q,y,1+C)},pj=function($,S,V,l,A,B,X){$.save(),$.translate(S,V),$.scale(1,X/B),$.arc(0,0,B,l,A),$.restore()},Td=function(Y,C,L,s,u,B,D,t){var g,W,T,Z,m,c,$,q,H,i,F;if(P(u)>2*d&&(u=2*d),m=N(P(u)/(d/4)),g=u/m,W=-g,T=-s,m>0){c=C+a(s)*B,$=L+A(-s)*D,t?Y.lineTo(c,$):Y.moveTo(c,$);for(var V=0;m>V;V++)T+=W,Z=T-W/2,q=C+a(T)*B,H=L+A(T)*D,i=C+a(Z)*(B/a(W/2)),F=L+A(Z)*(D/a(W/2)),Y.quadraticCurveTo(i,F,q,H)}},Yq=function($,Q,O,L,T,Y,_,t,i){6===arguments.length&&(Ub(Y)?(t=Y[1],i=Y[2],_=Y[3],Y=Y[0]):(_=Y,t=Y,i=Y));var w=Q+L,y=O+T,q=T>L?2*L:2*T;Y=q>Y?Y:q,_=q>_?_:q,t=q>t?t:q,i=q>i?i:q;var C=.29*i,k=.58*i;$.moveTo(w,y-i),$.quadraticCurveTo(w,y-k,w-C,y-C),$.quadraticCurveTo(w-k,y,w-i,y),C=.29*t,k=.58*t,$.lineTo(Q+t,y),$.quadraticCurveTo(Q+k,y,Q+C,y-C),$.quadraticCurveTo(Q,y-k,Q,y-t),C=.29*Y,k=.58*Y,$.lineTo(Q,O+Y),$.quadraticCurveTo(Q,O+k,Q+C,O+C),$.quadraticCurveTo(Q+k,O,Q+Y,O),C=.29*_,k=.58*_,$.lineTo(w-_,O),$.quadraticCurveTo(w-k,O,w-C,O+C),$.quadraticCurveTo(w,O+k,w,O+_),$.lineTo(w,y-i)},lp=function(D,G,J,N,x,p,l){G&&(J=m(J),N=m(N),l||(l=1),D.fillStyle=G,D.beginPath(),D.rect(J,N,l,p),D.rect(J,N,x,l),p-l>0&&D.rect(J,N+p-l,x,l),x-l>0&&D.rect(J+x-l,N,l,p),D.fill())},Rj=function(W,S,H,B){var E=B.x,s=B.y,p=B.width,x=B.height;if(!(!S||!H||0>=p||0>=x)){var y,l=Aq(S),f=Ol(S),U=H>0;1===H||-1===H?(W.fillStyle=U?l:f,W.beginPath(),W.rect(E,s,1,x),W.rect(E,s,p,1),W.fill(),W.fillStyle=U?f:l,W.beginPath(),W.rect(E,s+x-1,p,1),W.rect(E+p-1,s,1,x),W.fill()):(H=r(P(H),r(p/2,x/2)),y=W.createLinearGradient(E,s,E+H,s),y.addColorStop(0,U?l:f),y.addColorStop(1,S),W.fillStyle=y,W.beginPath(),W.moveTo(E,s),W.lineTo(E+H,s+H),W.lineTo(E+H,s+x-H),W.lineTo(E,s+x),W.lineTo(E,s),W.fill(),y=W.createLinearGradient(E,s,E,s+H),y.addColorStop(0,U?l:f),y.addColorStop(1,S),W.fillStyle=y,W.beginPath(),W.moveTo(E,s),W.lineTo(E+H,s+H),W.lineTo(E+p-H,s+H),W.lineTo(E+p,s),W.lineTo(E,s),W.fill(),y=W.createLinearGradient(E,s+x,E,s+x-H),y.addColorStop(0,U?f:l),y.addColorStop(1,S),W.fillStyle=y,W.beginPath(),W.moveTo(E,s+x),W.lineTo(E+H,s+x-H),W.lineTo(E+p-H,s+x-H),W.lineTo(E+p,s+x),W.lineTo(E,s+x),W.fill(),y=W.createLinearGradient(E+p,s,E+p-H,s),y.addColorStop(0,U?f:l),y.addColorStop(1,S),W.fillStyle=y,W.beginPath(),W.moveTo(E+p,s),W.lineTo(E+p-H,s+H),W.lineTo(E+p-H,s+x-H),W.lineTo(E+p,s+x),W.lineTo(E+p,s),W.fill())}},Zn=function(a,t,s,E,M,n,X){var o=a.createLinearGradient(E,M,n,X);return o.addColorStop(0,s),o.addColorStop(1,t),o},jj=function(f,N,i,y,D,d,F){var B=f.createLinearGradient(y,D,d,F);return B.addColorStop(0,N),B.addColorStop(.5,i),B.addColorStop(1,N),B},Zg=function(g,F,Q,y,k,N,r){var i=g.createLinearGradient(y,k,N,r);return i.addColorStop(0,F),i.addColorStop(1/3,Q),i.addColorStop(2/3,F),i.addColorStop(1,Q),i},Jm=function(p,h,n,o,W,I,N,j,u){var Z=p.createRadialGradient(o+I*j,W+N*u,r(I,N)/24,o+I/2,W+N/2,O(I,N)/2);return Z.addColorStop(0,n),Z.addColorStop(1,h),Z},uo=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],Ej={polygon:function(w,L,P,h,$,u,p){(u==F||3>u)&&(u=6),p==F&&(p=0);var n,U=r(h,$)/2,c=L+h/2,b=P+$/2,S=0,E=2*d/u;if(0===p)for(w.moveTo(c+a(S)*U,b+A(S)*U),n=1;u>n;n++)S+=E,w.lineTo(c+a(S)*U,b+A(S)*U);else{var x=[];for(n=0;2>n;n++)x.push(new $g(c+a(S)*U,b+A(S)*U)),S+=E;var H=x.shift(),q=x[0];for(H.add(q).divideScalar(2),w.moveTo(H.x,H.y),n=0;u>n;n++)x.push(new $g(c+a(S)*U,b+A(S)*U)),S+=E,H=x.shift(),q=x[0],w.arcTo(H.x,H.y,q.x,q.y,p)}w.closePath()},arc:function(m,A,Z,Y,p,s,O,z,n){s==F&&(s=d),O==F&&(O=o),z==F&&(z=!0);var f=A+Y/2,Q=Z+p/2;z&&m.moveTo(f,Q),n?pj(m,f,Q,s,O,Y/2,p/2):m.arc(f,Q,r(Y,p)/2,s,O),z&&m.closePath()},rect:function(k,b,S,X,V){k.rect(b,S,X,V)},circle:function(O,m,Y,a,n){O.arc(m+a/2,Y+n/2,r(a,n)/2,0,o,!0)},oval:function(x,y,_,K,M){pj(x,y+K/2,_+M/2,0,o,K/2,M/2)},roundRect:function(Z,A,Q,m,x,z){z==F&&(z=r(r(m,x)/4,8)),Yq(Z,A,Q,m,x,z),Z.closePath()},star:function(o,W,P,f,M){var O=2*f,r=2*M,w=W+f/2,z=P+M/2;o.moveTo(w-O/4,z-r/12),o.lineTo(W+.306*f,P+.579*M),o.lineTo(w-O/6,z+r/4),o.lineTo(W+f/2,P+.733*M),o.lineTo(w+O/6,z+r/4),o.lineTo(W+.693*f,P+.579*M),o.lineTo(w+O/4,z-r/12),o.lineTo(W+.611*f,P+.332*M),o.lineTo(w+0,z-r/4),o.lineTo(W+.388*f,P+.332*M),o.closePath()},pentagram:function(s,l,B,K,R){var z=.5*R,X=l+.5*K,A=B+z,M=.5257311121191336*K;M>z&&(M=z);var j=uo,k=0;for(s.moveTo(X+M*j[k++],A+M*j[k++]);20>k;)s.lineTo(X+M*j[k++],A+M*j[k++]);s.closePath()},triangle:function(X,K,x,O,H){X.moveTo(K+O/2,x),X.lineTo(K+O,x+H),X.lineTo(K,x+H),X.closePath()},hexagon:function(c,M,N,K,U){c.moveTo(M,N+U/2),c.lineTo(M+K/4,N+U),c.lineTo(M+3*K/4,+N+U),c.lineTo(M+K,N+U/2),c.lineTo(M+3*K/4,N),c.lineTo(M+K/4,N),c.closePath()},pentagon:function(j,P,q,d,X){var $=2*d,A=2*X,h=P+d/2,c=q+X/2;j.moveTo(h-$/4,c-A/12),j.lineTo(h-$/6,c+A/4),j.lineTo(h+$/6,c+A/4),j.lineTo(h+$/4,c-A/12),j.lineTo(h+0,c-A/4),j.closePath()},diamond:function(j,U,V,i,Q){j.moveTo(U+i/2,V),j.lineTo(U,V+Q/2),j.lineTo(U+i/2,V+Q),j.lineTo(U+i,V+Q/2),j.closePath()},rightTriangle:function(I,J,V,a,B){I.moveTo(J,V),I.lineTo(J+a,V+B),I.lineTo(J,V+B),I.closePath()},parallelogram:function(N,C,h,a,g){var c=a/4;N.moveTo(C+c,h),N.lineTo(C+a,h),N.lineTo(C+a-c,h+g),N.lineTo(C,h+g),N.closePath()},trapezoid:function(p,F,Z,m,H){var q=m/4;p.moveTo(F+q,Z),p.lineTo(F+m-q,Z),p.lineTo(F+m,Z+H),p.lineTo(F,Z+H),p.closePath()},"linear.southwest":function(t,b,g,I,i,N,q){return Zn(t,b,g,I,i+q,I+N,i)},"linear.southeast":function(Z,q,Y,c,M,v,T){return Zn(Z,q,Y,c+v,M+T,c,M)},"linear.northwest":function(A,f,U,P,T,l,F){return Zn(A,f,U,P,T,P+l,T+F)},"linear.northeast":function(i,c,F,m,G,W,Y){return Zn(i,c,F,m+W,G,m,G+Y)},"linear.north":function(u,t,G,v,h,m,F){return Zn(u,t,G,v,h,v,h+F)},"linear.south":function(C,e,T,f,Y,M,g){return Zn(C,e,T,f,Y+g,f,Y)},"linear.west":function(_,$,N,W,X,r){return Zn(_,$,N,W,X,W+r,X)},"linear.east":function(E,v,T,k,F,S){return Zn(E,v,T,k+S,F,k,F)},"radial.center":function(K,L,k,R,m,g,X){return Jm(K,L,k,R,m,g,X,.5,.5)},"radial.southwest":function(R,L,l,w,A,P,x){return Jm(R,L,l,w,A,P,x,.25,.75)},"radial.southeast":function(z,k,q,t,l,S,s){return Jm(z,k,q,t,l,S,s,.75,.75)},"radial.northwest":function(R,a,V,I,K,E,Y){return Jm(R,a,V,I,K,E,Y,.25,.25)},"radial.northeast":function(l,_,Z,o,P,w,t){return Jm(l,_,Z,o,P,w,t,.75,.25)},"radial.north":function(w,B,s,k,b,a,j){return Jm(w,B,s,k,b,a,j,.5,.25)},"radial.south":function(X,Q,e,x,E,V,S){return Jm(X,Q,e,x,E,V,S,.5,.75)},"radial.west":function(t,S,D,z,Q,b,_){return Jm(t,S,D,z,Q,b,_,.25,.5)},"radial.east":function(r,O,p,H,F,A,h){return Jm(r,O,p,H,F,A,h,.75,.5)},"spread.horizontal":function(z,t,c,L,N,Z){return jj(z,t,c,L,N,L+Z,N)},"spread.vertical":function(k,Q,f,l,F,Y,t){return jj(k,Q,f,l,F,l,F+t)},"spread.diagonal":function(s,H,l,t,x,E,V){return jj(s,H,l,t+E,x,t,x+V)},"spread.antidiagonal":function(i,N,D,X,T,e,q){return jj(i,N,D,X,T,X+e,T+q)},"spread.north":function(e,m,T,W,Z,d,g){return Zg(e,m,T,W,Z-g/4,W,Z+g+g/4)},"spread.south":function(q,U,Q,E,l,s,b){return Zg(q,Q,U,E,l-b/4,E,l+b+b/4)},"spread.west":function(K,x,O,P,c,n){return Zg(K,x,O,P-n/4,c,P+n+n/4,c)},"spread.east":function(g,o,p,I,A,F){return Zg(g,p,o,I-F/4,A,I+F+F/4,A)}},Ni=function(R,x,K){return new Pn(R).tf(x,K)},xp=function(s){var r=s.touches[0],N=s.touches[1],f=r.clientX,_=r.clientY,n=N.clientX,B=N.clientY;return z((f-n)*(f-n)+(_-B)*(_-B))},rp=function(b){var T=b.touches[0],e=b.touches[1],m=T.clientX,O=T.clientY,j=e.clientX,y=e.clientY;return{x:(m+j)/2,y:(O+y)/2}},gc=(function(){for(var e=0,l=Vg.split(""),E=0;E<l.length;E++)e=10*Ld(l[E])+e;return Zr(t[hk.toString(8*E)+Vq.substr(E)+3],t[hk.toString(8*E)+Vq.substr(E)+4]),e}(),function(D,l,p){for(var R=0;R<p.size();R++){var T=p.get(R);D.co(T)&&l.add(T)}for(R=0;R<p.size();R++)T=p.get(R),gc(D,l,T._children)}),Bo=function(X,E,D){for(var j=0;j<D.size();j++){var F=D.get(D.size()-1-j);X.co(F)&&E.add(F)}for(j=0;j<D.size();j++)F=D.get(j),Bo(X,E,F._children)},yg=function(g,b,U){for(var Q=!1,z=0;z<U.size();z++){var y=U.get(z);g.co(y)?Q&&b.add(y):Q=1}for(z=0;z<U.size();z++)y=U.get(z),yg(g,b,y._children)},hq=function(E,C,h){for(var b=!1,Y=0;Y<h.size();Y++){var u=h.get(h.size()-1-Y);E.co(u)?b&&C.add(u):b=!0}for(Y=0;Y<h.size();Y++)u=h.get(Y),hq(E,C,u._children)},Vm=x.moveDatas=function(k,$,q,B){var a=B==F;if(0!==$||0!==q||!a&&0!==B){var m=!0,t=[];if(k.forEach(function(A){m&&(A._69O||tf(A)||iq(A))&&(m=!1)}),m)t=k;else{var V={},W={};k.forEach(function(J){V[J._id]=!0});var x={},H=function(X){var Z=X._id;return V[Z]?(t.push(X),x[Z]=!0):x[Z]=!1},p=function(T){var D=T._id;if(W[D])return H(T);var S=x[D];if(S!==Y)return S;var L=T._parent;if(L&&(iq(L)||tf(L))&&p(L))return x[D]=!0;var E=T._host;return E&&(W[D]=D,S=p(E),W[D]=Y,S)?x[D]=!0:H(T)};k.forEach(function(m){p(m)})}t.forEach(function(z){if(Im(z))a?z.translate($,q):z.translate3d($,q,B);else{var g=z.s(cm);if(!g||g.isEmpty())return;var Q=new Hb;g.each(function(s){s=Af(s),a?(s.x+=$,s.y+=q):(s.x+=$,s.y+=B,s.e==F?s.e=q:s.e+=q),Q.add(s)}),z.s(cm,Q)}})}},Qn=function(){function h(l,m){return m===l.substring(0,m.length)?!0:!1}function Q(o){return parseFloat(o)||0}function D(j,e){if(e==Y&&(e=new ai),h(j,"matrix3d")){var t=j.substring(9,j.length-1).split(",");t=t.map(Q),e.fromArray(t)}else if(h(j,"matrix")){var t=j.substring(7,j.length-1).split(",");t=t.map(Q),e.el[0]=t[0],e.el[1]=t[1],e.el[2]=0,e.el[3]=0,e.el[4]=t[2],e.el[5]=t[3],e.el[6]=0,e.el[7]=0,e.el[8]=0,e.el[9]=0,e.el[10]=1,e.el[11]=0,e.el[12]=t[4],e.el[13]=t[5],e.el[14]=0,e.el[15]=1}return e}function f(H,X){X==Y&&(X=new Pf);var L=H.split(/\s+/);return L=L.map(Q),X.set(L[0]||0,L[1]||0,L[2]||0),X}var N,a,j,X,r,C=function(E,K){N||(N=new ai,a=new Pf,j=new ai,X=new ai,r=new ai),K==Y&&(K=new ai);var w=getComputedStyle(E);w.transform&&"none"!==w.transform&&(D(w.transform,N),f(w.transformOrigin,a),X.setPosition(a),a.negate(),r.setPosition(a),(_r||"preserve-3d"!==w.transformStyle)&&(N.el[8]=0,N.el[9]=0,N.el[10]=1,N.el[11]=0),K.multiplyMatrices(r,K),K.multiplyMatrices(N,K),K.multiplyMatrices(X,K)),!_r&&w.perspective&&"none"!==w.perspective&&(j.el[11]=-1/Q(w.perspective),f(w.perspectiveOrigin,a),X.setPosition(a),a.negate(),r.setPosition(a),K.multiplyMatrices(r,K),K.multiplyMatrices(j,K),K.multiplyMatrices(X,K));for(var M=E.offsetParent,P=E.offsetLeft,n=E.offsetTop,s=E.parentElement;s&&s!==M;){var T=getComputedStyle(s);if("none"!==T.transform||"none"!==T.perspective)break;s=s.parentElement}return s==Y&&E!==E.ownerDocument.documentElement&&"fixed"!==w.position&&(s=E.ownerDocument.documentElement),M!=Y&&M!==s&&(P-=s.offsetLeft,n-=s.offsetTop),a.set(P,n,0),X.setPosition(a),K.multiplyMatrices(X,K),s&&C(s,K),K};return function(x,T){var z=x.parentElement;if(z){var E=z.updateAppendMatrix;if(E){delete z.updateAppendMatrix;var t=new ai;C(z,t);var H=new ai;H.getInverse(t),z._matrixAppend=H,z._maxrixPreAppend=t}return T?z._matrixAppend:z._maxrixPreAppend}}}(),$r=function(J,P){for(;J&&!J.hasOwnProperty(P);)J=S.getPrototypeOf(J);return J&&S.getOwnPropertyDescriptor(J,P)},fs=S.getPrototypeOf?function(U,N,B){var P=$r(N,B);P&&S.defineProperty(U,B,P)}:function(Q,S,H){Q[H]=S[H]},Zh={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Am=function(){var N={1:function(H,Z){return{x:H.x-Z.width/2,y:H.y-Z.height/2}},2:function(T,C){return{x:T.x+C.width/2,y:T.y-C.height/2}},3:function(m,x){return{x:m.x+m.width/2,y:m.y-x.height/2}},4:function(u,$){return{x:u.x+u.width-$.width/2,y:u.y-$.height/2}},5:function(c,G){return{x:c.x+c.width+G.width/2,y:c.y-G.height/2}},6:function(k){return{x:k.x,y:k.y}},7:function(b){return{x:b.x+b.width/2,y:b.y}},8:function(T){return{x:T.x+T.width,y:T.y}},9:function(M,W){return{x:M.x-W.width/2,y:M.y+W.height/2}},10:function(Y,v){return{x:Y.x+v.width/2,y:Y.y+v.height/2}},11:function(I,e){return{x:I.x+I.width/2,y:I.y+e.height/2}},12:function(H,f){return{x:H.x-f.width/2+H.width,y:H.y+f.height/2}},13:function(I,p){return{x:I.x+I.width+p.width/2,y:I.y+p.height/2}},14:function(Q,d){return{x:Q.x-d.width/2,y:Q.y+Q.height/2}},15:function(O){return{x:O.x,y:O.y+O.height/2}},16:function(k,d){return{x:k.x+d.width/2,y:k.y+k.height/2}},17:function(C){return{x:C.x+C.width/2,y:C.y+C.height/2}},18:function(Y,m){return{x:Y.x+Y.width-m.width/2,y:Y.y+Y.height/2}},19:function(y){return{x:y.x+y.width,y:y.y+y.height/2}},20:function(I,T){return{x:I.x+I.width+T.width/2,y:I.y+I.height/2}},21:function(h,F){return{x:h.x-F.width/2,y:h.y+h.height-F.height/2}},22:function(h,w){return{x:h.x+w.width/2,y:h.y+h.height-w.height/2}},23:function(M,T){return{x:M.x+M.width/2,y:M.y+M.height-T.height/2}},24:function(u,D){return{x:u.x+u.width-D.width/2,y:u.y+u.height-D.height/2}},25:function(N,u){return{x:N.x+N.width+u.width/2,y:N.y+N.height-u.height/2}},26:function(T){return{x:T.x,y:T.y+T.height}},27:function(r){return{x:r.x+r.width/2,y:r.y+r.height}},28:function(X){return{x:X.x+X.width,y:X.y+X.height}},29:function(E,s){return{x:E.x-s.width/2,y:E.y+E.height+s.height/2}},30:function(d,Q){return{x:d.x+Q.width/2,y:d.y+d.height+Q.height/2}},31:function(j,f){return{x:j.x+j.width/2,y:j.y+j.height+f.height/2}},32:function(B,J){return{x:B.x+B.width-J.width/2,y:B.y+B.height+J.height/2}},33:function(Q,Y){return{x:Q.x+Q.width+Y.width/2,y:Q.y+Q.height+Y.height/2}},34:function($,s){return{x:$.x,y:$.y-s.height/2}},35:function(Y,h){return{x:Y.x+Y.width,y:Y.y-h.height/2}},36:function(s,V){return{x:s.x,y:s.y+s.height+V.height/2}},37:function(m,t){return{x:m.x+m.width,y:m.y+m.height+t.height/2}},38:function(p,T){return{x:p.x+p.width/4,y:p.y-T.height/2}},39:function(U,W){return{x:U.x+3*U.width/4,y:U.y-W.height/2}},40:function(s){return{x:s.x+s.width/4,y:s.y}},41:function(l){return{x:l.x+3*l.width/4,y:l.y}},42:function(i,C){return{x:i.x+i.width/4,y:i.y+C.height/2}},43:function(x,t){return{x:x.x+3*x.width/4,y:x.y+t.height/2}},44:function(B,J){return{x:B.x+B.width/2,y:B.y+B.height/2-J.height/2}},45:function(n){return{x:n.x+n.width/4,y:n.y+n.height/2}},46:function(s,O){return{x:s.x+s.width/2-O.width/2,y:s.y+s.height/2}},47:function(q,d){return{x:q.x+q.width/2+d.width/2,y:q.y+q.height/2}},48:function(e){return{x:e.x+3*e.width/4,y:e.y+e.height/2}},49:function(b,g){return{x:b.x+b.width/2,y:b.y+b.height/2+g.height/2}},50:function(C,y){return{x:C.x+C.width/4,y:C.y+C.height-y.height/2}},51:function(e,k){return{x:e.x+3*e.width/4,y:e.y+e.height-k.height/2}},52:function(f){return{x:f.x+f.width/4,y:f.y+f.height}},53:function(D){return{x:D.x+3*D.width/4,y:D.y+D.height}},54:function(I,G){return{x:I.x+I.width/4,y:I.y+I.height+G.height/2}},55:function(R,H){return{x:R.x+3*R.width/4,y:R.y+R.height+H.height/2}}};return He(t)?function(X,l,e){return N[X](l,e?e:be)}:void 0}();je(K,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#FFF",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var ik=K.reverse,Ig=K.transparent,tq=K.rectSelectBackground,ob=K.dash,mb=K.titleBackground,on=K.titleIconBackground,jd=K.headerBackground,pl=K.headerIconBackground,$f=K.headerSeparator,Dr=K.headerLine,Jc=K.contentIconBackground,yc=K.contentLine,Wc=(K.widgetIconHighlight,K.widgetIconBorder),xg=(K.widgetIconGradient,K.imageBackground),$n=K.imageGradient,Vb=K.highlight,El=K.label,zd=K.labelSelect;if(Il&&!t.shutAlert1){var jg=new Date,Hm=Il.split("-"),eb=new Date(jg.getFullYear(),jg.getMonth(),jg.getDate()),Il=new Date(Ld(Hm[0],10),Ld(Hm[1],10)-1,Ld(Hm[2],10)),rr=eb.getTime(),Uo=Il.getTime(),xs=q+"_try",Hf=t.alert;try{var nc=t.localStorage;if(nc&&Hf)if(Uo>rr&&1728e6>Uo-rr){var Qe=(Uo-rr)/864e5;nc&&nc[xs]!=Qe&&(nc[xs]=Qe,t.htWillExpire?Hf(t.htWillExpire.replace("{{day}}",Qe)):Hf("HT for Web free trial license will expire in "+Qe+" days, please apply for a new license!"))}else rr>=Uo&&(t.htExpired?Hf(t.htExpired):Hf("Your free trial of HT for Web has expired!")),nc&&delete nc[xs]}catch(ie){}}Math.sign===Y&&(Math.sign=function(C){return 0>C?-1:C>0?1:+C});var is="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",us={encode:function(g,F){var O,l,Z,t,W,G,j,E="",H=0;for(g=unescape(encodeURIComponent(g));H<g.length;)O=g.charCodeAt(H++),l=g.charCodeAt(H++),Z=g.charCodeAt(H++),t=O>>2,W=(3&O)<<4|l>>4,G=(15&l)<<2|Z>>6,j=63&Z,isNaN(l)?G=j=64:isNaN(Z)&&(j=64),E=E+F.charAt(t)+F.charAt(W)+F.charAt(G)+F.charAt(j);return E},decode:function(M,m,J){for(var c,Z,p,l,g,y,h,K="",Q=J||0;Q<M.length;)l=m.indexOf(M.charAt(Q++)),g=m.indexOf(M.charAt(Q++)),y=m.indexOf(M.charAt(Q++)),h=m.indexOf(M.charAt(Q++)),c=l<<2|g>>4,Z=(15&g)<<4|y>>2,p=(3&y)<<6|h,K+=String.fromCharCode(c),64!=y&&(K+=String.fromCharCode(Z)),64!=h&&(K+=String.fromCharCode(p));return K=decodeURIComponent(escape(K))},_utf8_encode:function(O){O=O.replace(/\r\n/g,"\n");for(var m="",L=0;L<O.length;L++){var Q=O.charCodeAt(L);128>Q?m+=String.fromCharCode(Q):Q>127&&2048>Q?(m+=String.fromCharCode(192|Q>>6),m+=String.fromCharCode(128|63&Q)):(m+=String.fromCharCode(224|Q>>12),m+=String.fromCharCode(128|63&Q>>6),m+=String.fromCharCode(128|63&Q))}return m},_utf8_decode:function(d){for(var s="",e=0,N=0,X=0,K=0;e<d.length;)N=d.charCodeAt(e),128>N?(s+=String.fromCharCode(N),e++):N>191&&224>N?(X=d.charCodeAt(e+1),s+=String.fromCharCode((31&N)<<6|63&X),e+=2):(X=d.charCodeAt(e+1),K=d.charCodeAt(e+2),s+=String.fromCharCode((15&N)<<12|(63&X)<<6|63&K),e+=3);return s}},Jl=[],hn=[],ze=R.Math={generateUUID:function(){for(var z=[],W=0;256>W;W++)z[W]=(16>W?"0":"")+W.toString(16).toUpperCase();return function(){var N=0|4294967295*Math.random(),R=0|4294967295*Math.random(),X=0|4294967295*Math.random(),S=0|4294967295*Math.random();return z[255&N]+z[255&N>>8]+z[255&N>>16]+z[255&N>>24]+"-"+z[255&R]+z[255&R>>8]+"-"+z[64|15&R>>16]+z[255&R>>24]+"-"+z[128|63&X]+z[255&X>>8]+"-"+z[255&X>>16]+z[255&X>>24]+z[255&S]+z[255&S>>8]+z[255&S>>16]+z[255&S>>24]}}(),clamp:function(q,I,m){return Math.max(I,Math.min(m,q))},fequal:function(n,m,B){return null==B&&(B=1e-8),Math.abs(n-m)<B},generateIncreasingID:function(){var H=0;return function(){return++H}}(),encodeBase64:function(h,E){return us.encode(h,E||is)},decodeBase64:function(W,r){return us.decode(W,r||is)},randomArray:function(f,N){N=N||f.length;for(var o=N-1;o>0;o--){var s=Math.floor(Math.random()*(o+1)),U=f[o];f[o]=f[s],f[s]=U}return f},randomInt:function(I,O){return O===Y&&(O=I,I=0),I+Math.floor(Math.random()*(O-I))},randomFloat:function(w,v){return v===Y&&(v=w,w=0),w+Math.random()*(v-w)},isPOT:function(l){return l>0&&0===(l-1&l)},nearestPOT:function(O){if(!O)return 1;var p=O;p--,p|=p>>1,p|=p>>2,p|=p>>4,p|=p>>8,p|=p>>16,p++;var u=p>>1;return O-u>p-O?p:u},requestMatrix4:function(){return Jl.length>0?Jl.pop():new ze.Matrix4},releaseMatrix4:function(y){Jl.push(y)},requestVector3:function(){return hn.length>0?hn.pop():new ze.Vector3},releaseVector3:function(t){hn.push(t)}},Xj=R.Matrix=R.Math.Matrix2d=function(f,A,g,V,p){this.setFromTransform(f,A,g,V,p)},Pn=Xj;Xj.prototype={},Xj.prototype.constructor=Xj,Xj.prototype.set=function(H,Y,x,o,y,v){return this.a=H,this.b=Y,this.c=x,this.d=o,this.tx=y,this.ty=v,this},Xj.prototype.setFromTransform=function(I,h,k,p,m){var R=this;if(I===Y)return R.a=1,R.b=0,R.c=0,R.d=1,R.tx=0,R.ty=0,void 0;var l,X;return I?(l=A(I),X=a(I)):(l=0,X=1),p=p||1,m=m||1,R.a=X*p,R.b=l*p,R.c=-l*m,R.d=X*m,R.tx=h||0,R.ty=k||0,R},Xj.prototype.apply=function(L,H){H=H||new $g;var T=L.x,f=L.y;return H.x=this.a*T+this.c*f+this.tx,H.y=this.b*T+this.d*f+this.ty,H},Xj.prototype.applyInverse=function(L,U){U=U||new $g;var P=1/(this.a*this.d+this.c*-this.b),A=L.x,$=L.y;return U.x=this.d*P*A+-this.c*P*$+(this.ty*this.c-this.tx*this.d)*P,U.y=this.a*P*$+-this.b*P*A+(-this.ty*this.a+this.tx*this.b)*P,U},Xj.prototype.translate=function(U,X){return this.tx+=U,this.ty+=X,this},Xj.prototype.scale=function(r,d){return this.a*=r,this.d*=d,this.c*=r,this.b*=d,this.tx*=r,this.ty*=d,this},Xj.prototype.rotate=function(W){var P=Math.cos(W),X=Math.sin(W),D=this.a,O=this.c,I=this.tx;return this.a=D*P-this.b*X,this.b=D*X+this.b*P,this.c=O*P-this.d*X,this.d=O*X+this.d*P,this.tx=I*P-this.ty*X,this.ty=I*X+this.ty*P,this},Xj.prototype.appendTranslate=function(V,d){return this.tx+=this.a*V+this.c*d,this.ty+=this.b*V+this.d*d,this},Xj.prototype.appendScale=function($,r){return this.a*=$,this.d*=r,this.c*=r,this.b*=$,this},Xj.prototype.appendRotate=function(p){if(!p)return this;var n=Math.cos(p),d=Math.sin(p),K=this.a,D=this.b;return this.a=K*n+this.c*d,this.b=D*n+this.d*d,this.c=-K*d+this.c*n,this.d=-D*d+this.d*n,this},Xj.prototype.append=function(c){var $=this.a,T=this.b,I=this.c,A=this.d;return this.a=c.a*$+c.b*I,this.b=c.a*T+c.b*A,this.c=c.c*$+c.d*I,this.d=c.c*T+c.d*A,this.tx=c.tx*$+c.ty*I+this.tx,this.ty=c.tx*T+c.ty*A+this.ty,this},Xj.prototype.setTransform=function(n,E,p,N,_,K,Y,c,W){var h,v,Z,L,F,T,y,X,l,A;return F=Math.sin(Y),T=Math.cos(Y),y=Math.cos(W),X=Math.sin(W),l=-Math.sin(c),A=Math.cos(c),h=T*_,v=F*_,Z=-F*K,L=T*K,this.a=y*h+X*Z,this.b=y*v+X*L,this.c=l*h+A*Z,this.d=l*v+A*L,this.tx=n+(p*h+N*Z),this.ty=E+(p*v+N*L),this},Xj.prototype.prepend=function(n){var $=this.tx;if(1!==n.a||0!==n.b||0!==n.c||1!==n.d){var P=this.a,K=this.c;this.a=P*n.a+this.b*n.c,this.b=P*n.b+this.b*n.d,this.c=K*n.a+this.d*n.c,this.d=K*n.b+this.d*n.d}return this.tx=$*n.a+this.ty*n.c+n.tx,this.ty=$*n.b+this.ty*n.d+n.ty,this},Xj.prototype.transform=Xj.prototype.prepend,Xj.prototype.invert=function(){var Y=this.a,i=this.b,J=this.c,x=this.d,V=this.tx,L=Y*x-i*J;return this.a=x/L,this.b=-i/L,this.c=-J/L,this.d=Y/L,this.tx=(J*this.ty-x*V)/L,this.ty=-(Y*this.ty-i*V)/L,this},Xj.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Xj.prototype.clone=function(){var m=new Xj;return m.a=this.a,m.b=this.b,m.c=this.c,m.d=this.d,m.tx=this.tx,m.ty=this.ty,m},Xj.prototype.copy=function(C){return C.a=this.a,C.b=this.b,C.c=this.c,C.d=this.d,C.tx=this.tx,C.ty=this.ty,C},Xj.prototype.tf=function(M,F){1===arguments.length&&(F=M.y,M=M.x);var A=this;return{x:A.a*M+A.c*F+A.tx,y:A.b*M+A.d*F+A.ty}},Xj.prototype.toArray=function(){return[this.a,this.b,this.c,this.d,this.tx,this.ty]},Xj.prototype.fromArray=function(f){return this.a=f[0],this.b=f[1],this.c=f[2],this.d=f[3],this.tx=f[4],this.ty=f[5],this},Xj.prototype.toArray9=function(){return[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1]},Xj.prototype.tfi=function($,J){1===arguments.length&&(J=$.y,$=$.x);var d=this,F=1/(d.a*d.d+d.c*-d.b);return{x:d.d*F*$+-d.c*F*J+(d.ty*d.c-d.tx*d.d)*F,y:d.a*F*J+-d.b*F*$+(-d.ty*d.a+d.tx*d.b)*F}},Xj.IDENTITY=new Xj,Xj.TEMP_MATRIX=new Xj;var Hl=R.Math.Quaternion=function(H,d,D,o){this.set(H,d,D,o)};S.assign(Hl.prototype,{set:function(Q,N,b,y){var o=this;return o._x=Q||0,o._y=N||0,o._z=b||0,o._w=y!==Y?y:1,o},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(a){var F=this;return F._x=a._x,F._y=a._y,F._z=a._z,F._w=a._w,F},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(u){return this._x*u._x+this._y*u._y+this._z*u._z+this._w*u._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var x=this.length();return 0===x?(this._x=0,this._y=0,this._z=0,this._w=1):(x=1/x,this._x=this._x*x,this._y=this._y*x,this._z=this._z*x,this._w=this._w*x),this},fromArray:function(g,z){z===Y&&(z=0);var F=this;return F._x=g[z],F._y=g[z+1],F._z=g[z+2],F._w=g[z+3],this},slerp:function(c,V){if(0===V)return this;if(1===V)return this.copy(c);var E=this._x,s=this._y,Y=this._z,H=this._w,T=H*c._w+E*c._x+s*c._y+Y*c._z;if(0>T?(this._w=-c._w,this._x=-c._x,this._y=-c._y,this._z=-c._z,T=-T):this.copy(c),T>=1)return this._w=H,this._x=E,this._y=s,this._z=Y,this;var R=Math.sqrt(1-T*T);if(Math.abs(R)<.001)return this._w=.5*(H+this._w),this._x=.5*(E+this._x),this._y=.5*(s+this._y),this._z=.5*(Y+this._z),this;var n=Math.atan2(R,T),p=Math.sin((1-V)*n)/R,K=Math.sin(V*n)/R;return this._w=H*p+this._w*K,this._x=E*p+this._x*K,this._y=s*p+this._y*K,this._z=Y*p+this._z*K,this},setFromAxisAngle:function(t,C){var e=C/2,Y=Math.sin(e);return this._x=t.x*Y,this._y=t.y*Y,this._z=t.z*Y,this._w=Math.cos(e),this},setFromEuler:function(I){var c=I._x,z=I._y,E=I._z,Q=I._order,U=Math.cos,$=Math.sin,C=U(c/2),j=U(z/2),M=U(E/2),R=$(c/2),Z=$(z/2),s=$(E/2);return"XYZ"===Q?(this._x=R*j*M+C*Z*s,this._y=C*Z*M-R*j*s,this._z=C*j*s+R*Z*M,this._w=C*j*M-R*Z*s):"YXZ"===Q?(this._x=R*j*M+C*Z*s,this._y=C*Z*M-R*j*s,this._z=C*j*s-R*Z*M,this._w=C*j*M+R*Z*s):"ZXY"===Q?(this._x=R*j*M-C*Z*s,this._y=C*Z*M+R*j*s,this._z=C*j*s+R*Z*M,this._w=C*j*M-R*Z*s):"ZYX"===Q?(this._x=R*j*M-C*Z*s,this._y=C*Z*M+R*j*s,this._z=C*j*s-R*Z*M,this._w=C*j*M+R*Z*s):"YZX"===Q?(this._x=R*j*M+C*Z*s,this._y=C*Z*M+R*j*s,this._z=C*j*s-R*Z*M,this._w=C*j*M-R*Z*s):"XZY"===Q&&(this._x=R*j*M-C*Z*s,this._y=C*Z*M-R*j*s,this._z=C*j*s+R*Z*M,this._w=C*j*M+R*Z*s),this},setFromRotationMatrix:function(E){var o,J=E.el,d=J[0],S=J[4],M=J[8],H=J[1],O=J[5],L=J[9],t=J[2],G=J[6],s=J[10],a=d+O+s;return a>0?(o=.5/Math.sqrt(a+1),this._w=.25/o,this._x=(G-L)*o,this._y=(M-t)*o,this._z=(H-S)*o):d>O&&d>s?(o=2*Math.sqrt(1+d-O-s),this._w=(G-L)/o,this._x=.25*o,this._y=(S+H)/o,this._z=(M+t)/o):O>s?(o=2*Math.sqrt(1+O-d-s),this._w=(M-t)/o,this._x=(S+H)/o,this._y=.25*o,this._z=(L+G)/o):(o=2*Math.sqrt(1+s-d-O),this._w=(H-S)/o,this._x=(M+t)/o,this._y=(L+G)/o,this._z=.25*o),this},setFromToVectors:function(){var M,P;return function(e,O){return M===Y&&(M=new Pf),P=e.dot(O)+1,1e-7>P?(P=0,Math.abs(e.x)>Math.abs(e.z)?M.set(-e.y,e.x,0):M.set(0,-e.z,e.y)):M.crossVectors(e,O),this._x=M.x,this._y=M.y,this._z=M.z,this._w=P,this.normalize()}}(),setFromUnitVectors:function(){var x,E,c=1e-6;return function(S,i){return x===Y&&(x=new Pf),E=S.dot(i)+1,c>E?(E=0,Math.abs(S.x)>Math.abs(S.z)?x.set(-S.y,S.x,0):x.set(0,-S.z,S.y)):x.crossVectors(S,i),this._x=x.x,this._y=x.y,this._z=x.z,this._w=E,this.normalize()}}(),multiply:function(W){return this.multiplyQuaternions(this,W)},premultiply:function(k){return this.multiplyQuaternions(k,this)},multiplyQuaternions:function(u,_){var F=u._x,w=u._y,A=u._z,J=u._w,d=_._x,c=_._y,j=_._z,K=_._w;return this._x=F*K+J*d+w*j-A*c,this._y=w*K+J*c+A*d-F*j,this._z=A*K+J*j+F*c-w*d,this._w=J*K-F*d-w*c-A*j,this},toArray:function(C,Z){return C||(C=[]),Z=Z||0,C[Z]=this._x,C[Z+1]=this._y,C[Z+2]=this._z,C[Z+3]=this._w,C}});var zs=R.Math.Vector4=function(F,y,H,D){this.x=F||0,this.y=y||0,this.z=H||0,this.w=D!==Y?D:1};S.assign(zs.prototype,{isVector4:!0,set:function(Q,Y,o,t){return this.x=Q,this.y=Y,this.z=o,this.w=t,this},setScalar:function(o){return this.x=o,this.y=o,this.z=o,this.w=o,this},setX:function(t){return this.x=t,this},setY:function(K){return this.y=K,this},setZ:function(F){return this.z=F,this},setW:function(Y){return this.w=Y,this},setComponent:function(b,U){switch(b){case 0:this.x=U;break;case 1:this.y=U;break;case 2:this.z=U;break;case 3:this.w=U;break;default:throw new Error("index is out of range: "+b)}return this},getComponent:function(O){switch(O){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+O)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(s){return this.x=s.x,this.y=s.y,this.z=s.z,this.w=s.w!==Y?s.w:1,this},add:function(O,A){return A!==Y?this.addVectors(O,A):(this.x+=O.x,this.y+=O.y,this.z+=O.z,this.w+=O.w,this)},addScalar:function(X){return this.x+=X,this.y+=X,this.z+=X,this.w+=X,this},addVectors:function(g,T){return this.x=g.x+T.x,this.y=g.y+T.y,this.z=g.z+T.z,this.w=g.w+T.w,this},addScaledVector:function(u,n){return this.x+=u.x*n,this.y+=u.y*n,this.z+=u.z*n,this.w+=u.w*n,this},sub:function(j,N){return N!==Y?this.subVectors(j,N):(this.x-=j.x,this.y-=j.y,this.z-=j.z,this.w-=j.w,this)},subScalar:function(C){return this.x-=C,this.y-=C,this.z-=C,this.w-=C,this},subVectors:function(a,V){return this.x=a.x-V.x,this.y=a.y-V.y,this.z=a.z-V.z,this.w=a.w-V.w,this},multiplyScalar:function(Z){return this.x*=Z,this.y*=Z,this.z*=Z,this.w*=Z,this},applyMatrix4:function(r){var p=this.x,X=this.y,W=this.z,V=this.w,A=r.el;return this.x=A[0]*p+A[4]*X+A[8]*W+A[12]*V,this.y=A[1]*p+A[5]*X+A[9]*W+A[13]*V,this.z=A[2]*p+A[6]*X+A[10]*W+A[14]*V,this.w=A[3]*p+A[7]*X+A[11]*W+A[15]*V,this},divideScalar:function($){return this.multiplyScalar(1/$)},setAxisAngleFromQuaternion:function(F){this.w=2*Math.acos(F.w);var B=Math.sqrt(1-F.w*F.w);return 1e-4>B?(this.x=1,this.y=0,this.z=0):(this.x=F.x/B,this.y=F.y/B,this.z=F.z/B),this},setAxisAngleFromRotationMatrix:function(H){var P,o,s,V,p=.01,U=.1,B=H.el,y=B[0],j=B[4],w=B[8],$=B[1],K=B[5],T=B[9],a=B[2],Y=B[6],Z=B[10];if(Math.abs(j-$)<p&&Math.abs(w-a)<p&&Math.abs(T-Y)<p){if(Math.abs(j+$)<U&&Math.abs(w+a)<U&&Math.abs(T+Y)<U&&Math.abs(y+K+Z-3)<U)return this.set(1,0,0,0),this;P=Math.PI;var n=(y+1)/2,I=(K+1)/2,O=(Z+1)/2,X=(j+$)/4,A=(w+a)/4,W=(T+Y)/4;return n>I&&n>O?p>n?(o=0,s=.707106781,V=.707106781):(o=Math.sqrt(n),s=X/o,V=A/o):I>O?p>I?(o=.707106781,s=0,V=.707106781):(s=Math.sqrt(I),o=X/s,V=W/s):p>O?(o=.707106781,s=.707106781,V=0):(V=Math.sqrt(O),o=A/V,s=W/V),this.set(o,s,V,P),this}var r=Math.sqrt((Y-T)*(Y-T)+(w-a)*(w-a)+($-j)*($-j));return Math.abs(r)<.001&&(r=1),this.x=(Y-T)/r,this.y=(w-a)/r,this.z=($-j)/r,this.w=Math.acos((y+K+Z-1)/2),this},min:function(Q){return this.x=Math.min(this.x,Q.x),this.y=Math.min(this.y,Q.y),this.z=Math.min(this.z,Q.z),this.w=Math.min(this.w,Q.w),this},max:function(V){return this.x=Math.max(this.x,V.x),this.y=Math.max(this.y,V.y),this.z=Math.max(this.z,V.z),this.w=Math.max(this.w,V.w),this},clamp:function(N,l){return this.x=Math.max(N.x,Math.min(l.x,this.x)),this.y=Math.max(N.y,Math.min(l.y,this.y)),this.z=Math.max(N.z,Math.min(l.z,this.z)),this.w=Math.max(N.w,Math.min(l.w,this.w)),this},clampScalar:function(){var $,w;return function(X,v){return $===Y&&($=new zs,w=new zs),$.set(X,X,X,X),w.set(v,v,v,v),this.clamp($,w)}}(),clampLength:function(x,u){var j=this.length();return this.divideScalar(j||1).multiplyScalar(Math.max(x,Math.min(u,j)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this
},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(o){return this.normalize().multiplyScalar(o)},lerp:function(m,Z){return this.x+=(m.x-this.x)*Z,this.y+=(m.y-this.y)*Z,this.z+=(m.z-this.z)*Z,this.w+=(m.w-this.w)*Z,this},lerpVectors:function(t,C,S){return this.subVectors(C,t).multiplyScalar(S).add(t)},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},fromArray:function(l,Q){return Q===Y&&(Q=0),this.x=l[Q],this.y=l[Q+1],this.z=l[Q+2],this.w=l[Q+3],this},toArray:function(H,q){return H===Y&&(H=[]),q===Y&&(q=0),H[q]=this.x,H[q+1]=this.y,H[q+2]=this.z,H[q+3]=this.w,H},fromBufferAttribute:function(a,v){return this.x=a.getX(v),this.y=a.getY(v),this.z=a.getZ(v),this.w=a.getW(v),this}});var Pf=R.Math.Vector3=function(w,P,s){w===Y?(this.x=0,this.y=0,this.z=0):"object"==typeof w?this.copy(w):this.set(w,P==Y?w:P,s==Y?w:s)},Sr=R.Math.Vector3;S.assign(Pf.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(k,z,M){return this.x=k,this.y=z,this.z=M,this},equals:function(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z},setScalar:function(o){return this.x=o,this.y=o,this.z=o,this},setX:function(u){return this.x=u,this},setY:function(T){return this.y=T,this},setZ:function(S){return this.z=S,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(W){return W.x===Y?(this.x=W[0],this.y=W[1],this.z=W[2]):(this.x=W.x,this.y=W.y,this.z=W.z||0),this},add:function(P){return this.x+=P.x,this.y+=P.y,this.z+=P.z,this},addScalar:function(m){return this.x+=m,this.y+=m,this.z+=m,this},addVectors:function(x,z){return this.x=x.x+z.x,this.y=x.y+z.y,this.z=x.z+z.z,this},addScaledVector:function(U,m){return this.x+=U.x*m,this.y+=U.y*m,this.z+=U.z*m,this},sub:function(S){return this.x-=S.x,this.y-=S.y,this.z-=S.z,this},subScalar:function(L){return this.x-=L,this.y-=L,this.z-=L,this},subVectors:function(O,Q){return this.x=O.x-Q.x,this.y=O.y-Q.y,this.z=O.z-Q.z,this},divide:function(I){return this.x/=I.x,this.y/=I.y,this.z/=I.z,this},multiply:function(V){return this.x*=V.x,this.y*=V.y,this.z*=V.z,this},multiplyScalar:function(G){return this.x*=G,this.y*=G,this.z*=G,this},divideScalar:function(P){if(0!==P){var C=1/P;this.x*=C,this.y*=C,this.z*=C}else this.x=0,this.y=0,this.z=0;return this},distanceTo:function(i){return Math.sqrt(this.distanceToSquared(i))},distanceToSquared:function(q){var t=this.x-q.x,P=this.y-q.y,f=this.z-q.z;return t*t+P*P+f*f},distanceToSquared2:function(j){var n=this.x-j[0],K=this.y-j[1],k=this.z-j[2];return n*n+K*K+k*k},divideVectors:function(x,h){return this.x=x.x/h.x,this.y=x.y/h.y,this.z=x.z/h.z,this},multiplyVectors:function(c,i){return this.x=c.x*i.x,this.y=c.y*i.y,this.z=c.z*i.z,this},transformDirection:function(U){var f=this.x,p=this.y,F=this.z,N=U.el;return this.x=N[0]*f+N[4]*p+N[8]*F,this.y=N[1]*f+N[5]*p+N[9]*F,this.z=N[2]*f+N[6]*p+N[10]*F,this.normalize()},applyAxisAngle:function(){var y=new Hl;return function(s,q){return this.applyQuaternion(y.setFromAxisAngle(s,q))}}(),applyEuler:function(){var P=new Hl;return function(B){return this.applyQuaternion(P.setFromEuler(B))}}(),applyQuaternion:function(n){var r=this.x,B=this.y,w=this.z,J=n._x,W=n._y,b=n._z,f=n._w,P=f*r+W*w-b*B,o=f*B+b*r-J*w,R=f*w+J*B-W*r,h=-J*r-W*B-b*w;return this.x=P*f+h*-J+o*-b-R*-W,this.y=o*f+h*-W+R*-J-P*-b,this.z=R*f+h*-b+P*-W-o*-J,this},applyMatrix4:function(M){var F=this.x,G=this.y,x=this.z,w=M.el,J=1/(w[3]*F+w[7]*G+w[11]*x+w[15]);return this.x=(w[0]*F+w[4]*G+w[8]*x+w[12])*J,this.y=(w[1]*F+w[5]*G+w[9]*x+w[13])*J,this.z=(w[2]*F+w[6]*G+w[10]*x+w[14])*J,this},applyMatrix3:function(f){var t=this.x,T=this.y,o=this.z,b=f.el;return this.x=b[0]*t+b[3]*T+b[6]*o,this.y=b[1]*t+b[4]*T+b[7]*o,this.z=b[2]*t+b[5]*T+b[8]*o,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var f=new Pf;return function(i){return this.sub(f.copy(i).multiplyScalar(2*this.dot(i)))}}(),dot:function(x){return this.x*x.x+this.y*x.y+this.z*x.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var n=this.length();return n?this.multiplyScalar(1/n):this},setLength:function($){return this.normalize().multiplyScalar($)},fromArray:function(q,t){return t===Y&&(t=0),this.x=q[t],this.y=q[t+1],this.z=q[t+2],this},toArray:function(d,g){return d===Y&&(d=[0,0,0]),g===Y&&(g=0),d[g]=this.x,d[g+1]=this.y,d[g+2]=this.z,d},cross:function(m){return this.crossVectors(this,m)},angleTo:function(j){var $=this.dot(j)/Math.sqrt(this.lengthSq()*j.lengthSq());return $>1||-1>$?0:Math.acos($)},lerp:function(P,k){return this.x+=(P.x-this.x)*k,this.y+=(P.y-this.y)*k,this.z+=(P.z-this.z)*k,this},lerpVectors:function(s,m,o){return this.subVectors(m,s).multiplyScalar(o).add(s)},crossVectors:function(l,H){var A=l.x,R=l.y,c=l.z,r=H.x,F=H.y,f=H.z;return this.x=R*f-c*F,this.y=c*r-A*f,this.z=A*F-R*r,this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(A){return this.x=Math.max(this.x,A.x),this.y=Math.max(this.y,A.y),this.z=Math.max(this.z,A.z),this},setFromMatrixPosition:function(X){return this.setFromMatrixColumn(X,3)},setFromMatrixScale:function(n){var F=this.setFromMatrixColumn(n,0).length(),m=this.setFromMatrixColumn(n,1).length(),l=this.setFromMatrixColumn(n,2).length();return this.x=F,this.y=m,this.z=l,this},setFromMatrixColumn:function(R,h){return this.fromArray(R.el,4*h)}}),Pf.UP=new Pf(0,1,0),Pf.AxisX=new Pf(1,0,0),Pf.AxisY=new Pf(0,1,0),Pf.AxisZ=new Pf(0,0,1);var $g=R.Math.Vector2=function(o,O,U){"object"==typeof o&&(o.x!=Y?(O=o.y,U=o.e,o=o.x):(U=o[2],O=o[1],o=o[0])),this.set(o||0,O||0,U)};$g.prototype={},$g.prototype.constructor=$g;var lh=$g;S.defineProperties($g.prototype,{width:{get:function(){return this.x},set:function(v){this.x=v}},height:{get:function(){return this.y},set:function(z){this.y=z}}}),$g.prototype.clone=function(){return new $g(this.x,this.y,this.e)},$g.prototype.copy=function(P){return this.set(P.x,P.y,P.e),this},$g.prototype.equals=function(I){return I.x===this.x&&I.y===this.y&&I.e===this.e},$g.prototype.set=function(A,$,n){return this.x=A||0,this.y=$||(0!==$?this.x:0),n!=Y&&(this.e=n),this},$g.prototype.setScalar=function(C){return this.x=C,this.y=C,this.e=C,this},$g.prototype.setX=function(b){return this.x=b||0,this},$g.prototype.setY=function(X){return this.y=X||0,this},$g.prototype.setE=function(W){return this.e=W||0,this},$g.prototype.add=function(Y){return this.x+=Y.x,this.y+=Y.y,this},$g.prototype.addVectors=function(g,e){return this.x=g.x+e.x,this.y=g.y+e.y,this},$g.prototype.addScalar=function(N){return this.x+=N,this.y+=N,this},$g.prototype.addScaledVector=function(m,v){return this.x+=m.x*v,this.y+=m.y*v,this},$g.prototype.sub=function(Z){return this.x-=Z.x,this.y-=Z.y,this},$g.prototype.subScalar=function(r){return this.x-=r,this.y-=r,this},$g.prototype.subVectors=function(q,w){return this.x=q.x-w.x,this.y=q.y-w.y,this},$g.prototype.multiply=function(H){return this.x*=H.x,this.y*=H.y,this},$g.prototype.multiplyScalar=function(E){return this.x*=E,this.y*=E,this},$g.prototype.divide=function(u){return this.x/=u.x,this.y/=u.y,this},$g.prototype.divideScalar=function(p){return this.multiplyScalar(1/p)},$g.prototype.min=function(V){return this.x=Math.min(this.x,V.x),this.y=Math.min(this.y,V.y),this},$g.prototype.max=function(F){return this.x=Math.max(this.x,F.x),this.y=Math.max(this.y,F.y),this},$g.prototype.fromArray=function(Q,A){return A===Y&&(A=0),this.x=Q[A],this.y=Q[A+1],this},$g.prototype.clamp=function(X,u){return this.x=Math.max(X.x,Math.min(u.x,this.x)),this.y=Math.max(X.y,Math.min(u.y,this.y)),this},$g.prototype.clampScalar=function(){var W,b;return function(K,Z){return W===Y&&(W=new $g,b=new $g),W.set(K,K),b.set(Z,Z),this.clamp(W,b)}}(),$g.prototype.clampLength=function(L,z){var w=this.length();return this.multiplyScalar(Math.max(L,Math.min(z,w))/w)},$g.prototype.dot=function(R){return this.x*R.x+this.y*R.y},$g.prototype.cross=function(r){return this.x*r.y-this.y*r.x},$g.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},$g.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},$g.prototype.normalize=function(){return this.divideScalar(this.length())},$g.prototype.angle=function(){var U=Math.atan2(this.y,this.x);return 0>U&&(U+=2*Math.PI),U},$g.prototype.distanceTo=function(p){return Math.sqrt(this.distanceToSquared(p))},$g.prototype.distanceToSquared=function(C){var v=this.x-C.x,g=this.y-C.y;return v*v+g*g},$g.prototype.isNearEnough=function(M){return this.distanceToSquared(M)<1e-8},$g.prototype.setLength=function(T){var R=this.length();return R?this.multiplyScalar(T/R):this},$g.prototype.lerp=function(x,p){return this.x+=(x.x-this.x)*p,this.y+=(x.y-this.y)*p,"number"==typeof x.e&&"number"==typeof this.e&&(this.e+=(x.e-this.e)*p),this},$g.prototype.lerpVectors=function(X,Y,s){return this.subVectors(Y,X).multiplyScalar(s).add(X)},$g.prototype.rotateAround=function(O,w){var e=O?O.x:0,K=O?O.y:0,q=Math.cos(w),s=Math.sin(w),A=this.x-e,x=this.y-K;return this.x=A*q-x*s+e,this.y=A*s+x*q+K,this};var Lg=R.Math.Matrix3=function(){this.el=[1,0,0,0,1,0,0,0,1]};S.assign(Lg.prototype,{isMatrix3:!0,set:function(S,C,K,R,T,b,V,h,Q){var P=this.el;return P[0]=S,P[1]=R,P[2]=V,P[3]=C,P[4]=T,P[5]=h,P[6]=K,P[7]=b,P[8]=Q,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(f){var z=this.el,I=f.el;return z[0]=I[0],z[1]=I[1],z[2]=I[2],z[3]=I[3],z[4]=I[4],z[5]=I[5],z[6]=I[6],z[7]=I[7],z[8]=I[8],this},setFromMatrix4:function(O){var k=O.el;return this.set(k[0],k[4],k[8],k[1],k[5],k[9],k[2],k[6],k[10]),this},applyToBufferAttribute:function(){var t=new Pf;return function(F){for(var a=0,_=F.count;_>a;a++)t.x=F.getX(a),t.y=F.getY(a),t.z=F.getZ(a),t.applyMatrix3(this),F.setXYZ(a,t.x,t.y,t.z);return F}}(),multiply:function(c){return this.multiplyMatrices(this,c)},premultiply:function(R){return this.multiplyMatrices(R,this)},multiplyMatrices:function(Y,u){var A=Y.el,M=u.el,f=this.el,y=A[0],N=A[3],H=A[6],s=A[1],B=A[4],k=A[7],l=A[2],L=A[5],R=A[8],T=M[0],a=M[3],C=M[6],o=M[1],h=M[4],r=M[7],F=M[2],I=M[5],n=M[8];return f[0]=y*T+N*o+H*F,f[3]=y*a+N*h+H*I,f[6]=y*C+N*r+H*n,f[1]=s*T+B*o+k*F,f[4]=s*a+B*h+k*I,f[7]=s*C+B*r+k*n,f[2]=l*T+L*o+R*F,f[5]=l*a+L*h+R*I,f[8]=l*C+L*r+R*n,this},multiplyScalar:function(E){var e=this.el;return e[0]*=E,e[3]*=E,e[6]*=E,e[1]*=E,e[4]*=E,e[7]*=E,e[2]*=E,e[5]*=E,e[8]*=E,this},determinant:function(){var f=this.el,X=f[0],r=f[1],v=f[2],w=f[3],U=f[4],g=f[5],S=f[6],Y=f[7],t=f[8];return X*U*t-X*g*Y-r*w*t+r*g*S+v*w*Y-v*U*S},getInverse:function(m){var $=m.el,F=this.el,I=$[0],w=$[1],D=$[2],n=$[3],G=$[4],b=$[5],S=$[6],x=$[7],t=$[8],B=t*G-b*x,A=b*S-t*n,i=x*n-G*S,E=I*B+w*A+D*i;if(0===E)return this.identity();var l=1/E;return F[0]=B*l,F[1]=(D*x-t*w)*l,F[2]=(b*w-D*G)*l,F[3]=A*l,F[4]=(t*I-D*S)*l,F[5]=(D*n-b*I)*l,F[6]=i*l,F[7]=(w*S-x*I)*l,F[8]=(G*I-w*n)*l,this},transpose:function(){var A,$=this.el;return A=$[1],$[1]=$[3],$[3]=A,A=$[2],$[2]=$[6],$[6]=A,A=$[5],$[5]=$[7],$[7]=A,this},getNormalMatrix:function(W){return this.setFromMatrix4(W).getInverse(this).transpose()},transposeIntoArray:function($){var O=this.el;return $[0]=O[0],$[1]=O[3],$[2]=O[6],$[3]=O[1],$[4]=O[4],$[5]=O[7],$[6]=O[2],$[7]=O[5],$[8]=O[8],this},setUvTransform:function(E,B,m,u,d,H,Z){var z=Math.cos(d),I=Math.sin(d);this.set(m*z,m*I,-m*(z*H+I*Z)+H+E,-u*I,u*z,-u*(-I*H+z*Z)+Z+B,0,0,1)},scale:function(P,_){var y=this.el;return y[0]*=P,y[3]*=P,y[6]*=P,y[1]*=_,y[4]*=_,y[7]*=_,this},rotate:function(m){var Q=Math.cos(m),j=Math.sin(m),v=this.el,O=v[0],G=v[3],S=v[6],p=v[1],y=v[4],Y=v[7];return v[0]=Q*O+j*p,v[3]=Q*G+j*y,v[6]=Q*S+j*Y,v[1]=-j*O+Q*p,v[4]=-j*G+Q*y,v[7]=-j*S+Q*Y,this},translate:function(_,N){var y=this.el;return y[0]+=_*y[2],y[3]+=_*y[5],y[6]+=_*y[8],y[1]+=N*y[2],y[4]+=N*y[5],y[7]+=N*y[8],this},equals:function(H){for(var Z=this.el,c=H.el,A=0;9>A;A++)if(Z[A]!==c[A])return!1;return!0},fromArray:function(F,x){x===Y&&(x=0);for(var A=0;9>A;A++)this.el[A]=F[A+x];return this},toArray:function(q,A){q===Y&&(q=[]),A===Y&&(A=0);var y=this.el;return q[A]=y[0],q[A+1]=y[1],q[A+2]=y[2],q[A+3]=y[3],q[A+4]=y[4],q[A+5]=y[5],q[A+6]=y[6],q[A+7]=y[7],q[A+8]=y[8],q}});var Yr=R.Math.Plane=function(c,V){this.normal=c!==Y?c:new Pf(1,0,0),this.constant=V!==Y?V:0};S.assign(Yr.prototype,{set:function(t,R){return this.normal.copy(t),this.constant=R,this},setComponents:function(t,j,Y,P){return this.normal.set(t,j,Y),this.constant=P,this},setFromNormalAndCoplanarPoint:function(L,P){return this.normal.copy(L),this.constant=-P.dot(this.normal),this},setFromCoplanarPoints:function(){var I=new Pf,h=new Pf;return function(T,A,x){var J=I.subVectors(x,A).cross(h.subVectors(T,A)).normalize();return this.setFromNormalAndCoplanarPoint(J,T),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(D){return this.normal.copy(D.normal),this.constant=D.constant,this},normalize:function(){var y=1/this.normal.length();return this.normal.multiplyScalar(y),this.constant*=y,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(b){return this.normal.dot(b)+this.constant},distanceToSphere:function(s){return this.distanceToPoint(s.center)-s.radius},projectPoint:function(q,O){return O===Y&&(O=new Pf),O.copy(this.normal).multiplyScalar(-this.distanceToPoint(q)).add(q)},intersectLine:function(){var g=new Pf;return function(z,j){j===Y&&(j=new Pf);var R=z.delta(g),A=this.normal.dot(R);if(0===A)return 0===this.distanceToPoint(z.start)?j.copy(z.start):Y;var S=-(z.start.dot(this.normal)+this.constant)/A;return 0>S||S>1?Y:j.copy(R).multiplyScalar(S).add(z.start)}}(),intersectsLine:function(V){var n=this.distanceToPoint(V.start),F=this.distanceToPoint(V.end);return 0>n&&F>0||0>F&&n>0},intersectsBox:function(O){return O.intersectsPlane(this)},intersectsSphere:function(s){return s.intersectsPlane(this)},coplanarPoint:function(A){return A===Y&&(A=new Pf),A.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var p=new Pf,Q=new Lg;return function(j,P){var Z=P||Q.getNormalMatrix(j),E=this.coplanarPoint(p).applyMatrix4(j),o=this.normal.applyMatrix3(Z).normalize();return this.constant=-E.dot(o),this}}(),translate:function(u){return this.constant-=u.dot(this.normal),this},equals:function(y){return y.normal.equals(this.normal)&&y.constant===this.constant}});var ij=R.Math.Ray=function(t,p){this.origin=t!==Y?t.clone():new Pf,this.direction=p!==Y?p.clone():new Pf};S.assign(ij.prototype,{set:function(L,i){return this.origin.copy(L),this.direction.copy(i),this},clone:function(){return(new this.constructor).copy(this)},copy:function(g){return this.origin.copy(g.origin),this.direction.copy(g.direction),this.maxHitLen=g.maxHitLen,this},at:function(i,P){var _=P||new Pf;return _.copy(this.direction).multiplyScalar(i).add(this.origin)},setMaxHitLength:function(K){this.maxHitLen=K},lookAt:function(l){return this.direction.copy(l).sub(this.origin).normalize(),this},applyMatrix4:function(Z){var V=this.maxHitLen;if(V){var K=this.direction.clone().multiplyScalar(V).add(this.origin);K.applyMatrix4(Z)}return this.origin.applyMatrix4(Z),this.direction.transformDirection(Z),V&&(this.maxHitLen=this.origin.distanceTo(K)),this},distanceToPlane:function(n){var J=n.normal.dot(this.direction);if(0===J)return 0===n.distanceToPoint(this.origin)?0:null;var I=-(this.origin.dot(n.normal)+n.constant)/J;return I>=0?I:null},intersectPlane:function(r,K){var $=this.distanceToPlane(r);return null===$?null:this.at($,K)},intersectSphere:function(){var D=new Pf;return function(q,V){D.subVectors(q.center,this.origin);var C=D.dot(this.direction),d=D.dot(D)-C*C,c=q.radius*q.radius;if(d>c)return null;var S=Math.sqrt(c-d),T=C-S,X=C+S;return 0>T&&0>X?null:0>T?this.at(X,V):this.at(T,V)}}(),intersectEllipsoid:function(){var x=new Pf,z=new Pf;return function(b,D){x.subVectors(b.center,this.origin),x.divide(b.radius),z.divideVectors(this.direction,b.radius);var t=z.lengthSq(),R=x.dot(z),B=x.dot(x)*t-R*R;if(B>t)return null;var Q=Math.sqrt(t-B),L=(R-Q)/t,U=(R+Q)/t;return 0>L&&0>U?null:0>L?this.at(U,D):this.at(L,D)}}(),intersectBox:function(s,c){var g,i,Z,w,y,l,J=1/this.direction.x,Q=1/this.direction.y,H=1/this.direction.z,z=this.origin;if(J>=0?(g=(s.min.x-z.x)*J,i=(s.max.x-z.x)*J):(g=(s.max.x-z.x)*J,i=(s.min.x-z.x)*J),Q>=0?(Z=(s.min.y-z.y)*Q,w=(s.max.y-z.y)*Q):(Z=(s.max.y-z.y)*Q,w=(s.min.y-z.y)*Q),g>w||Z>i)return null;if((Z>g||g!==g)&&(g=Z),(i>w||i!==i)&&(i=w),H>=0?(y=(s.min.z-z.z)*H,l=(s.max.z-z.z)*H):(y=(s.max.z-z.z)*H,l=(s.min.z-z.z)*H),g>l||y>i)return null;if((y>g||g!==g)&&(g=y),(i>l||i!==i)&&(i=l),0>i)return null;var P=g>=0?g:i,R=this.maxHitLen;return R&&P>R?null:this.at(P,c)},intersectTriangle:function(){var C=new Pf,J=new Pf,f=new Pf,Z=new Pf;return function(W,D,y,Y,V){J.subVectors(D,W),f.subVectors(y,W),Z.crossVectors(J,f);var z,n=this.direction.dot(Z);if(n>0){if(Y)return null;z=1}else{if(!(0>n))return null;z=-1,n=-n}C.subVectors(this.origin,W);var $=z*this.direction.dot(f.crossVectors(C,f));if(0>$)return null;var U=z*this.direction.dot(J.cross(C));if(0>U||$+U>n)return null;var w=-z*C.dot(Z);if(0>w)return null;var q=w/n,i=this.maxHitLen;return i&&q>i?null:this.at(q,V)}}()});var xb=R.Math.Box3=function(f,c){this.min=f!==Y?f:new Pf(1/0,1/0,1/0),this.max=c!==Y?c:new Pf(-1/0,-1/0,-1/0)};S.assign(xb.prototype,{set:function(Y,C){return this.min.copy(Y),this.max.copy(C),this},setFromArray:function(u){for(var h=1/0,Y=1/0,o=1/0,I=-1/0,d=-1/0,y=-1/0,X=0,M=u.length;M>X;X+=3){var G=u[X],B=u[X+1],m=u[X+2];h>G&&(h=G),Y>B&&(Y=B),o>m&&(o=m),G>I&&(I=G),B>d&&(d=B),m>y&&(y=m)}return this.min.set(h,Y,o),this.max.set(I,d,y),this},setFromPoints:function(W){this.makeEmpty();for(var H=0,t=W.length;t>H;H++)this.expandByPoint(W[H]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(j){return j.max.x<this.min.x||j.min.x>this.max.x||j.max.y<this.min.y||j.min.y>this.max.y||j.max.z<this.min.z||j.min.z>this.max.z?!1:!0},copy:function(n){return this.min.copy(n.min),this.max.copy(n.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(T){return this.min.min(T),this.max.max(T),this},expandByBox:function(y){return this.min.min(y.min),this.max.max(y.max),this},applyMatrix4:function(){var n=[new Pf,new Pf,new Pf,new Pf,new Pf,new Pf,new Pf,new Pf];return function(E){return this.isEmpty()?this:(n[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(E),n[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(E),n[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(E),n[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(E),n[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(E),n[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(E),n[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(E),n[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(E),this.setFromPoints(n),this)}}()});var Qg=R.Math.Sphere=function(w,U){this.center=w!==Y?w:new Pf,this.radius=U!==Y?U:0};S.assign(Qg.prototype,{set:function(P,v){return this.center.copy(P),this.radius=v,this},setFromPoints:function(){var g=new xb;return function(X,e){var d=this.center;e!==Y?d.copy(e):g.setFromPoints(X).getCenter(d);for(var S=0,s=0,J=X.length;J>s;s++)S=Math.max(S,d.distanceToSquared(X[s]));return this.radius=Math.sqrt(S),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(i){return this.center.copy(i.center),this.radius=i.radius,this},empty:function(){return this.radius<=0},containsPoint:function(F){return F.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(y){return y.distanceTo(this.center)-this.radius},intersectsSphere:function(Z){var G=this.radius+Z.radius;return Z.center.distanceToSquared(this.center)<=G*G},intersectsBox:function(k){return k.intersectsSphere(this)},intersectsPlane:function(Y){return Math.abs(Y.distanceToPoint(this.center))<=this.radius},clampPoint:function(x,F){var f=this.center.distanceToSquared(x);return F===Y&&(F=new Pf),F.copy(x),f>this.radius*this.radius&&(F.sub(this.center).normalize(),F.multiplyScalar(this.radius).add(this.center)),F},getBoundingBox:function(z){return z===Y&&(z=new xb),z.set(this.center,this.center),z.expandByScalar(this.radius),z},applyMatrix4:function(X){return this.center.applyMatrix4(X),this.radius=this.radius*X.getMaxScaleOnAxis(),this},translate:function(B){return this.center.add(B),this},equals:function(v){return v.center.equals(this.center)&&v.radius===this.radius}});var qd=R.Math.Frustum=function(i,D,G,P,A,c){this.planes=[i!==Y?i:new Yr,D!==Y?D:new Yr,G!==Y?G:new Yr,P!==Y?P:new Yr,A!==Y?A:new Yr,c!==Y?c:new Yr]};S.assign(qd.prototype,{set:function(E,z,T,D,v,p){var M=this.planes;return M[0].copy(E),M[1].copy(z),M[2].copy(T),M[3].copy(D),M[4].copy(v),M[5].copy(p),this},clone:function(){return(new this.constructor).copy(this)},copy:function(O){for(var n=this.planes,C=0;6>C;C++)n[C].copy(O.planes[C]);return this},setFromMatrix:function(O){var F=this.planes,H=O.el,A=H[0],e=H[1],t=H[2],i=H[3],w=H[4],b=H[5],o=H[6],E=H[7],W=H[8],$=H[9],L=H[10],Y=H[11],p=H[12],v=H[13],u=H[14],c=H[15];return F[0].setComponents(i-A,E-w,Y-W,c-p).normalize(),F[1].setComponents(i+A,E+w,Y+W,c+p).normalize(),F[2].setComponents(i+e,E+b,Y+$,c+v).normalize(),F[3].setComponents(i-e,E-b,Y-$,c-v).normalize(),F[4].setComponents(i-t,E-o,Y-L,c-u).normalize(),F[5].setComponents(i+t,E+o,Y+L,c+u).normalize(),this},intersectsObject:function(){var A=new Qg;return function(V){var G=V.geometry;return null===G.boundingSphere&&G.computeBoundingSphere(),A.copy(G.boundingSphere).applyMatrix4(V.matrixWorld),this.intersectsSphere(A)}}(),intersectsSprite:function(){var T=new Qg;return function(P){return T.center.set(0,0,0),T.radius=.7071067811865476,T.applyMatrix4(P.matrixWorld),this.intersectsSphere(T)}}(),intersectsSphere:function(x){for(var h=this.planes,p=x.center,G=-x.radius,C=0;6>C;C++){var c=h[C].distanceToPoint(p);if(G>c)return!1}return!0},intersectsBox:function(){var u=new Pf;return function(i){for(var f=this.planes,H=0;6>H;H++){var $=f[H];if(u.x=$.normal.x>0?i.max.x:i.min.x,u.y=$.normal.y>0?i.max.y:i.min.y,u.z=$.normal.z>0?i.max.z:i.min.z,$.distanceToPoint(u)<0)return!1}return!0}}(),containsPoint:function(_){for(var U=this.planes,i=0;6>i;i++)if(U[i].distanceToPoint(_)<0)return!1;return!0}});var ai=R.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};S.assign(ai.prototype,{set:function(J,S,k,$,X,L,M,F,P,o,W,B,C,d,x,c){var p=this.el;return p[0]=J,p[4]=S,p[8]=k,p[12]=$,p[1]=X,p[5]=L,p[9]=M,p[13]=F,p[2]=P,p[6]=o,p[10]=W,p[14]=B,p[3]=C,p[7]=d,p[11]=x,p[15]=c,this},clone:function(){return(new ai).fromArray(this.el)},fromArray:function(s,M){M===Y&&(M=0);for(var T=this.el,R=0;16>R;R++)T[R]=s[R+M];return this},getElements:function(){return this.el},scale:function(l){var e=this.el,G=l.x,m=l.y,b=l.z;return e[0]*=G,e[4]*=m,e[8]*=b,e[1]*=G,e[5]*=m,e[9]*=b,e[2]*=G,e[6]*=m,e[10]*=b,e[3]*=G,e[7]*=m,e[11]*=b,this},makeRotationFromEuler:function(w){var q=this.el,p=w._x,z=w._y,Q=w._z,Y=w._order,S=Math.cos(p),a=Math.sin(p),v=Math.cos(z),D=Math.sin(z),g=Math.cos(Q),M=Math.sin(Q);if("XYZ"===Y){var m=S*g,C=S*M,f=a*g,n=a*M;q[0]=v*g,q[4]=-v*M,q[8]=D,q[1]=C+f*D,q[5]=m-n*D,q[9]=-a*v,q[2]=n-m*D,q[6]=f+C*D,q[10]=S*v}else if("YXZ"===Y){var o=v*g,V=v*M,I=D*g,l=D*M;q[0]=o+l*a,q[4]=I*a-V,q[8]=S*D,q[1]=S*M,q[5]=S*g,q[9]=-a,q[2]=V*a-I,q[6]=l+o*a,q[10]=S*v}else if("ZXY"===Y){var o=v*g,V=v*M,I=D*g,l=D*M;q[0]=o-l*a,q[4]=-S*M,q[8]=I+V*a,q[1]=V+I*a,q[5]=S*g,q[9]=l-o*a,q[2]=-S*D,q[6]=a,q[10]=S*v}else if("ZYX"===Y){var m=S*g,C=S*M,f=a*g,n=a*M;q[0]=v*g,q[4]=f*D-C,q[8]=m*D+n,q[1]=v*M,q[5]=n*D+m,q[9]=C*D-f,q[2]=-D,q[6]=a*v,q[10]=S*v}else if("YZX"===Y){var L=S*v,X=S*D,Z=a*v,s=a*D;q[0]=v*g,q[4]=s-L*M,q[8]=Z*M+X,q[1]=M,q[5]=S*g,q[9]=-a*g,q[2]=-D*g,q[6]=X*M+Z,q[10]=L-s*M}else if("XZY"===Y){var L=S*v,X=S*D,Z=a*v,s=a*D;q[0]=v*g,q[4]=-M,q[8]=D*g,q[1]=L*M+s,q[5]=S*g,q[9]=X*M-Z,q[2]=Z*M-X,q[6]=a*g,q[10]=s*M+L}return q[3]=0,q[7]=0,q[11]=0,q[12]=0,q[13]=0,q[14]=0,q[15]=1,this},makeRotationFromQuaternion:function(Q){var V=this.el,R=Q._x,c=Q._y,U=Q._z,C=Q._w,s=R+R,a=c+c,v=U+U,q=R*s,j=R*a,T=R*v,z=c*a,p=c*v,k=U*v,O=C*s,e=C*a,E=C*v;return V[0]=1-(z+k),V[4]=j-E,V[8]=T+e,V[1]=j+E,V[5]=1-(q+k),V[9]=p-O,V[2]=T-e,V[6]=p+O,V[10]=1-(q+z),V[3]=0,V[7]=0,V[11]=0,V[12]=0,V[13]=0,V[14]=0,V[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(R){var q=this.el,U=R.el,V=U[0],y=U[1],e=U[2],H=U[3],A=U[4],r=U[5],I=U[6],L=U[7],W=U[8],J=U[9],_=U[10],S=U[11],s=U[12],w=U[13],i=U[14],E=U[15],B=J*i*L-w*_*L+w*I*S-r*i*S-J*I*E+r*_*E,X=s*_*L-W*i*L-s*I*S+A*i*S+W*I*E-A*_*E,n=W*w*L-s*J*L+s*r*S-A*w*S-W*r*E+A*J*E,D=s*J*I-W*w*I-s*r*_+A*w*_+W*r*i-A*J*i,b=V*B+y*X+e*n+H*D;if(0===b)return this.identity();var m=1/b;return q[0]=B*m,q[1]=(w*_*H-J*i*H-w*e*S+y*i*S+J*e*E-y*_*E)*m,q[2]=(r*i*H-w*I*H+w*e*L-y*i*L-r*e*E+y*I*E)*m,q[3]=(J*I*H-r*_*H-J*e*L+y*_*L+r*e*S-y*I*S)*m,q[4]=X*m,q[5]=(W*i*H-s*_*H+s*e*S-V*i*S-W*e*E+V*_*E)*m,q[6]=(s*I*H-A*i*H-s*e*L+V*i*L+A*e*E-V*I*E)*m,q[7]=(A*_*H-W*I*H+W*e*L-V*_*L-A*e*S+V*I*S)*m,q[8]=n*m,q[9]=(s*J*H-W*w*H-s*y*S+V*w*S+W*y*E-V*J*E)*m,q[10]=(A*w*H-s*r*H+s*y*L-V*w*L-A*y*E+V*r*E)*m,q[11]=(W*r*H-A*J*H-W*y*L+V*J*L+A*y*S-V*r*S)*m,q[12]=D*m,q[13]=(W*w*e-s*J*e+s*y*_-V*w*_-W*y*i+V*J*i)*m,q[14]=(s*r*e-A*w*e-s*y*I+V*w*I+A*y*i-V*r*i)*m,q[15]=(A*J*e-W*r*e+W*y*I-V*J*I-A*y*_+V*r*_)*m,this},makeRotationAxis:function(u,l){var t=Math.cos(l),j=Math.sin(l),p=1-t,Y=u.x,C=u.y,i=u.z,A=p*Y,n=p*C;return this.set(A*Y+t,A*C-j*i,A*i+j*C,0,A*C+j*i,n*C+t,n*i-j*Y,0,A*i-j*C,n*i+j*Y,p*i*i+t,0,0,0,0,1),this},multiply:function(Z){return this.multiplyMatrices(this,Z)},premultiply:function(x){return this.multiplyMatrices(x,this)},multiplyMatrices:function(J,T){var o=J.el,p=T.el,b=this.el,P=o[0],c=o[4],N=o[8],M=o[12],e=o[1],q=o[5],X=o[9],y=o[13],j=o[2],r=o[6],Y=o[10],z=o[14],Q=o[3],V=o[7],H=o[11],$=o[15],w=p[0],K=p[4],v=p[8],O=p[12],F=p[1],n=p[5],R=p[9],L=p[13],E=p[2],B=p[6],x=p[10],G=p[14],s=p[3],Z=p[7],D=p[11],k=p[15];return b[0]=P*w+c*F+N*E+M*s,b[4]=P*K+c*n+N*B+M*Z,b[8]=P*v+c*R+N*x+M*D,b[12]=P*O+c*L+N*G+M*k,b[1]=e*w+q*F+X*E+y*s,b[5]=e*K+q*n+X*B+y*Z,b[9]=e*v+q*R+X*x+y*D,b[13]=e*O+q*L+X*G+y*k,b[2]=j*w+r*F+Y*E+z*s,b[6]=j*K+r*n+Y*B+z*Z,b[10]=j*v+r*R+Y*x+z*D,b[14]=j*O+r*L+Y*G+z*k,b[3]=Q*w+V*F+H*E+$*s,b[7]=Q*K+V*n+H*B+$*Z,b[11]=Q*v+V*R+H*x+$*D,b[15]=Q*O+V*L+H*G+$*k,this},lookAt:function(){var L=new Pf;return function(g,b,H){return L.subVectors(g,b),this.lookAtDirection(L,H)}}(),lookAtDirection:function(){var G=new Pf,f=new Pf,d=new Pf;return function(o,k){k||(k=Pf.UP);var M=this.el;return d.copy(o),0===d.lengthSq()&&(d.z=1),d.normalize(),G.crossVectors(k,d),0===G.lengthSq()&&(1===Math.abs(k.z)?d.x+=1e-4:d.z+=1e-4,d.normalize(),G.crossVectors(k,d)),G.normalize(),f.crossVectors(d,G),M[0]=G.x,M[4]=f.x,M[8]=d.x,M[1]=G.y,M[5]=f.y,M[9]=d.y,M[2]=G.z,M[6]=f.z,M[10]=d.z,this}}(),extractScale:function(){var B;return function(u){B===Y&&(B=new Pf),u===Y&&(u=new Pf);var T=B.setFromMatrixColumn(this,0).length(),h=B.setFromMatrixColumn(this,1).length(),W=B.setFromMatrixColumn(this,2).length();return u.set(T,h,W),u}}(),extractRotation:function(){var D;return function(A){D===Y&&(D=new Pf),A===Y&&(A=new ai);var H=this.el,R=A.el,U=1/D.setFromMatrixColumn(A,0).length(),N=1/D.setFromMatrixColumn(A,1).length(),M=1/D.setFromMatrixColumn(A,2).length();return H[0]=R[0]*U,H[1]=R[1]*U,H[2]=R[2]*U,H[4]=R[4]*N,H[5]=R[5]*N,H[6]=R[6]*N,H[8]=R[8]*M,H[9]=R[9]*M,H[10]=R[10]*M,this}}(),multiplyScalar:function(D){var j=this.el;return j[0]*=D,j[4]*=D,j[8]*=D,j[12]*=D,j[1]*=D,j[5]*=D,j[9]*=D,j[13]*=D,j[2]*=D,j[6]*=D,j[10]*=D,j[14]*=D,j[3]*=D,j[7]*=D,j[11]*=D,j[15]*=D,this},getPosition:function(N){return N===Y&&(N=new Pf),N.setFromMatrixColumn(this,3)},setPosition:function(a){var e=this.el;return e[12]=a.x,e[13]=a.y,e[14]=a.z,this},toArray:function(_,v){_===Y&&(_=[]),v===Y&&(v=0);var H=this.el;return _[v]=H[0],_[v+1]=H[1],_[v+2]=H[2],_[v+3]=H[3],_[v+4]=H[4],_[v+5]=H[5],_[v+6]=H[6],_[v+7]=H[7],_[v+8]=H[8],_[v+9]=H[9],_[v+10]=H[10],_[v+11]=H[11],_[v+12]=H[12],_[v+13]=H[13],_[v+14]=H[14],_[v+15]=H[15],_},determinant:function(){var n=this.el,x=n[0],F=n[4],d=n[8],_=n[12],O=n[1],z=n[5],L=n[9],M=n[13],t=n[2],e=n[6],K=n[10],G=n[14],i=n[3],T=n[7],o=n[11],j=n[15];return i*(+_*L*e-d*M*e-_*z*K+F*M*K+d*z*G-F*L*G)+T*(+x*L*G-x*M*K+_*O*K-d*O*G+d*M*t-_*L*t)+o*(+x*M*e-x*z*G-_*O*e+F*O*G+_*z*t-F*M*t)+j*(-d*z*t-x*L*e+x*z*K+d*O*e-F*O*K+F*L*t)},copy:function(Z){var E=this.el,c=Z.el;return E[0]=c[0],E[1]=c[1],E[2]=c[2],E[3]=c[3],E[4]=c[4],E[5]=c[5],E[6]=c[6],E[7]=c[7],E[8]=c[8],E[9]=c[9],E[10]=c[10],E[11]=c[11],E[12]=c[12],E[13]=c[13],E[14]=c[14],E[15]=c[15],this},compose:function(d,l,L){var a=this.el,z=l._x,G=l._y,S=l._z,X=l._w,P=z+z,A=G+G,y=S+S,q=z*P,h=z*A,w=z*y,Q=G*A,Y=G*y,J=S*y,R=X*P,u=X*A,j=X*y,H=L.x,M=L.y,x=L.z;return a[0]=(1-(Q+J))*H,a[1]=(h+j)*H,a[2]=(w-u)*H,a[3]=0,a[4]=(h-j)*M,a[5]=(1-(q+J))*M,a[6]=(Y+R)*M,a[7]=0,a[8]=(w+u)*x,a[9]=(Y-R)*x,a[10]=(1-(q+Q))*x,a[11]=0,a[12]=d.x,a[13]=d.y,a[14]=d.z,a[15]=1,this},decompose:function(){var Z=new Pf,z=new ai;return function(U,h,t){var f=this.el,M=Z.set(f[0],f[1],f[2]).length(),l=Z.set(f[4],f[5],f[6]).length(),j=Z.set(f[8],f[9],f[10]).length(),x=this.determinant();0>x&&(M=-M),U.x=f[12],U.y=f[13],U.z=f[14],z.copy(this);var P=1/M,p=1/l,d=1/j;return z.el[0]*=P,z.el[1]*=P,z.el[2]*=P,z.el[4]*=p,z.el[5]*=p,z.el[6]*=p,z.el[8]*=d,z.el[9]*=d,z.el[10]*=d,h.setFromRotationMatrix(z),t.x=M,t.y=l,t.z=j,this}}()});var Fb=R.Math.Triangle=function(H,I,c){this.a=H!==Y?H:new Pf,this.b=I!==Y?I:new Pf,this.c=c!==Y?c:new Pf};S.assign(Fb,{barycoordFromPoint:function(){var w=new Pf,F=new Pf,I=new Pf;return function(y,n,C,G,B){w.subVectors(G,n),F.subVectors(C,n),I.subVectors(y,n);var a=w.dot(w),L=w.dot(F),u=w.dot(I),g=F.dot(F),x=F.dot(I),o=a*g-L*L,E=B||new Pf;if(0===o)return E.set(-2,-1,-1);var H=1/o,_=(g*u-L*x)*H,e=(a*x-L*u)*H;return E.set(1-_-e,e,_)}}(),uvIntersection:function(){var S=new Pf;return function(o,A,i,u,w,J,C){return Fb.barycoordFromPoint(o,A,i,u,S),w.multiplyScalar(S.x),J.multiplyScalar(S.y),C.multiplyScalar(S.z),w.add(J).add(C),w.clone()}}()});var le=R.Math.Euler=function(b,k,c,q,i){this.set(b,k,c,q,i)};le.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],le.DefaultOrder="XYZ",le.ReverseOrder=function(){var $={xyz:"ZYX",xzy:"YZX",yxz:"ZXY",yzx:"XZY",zxy:"YXZ",zyx:"XYZ"};return function(i){return $[i]}}(),S.defineProperties(le.prototype,{x:{get:function(){return this._x},set:function(W){this._x=W,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(h){this._y=h,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(o){this._z=o,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback()}}}),S.assign(le.prototype,{set:function(q,W,M,E,d){return Ub(q)&&(d=M,E=W,M=q[2],W=q[1],q=q[0]),E?d&&(E=le.ReverseOrder(E)):E="ZYX",this._x=q||0,this._y=W||0,this._z=M||0,this._order=E||this._order,this.onChangeCallback(),this
},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(I){return this._x=I._x,this._y=I._y,this._z=I._z,this._order=I._order,this.onChangeCallback(),this},setFromRotationMatrix:function(K,m,f){var T=R.Math.clamp,e=K.el||K,g=e[0],X=e[4],s=e[8],w=e[1],Q=e[5],o=e[9],j=e[2],A=e[6],D=e[10];return m=m||this._order,"XYZ"===m?(this._y=Math.asin(T(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-o,D),this._z=Math.atan2(-X,g)):(this._x=Math.atan2(A,Q),this._z=0)):"YXZ"===m?(this._x=Math.asin(-T(o,-1,1)),Math.abs(o)<.99999?(this._y=Math.atan2(s,D),this._z=Math.atan2(w,Q)):(this._y=Math.atan2(-j,g),this._z=0)):"ZXY"===m?(this._x=Math.asin(T(A,-1,1)),Math.abs(A)<.99999?(this._y=Math.atan2(-j,D),this._z=Math.atan2(-X,Q)):(this._y=0,this._z=Math.atan2(w,g))):"ZYX"===m?(this._y=Math.asin(-T(j,-1,1)),Math.abs(j)<.99999?(this._x=Math.atan2(A,D),this._z=Math.atan2(w,g)):(this._x=0,this._z=Math.atan2(-X,Q))):"YZX"===m?(this._z=Math.asin(T(w,-1,1)),Math.abs(w)<.99999?(this._x=Math.atan2(-o,Q),this._y=Math.atan2(-j,g)):(this._x=0,this._y=Math.atan2(s,D))):"XZY"===m?(this._z=Math.asin(-T(X,-1,1)),Math.abs(X)<.99999?(this._x=Math.atan2(A,Q),this._y=Math.atan2(s,g)):(this._x=Math.atan2(-o,D),this._y=0)):console.warn("unsupported order: "+m),this._order=m,f!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var C=new ai;return function(h,A,S){return C.makeRotationFromQuaternion(h),this.setFromRotationMatrix(C,A,S)}}(),setFromVector3:function(M,u){return this.set(M.x,M.y,M.z,u||this._order)},reorder:function(){var X=new Hl;return function(I){return X.setFromEuler(this),this.setFromQuaternion(X,I)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(a){return this._x=a[0],this._y=a[1],this._z=a[2],a[3]!==Y&&(this._order=a[3]),this.onChangeCallback(),this},toArray:function(m,h){return m===Y&&(m=[]),h===Y&&(h=0),m[h]=this._x,m[h+1]=this._y,m[h+2]=this._z,m[h+3]=this._order,m},toVector3:function(K){return K?K.set(this._x,this._y,this._z):new Pf(this._x,this._y,this._z)},onChange:function(b){return this.onChangeCallback=b,this},onChangeCallback:function(){}});var _g={ms_ac:function(c,w){for(var i=w.ms_ac,P=0;P<i.length;P++)Gl(c,i[P])},ms_listener:function(s){s.addListeners=function(){var D=this,s=De;x.mockTouch&&(s=nl.concat(de).concat(Wq)),D.__events__=s;for(var y=0,n=s.length;n>y;y++){var A=s[y];"wheel"===A&&!D.handle_wheel&&D.handle_mousewheel&&(D.handle_wheel=function(f){Ci(D,f)}),D["handle_"+A]&&lc(A,D.getView(),D)}},s.removeListeners=function(){var W=this,K=W.__events__;if(K){W.__events__=Y;for(var s=0,j=K.length;j>s;s++)W["handle_"+K[s]]&&qj(K[s],W.getView(),W)}}},ms_fire:function(p){p.mp=function(l,L,D){this.addPropertyChangeListener(l,L,D)},p.ump=function(H,f){this.removePropertyChangeListener(H,f)},p.fp=function(J,n,U,O,Z){return this.firePropertyChange(J,n,U,O,Z)},p.addPropertyChangeListener=function(S,L,d){var x=this;x._62I||(x._62I=new Fr),x._62I.add(S,L,d)},p.removePropertyChangeListener=function(k,I){this._62I&&this._62I.remove(k,I)},p.firePropertyChange=function(B,c,k,G,e){if(G){if(G(c,k))return!1}else if(c===k)return!1;var s=this,R=e||{};return R.property=B,R.oldValue=c,R.newValue=k,R.source=s,R.data=s,s._62I&&s._62I.fire(R),s.onPropertyChanged&&s.onPropertyChanged(R),!0}},ms_attr:function(T){T.a=function(T,m){var b=this;if(2===arguments.length)b.setAttr(T,m);else{if(!gr(T))return b.getAttr(T);for(var k in T)b.setAttr(k,T[k])}return b},T.getAttr=function(Z,W){if(W===Y&&(W=1),this._attrObject&&Z in this._attrObject)return this._attrObject[Z];if(this.getImage){var O=this.getImage();if(Fn(O)&&(O=gj[O]),gr(O)&&"dataBindings"in O)for(var g=O.dataBindings,w=g.length-1;w>=0;w--){var M=g[w];if(M.attr===Z){if("defaultValue"in M)return M.defaultValue;break}}}return W?I[Z]:Y},T.setAttr=function(U,d){var z=this;z._attrObject||(z._attrObject={});var y=z._attrObject[U];d===Y?delete z._attrObject[U]:z._attrObject[U]=d,z.fp&&z.fp("a:"+U,y,d)&&z.onAttrChanged&&z.onAttrChanged(U,y,d)},T.getSerializableAttrs=function(){var f,Z={};for(f in this._attrObject)Z[f]=1;return Z}},ms_bnb:function(F){F.getBodyColor=function(M){return M.s("body.color")},F.getBorderColor=function(G){return G.s("border.color")}},_51o:function($){$.mi=function(d,G,i){this.addInteractorListener(d,G,i)},$.umi=function(j,T){this.removeInteractorListener(j,T)},$.fi=function(R){this.fireInteractorEvent(R)},$.addInteractorListener=function(C,D,q){var J=this;J._63I||(J._63I=new Fr),J._63I.add(C,D,q)},$.removeInteractorListener=function(B,C){this._63I&&this._63I.remove(B,C)},$.fireInteractorEvent=function(l){this._63I&&this._63I.fire(l)},$.setInteractors=function(x){var V=this,M=V._interactors;M&&M.each(function(o){o.tearDown()}),Ub(x)&&(x=new Hb(x)),V._interactors=x,x&&x.each(function(p){p.setUp()}),V.fp("interactors",M,x),V.invalidateSelection()},$.getInteractors=function(){return this._interactors}},_49o:function(y){y._44O=F,y._45O=F,y.getTopPainters=function(){return this._44O},y.getBottomPainters=function(){return this._45O},y.addTopPainter=function(x){var t=this;t._44O||(t._44O=new Hb),t._44O.contains(x)||(t._44O.add(x),t.redraw&&t.redraw())},y.removeTopPainter=function(K){var $=this;$._44O&&($._44O.remove(K),$.redraw&&$.redraw())},y.addBottomPainter=function(j){var E=this;E._45O||(E._45O=new Hb),E._45O.contains(j)||(E._45O.add(j),E.redraw&&E.redraw())},y.removeBottomPainter=function(X){var p=this;p._45O&&(p._45O.remove(X),p.redraw&&p.redraw())},y._93db=function(c,w){var h=this;h._45O&&h._45O.each(function(Q){Q.draw?Q.draw(c,w):Q.call(h,c,w)})},y._92db=function(B,P){var C=this;C._44O&&C._44O.each(function(K){K.draw?K.draw(B,P):K.call(C,B,P)})}},ms_sm:function(I){I.sm=function(){return this.getSelectionModel()},I.setSelectableFunc=function(c){this.sm().setFilterFunc(c)},I.getSelectableFunc=function(){return this.sm().getFilterFunc()},I.getSelectionModel=function(){var D=this;return D._selectionModel?D._selectionModel:D.dm().sm()},I.isSelectionModelShared=function(){return!this._selectionModel},I.setSelectionModelShared=function(e){var Q=this,t=Q.sm(),G=!Q._selectionModel,g=Q.handleSelectionChange,$=Q.dm();G!==e&&(Q.invalidateSelection&&Q.invalidateSelection(),e?($.sm().ms(g,Q),Q._selectionModel.ums(g,Q),Q._selectionModel.dispose(),Q._selectionModel=F):($.sm().ums(g,Q),Q._selectionModel=new Rh($),Q._selectionModel.ms(g,Q)),Q.onSelectionModelSharedChanged(),Q.fp("selectionModelShared",G,e),Q.fireViewEvent({kind:"selectionModelSharedChange",oldValue:G,newValue:e,oldSelectionModel:t,newSelectionModel:Q.sm()}))},I.onSelectionModelSharedChanged=function(){var s=this;s.redraw(),s.invalidateSelection&&s.invalidateSelection()},I.removeSelection=function(){var j=this.dm();j.beginTransaction(),this.sm().toSelection().each(j.remove,j),j.endTransaction()},I.selectAll=function(){var K=this;K.sm().ss(K.dm().toDatas(function(Y){return K.isVisible(Y)&&K.isSelectable(Y)}))},I.isSelected=function(c){return this.sm().co(c)},I.isSelectedById=function(G){var J=this.dm().getDataById(G);return J?this.isSelected(J):!1},I.isSelectable=function(H){return this.sm().isSelectable(H)}},ms_tx:function(y){y._64I=0,y._65O=0,y.isScrollable=function(){return this.getWidth()<this._64I},y._40o=function(){return this.isScrollable()},y.getLogicalPoint=function(G){return Oj(G,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},y.tx=function(i){return i===Y?this.getTranslateX():(this.setTranslateX(i),void 0)},y.getTranslateX=function(){return this._65O},y.setTranslateX=function(Y){var $=this,x=$.getWidth()-$._64I;x>Y&&(Y=x),Y>0&&(Y=0),Y=m(Y);var q=$._65O;$._65O=Y,$.fp(Nl,q,Y)}},ms_ty:function(G){G._23Q=0,G._66O=0,G._41o=function(){return this.getHeight()<this._23Q},G.getLogicalPoint=function(H){return Oj(H,this._canvas||this._view,this.tx?this.tx():0,this.ty())},G.ty=function(P){return P===Y?this.getTranslateY():(this.setTranslateY(P),void 0)},G.getTranslateY=function(){return this._66O},G.setTranslateY=function(Y){var k=this,q=k.getHeight()-k._23Q;q>Y&&(Y=q),Y>0&&(Y=0),Y=m(Y);var z=k._66O;k._66O=Y,k.fp(Tk,z,Y)}},ms_txy:function(H){H._65O=0,H._66O=0,H.tx=function(d){return d===Y?this.getTranslateX():(this.setTranslateX(d),void 0)},H.ty=function(g){return g===Y?this.getTranslateY():(this.setTranslateY(g),void 0)},H.onTranslateEnded=function(){},H.setTranslate=function(N,r,I){var K=this;if(I=Pg(I)){K._65I&&K._65I.stop(!0);var f=K.tx(),t=K.ty();I.action=function(F){K.setTranslate(f+(N-f)*F,t+(r-t)*F)},I._37o=function(){delete K._66I,delete K._65I,K.onTranslateEnded()},K._66I=1,K._65I=Rg(I)}else K.tx(N),K.ty(r)},H.getTranslateX=function(){return this._65O},H.setTranslateX=function(k){var j=this;k=j.adjustTranslateX(k);var U=j._65O;j._65O=k,j.fp(Nl,U,k)},H.getTranslateY=function(){return this._66O},H.setTranslateY=function(g){var p=this;g=p.adjustTranslateY(g);var R=p._66O;p._66O=g,p.fp(Tk,R,g)},H.adjustTranslateX=function(b){return m(b)},H.adjustTranslateY=function(o){return m(o)},H.translate=function(E,A,x){this.setTranslate(this.tx()+E,this.ty()+A,x)},H.getLogicalPoint=function(O){var Y=this;return Oj(O,this._canvas||Y._view,Y.tx(),Y.ty())}},ms_dm:function(D){D.dm=function(u){return u?(this.setDataModel(u),void 0):this.getDataModel()},D.getDataModel=function(){return this._dataModel}},ms_lp:function(v){v.lp=function(f){return this.getLogicalPoint(f)}},ms_v:function(b){b._disabled=!1,b.setDisabled=function(r,f){var Z=this,t=Z._disabled;t!==r&&(t&&(yo(Z._63O),delete Z._63O),r&&(kf(Z._view,Z._63O=hr(f)),Z.iv()),Z._disabled=r,Z.fp("disabled",t,r))},b.isDisabled=function(){return this._disabled},b.getDisabledDiv=function(){return this._63O},b.getView=function(){return this._view},b.addToDOM=function(T){var q=this,l=q.getView(),Q=l.style;T=T||M.body,T.appendChild(l),Q.left="0",Q.right="0",Q.top="0",Q.bottom="0",B(t,"resize",function(){q.iv()}),q.iv()},b.setCursor=function(x){"default"===x&&(x=this._defaultCursor||x);var y=this.getView().style;y.cursor=x,y.cursor="-webkit-"+x,y.cursor="-moz-"+x},b.getWidth=function(){return this._view.clientWidth},b.getHeight=function(){return this._view.clientHeight},b.setWidth=function(M){var h=this;h._view.style.width=M+Oq,h.iv(),h.fp&&h.fp(jf,F,M)},b.setHeight=function(A){var k=this;k._view.style.height=A+Oq,k.iv(),k.fp&&k.fp(xn,F,A)},b.setFocus=function(f){var p=this,G=p._currentEditor;return f&&G&&(G.getView&&(G=G.getView()),G.contains(f.target))?!1:(Qk(p._view),p.endEditing&&p.endEditing(),p.fireViewEvent("focus"),!0)},b.iv=function(N){this.invalidate(N)},b.invalidate=function(b){var L=this;L._68I||(L._68I=1,Di(L.validate,L,F,b),L.onInvalidated&&L.onInvalidated(),L.fireViewEvent("invalidate"))},b.validate=function(){var S=this,N=S._view;if(S._68I&&(delete S._68I,N.parentNode))if(0===N.offsetWidth&&0===N.offsetHeight&&S._67I!==F)S._67I===Y&&(S._67I=x.reinvalidateCount),S._67I>0?S._67I--:S._67I=F,S.iv();else{S.fireViewEvent("beginValidate"),S.validateImpl(),S.onValidated&&S.onValidated(),S.fireViewEvent("validate");var D=S._63O;D&&(N.lastChild!==D&&(yo(D),kf(N,D)),Gk(D,0,0,S.getWidth(),S.getHeight())),Ql(S),Ri(S),kb(S)}},b.layout=function(r,B,z,b){1===arguments.length?Gk(this,r):Gk(this,r,B,z,b)},b.addViewListener=function(I,r,q){var C=this;C._67O||(C._67O=new Fr),C._67O.add(I,r,q)},b.removeViewListener=function(L,B){this._67O.remove(L,B)},b.fireViewEvent=function(W){var d=this;d._67O&&(Fn(W)&&(W={kind:W}),d._67O.fire(W)),x.viewListener&&x.viewListener(d,W)}},ms_tip:function(J){J.setToolTipEnabled=function(P){var w=this;P?Mc||w._13o||(w.enableToolTip(),w.fp("toolTipEnabled",!1,!0)):w._13o&&(w.disableToolTip(),w.fp("toolTipEnabled",!0,!1))},J.isToolTipEnabled=function(){return!!this._13o},J.enableToolTip=function(){var K=this;if(!Mc&&!K._13o){K._13o=function(y){var r=K.getToolTip(y);r!=F?(x.toolTipContinual&&x.isToolTipShowing()?rg(y,r):(Qf(),bf={timeout:bg(Zm,Wl),e:y,info:r}),Wn={e:y,view:K}):Qf()};var H=K.getView();B(H,id,K._13o),B(H,"mouseleave",x.hideToolTip)}},J.disableToolTip=function(){var T=this;if(T._13o){var J=T.getView();V(J,id,T._13o),V(J,"mouseleave",x.hideToolTip),delete T._13o}},J.getToolTip=function(Y){var q=this;if(q.getDataAt){var n=q.getDataAt(Y);return n?n.getToolTip():F}return q.getValue?q.getValue():void 0}},_52o:function(D){D._zoom=1,D._29I=be,D.zoomIn=function($,n){this.setZoom(this._zoom*aj,$,n)},D.zoomOut=function(I,W){this.setZoom(this._zoom/aj,I,W)},D.zoomReset=function(w,N){this.setZoom(1,w,N)},D.scrollZoomIn=function(X){this.setZoom(this._zoom*eg,F,X)},D.scrollZoomOut=function(O){this.setZoom(this._zoom/eg,F,O)},D.pinchZoomIn=function(U){this.setZoom(this._zoom*cf,F,U)},D.pinchZoomOut=function(E){this.setZoom(this._zoom/cf,F,E)},D.adjustZoom=function(K){return Ur>K?Ur:K>Qr?Qr:K},D.getZoom=function(){return this._zoom},D.setZoom=function(H,_,R){var z=this;if(_=Pg(_)){z._14o&&z._14o.stop(!0);var e=z._zoom;_.action=function(J){z._96O(e+(H-e)*J,R)},_._37o=function(){delete z._zooming,delete z._14o,z.onZoomEnded()},z._zooming=1,z._14o=Rg(_)}else z._96O(H,R)},D._96O=function(Y,I){var D=this;if(Y=D.adjustZoom(Y),Y!==D._zoom){D.validate();var H=D._29I,E=D._zoom;0!==H.width&&0!==H.height&&(I=I?I:{x:H.x+H.width/2,y:H.y+H.height/2},D.tx((I.x-H.x)*E-I.x*Y),D.ty((I.y-H.y)*E-I.y*Y)),D._zoom=Y,D.fp("zoom",E,Y)}}},ms_edge:function(R){R._2I=function(w){var F=this;F._44I||(F._44I=new Hb),F._42I||(F._42I=new Hb),F._44I.add(w),F._42I.add(w),F._20I()},R._4I=function(B){var r=this;r._44I||(r._44I=new Hb),r._43I||(r._43I=new Hb),r._44I.add(B),r._43I.add(B),r._20I()},R._16I=function(f){var J=this;J._44I.remove(f),J._42I.remove(f),J._44I.isEmpty()&&delete J._44I,J._42I.isEmpty()&&delete J._42I,J._20I()},R._18I=function(n){var f=this;f._44I.remove(n),f._43I.remove(n),f._44I.isEmpty()&&delete f._44I,f._43I.isEmpty()&&delete f._43I,f._20I()},R._20I=function(){var J=this;if(delete J._45I,!J._44I||J._44I.isEmpty())return delete J._70O,void 0;var R;J._44I.each(function(F){F.isLooped()&&(R||(R={}),R[F._id]||(J._45I||(J._45I=new Hb),J._45I.add(F),R[F._id]=F))}),R?(J._70O=new Hb,J._44I.each(function(p){R[p._id]?"A"===R[p._id]||(R[p._id]="A",J._70O.add(p)):J._70O.add(p)})):J._70O=J._44I},R.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},R.getSourceAgentEdges=function(){return this._46I},R.getTargetAgentEdges=function(){return this._47I},R._1I=function(x){var L=this;L._46I||(L._46I=new Hb),L._48I||(L._48I=new Hb),L._46I.add(x),L._48I.add(x),L._19I()},R._3I=function(s){var P=this;P._47I||(P._47I=new Hb),P._48I||(P._48I=new Hb),P._47I.add(s),P._48I.add(s),P._19I()},R._15I=function(J){var N=this;N._46I.remove(J),N._48I.remove(J),N._46I.isEmpty()&&delete N._46I,N._48I.isEmpty()&&delete N._48I,N._19I()},R._17I=function(q){var p=this;p._47I.remove(q),p._48I.remove(q),p._47I.isEmpty()&&delete p._47I,p._48I.isEmpty()&&delete p._48I,p._19I()},R._19I=function(){var e=this;delete e._49I;var R=e._48I;if(R&&!R.isEmpty()){var m={};R.each(function(G){m[G._id]?e._49I||(e._49I=new Hb):m[G._id]=G}),e._49I?R.each(function(q){m[q._id]&&(e._49I.add(q),delete m[q._id])}):e._49I=R}},R.getLoopedEdges=function(){return this._45I},R.getEdges=function(){return this._70O},R.getAgentEdges=function(){return this._49I},R.getSourceEdges=function(){return this._42I},R.getTargetEdges=function(){return this._43I},R._8I=function(){this._70O&&this._70O.each(function(w){w._7I()})}},ms_shadow:function(n){hi.PARAMS.forEach(function(j){var k=j.replace(/(^|\.)[a-z]/g,function(W){return W[W.length-1].toUpperCase()}),o=k.charAt(0).toLowerCase()+k.substr(1);n["getShadow"+k]=function(){return this._getShadowParam(o)},n["setShadow"+k]=function(T){this._setShadowParam(o,T)}}),n.enableShadow=function(M){this.shadowMap.setShadow(!0,M)},n.disableShadow=function(){this.shadowMap.setShadow(!1)},n._getShadowParam=function(g){return this.shadowMap.getShadow()[g]},n._setShadowParam=function($,P){var B=this._getShadowParam($),F={};F[$]=P;var V=this.shadowMap;V.setShadow(V.enable,F),this.firePropertyChange("shadow"+$.charAt(0).toUpperCase()+$.substr(1),B,P)}}};je(x,{getVersion:function(){return"7.2.6-dev8"}},!0),je(x,{numberDigits:5,crossOrigin:"",baseZIndex:Y,isTouchable:Mc,mockTouch:!0,devicePixelRatio:t.devicePixelRatio?t.devicePixelRatio:t.screen?t.screen.deviceXDPI/t.screen.logicalXDPI:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:K.disabledBackground,forceHierarchicalSerialization:!0,extractBatchTranslation:!1,extractShapeTranslation:!1,envmapProbeMinWaitTime:300,envmapProbeMaxWaitTime:25e3,EnvmapTextureSize:1024,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Lh},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],blockMinSize:1,textExtraWidth:4,encodeStringKey:null,doubleClickSpeed:500,doubleClickRange:1,doubleTouchRange:20,touchMoveThreshold:10,animDuration:200,animEasing:function(v){return v*v},labelColor:El,labelSelectColor:zd,labelFont:"12px arial, sans-serif",widgetIndent:Mc?30:20,widgetRowHeight:Mc?30:20,widgetHeaderHeight:Mc?32:22,widgetTitleHeight:Mc?34:24,scrollBarColor:Ig,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Mc?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,pinchZoomThreshold:1,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:xo,intersectionLineLine:Si,isEnter:kj,isEsc:Ei,isDelete:Nb,isSpace:an,isLeft:pm,isUp:ce,isRight:hj,isDown:Hr,isTouchEvent:kh,getTarget:Co,isString:Fn,isNumber:bs,isBoolean:Um,isArray:Ub,isSelectAll:fe,isFunction:nf,isObject:gr,getPropertyValue:Jo,setPropertyValue:bo,addMethod:je,createGradient:function(D,N,E,x,o,r,n,$){var e=Ej[N];return e(D,E,x,o,r,n,$)},appendToScreen:function(F){F=F.getView?F.getView():F,(M.fullscreenElement||M.mozFullScreenElement||M.webkitFullscreenElement||M.msFullscreenElement||M.body).appendChild(F)},encodeString:function(U){return R.Math.encodeBase64(U,x.encodeStringKey)},decodeString:function(L){return R.Math.decodeBase64(L,x.encodeStringKey)},findView:function(o){var V=function(I,d){var a=d._ht;a&&I.push(a);var Q=d.children,W=Q.length;if(W)for(var x=0;W>x;x++)V(I,Q[x])},K=[];V(K,M.body);var C=function(m,Q){for(var M="2d"===Q?vh.GraphView:Km.Graph3dView,G=0,k=m.length;k>G;G++)if(m[G]instanceof M)return K[G];return null};return"all"===o?K:"2d"===o?C(K,"2d"):"3d"===o?C(K,"3d"):C(K,"3d")||C(K,"2d")},toggleFullscreen:function(F){var t=F.getView();if(M.fullscreenElement||M.mozFullScreenElement||M.webkitFullscreenElement||M.msFullscreenElement)M.exitFullscreen?M.exitFullscreen():M.msExitFullscreen?M.msExitFullscreen():M.mozCancelFullScreen?M.mozCancelFullScreen():M.webkitExitFullscreen&&M.webkitExitFullscreen();else{var D=!0;if(F.isSelfViewEvent){var V=F.getX(),n=F.getY(),X=F.getWidth(),L=F.getHeight(),Q=t.style.background,q=t.style.backgroundColor;Q||q||(t.style.backgroundColor="white"),t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen();var w=setInterval(function(){if(t!==(M.fullscreenElement||M.mozFullScreenElement||M.webkitFullscreenElement||M.msFullscreenElement))clearInterval(w),F.setX(V),F.setY(n),F.setWidth(X),F.setHeight(L),F._fullscreen=!1,t.style.oldBackgroundColor=q,F.iv();else{var z=R.Default.getWindowInfo();(D||z.width!==F.getWidth()||z.height!==F.getHeight())&&(F.setX(z.left),F.setY(z.top),F.setWidth(z.width),F.setHeight(z.height),F._fullscreen=!0,F.iv(),D=!1)}},500)}else{var d=t.style.left,k=t.style.top,X=t.style.width,L=t.style.height,Q=t.style.background,q=t.style.backgroundColor;Q||q||(t.style.backgroundColor="white"),t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen();var w=setInterval(function(){if(t!==(M.fullscreenElement||M.mozFullScreenElement||M.webkitFullscreenElement||M.msFullscreenElement))clearInterval(w),t.style.left=d,t.style.top=k,t.style.width=X,t.style.height=L,t.style.oldBackgroundColor=q,F.iv();else{var o=R.Default.getWindowInfo();(D||o.width!==F.getWidth()||o.height!==F.getHeight())&&(Gk(F),D=!1)}},500)}}},appendTimeStamp:function(W){return W},setCompType:function(W,v){Fn(v)&&v.substr(0,12)==Uk&&(v=x.parse(v)),nf(v)||gr(v)?kr[W]=v:Lc(W)},getCompType:function(w){var m=kr[w];return m===Y&&Om.test(w)&&Lc(w),m},getCompTypeMap:function(){return kr},drawCompType:function(d,z,b,r,Q,i){d(z,b,r,Q,i)},numberListener:function(){var X={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(M){var h=M.keyCode;X[h]||65===h&&x.isCtrlDown(M)||86===h&&x.isCtrlDown(M)||67===h&&x.isCtrlDown(M)||88===h&&x.isCtrlDown(M)||h>=35&&40>=h||(M.shiftKey||48>h||h>57)&&(96>h||h>105)&&M.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(F){var A=F.target.tagName;("DIV"===A||"CANVAS"===A)&&!(x.ignoreKeyCodes.indexOf(F.keyCode)>=0)&&("keydown"!==F.type||pm(F)||hj(F)||ce(F)||Hr(F)||Nb(F)||65===F.keyCode&&(F.metaKey||F.ctrlKey))&&F.cancelable===!0&&(F.preventDefault(),F.preventManipulation&&F.preventManipulation())},getWindowInfo:function(){var d=M.documentElement,m=d&&(d.scrollLeft||d.scrollTop)?d:M.body;return{target:m,left:m.scrollLeft,top:m.scrollTop,width:t.innerWidth||m.clientWidth,height:t.innerHeight||m.clientHeight}},isDragging:function(){return!!Lh},isLeftButton:function(Z){return kh(Z)?!0:0===Z.button},isMiddleButton:function(h){return kh(h)?!1:h&&(1===h.button||4&(h.buttons||0))},isRightButton:function(t){return kh(t)?!1:t&&(2===t.button||2&(t.buttons||0))},isInput:function(d){if(!d)return!1;var y=d.tagName;return"INPUT"===y||"TEXTAREA"===y||"SELECT"===y},getTouchCount:function(L){return kh(L)?L.touches.length:1},isDoubleClick:function(){function m(O){O.details=0,O.timeout=null,O.lastPoint=null}var O={};return _b=new yq,rs=_b.getTime(),function(j){if(Hh(j)>1)return!1;var $=j.button==F?"":j.button,H=j.type+$,b=H+"_isDoubleClick",Q=O[H];if(Q||(Q=O[H]={details:0,timeout:null,lastPoint:null}),j[b]===Y){j[b]=!0;var B=sf(j);Q.timeout&&(ee(Q.timeout),Q.timeout=null);var J=kh(j)?x.doubleTouchRange:x.doubleClickRange;Q.lastPoint&&Gd(Q.lastPoint,B)>J&&m(Q),Q.lastPoint=B,Q.details++,Q.timeout=bg(function(){m(this)}.bind(Q),x.doubleClickSpeed)}return 2===Q.details}}(),isShiftDown:function(V){return V?V.shiftKey:Qm["16"]},isCtrlDown:function(l){return l?Qd?l.metaKey:l.ctrlKey:Qd?Qm["91"]:Qm["17"]},getClientPoint:function(L){return kh(L)&&(L=Hp(L)),{x:L.clientX,y:L.clientY}},isMouseEvent:function(I){return I instanceof MouseEvent||0===I.type.indexOf("mouse")},getTargetElement:function(d){var Y,F=Jp(d);if(Y=x.isMouseEvent(d)||!M.elementFromPoint?d.target:M.elementFromPoint(F.x,F.y),_r&&M.elementFromPoint){for(var n=[],X=[];"none"===Y.style.pointerEvents;)n.push(Y),X.push(Y.style.display||""),Y.style.display="none",Y=M.elementFromPoint(F.x,F.y);n.forEach(function(v,m){v.style.display=X[m]})}return Y},getPagePoint:function(A){return kh(A)&&(A=Hp(A)),{x:A.pageX,y:A.pageY}},createObject:function(I,N){var $=new I;for(var L in N){var V=N[L];if(nf(V))$[L]=V;else if(0===L.indexOf("s:"))$.s(L.substr(2),N[L]);else if(0===L.indexOf("a:"))$.a(L.substr(2),N[L]);else{var o=_q(L),V=N[L];$[o]?($[o](V),"setToolTip"===o&&$.enableToolTip&&$.enableToolTip()):$[L]=V}}return $},setImage:function(C,Y,k,t){var L=arguments.length;4===L?li(C,t,Y,k):2===L?Fn(Y)?Y.substr(0,12)==Uk?Yb(C,x.parse(Y)):li(C,Y):Yb(C,Y):1===L&&li(C,C)},getImage:function(e,V,C){var I;if(e==F)return F;if(gr(e)?I=e:(I=gj[e],e&&I===Y&&(ym&&ym[e]||li(e,e))),V&&I&&I.tagName){var g;g="override"===C?"colors_override":"override_rgb"===C?"colors_override_rgb":"override_a"===C?"colors_override_a":"colors",I[g]||(I[g]={__count__:0});var J=I[g][V];return J||(I[g].__count__>x.imageCacheThreshold&&(I[g]={__count__:0}),J=ch(I,yl(V),I.width,I.height,C),I[g][V]=J,I[g].__count__++),J}return I},isImageComplete:function(Z,E,k){var u=ti(Z);if(!u)return!1;if(u.tagName)return u.complete;for(var G,Z,m,h=u.comps,s=!0,y=0,N=h.length;N>y;y++)if(G=h[y],m=G.type,"image"===G.type){Z=G.name,Z&&Z.func&&(Z=ur(Z,E));var V=Md(Z,E,k);if(!V){s=!1;break}}else if(Om.test(m)&&x.getCompType(m)===Y){s=!1,Lc(m);break}return s},getId:function(){var A=1;return function(){return++A}}(),callLater:function(e,I,q,F){var p=function(){e.apply(I,q)};return F?bg(p,F):t.requestAnimationFrame(p)},cancelLater:function(Z,u){u?ee(Z):t.cancelAnimationFrame(Z)},clone:function(J){if(null==J||"object"!=typeof J)return J;if(J instanceof Date){var b=new Date;return b.setTime(J.getTime()),b}if(J instanceof Array){for(var b=[],I=0,u=J.length;u>I;I++)b[I]=Af(J[I]);return b}if(J instanceof Hb){for(var b=new Hb,I=0,u=J.length;u>I;I++)b.set(I,Af(J.get(I)));return b}if(J instanceof Yk)return J;if(J instanceof dl){var b=new dl;return b.deserialize(J.serialize()),b}if(J instanceof S){var b={};for(var W in J)J.hasOwnProperty(W)&&(b[W]=Af(J[W]));return b}return J},callWhenLoaded:function(J,w){w=w||100;var A=qs(J,w);Tf||(Tf={}),Tf[A]={tick:A,cb:J,delay:w}},beforeLoadURL:function(F,c){if(Tf){var Z={};for(var c in Tf){var D=Tf[c];ee(D.tick);var z=qs(D.cb,D.delay);Z[z]={tick:z,delay:D.delay,cb:D.cb}}Tf=Z}return x.convertURL?x.convertURL(F,c):F},convertURL:function(C){return C},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return x.getImage("default_blank")},resizeImage:function(M,q,L,R){L||(L=q),R||(R=Vl());var $=R.getContext("2d");return Bh(R,q,L,1),$.drawImage(M,0,0,q,L),R},resizeImagePOT:function(P,Q,e){if(!P||!P.tagName)return P;var o=P.width,A=P.height;if(!o||!A)return P;if(ze.isPOT(o)&&ze.isPOT(A)&&(!Q||o===A))return P;var g,r;return Q?r=g=ze.nearestPOT(Math.min(o,A)):(g=ze.nearestPOT(o),r=ze.nearestPOT(A)),x.resizeImage(P,g,r,e)},sortFunc:function(M,P){if(M===P)return 0;if(M==F&&P!=F)return 1;if(M!=F&&P==F)return-1;if(M==F&&P==F)return 0;var i,t=typeof M,o=typeof P;return t===ud&&o===ud?i=M.localeCompare(P):t===Kp&&o===Kp&&(i=M-P),i===Y&&(i=(""+M).localeCompare(""+P)),i>0?1:0>i?-1:0},getClassMap:function(){return ah},getClass:function(e){if(Fn(e)){var m,L=ah[e];if(!L){m=e.split("."),L=t;for(var B=0;B<m.length;B++)L=L[m[B]];ah[e]=L}return L}return e},def:function(s,z,p){var A,x,R,J=function(){};if(J.prototype=z.prototype,A=new J,Fn(s)){if(ah[s])throw"'"+s+"' already defined";R=nr(s),A.getClassName=function(){return s}}else R=s;if(A.constructor=R,A.getClass=function(){return R},A.getSuperClass=function(){return z},p)for(x in p)_g[x]&&_g.hasOwnProperty(x)?_g[x](A,p):fs(A,p,x);R.prototype=A,R.superClass=z.prototype},startAnim:function(){var N=function(y){y.duration&&(y.startTime=wi()),y.timeId=Di(y.tick,F,F,y.interval)};return function(D){return D=Af(D),D.easing=D.easing||x.animEasing,D.duration||D.frames||(D.duration=x.animDuration),D.t=0,D.duration?D.interval=0:(D.frame=0,D.interval=D.interval||10),D.tick=function(){if(D.duration){var G=(wi()-D.startTime)/D.duration;if(G>1&&(G=1),D.t=G,D.action(D.easing(G),G),!D.isRunning())return;1===G?D.stop():D._isPaused||(D.timeId=Di(D.tick))}else{if(D.frame++,G=D.t=D.frame/D.frames,D.action(D.easing(G),G),!D.isRunning())return;D.frame<D.frames?D._isPaused||(D.timeId=Di(D.tick,F,F,D.interval)):D.stop()}},D.resume=function(){D._isPaused&&(delete D._isPaused,D.duration?D.t<1&&(D.startTime=wi()-D.duration*D.t,D.timeId=Di(D.tick)):D.frame<D.frames&&(D.timeId=Di(D.tick,F,F,D.interval)))},D.pause=function(){lj(D.timeId,!D.duration),D._isPaused=!0},D.isPaused=function(){return this._isPaused},D.stop=function(O){D.isRunning()&&(lj(D.timeId,!D.duration),delete D.timeId,D.duration?D.t<1&&O&&(D.t=1,D.action(D.easing(1),1)):D.frame<D.frames&&O&&(D.frame=D.frames,D.action(D.easing(1),1)),D._37o&&D._37o(),D.finishFunc&&D.finishFunc())},D.isRunning=function(){return D.timeId!=F},D.delay?Di(N,F,[D],D.delay):N(D),D}}(),getTextSize:function(){var Y={},p=M?Vl().getContext("2d"):F;return function(O,m){p.font=O?O:Pd;var P=Y[p.font];return P||(P=2*p.measureText("e").width+4,Y[p.font]=P),{width:p.measureText(m).width+x.textExtraWidth,height:P}}}(),drawText:function(E,L,K,D,j,X,m,v,J,u,i){if(L!=F){var R=gn(K,L),W={};W.y=u&&u!==Pk?u===En?X+R.height/2:X+v-R.height/2:X+v/2,W.x=J&&J!==Qi?J===Me?j+m-R.width/2:j+m/2:j+R.width/2,Io(E,L,W,K,D),i&&Ar(E,L,K,D,W.x,W.y,R.width,i)}},getDistance:function(h,e){var g=h.length;return e?3===g?z(dc(h[0]-e[0])+dc(h[1]-e[1])+dc(h[2]-e[2])):2===g?z(dc(h[0]-e[0])+dc(h[1]-e[1])):h.z===Y?z(dc(e.x-h.x)+dc(e.y-h.y)):z(dc(e.x-h.x)+dc(e.y-h.y)+dc(e.z-h.z)):3===g?z(dc(h[0])+dc(h[1])+dc(h[2])):2===g?z(dc(h[0])+dc(h[1])):void 0},brighter:function(N,j){return 0>j&&(j=-j),Cj(N,j?j:40)},darker:function(n,A){return A>0&&(A=-A),Cj(n,A?A:-40)},unionPoint:function(C,L){if(!C)return F;if(2===arguments.length)return C&&L?{x:r(C.x,L.x),y:r(C.y,L.y),width:P(C.x-L.x),height:P(C.y-L.y)}:F;var S=C;if(S._as&&(S=S._as),S.length===Y)return F;var X=S.length;if(0>=X)return F;for(var b=1,E=S[0],z={x:E.x,y:E.y,width:0,height:0};X>b;b++){E=S[b];var _=r(z.x,E.x),q=O(z.x+z.width,E.x),n=r(z.y,E.y),u=O(z.y+z.height,E.y);z.x=_,z.y=n,z.width=q-_,z.height=u-n}return z},unionRect:function(Q,X){if(Q&&!X)return Af(Q);if(!Q&&X)return Af(X);if(Q&&X){var a={x:r(Q.x,X.x),y:r(Q.y,X.y)};return a.width=O(Q.x+Q.width,X.x+X.width)-a.x,a.height=O(Q.y+Q.height,X.y+X.height)-a.y,a}return F},containsPoint:function(v,P,K,R){if(R!=F&&1!==R){var Y=v.x+v.width/2,T=v.y+v.height/2;v={x:Y-v.width/2*R,y:T-v.height/2*R,width:v.width*R,height:v.height*R}}if(K){var C=v.width/2,Z=v.height/2,d=A(-K),x=a(-K),M=P.x-v.x-C,W=P.y-v.y-Z;return P={x:x*M-d*W,y:d*M+x*W},Kk({x:-C,y:-Z,width:v.width,height:v.height},P)}return!(!v||P.x<v.x||P.y<v.y||P.x>v.x+v.width||P.y>v.y+v.height)},containsRect:function(F,d){if(!F||!d)return!1;var R=d.x,Z=d.y,c=d.width,U=d.height,u=F.width,Y=F.height;if(0>(u|Y|c|U))return!1;var V=F.x,E=F.y;if(V>R||E>Z)return!1;if(u+=V,c+=R,R>=c){if(u>=V||c>u)return!1}else if(u>=V&&c>u)return!1;if(Y+=E,U+=Z,Z>=U){if(Y>=E||U>Y)return!1}else if(Y>=E&&U>Y)return!1;return!0},intersectsRect:function(h,y){if(!h||!y)return!1;var S=y.width,I=y.height,u=h.width,k=h.height;if(0>=u||0>=k||0>=S||0>=I)return!1;var L=y.x,C=y.y,c=h.x,d=h.y;return u+=c,k+=d,S+=L,I+=C,u>L&&k>C&&S>c&&I>d},intersection:function(g,u){if(!g||!u)return F;var w=u.x,s=u.y,H=g.x,o=g.y,h=w,W=s,K=H,V=o;return h+=u.width,W+=u.height,K+=g.width,V+=g.height,H>w&&(w=H),o>s&&(s=o),h>K&&(h=K),W>V&&(W=V),h-=w,W-=s,0>=h||0>=W?F:{x:w,y:s,width:h,height:W}},grow:function(p,f,v){v===Y&&(v=f),p.x-=f,p.y-=v,p.width=p.width+2*f,p.height=p.height+2*v},getScreenPoint:function(Y,C,o,T,U,d,l){var g=o.getBoundingClientRect(),m=Y*(d||1)-o.scrollLeft+(T||0),u=C*(l||1)-o.scrollTop+(U||0),S=Qn(o,!1);if(S){var q=new Pf(m,u,0);return q.applyMatrix4(S),console.log(q),{x:q.x,y:q.y}}return{x:m+g.left,y:u+g.top}},getLogicalPoint:function(D,V,g,A,c,N){var i,M,E=V.getBoundingClientRect();D.target?(qh(D)?Qd?Qm["91"]=!0:Qm["17"]=!0:Qd?Qm["91"]=!1:Qm["17"]=!1,Qm["16"]=eq(D)?!0:!1,D=kh(D)?Hp(D):D,i=D.clientX,M=D.clientY):(i=D.x,M=D.y);var H=Qn(V,!0);if(H){var Q=new Pf(i,M,0);Q.applyMatrix4(H);do{if(Math.abs(Q.z)<=1e-6)break;var B=new Pf(i,M,1);if(B.applyMatrix4(matrix),Math.abs(B.z)<=1e-6){Q=B;break}if(B.sub(Q),Math.abs(B.z)<=1e-6)break;Q.addScaledVector(B,-Q.z/B.z)}while(!1);return{x:(Q.x+V.scrollLeft-(g||0))/(c||1),y:(Q.y+V.scrollTop-(A||0))/(N||1)}}return{x:(i-E.left+V.scrollLeft-(g||0))/(c||1),y:(M-E.top+V.scrollTop-(A||0))/(N||1)}},removeHTML:function(){var T;return function(g){return g&&g.getView&&(g=g.getView()),g&&g.parentNode?T===g?!0:(T=g,g.parentNode.removeChild(g),T=F,!0):!1}}(),getToolTipDiv:function(){if(!bn){bn=eo(),ub=eo();var r=bn.style;x.baseZIndex!=F&&(r.zIndex=Ld(x.baseZIndex)+3+""),r.whiteSpace="nowrap",r.color=x.toolTipLabelColor,r.background=x.toolTipBackground,r.font=x.toolTipLabelFont,r.padding="5px",r.boxShadow="0px 0px 3px "+x.toolTipShadowColor}return bn},isToolTipShowing:function(){return bn&&bn.parentNode?!0:ub&&ub.parentNode?!0:!1},updateToolTipContent:function(L,s){if(x.isToolTipShowing()&&(s||(s=Wn&&Wn.view),L===Y&&s&&Wn.e&&(L=s.getToolTip(Wn.e)),L!=F)){var $;
L.html?(L=L.html,$=ub):$=bn,$.innerHTML=L}},hideToolTip:function(){if(x.isToolTipShowing()){yo(bn),yo(ub),_m();var E=Wn&&Wn.view;E&&E.onHideToolTip&&E.onHideToolTip(),Wn=F}},showToolTip:function(Z,m,k){if(!Z||m==F)return Qf(),void 0;x.getToolTipDiv();var a,n;if(m.html?(m=m.html,a=ub,yo(bn)):(a=bn,yo(ub)),n=a.style,a.innerHTML=m,a.parentNode||R.Default.appendToScreen(a),Z.target){Z=Jp(Z);var L=Tq(),r=Z.x,s=Z.y,A=Mc?60:12;if(Mc){var o=a.getBoundingClientRect();n.left=r-o.width/2+Oq,n.top=s-o.height-A<L.top?s+A+Oq:s-o.height-A+Oq}else{n.left=r+A+Oq,n.top=s+A+Oq;var o=a.getBoundingClientRect();o.left+o.width>L.width&&(n.left=r-A-o.width+Oq),o.top+o.height>L.height&&(n.top=s-A-o.height+Oq),o.left<0&&(n.left=r+A+Oq),o.top<0&&(n.top=s+A+Oq)}}else n.left=Z.x+Oq,n.top=Z.y+Oq;_m(),k===Y?k=Wn&&Wn.view:Wn={e:Z,view:k},k&&k.onShowToolTip&&k.onShowToolTip()},startDragging:function(u,X,h){h==Y&&(h=!0),u!==Lh&&(Lh?h&&(kh(X)?Lh.handleWindowTouchEnd(X):Lh.handleWindowMouseUp(X)):kh(X)?(B(t,Ak,Fd),B(t,xq,Up),B(t,"blur",Up)):(B(t,id,ef),B(t,uh,sc),B(t,"blur",sc)),Lh=u)},getImageMap:function(){return gj},toBoundaries:function(P,m,L,r){var B=[];return fq(P,m,L,r).forEach(function(V){var k=[];V.forEach(function(q){k.push(q.x,q.y)}),B.push(k)}),B},getCurrentKeyCodeMap:function(){return Qm},drawCenterImage:function(i,o,H,T,O,h,$,a){!O&&h&&h.isSelfViewEvent&&(O=h);var W=Ro(o,O,h),c=Kb(o,O,h);tp(i,o,m(H-W/2),m(T-c/2),W,c,O,h,$,a)},drawStretchImage:function(c,u,C,U,N,d,l,y,R,e,E,k){!y&&R&&R.isSelfViewEvent&&(y=R);var p,z=Ro(u,y,R,d),j=Kb(u,y,R,l);"uniform"===C?(p=r(d/z,l/j),z*=p,j*=p,U+=m((d-z)/2),N+=m((l-j)/2),d=z,l=j):"centerUniform"===C&&((z>d||j>l)&&(p=r(d/z,l/j),z*=p,j*=p),U+=m((d-z)/2),N+=m((l-j)/2),d=z,l=j);var i=c.interactiveInfo;if(i){var K;if(K="center"===C?{x:U+d/2-z/2,y:N+l/2-j/2,width:z,height:j}:{x:U,y:N,width:d,height:l},i.rect){var x=i.compInfos,g=x.length;g&&(x[g-1].rect.image=u)}else i.rect=K}if("center"===C){var t=E!==!1&&(z>d||j>l);t&&(c.save(),c.beginPath(),c.rect(U,N,d,l),c.clip()),tp(c,u,U+d/2-z/2,N+l/2-j/2,z,j,y,R,e,k),t&&c.restore()}else tp(c,u,U,N,d,l,y,R,e,k)},toCanvas:function(F,l,h,I,a,D,f,B,Z){F=ti(F,f),l=l||Ro(F,a),h=h||Kb(F,a);var C=Vl(),K=Se(C);return B?(Bh(C,l,h,B),K.scale(B,B)):Bh(C,l,h,1),sl(K,F,I,0,0,l,h,a,D,f,Z),F&&F.clampToEdge&&(C.clampToEdge=F.clampToEdge),K.restore(),C},toGrayColor:function(B){if(!B)return B;var H=yh(B),Q=m(.299*H[0]+.587*H[1]+.114*H[2]);return"rgba("+Q+","+Q+","+Q+","+H[3]/255+")"},createGradientImage:function(M,y,H,_){for(var s=["L",0,0,M,0,1,0,0,1,0,0],K=0,i=Math.min(y.length,H.length);i>K;K++)s.push(H[K],y[K]);var U=R.Default.toCanvas({width:M,height:M,clampToEdge:!0,comps:[{type:"shape",rotation:_||0,points:[0,0,M,0,M,M,0,M],background:"#ffffff",gradientPack:s}]});return U},createElement:function(A,W,n,B){var u=M.createElement(A);return Lm(u,W||K.widgetBorder,2),u.style.font=n?n:Pd,B!=F&&(u.value=B),x.onElementCreated&&x.onElementCreated(u),u},containedInView:function(F,P){var s=pq(P).getBoundingClientRect();return Kk({x:s.left,y:s.top,width:s.width,height:s.height},sf(F))},isIsolating:function(){return ci>0},setIsolating:function(g){g?ci++:ci--},getMSMap:function(){return _g},stringify:function(r,D,a){var W=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var I=dl.prototype.toJSON;dl.prototype.toJSON=function(){return"__ht__dataModel"+this.serialize(0)},D=a?0:D==F?2:D;var l=JSON.stringify(r,function(k,g){return"function"==typeof g?"__ht__"+(g.__ht__||g.toString()):bs(g)?yi(g):g instanceof R.List?"__ht__list"+(g.__ht__list||x.stringify(g._as)):g},D);return Date.prototype.toJSON=W,dl.prototype.toJSON=I,a&&(l=Uk+gs(l)),l},parse:function(R,H){return Fn(R)?R.substr(0,12)!=Uk||(R=Bp(R.substr(12)),Fn(R))?(H=H||{},JSON.parse(R,function(N,R){if(Fn(R))if(H.ignoreFunction||"__ht__function"!=R.substr(0,14)){if(!H.ignoreDate&&"__ht__date"==R.substr(0,10))return new Date(Ld(R.substr(10)));if("__ht__list"===R.substr(0,10))return new Hb(x.parse(R.substr(10)));if(!H.ignoreDataModel&&"__ht__dataModel"===R.substr(0,15)){var r=new dl;return r.deserialize(x.parse(R.substr(15))),r}}else{var o=R.indexOf("{")+1,f=R.lastIndexOf("}"),M=R.indexOf("(")+1,v=R.indexOf(")");if(o&&f&&M&&v)try{var d=new Function(R.substring(M,v),R.substring(o,f));return d.__ht__=R.substr(6),d}catch(I){throw console.info("=== SyntaxError ===\n",R),I}}return R})):R:R},loadJS:function(z,F){F&&z.push(F);var e=z.shift();if(Ub(e))z=e.contact(z),x.loadJS(z);else if(nf(e))e(),x.loadJS(z);else if(Fn(e)){var d=M.createElement("script");d.onload=function(){x.loadJS(z)},d.setAttribute("src",e),M.getElementsByTagName("head")[0].appendChild(d)}else z.length&&x.loadJS(z)},extendClass:function(E,$){var w=E.prototype;for(var R in $)_g[R]&&_g.hasOwnProperty(R)?_g[R](w,$):w[R]=$[R]},toRoundedCorner:function(){function W(H,A,c){H.x=A.x,H.y=A.e||c,H.z=A.y}var T=new Pf,l=new Pf,U=new Pf,P=new Pf;return function(J,Q){var r,M=0;J.getPoints&&(M=J.getElevation(),J=J.getPoints()),r=J instanceof Hb?J:new Hb(J);var n=r.size();if(0>=Q)return{points:r};var g=new Hb,C=new Hb,x=r.get(0);W(T,x,M),g.add(x),C.add(1);for(var b=1;n>b;b++)if(n>b+1){var y=r.get(b),k=r.get(b+1);W(l,y,M),W(U,k,M),P.subVectors(T,l).setLength(Math.min(.99*P.length(),Q)).add(l),y.e!==Y||x.e!==Y?g.add({x:P.x,y:P.z,e:P.y}):g.add({x:P.x,y:P.z}),g.add(y),P.subVectors(U,l).setLength(Math.min(.99*P.length(),Q)).add(l),y.e!==Y||k.e!==Y?g.add(x={x:P.x,y:P.z,e:P.y}):g.add(x={x:P.x,y:P.z}),T.copy(P),C.addAll([2,3])}else g.add(r.get(b)),C.add(2);return{points:g,segments:C}}}(),toColorData:yh,setCanvas:Bh,createDiv:eo,createDisabledDiv:hr,createView:jb,createCanvas:Vl,appendChild:kf,initContext:Se,checkLoadingImage:Ql,translateAndScale:zg,layout:Gk,getPosition:Am,drawPoints:Sg,drawRoundRect:Yq,drawBorder:lp,setFocus:Qk,getter:sg,setter:_q,isEmptyObject:un,cameraPriority:function(){var C={skybox:0,main:1e4,top:1e7,infinity:1/0};return S.seal(S.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return C.skybox},set:function(w){if(w>=C.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");C.skybox=Number(w)}},main:{configurable:!1,enumerable:!1,get:function(){return C.main},set:function(r){if(r<=C.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(r>=C.top)throw new RangeError("Main camera must have lower priority than the top camera.");C.main=Number(r)}},top:{configurable:!1,enumerable:!1,get:function(){return C.top},set:function(g){if(g<=C.main)throw new RangeError("Top camera must have higher priority than the main camera.");C.top=Number(g)}}}))}()},!0),je(G,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var ni=x.disabledOpacity,Wl=x.toolTipDelay,Cf=x.devicePixelRatio,mc=x.autoMakeVisible,yr=x.autoHideScrollBar,Ao=x.imageGradient,rg=x.showToolTip,Qf=x.hideToolTip,zh=x.dashPattern,Bi=x.lineCap,Fk=x.lineJoin,Wg=x.labelColor,Je=x.labelSelectColor,Pd=x.labelFont,Wf=x.widgetIndent,ec=x.widgetRowHeight,cg=x.widgetHeaderHeight,$p=x.widgetTitleHeight,Jj=x.scrollBarColor,xr=x.scrollBarSize,Vh=x.scrollBarTimeout,ws=x.scrollBarMinLength,kd=x.scrollBarInteractiveSize,aj=x.zoomIncrement,eg=x.scrollZoomIncrement,cf=x.pinchZoomIncrement,Qr=x.zoomMax,Ur=x.zoomMin,bj=x.createObject,cc=x.preventDefault,We=x.setImage,ti=x.getImage,Md=x.isImageComplete,td=x.drawCenterImage,sl=x.drawStretchImage,dh=x.getId,Di=x.callLater,lj=x.cancelLater,Gc=x.sortFunc,Af=x.clone,nr=x.getClass,Rg=x.startAnim,Aq=x.brighter,Ol=x.darker,ke=x.drawText,gn=x.getTextSize,rf=x.isLeftButton,qn=x.isMiddleButton,Kd=x.isRightButton,Hh=x.getTouchCount,hl=x.isDoubleClick,eq=x.isShiftDown,qh=x.isCtrlDown,sf=x.getClientPoint,Jp=x.getPagePoint,Gd=x.getDistance,To=x.unionPoint,ek=x.unionRect,Kk=x.containsPoint,ho=x.containsRect,pd=x.intersectsRect,pk=x.intersection,Tq=x.getWindowInfo,ge=x.grow,Oj=x.getLogicalPoint,Oc=x.getScreenPoint,om=x.startDragging,yo=x.removeHTML,Ib=x.createElement,wm=x.segmentResolution,qm=x.shapeResolution,Dg=x.shapeSide,tr=x.def,jh=function(d,G,F){tr(q+"."+d,G,F)},cr=function(C,B){C.childNodes.forEach(function(e){B(e),cr(e,B)})};je(x,{toolTipLabelColor:Wg,toolTipLabelFont:Pd,toolTipBackground:K.toolTipBackground,toolTipShadowColor:Ig,debugTipLabelFont:Pd,debugTipLabelColor:Wg,debugTipBackground:K.toolTipBackground,drawBreakableText:Ai,setDevicePixelRatio:function(b){Cf=x.devicePixelRatio="number"==typeof b?b:t.screen?t.screen.deviceXDPI/t.screen.logicalXDPI:1,cr(M.body,function(p){var j=p._ht;j&&j._canvas&&(Bh(j._canvas,j.getWidth(),j.getHeight()),j.redraw?j.redraw():j.iv())})},getPosition3dGap:function(){return Gm()}},!0);var mn=1e-6,xk="undefined"!=typeof Uint16Array?Uint16Array:Array,Oh="undefined"!=typeof Float32Array?Float32Array:Array,Ok=function(r,K,e){var X=[r[0]-K[0],r[1]-K[1],r[2]-K[2]];if(e){var W=Gd(X);W>0&&(X[0]/=W,X[1]/=W,X[2]/=W)}return X},vg=function(){var Z="charCodeAt",m=2*(2*bl.length+1);for(var _ in t)if(_===q+Qi[0]+(Oq.length+2)){var S=t[_];if(!S)break;for(var v=S.length,Q=0;v>Q;Q++)if(S[Q][Z](0)===m&&S[Q+1]!=F&&S[Q+1]===Oq[0]&&S[Q+2]!=F&&S[Q+2][Z](0)===m){for(var B=Q+3;v>B;B++)if(S[B][Z](0)===m){if(0==S[B+1])for(var s,r=B+2;v>r;r++){if(S[r][Z](0)===m){0==S[r-1]&&s&&(to=s.substr(0,s.length-1));break}s==F?s=S[r]:s+=S[r]}break}break}break}return function(G){return[-G[0],-G[1],-G[2]]}}(),Oe=function(P,d){return 3===P.length?P[0]*d[0]+P[1]*d[1]+P[2]*d[2]:P[0]*d[0]+P[1]*d[1]},vc=function(){var Y=new Array(16);return Y[0]=1,Y[1]=0,Y[2]=0,Y[3]=0,Y[4]=0,Y[5]=1,Y[6]=0,Y[7]=0,Y[8]=0,Y[9]=0,Y[10]=1,Y[11]=0,Y[12]=0,Y[13]=0,Y[14]=0,Y[15]=1,Y},yd=vc(),pn=function(i){var w=new Array(16);return w[0]=i[0],w[1]=i[1],w[2]=i[2],w[3]=i[3],w[4]=i[4],w[5]=i[5],w[6]=i[6],w[7]=i[7],w[8]=i[8],w[9]=i[9],w[10]=i[10],w[11]=i[11],w[12]=i[12],w[13]=i[13],w[14]=i[14],w[15]=i[15],w},$d=function(q,L){return q[0]=L[0],q[1]=L[1],q[2]=L[2],q[3]=L[3],q[4]=L[4],q[5]=L[5],q[6]=L[6],q[7]=L[7],q[8]=L[8],q[9]=L[9],q[10]=L[10],q[11]=L[11],q[12]=L[12],q[13]=L[13],q[14]=L[14],q[15]=L[15],q},io=function(B){return B[0]=1,B[1]=0,B[2]=0,B[3]=0,B[4]=0,B[5]=1,B[6]=0,B[7]=0,B[8]=0,B[9]=0,B[10]=1,B[11]=0,B[12]=0,B[13]=0,B[14]=0,B[15]=1,B},Lp=function(M,c){var n=M[0],B=M[1],T=M[2];return M[0]=c[0]*n+c[4]*B+c[8]*T+c[12],M[1]=c[1]*n+c[5]*B+c[9]*T+c[13],M[2]=c[2]*n+c[6]*B+c[10]*T+c[14],M},xc=function(o,p){var s=o[0],$=o[1],g=o[2],S=o[3];return o[0]=p[0]*s+p[4]*$+p[8]*g+p[12]*S,o[1]=p[1]*s+p[5]*$+p[9]*g+p[13]*S,o[2]=p[2]*s+p[6]*$+p[10]*g+p[14]*S,o[3]=p[3]*s+p[7]*$+p[11]*g+p[15]*S,o},fl=function(){var y,J,p,l,i=Ic(Rr[1]+Rr[7]),G=Ic(Rr[0]+Rr[3]-Rr[10]),T=Ic(Rr[8]+2),X=function(){return J=p.charAt(y),y+=1,J},v=function(){var p="";if(J===T)for(;X();){if(J===T)return X(),p;p+=J}else X()},f=function(){for(;J&&" ">=J;)X()},H=function(){var Q,z={};if(J===i){if(X(),f(),J===G)return X(),z;for(;J;){if(Q=v(),f(),X(),z[Q]=l(),f(),J===G)return X(),z;X(),f()}}};return l=function(){switch(f(),J){case i:return H();default:return v()}},function(C){if(W={},C){var X;if(p=C,y=0,J=" ",X=l(),f(),!J)return X}}}(),ms=function(G,P){if(P){var $=A(P),C=a(P),J=G[4],m=G[5],O=G[6],F=G[7],N=G[8],U=G[9],Y=G[10],z=G[11];G[4]=J*C+N*$,G[5]=m*C+U*$,G[6]=O*C+Y*$,G[7]=F*C+z*$,G[8]=N*C-J*$,G[9]=U*C-m*$,G[10]=Y*C-O*$,G[11]=z*C-F*$}},pp=function(u,h){if(h){var b=A(h),H=a(h),r=u[0],W=u[1],X=u[2],U=u[3],K=u[8],e=u[9],z=u[10],y=u[11];u[0]=r*H-K*b,u[1]=W*H-e*b,u[2]=X*H-z*b,u[3]=U*H-y*b,u[8]=r*b+K*H,u[9]=W*b+e*H,u[10]=X*b+z*H,u[11]=U*b+y*H}},ng=function(T,o){if(o){var N=A(o),l=a(o),n=T[0],s=T[1],h=T[2],C=T[3],D=T[4],i=T[5],H=T[6],J=T[7];T[0]=n*l+D*N,T[1]=s*l+i*N,T[2]=h*l+H*N,T[3]=C*l+J*N,T[4]=D*l-n*N,T[5]=i*l-s*N,T[6]=H*l-h*N,T[7]=J*l-C*N}},_j=function(z,V,c){return Be(F,c===!1?F:z.getFinalScale3d(),z.getFinalRotation3d(),z.getRotationMode(),z.p3(),F,V)},Be=function(V,M,I,Z,F,G,x){return G||(G=vc()),F&&gk(G,F),ih(G,I,Z),x&&_i(G,G,x),M&&Ec(G,M),V&&_i(G,G,V),G},hs=function($,D,x){D=Ld(D),x=Ld(x);var T=this;T.g=$,T._84O=D,T._85O=x,T._70I=!0,T.F=0,T._83O=D+x,T.pen={x:0,y:0}},wr="lineDashOffset",qf="setLineDash",ro=function(W){for(var $ in W)1===$.length&&(wr=W[$]);return $?1:0},so=function(O,u,r){return Jf(u)?O:O[qf]?(O[qf](u),r&&(O.lineDashOffset=r),O):new hs(O,u[0],u.length>1?u[1]:u[0])},gq=function(P,G){!Jf(G)&&P[qf]&&(P[qf](uk),P.lineDashOffset=0)};tr(hs,S,{_69I:6,moveTo:function(m,Q){var e=this,r=e.pen;r.x=m,r.y=Q,e.g.moveTo(m,Q),e.start||(e.start={x:m,y:Q})},lineTo:function(r,p){var G=this,q=G.pen,H=r-q.x,d=p-q.y,t=jm(d,H),O=a(t),L=A(t),T=G._23O(q.x,q.y,r,p),z=G._85O,l=G._84O,g=G._83O;if(G.F){if(G.F>T)return G._70I?G._72I(r,p):G.moveTo(r,p),G.F-=T,void 0;if(G._70I?G._72I(q.x+O*G.F,q.y+L*G.F):G.moveTo(q.x+O*G.F,q.y+L*G.F),T-=G.F,G.F=0,G._70I=!G._70I,!T)return}var h=Z(T/g);if(h){for(var J=O*l,f=L*l,E=O*z,X=L*z,D=0;h>D;D++)G._70I?(G._72I(q.x+J,q.y+f),G.moveTo(q.x+E,q.y+X)):(G.moveTo(q.x+E,q.y+X),G._72I(q.x+J,q.y+f));T-=g*h}G._70I?T>l?(G._72I(q.x+O*l,q.y+L*l),G.moveTo(r,p),G.F=z-(T-l),G._70I=!1):(G._72I(r,p),T===l?(G.F=0,G._70I=!G._70I):(G.F=l-T,G.moveTo(r,p))):T>z?(G.moveTo(q.x+O*z,q.y+L*z),G._72I(r,p),G.F=l-(T-z),G._70I=!0):(G.moveTo(r,p),T===z?(G.F=0,G._70I=!G._70I):G.F=z-T)},quadraticCurveTo:function(y,o,c,B){var x,C=this,d=C.pen,$=d.x,v=d.y,u=C._22O($,v,y,o,c,B),T=0,p=0,g=C._85O,r=C._84O;if(C.F){if(C.F>u)return C._70I?C._71I(y,o,c,B):C.moveTo(c,B),C.F-=u,void 0;if(T=C.F/u,x=C._20O($,v,y,o,c,B,T),C._70I?C._71I(x[2],x[3],x[4],x[5]):C.moveTo(x[4],x[5]),C.F=0,C._70I=!C._70I,!u)return}var f=u-u*T,w=Z(f/C._83O),N=r/u,h=g/u;if(w)for(var e=0;w>e;e++)C._70I?(p=T+N,x=C._21O($,v,y,o,c,B,T,p),C._71I(x[2],x[3],x[4],x[5]),T=p,p=T+h,x=C._21O($,v,y,o,c,B,T,p),C.moveTo(x[4],x[5])):(p=T+h,x=C._21O($,v,y,o,c,B,T,p),C.moveTo(x[4],x[5]),T=p,p=T+N,x=C._21O($,v,y,o,c,B,T,p),C._71I(x[2],x[3],x[4],x[5])),T=p;f=u-u*T,C._70I?f>r?(p=T+N,x=C._21O($,v,y,o,c,B,T,p),C._71I(x[2],x[3],x[4],x[5]),C.moveTo(c,B),C.F=g-(f-r),C._70I=!1):(x=C._19O($,v,y,o,c,B,T),C._71I(x[2],x[3],x[4],x[5]),u===r?(C.F=0,C._70I=!C._70I):(C.F=r-f,C.moveTo(c,B))):f>g?(p=T+h,x=C._21O($,v,y,o,c,B,T,p),C.moveTo(x[4],x[5]),x=C._19O($,v,y,o,c,B,p),C._71I(x[2],x[3],x[4],x[5]),C.F=r-(f-g),C._70I=!0):(C.moveTo(c,B),f===g?(C.F=0,C._70I=!C._70I):C.F=g-f)},bezierCurveTo:function(){var n=arguments;this.pen={x:n[4],y:n[5]},this.g.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5])},arc:function(F,T,w,S,u,N){N||(S=-S,u=-u),Td(this,F,T,S,u-S,w,w,!1)},rect:function(a,L,Y,j){var f=this;f.pen={x:a,y:L},f.moveTo(a,L),f.lineTo(a,L+j),f.lineTo(a+Y,L+j),f.lineTo(a+Y,L),f.lineTo(a,L)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(y,I,O,V){var Y=O-y,G=V-I;return z(Y*Y+G*G)},_22O:function(e,G,z,J,h,F,$){for(var C,a,U,S,O,L,d,n=0,H=e,B=G,t=$>0?$:this._69I,K=1;t>=K;K++)U=K/t,S=1-U,O=S*S,L=2*U*S,d=U*U,C=O*e+L*z+d*h,a=O*G+L*J+d*F,n+=this._23O(H,B,C,a),H=C,B=a;return n},_21O:function(c,M,G,N,n,y,$,t){var R=this;if(0===$)return R._20O(c,M,G,N,n,y,t);if(1===t)return R._19O(c,M,G,N,n,y,$);var u=R._20O(c,M,G,N,n,y,t);return u.push($/t),R._19O.apply(R,u)},_20O:function(t,D,d,k,Q,v,N){if(1!==N){var s=d+(Q-d)*N,E=k+(v-k)*N;d=t+(d-t)*N,k=D+(k-D)*N,Q=d+(s-d)*N,v=k+(E-k)*N}return[t,D,d,k,Q,v]},_19O:function(f,Q,C,G,q,s,n){if(1!==n){var w=f+(C-f)*n,d=Q+(G-Q)*n;C+=(q-C)*n,G+=(s-G)*n,f=w+(C-w)*n,Q=d+(G-d)*n}return[f,Q,C,G,q,s]},_72I:function(l,j){var b=this.pen;(l!==b.x||j!==b.y)&&(b.x=l,b.y=j,this.g.lineTo(l,j))},_71I:function(q,z,g,O){var A=this.pen;(q!==g||z!==O||g!==A.x||O!==A.y)&&(A.x=g,A.y=O,this.g.quadraticCurveTo(q,z,g,O))}}),_g.ms_quickVisible=function(G){G._4BQ=!1,G._4CQ=function(e){var w=e._4EQ;return w!==Y?w:w=e._4EQ=this._4FQ(e)},G._4DQ=function(m){if(!m)return this.dm().each(function(Z){Z._4EQ=Y}),void 0;m._4EQ=Y;var l=this;if(m instanceof tm||tf(m)||m instanceof zl||m.ISubGraph)m.eachChild(function(g){l.invalidateQuickVisible(g)});else if(m.getEdges){var _=m.getEdges();_&&_.each(function(e){l.invalidateQuickVisible(e)})}},G.enableQuickVisibleMode=function(){this._4BQ||(this._4BQ=!0,this._4FQ=this.isVisible,this.isVisible=this._4CQ,this.invalidateQuickVisible=this._4DQ)},G.disableQuickVisibleMode=function(){this._4BQ&&(this._4BQ=!1,this.isVisible=this._4FQ,this.invalidateQuickVisible=Ko)},G.isQuickVisibleMode=function(){return this._4BQ},G.invalidateQuickVisible=Ko},jn=me()+1,Yo&&t.console&&jn&&!0&&(t.navigator&&t.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?t.console.log.apply(console,["Hightopo - Version："+R.Default.getVersion()+" - %cTrial：http://hightopo.com/request.html","color: #f00;"]):t.console.log("Hightopo - Version："+R.Default.getVersion()+" - Trial：http://hightopo.com/request.html"));var tg=F,Gf=F,Ri=x.checkLoadingCompType=function(d){tg&&!d._72O_&&(Gf||(Gf={}),Gf[d._72O_=dh()]=d)},Lc=function(C,I){if(I||(I=C),I&&(tg||(tg={}),!tg[C])){var V=new wq;if(tg[I]={request:V,url:I},I=x.beforeLoadURL(I,C),I.data){var u=x.parse(I.data);aq(C,u),x.handleCompTypeLoaded(C,u)}else{V.onload=function(){if(200===this.status||0===this.status){var J=x.parse(V.getResponseText());aq(C,J),x.handleCompTypeLoaded(C,J)}else aq(C,F)},V.onerror=function(){aq(C,F)};var b={};b.url=encodeURI(I),b.sync=!1,V.send(b)}}},aq=function(w,S){if(kr[w]=S,delete tg[w],un(tg)&&(tg=F,Gf)){for(var k in Gf){var x=Gf[k];x.invalidateAll&&x.invalidateAll(Y,"compTypeLoaded",w),x.redraw&&x.redraw(),x.iv(),delete x._72O_}Gf=F}if(S&&Gf)for(var k in Gf){var x=Gf[k];x.invalidateAll&&x.invalidateAll(Y,"compTypeLoading",w),x.redraw&&x.redraw(),x.iv()}},ak=K.chart,Wr="",Yc=!0,Aj=x.compStack=[],zj=/^style@/,Cl=/^attr@/,Ce=/^field@/,ks={x:.5,y:.5},Wp=function(){Yc=!0},Tg=function(){return Yc},Ro=function(g,d,b,y){if(!g)return 0;if(ur(g.fitSize,d,b)&&y)return y;var V=ur(g.width,d,b);return null==V?20:V},Kb=function(V,v,m,M){if(!V)return 0;if(ur(V.fitSize,v,m)&&M)return M;var o=ur(V.height,v,m);return null==o?20:o},ur=function(a,O,e){if(!a||!a.func)return a;var t,T=a.func,_=a.value;return t=nf(T)?e&&e.vectorDataBindingDisabled&&!a.isSafeFunc?_:T(O,e):O instanceof Yk||(R.ui?O instanceof R.ui.View:0)?Cl.test(T)?O.a(Wr+T.slice(5)):zj.test(T)?O.s(Wr+T.slice(6)):Ce.test(T)?O[T.slice(6)]:O[T]?O[T](e):_:_,_!==Y&&t==F?_:t},tp=x.drawImage=function(){var I,j,w,e,N,k,M=3,f=6,S=function(r,s){r.getValue&&r.getValue.compType===s||(r.getValue=function($){var i=y(r,$);if(i===Y&&s.properties){var l=s.properties[$];l&&(i=l.defaultValue)}return i},r.getColor=function(c,h){return h===!0?Z(c):Z(r.getValue(c))},r.getValue.compType=s)},y=function(b,$,d){var Q,E=!1;if(b.prefix&&j instanceof Yk){var V=j.a(Wr+$);V!==Y&&(E=!0,Q=V)}return Q===Y&&(Q=b[$]),Q&&Q.func&&(E=!0,Q=ur(Q,j,w)),d&&(Q=d(Q),E||(b[$]=Q)),Q},Z=function(E,F){var i;return i=F?y(E,F):E,I&&I.compGray&&i?x.toGrayColor(i):N&&i?Fp(i,N,k):i},h=function(O){if(Ub(O)){for(var Q=new Hb,V=O.length,t=0;V>t;t+=2)Q.add({x:O[t],y:O[t+1]});O=Q}return O},C=function(w){var s=y(w,"anchorX"),T=y(w,"anchorY");if(s!==Y||T!==Y)return{x:s===Y?ks.x:s,y:T===Y?ks.y:T};var u=y(w,"type"),J=y(w,"name");if("image"!==u||!J)return ks;var F=ti(J);return F&&F.anchorX!==Y&&F.anchorY!==Y?{x:F.anchorX,y:F.anchorY}:ks},D=function(S,m){var u=y(S,Gj),X=C(S);if(Ub(u)){var I=u.length,B=y(S,"relative"),R=m.width,F=m.height;if(4===I)u={x:u[0],y:u[1],width:u[2],height:u[3]},B&&(u.x*=R,u.y*=F,u.width*=R,u.height*=F);else if(3===I){var M=u[0];u={width:u[1],height:u[2]},B&&(u.width*=R,u.height*=F),"object"==typeof M?M.length&&(M={x:M[0],y:M[1]}):M=Am(M,m,u),u.x=M.x-u.width*X.x,u.y=M.y-u.height*X.y}u.x+=y(S,"offsetX")||0,u.y+=y(S,"offsetY")||0,!B&&m.fitSize&&(u=b(S,u,m))}return u},b=function(T,a,I){if(a){var M,U,X,j={x:a.x,y:a.y,width:a.width,height:a.height},l=C(T),i=y(T,"layoutH"),L=y(T,"layoutV"),B=1,b=1,E=0,h=0,V=1,R=1;switch(i){case"left":break;case"right":j.x+=I.width-I.rw;break;case"center":j.x+=.5*(I.width-I.rw);break;case"scale":case"leftright":default:M=y(T,$o)||0,M&&(E=Math.abs(h=Math.sin(M)),V=Math.abs(R=Math.cos(M))),"leftright"!==i?(B+=V*(I.widthScale-1),b+=E*(I.widthScale-1)):(B+=j.width?V*(I.width-I.rw)/j.width:0,b+=j.height?E*(I.width-I.rw)/j.height:0,U=-Math.min(-l.x*R+l.y*h,-l.x*R-(1-l.y)*h,(1-l.x)*R+l.y*h,(1-l.x)*R-(1-l.y)*h))}switch(L){case"top":break;case"bottom":j.y+=I.height-I.rh;break;case"center":j.y+=.5*(I.height-I.rh);break;case"scale":case"topbottom":default:M==F&&(M=y(T,$o),M&&(E=Math.abs(h=Math.sin(M)),V=Math.abs(R=Math.cos(M)))),"topbottom"!==L?(B+=E*(I.heightScale-1),b+=V*(I.heightScale-1)):(B+=j.width?E*(I.height-I.rh)/j.width:0,b+=j.height?V*(I.height-I.rh)/j.height:0,X=-Math.min(-l.x*h-l.y*R,-l.x*h+(1-l.y)*R,(1-l.x)*h-l.y*R,(1-l.x)*h+(1-l.y)*R))}return(1!==B||1!==b)&&("scale"!==i&&i?"leftright"===i&&(j.x+=j.width*(1-B)*l.x+U*(I.width-I.rw)):j.x+=j.x*(I.widthScale-1)+l.x*j.width*(I.widthScale-B),"scale"!==L&&L?"topbottom"===L&&(j.y+=j.height*(1-b)*l.y+X*(I.height-I.rh)):j.y+=j.y*(I.heightScale-1)+l.y*j.height*(I.heightScale-b),j.width*=B,j.height*=b),j.width<0&&(j.width=0),j.height<0&&(j.height=0),j}},p=function(p){return Ub(p)?new Hb(p):p},B=function(K,C,o,n,M,W,k){var q=I.interactiveInfo,R=K.transform;if(R)return I.save(),I.setTransform(R.a,R.b,R.c,R.d,R.tx,R.ty),q&&q.compInfos.push({comp:K,rect:C,matrix:R.clone(),prefix:Wr,refRect:q.refRect}),!0;M===Y&&(M=1),W===Y&&(W=1);var A=y(K,"clipPercentage"),l=uc(o,C);if(l&&!n&&1===M&&1===W&&A==Y)return q&&q.compInfos.push({comp:K,rect:C,matrix:q.matrix.clone(),prefix:Wr,refRect:q.refRect}),!1;k=k||ks;var z=C.x+C.width*k.x,D=C.y+C.height*k.y,F=o.x+o.width*k.x,j=o.y+o.height*k.y,T=o.width?M*(C.width/o.width):1,h=o.height?W*(C.height/o.height):1;if(I.save(),q&&(q.matrix.appendTranslate(z,D).appendRotate(n).appendScale(T,h).appendTranslate(-F,-j),q.compInfos.push({comp:K,rect:C,matrix:q.matrix.clone(),prefix:Wr,refRect:q.refRect})),Yp(I,z,D),Cq(I,n||0),rc(I,T,h),Yp(I,-F,-j),A!=Y){var E=Mo(o,y(K,"clipDirection"),A);I.beginPath(),I.rect(E.x,E.y,E.width,E.height),I.clip()}return!0},z=function(){I.restore()},g=function(t,i,Y){var S=y(t,"path"),M=y(t,$o),J=y(t,"scaleX"),h=y(t,"scaleY"),x=C(t),E=F,f=zr(null,S);if(Y||(Y=t.unionRect,Y||(Y=To(f),t.path.func||(t.unionRect=Y)),E=Y),Y){E||(E=t.unionRect,E||(E=To(f),t.path.func||(t.unionRect=E)));var U=B(t,Y,E,M,J,h,x),n=y(t,"borderPattern"),G=so(I,n),d=Z(t,"background"),W=Z(t,"borderColor"),K=y(t,"borderWidth"),u=y(t,"gradient"),V=Z(t,"gradientColor"),v=y(t,"border3d"),q=Z(t,"border3dColor"),s=y(t,"border3dAccuracy"),A=I.lineJoin,R=I.lineCap;I.lineJoin=y(t,"borderJoin")||Fk,I.lineCap=y(t,"borderCap")||Bi,d?(zc(I,d,u,V,E),zr(I,S),I.fill(),G!==I&&zr(I,S)):zr(I,S);var T=y(t,"borderWidthAbsolute");if(T&&(I.save(),I.setTransform(1,0,0,1,0,0)),K&&W&&(I.lineWidth=K,I.strokeStyle=W,I.stroke(),v&&ts(I,W,q,K,e,s)),gq(I,n),y(t,"dash")){var H=y(t,"dashWidth")||K;if(H>0){n=y(t,"dashPattern")||zh;var G=so(I,n,y(t,"dashOffset")),g=Z(t,"dashColor")||Z(ob);G!==I&&zr(I,S),I.strokeStyle=g,I.lineWidth=H,I.stroke(),y(t,"dash3d")&&ts(I,g,Z(t,"dash3dColor"),H,e,y(t,"dash3dAccuracy")),gq(I,n)}}T&&I.restore(),i===Gj&&Rj(I,d,y(t,"depth"),E),I.lineJoin=A,I.lineCap=R,U&&z()}},q=function(d,L,Q,A){var n=y(d,Kn,h),M=y(d,$o),U=C(d);if(n&&A.fitSize){var $=new Hb,u=To(n),q=b(d,u,A),W=u.x+U.x*u.width,x=u.y+U.y*u.height,J=q.x+U.x*q.width,t=q.y+U.y*q.height,o=u.width?q.width/u.width:1,c=u.height?q.height/u.height:1;n.each(function(E){$.add({x:J+(E.x-W)*o,y:t+(E.y-x)*c})}),n=$,d.unionRect=null}var H=y(d,"scaleX"),l=y(d,"scaleY"),v=L===ad,i=F;if(!Q&&v&&(Q=d.unionRect,Q||(Q=To(n),d.points.func||(d.unionRect=Q)),i=Q),Q){v?i||(i=d.unionRect,i||(i=To(n),d.points.func||(d.unionRect=i))):i=Q;var P,K,T,E,g=B(d,Q,i,M,H,l,U),m=y(d,"borderPattern"),s=so(I,m),R=Z(d,"background"),V=ti(y(d,"repeatImage"),N,k),X=y(d,"gradientPack"),f=y(d,"borderGradientPack"),a=Z(d,"borderColor"),D=y(d,"borderWidth"),r=ti(y(d,"borderRepeatImage"),N,k),S=y(d,"segments",p),O=y(d,"gradient"),G=Z(d,"gradientColor"),_=y(d,"border3d"),Yo=Z(d,"border3dColor"),Ci=y(d,"border3dAccuracy"),Xc=y(d,"closePath"),sk=y(d,"fillRule")||"nonzero",Oj=I.lineJoin,Ir=I.lineCap;if(I.lineJoin=y(d,"borderJoin")||Fk,I.lineCap=y(d,"borderCap")||Bi,v)if(R||V||X){var Pj=y(d,"fillClipPercentage");if(Pj!=Y){var fn=Mo(i,y(d,"fillClipDirection"),Pj);I.save(),I.beginPath(),I.rect(fn.x,fn.y,fn.width,fn.height),I.clip()}Sg(I,n,S,Xc),X?Mj(I,X,Z,!1,Q):V?Of(I,V,N,k,j,w):zc(I,R,O,G,i),I.fill(sk),X&&I.restore(),Pj!=Y&&I.restore(),s!==I&&Sg(s,n,S,Xc)}else Sg(s,n,S,Xc);else if("roundRect"===L?P=y(d,"cornerRadius"):"polygon"===L?(P=y(d,"polygonSide"),K=y(d,"cornerRadius")):"arc"===L&&(P=y(d,"arcFrom"),K=y(d,"arcTo"),T=y(d,"arcClose"),E=y(d,"arcOval")),R||V||X){var Pj=y(d,"fillClipPercentage");if(Pj!=Y){var fn=Mo(i,y(d,"fillClipDirection"),Pj);I.save(),I.beginPath(),I.rect(fn.x,fn.y,fn.width,fn.height),I.clip()}Vn(I,L,i,P,K,T,E),X?Mj(I,X,Z,!1,Q):V?Of(I,V,N,k,j,w):zc(I,R,O,G,i),I.fill(sk),X&&I.restore(),Pj!=Y&&I.restore(),I!==s&&Vn(s,L,i,P,K,T,E)}else Vn(s,L,i,P,K,T,E);var Jj=y(d,"borderWidthAbsolute");if(Jj&&(I.save(),I.setTransform(1,0,0,1,0,0)),D&&(a||r||f)&&(I.lineWidth=D,f?Mj(I,f,Z,!0,Q):r?tj(I,r,N,k,j,w):I.strokeStyle=a,I.stroke(),f&&I.restore(),_&&ts(I,a,Yo,D,e,Ci)),gq(I,m),y(d,"dash")){var Pr=y(d,"dashWidth")||D;if(Pr>0){m=y(d,"dashPattern")||zh;var s=so(I,m,y(d,"dashOffset")),Tb=Z(d,"dashColor")||Z(ob);s!==I&&(v?Sg(s,n,S,Xc):Vn(s,L,i,P,K,T,E)),I.strokeStyle=Tb,I.lineWidth=Pr,I.stroke(),y(d,"dash3d")&&ts(I,Tb,Z(d,"dash3dColor"),Pr,e,y(d,"dash3dAccuracy")),gq(I,m)}}Jj&&I.restore(),L===Gj&&Rj(I,R,y(d,"depth"),i),I.lineJoin=Oj,I.lineCap=Ir,g&&z()}},U=function(b,o){var a=N||y(b,cb),$=k||y(b,"blendMode"),x=y(b,"name"),L=ti(x,a,$);L&&L.cacheRule!=F&&(L=dn(I,L,y(b,"stretch"),o.width,o.height,j,w,a)),L?sl(I,L,y(b,"stretch"),o.x,o.y,o.width,o.height,j,w,a,null,$):Yc=!1},E=function(L,$){var a=y(L,"text");if(a!=F){var C,n=y(L,"gradientPack"),z=y(L,"gradient"),s=Z(L,"gradientColor"),m=y(L,"font"),G=y(L,"vertical"),t=y(L,"verticalGap"),X=y(L,"align"),v=y(L,"vAlign"),P=y(L,"decoration");if(C=n?Mj(I,n,Z,!1,$):Z(L,cb),!n&&z&&(C=x.createGradient(I,z,C||x.labelColor,s||K.imageGradient,$.x,$.y,$.width,$.height)),G){null==t&&(t=1);var S,i,H=a.length,D=0,Y=(H-1)*t,W=[];I.textBaseline=En,I.font=m;for(var Q=0;H>Q;Q++){var V=I.measureText(a[Q]);W.push(V),Y+=V.fontBoundingBoxDescent,D=O(D,V.width)}i=v&&v!==Pk?v===En?$.y:$.y+$.height-Y:$.y+($.height-Y)/2,S=X&&X!==Qi?X===Me?$.x+$.width-D:$.x+($.width-D)/2:$.x;for(var Q=0;H>Q;Q++){var u=a[Q],V=W[Q];ke(I,u,m,C,S,i,D,V.fontBoundingBoxDescent,Dq,Pk,P),i+=V.fontBoundingBoxDescent+t}}else ke(I,a,m,C,$.x,$.y,$.width,$.height,X,v,P);n&&I.restore()}},Q=function(F,D){lp(I,Z(F,cb),D.x,D.y,D.width,D.height,y(F,"width"))},l=function(Z,b){var g=y(Z,Rm),t=0;if(g&&(g.forEach(function(z){t+=z}),t>0)){for(var H=y(Z,"colors")||ak,d=y(Z,"startAngle")||0,Q=y(Z,"hollow"),L=y(Z,Vq),U=y(Z,gp),T=y(Z,kq),u=L?new Hb:F,z=b.x,R=b.y,G=b.width,f=b.height,J=z+G/2,x=R+f/2,_=r(G,f)/2,N=0,M=0;M<g.length;M++){var K=g[M],P=o*K/t,h=d+P;if(I.fillStyle=H[N++],N===H.length&&(N=0),I.beginPath(),Q){var e=J+a(d)*_/2,X=x+A(d)*_/2,m=J+a(h)*_,W=x+A(h)*_;I.moveTo(e,X),I.arc(J,x,_/2,d,h,!1),I.lineTo(m,W),I.arc(J,x,_,h,d,!0)}else I.moveTo(J,x),I.arc(J,x,_,h,d,!0);u&&(P=(d+h)/2,u.add({text:nf(L)?L(K,M,t,j):K,x:J+.75*a(P)*_,y:x+.75*A(P)*_})),I.closePath(),I.fill(),d=h}u&&u.each(function(S){ke(I,S.text,U,T,S.x,S.y,0,0,Dq)})}},T=function(M,r){var s=y(M,Dd);if(s&&s.length>0){var k=s.length,o=y(M,Vq),$=y(M,gp),h=y(M,kq),l=o?new Hb:F,Q=y(M,"minValue")||0,C=y(M,"maxValue");if(C==F&&(C=0,s.forEach(function(I){y(I,Rm).forEach(function(G){C=O(C,G)})})),Q===C)return;for(var q=r.height/(C-Q),i=r.y+C*q,t=y(s[0],Rm).length,B=r.width/(3*t+1),R=2*B/k,L=0,V=0;k>V;V++)for(var T=s[V],D=y(T,cb),W=y(T,"colors"),P=y(T,Rm),E=0;t>E;E++){W?I.fillStyle=W[E]:D?I.fillStyle=D:(I.fillStyle=ak[L++],L===ak.length&&(L=0));var J=P[E],x=J*q,p=r.x+(1+3*E)*B+V*R;if(ys(I,p,i-x,R,x),l){var _=nf(o)?o(J,E,T,j):J,A=gn($,_).height;l.add({x:p,y:i-x-A,width:R,height:A,text:_})}}l&&l.each(function(s){ke(I,s.text,$,h,s.x,s.y,s.width,s.height,Dq)})}},c=function(L,r){var P=y(L,Dd);if(P&&P.length>0){var Z=P.length,o=y(P[0],Rm).length,n=r.width/(3*o+1),w=0,u=y(L,"maxValue"),x=y(L,Vq),N=y(L,gp),T=y(L,kq),q=x?new Hb:F;if(u==F){u=0;for(var b=0;o>b;b++){for(var V=0,J=0;Z>J;J++)V+=y(P[J],Rm)[b];u=O(u,V)}}if(u>0){for(var b=0;o>b;b++)for(var H=r.y+r.height,J=0;Z>J;J++){var M=P[J],v=y(M,cb),C=y(M,Rm)[b],l=C/u*r.height;v?I.fillStyle=v:(I.fillStyle=ak[w++],w===ak.length&&(w=0)),H-=l;var Q={x:r.x+(1+3*b)*n,y:H,width:2*n,height:l};ys(I,Q.x,Q.y,Q.width,Q.height),q&&(Q.text=nf(x)?x(C,b,M,j):C,q.add(Q))}q&&q.each(function(R){ke(I,R.text,N,T,R.x,R.y,R.width,R.height,Dq)})}}},G=function(c,X){var o=y(c,Dd);if(o&&o.length>0){for(var e=o.length,u=y(o[0],Rm).length,_=X.width/(3*u+1),H=0,q=y(c,Vq),m=y(c,gp),s=y(c,kq),g=q?new Hb:F,V=0;u>V;V++){for(var S=0,K=0;e>K;K++)S+=y(o[K],Rm)[V];if(S>0){var x=X.y+X.height;for(K=0;e>K;K++){var D=o[K],N=y(D,cb),Z=y(D,Rm)[V],l=Z/S*X.height;N?I.fillStyle=N:(I.fillStyle=ak[H++],H===ak.length&&(H=0)),x-=l;var Q={x:X.x+(1+3*V)*_,y:x,width:2*_,height:l};ys(I,Q.x,Q.y,Q.width,Q.height),g&&(Q.text=nf(q)?q(Z,V,D,j):Z,g.add(Q))}}}g&&g.each(function(M){ke(I,M.text,m,s,M.x,M.y,M.width,M.height,Dq)})}},J=function(J,p){var T=y(J,Dd);if(T&&T.length>0){var B=T.length,Z=y(J,"minValue")||0,N=y(J,"maxValue");if(N==F&&(N=0,T.forEach(function(A){y(A,Rm).forEach(function(k){N=O(N,k)})})),Z===N)return;for(var A=p.height/(N-Z),m=p.y+N*A,K=y(T[0],Rm).length,H=p.width/(3*K+1),W=0,i=y(J,"lineWidth")||2,r=y(J,"line3d"),s=y(J,"linePoint"),x=y(J,Vq),C=y(J,gp),v=y(J,kq),w=0;B>w;w++){var l=T[w],d=y(l,cb),Q=y(l,Rm);d?I.strokeStyle=d:(d=I.strokeStyle=ak[W++],W===ak.length&&(W=0)),I.beginPath();for(var h=0;K>h;h++){var g=p.x+(2+3*h)*H,k=m-Q[h]*A;0===h?I.moveTo(g,k):I.lineTo(g,k)}if(I.lineWidth=i,I.stroke(),r&&ts(I,d,F,i,e),s||x){var U,R=i/2+2;for(h=0;K>h;h++){var u=Q[h];if(g=p.x+(2+3*h)*H,k=m-u*A,nf(s)?s(I,g,k,d,h,l,j):s&&(I.fillStyle=d,I.beginPath(),I.arc(g,k,R,0,o,!0),I.fill()),nf(x)?U=x(u,h,l,j):x&&(U=u),U){var $=gn(C,U).height,n=I.shadowBlur;if(n){var t=I.shadowOffsetX,D=I.shadowOffsetY,L=I.shadowColor;I.shadowOffsetX=0,I.shadowOffsetY=0,I.shadowBlur=0,I.shadowColor=F}ke(I,U,C,v,g,k-$-R+2,0,$,Dq),n&&(I.shadowOffsetX=t,I.shadowOffsetY=D,I.shadowBlur=n,I.shadowColor=L)}}}}}},v=function(J){I=J[0],j=J[1],w=J[2],e=J[3],N=J[4],k=J[5]},L=function(){return[I,j,w,e,N,k]},s=function(M,P){var U;w&&w.getDrawableState?U=w.getDrawableState(j):w&&w.getState?U=w.getState(j):(U=j instanceof Yk?j.s(gh):null,(U===Y||null===U)&&(U=y(M,gh)));var e=y(P,gh);return e!==Y&&null!==e&&e!==U?!1:y(P,Fi)},u={border:Q,image:U,text:E,pieChart:l,columnChart:T,stackedColumnChart:c,percentageColumnChart:G,lineChart:J};return function(m,A,K,b,U,P,T,G,d,V){if(A&&U&&P){var O=L();I=m,j=T,w=G,!j&&w&&w.isSelfViewEvent&&(j=w),e=w?w._zoom?w._zoom:1:1,N=d,k=V;var l=U,W=P;if(Zj()){var E,J,c,i,r,n;0===I[Pm]?Zj[0]&&(E=!0):E=!0,I.texureImage2D?Zj[1]&&(J=!0):J=!0,I.texureImage3D?Zj[2]&&(c=!0):c=!0,I.drawDNDState?Zj[3]&&(r=!0):r=!0,R[_l[1]+Re[0]+Lf[1]]?Zj[Re[0]]&&(n=!0):n=!0,ns.widget[0]?Zj[4]&&(i=!0):i=!0,E&&J&&c&&i&&r&&n&&(l=K,W=b)}if(A.tagName)return Fn(to)&&!t[to]||I.drawImage(A,l,W,U,P),v(O),void 0;if(0==y(A,"visible"))return v(O),void 0;N||(N=ur(A.color,j,w)),V||(k=ur(A.blendMode,j,w)),Fn(to)&&!t[to]&&(U=l,P=W);var H=Ro(A,j,w,U),o=Kb(A,j,w,P),$={x:0,y:0,width:H,height:o,fitSize:y(A,"fitSize")},Q=y(A,"clip"),X=y(A,"opacity");if($.fitSize){var a=$.rw=ur(A.width,j,w)||20;$.widthScale=H/a;var _=$.rh=ur(A.height,j,w)||20;$.heightScale=o/_}if(I.save(),I.interactiveInfo){var Cp=I.interactiveInfo.matrix,ji=Cp.clone();Cp.appendTranslate(l,W).appendScale(U/H,P/o),I.interactiveInfo.refRect=$}Yp(I,l,W),(H!==U||o!==P)&&I.scale(U/H,P/o),Q&&(nf(Q)?Q(I,H,o,j,w,A):(I.beginPath(),I.rect(0,0,H,o),I.clip())),X!=F&&(I.globalAlpha*=X),y(A,"comps").forEach(function(b){if(b.prefix){var L=Wr,r=ur(b.prefix,j,w);r&&(Wr=Wr+r+".")}if(0==s(A,b))return b.prefix&&(Wr=L),void 0;if(Aj.splice(0,0,b),I.interactiveInfo)var V=I.interactiveInfo.matrix.clone();var O=y(b,"opacity"),l=y(b,"shadow"),P=y(b,"type"),d=y(b,"refRect")||$,n=D(b,d);
if(O!=F){var _=I.globalAlpha;I.globalAlpha*=O}if(l){var H=e*x.devicePixelRatio,m=I.shadowOffsetX,v=I.shadowOffsetY,Q=I.shadowBlur,c=I.shadowColor,X=y(b,"shadowOffsetX"),T=y(b,"shadowOffsetY"),N=y(b,"shadowBlur"),K=Z(b,"shadowColor");I.shadowOffsetX=(X==F?M:X)*H,I.shadowOffsetY=(T==F?M:T)*H,I.shadowBlur=(N==F?f:N)*H,I.shadowColor=K||Z(Vb)}if("save"===P)I.save();else if("endClip"===P||"restore"===P)I.restore();else if("clip"===P)I.save(),Sg(I,y(b,"points",h),y(b,"segments",p),!0),I.clip();else if(Ej[P])n=n||{x:0,y:0,width:d.width,height:d.height},q(b,P,n,d);else if(P===ad)q(b,P,n,d);else if("SVGPath"===P)g(b,P,n);else{n=n||{x:0,y:0,width:d.width,height:d.height};var t=y(b,$o),E=y(b,"scaleX"),R=y(b,"scaleY"),a=C(b),U=B(b,n,n,t,E,R,a);if(nf(P))S(b,P),x.drawCompType(P,I,n,b,j,w);else if(x.getCompType(P)){var o=x.getCompType(P),G=o.func||o;S(b,o),x.drawCompType(G,I,n,b,j,w)}else u[P]?u[P](b,n):x.getCompType(P)===Y&&Om.test(P)&&(Lc(P),Yc=!1);U&&z()}l&&(I.shadowOffsetX=m,I.shadowOffsetY=v,I.shadowBlur=Q,I.shadowColor=c),O!=F&&(I.globalAlpha=_),I.interactiveInfo&&(I.interactiveInfo.matrix=V),b.prefix&&(Wr=L),Aj.splice(0,1)}),I.interactiveInfo&&(I.interactiveInfo.matrix=ji),I.restore(),v(O)}}}();x.getCurrentComp=function(){return Aj[0]},x.getParentComp=function(){return Aj[1]},x.getInternal=function(){return{isEnter:kj,isEsc:Ei,isSpace:an,isLeft:pm,isUp:ce,isRight:hj,isDown:Hr,addMethod:je,superCall:ag,toPointsArray:fq,translateAndScale:zg,appendArray:eh,createWorldMatrix:Be,vec3TransformMat4:Lp,setCanvas:Bh,createDiv:eo,createView:jb,createCanvas:Vl,createImage:Bj,initContext:Se,layout:Gk,fillRect:ys,Mat:Pn,drawBorder:lp,isString:Fn,setBorder:Lm,getPropertyValue:Jo,setPropertyValue:bo,drawVerticalLine:Kc,draw3DRect:Rj,getPinchDist:xp,isSameRect:uc,getPosition:Am,intersectionLineRect:xo,getNodeRect:Bf,getEdgeAgentPosition:lb,getEdgeHostPosition:wf,getImageWidth:Ro,getImageHeight:Kb,initItemElement:Kf,drawPoints:Sg,createG2:so,closePopup:fi,isH:Ep,createAnim:Pg,createNormalMatrix:Vc,toColorArray:yl,createNormals:Jd,toFloatArray:Ck,glMV:vo,glPop:Ah,batchShape:Fe,createNodeMatrix:_j,getShapeModel:qc,getFaceInfo:we,transformAppend:Xg,drawFaceInfo:Zc,glUploadData:dg,glUploadElementData:lo,glDrawArray:Rf,glDrawElement:Eb,glBindTexture:Tj,pickValueToColor:Gs,to3dPointsArray:Rb,setGLDebugMode:function(Q){gd=Q},cube:function(){return{vs:rn,is:_c,uv:qg}},ui:function(){return{DataUI:ps,NodeUI:mm,EdgeUI:Or,GroupUI:ki,ShapeUI:$c,GridUI:Jn,Data3dUI:Ws,Node3dUI:Xs,Shape3dUI:$s}},getInternalVersion:function(){return"U2FsdGVkX1/KIl5K68iEEU1Np1GUYCNitXKjRaxIYjI="},getDragger:function(){return Lh},addMSMap:function(c){je(_g,c)},k:c,overrideTimerFunc:function(o,Z){Di=R.Default.callLater=o,lj=R.Default.cancelLater=Z},canEnterEditDetailMode:Hk,addEventListener:B,removeEventListener:V}},function(S){function p(H,g){H!=F&&(g==F&&ud!=typeof H?this._54O(H,256):this._54O(H,g))}function V(){return new p(F)}function h(B,A,m,w,u,N){for(;--N>=0;){var q=A*this[B++]+m[w]+u;u=Z(q/67108864),m[w++]=67108863&q}return u}function R(N,W,Z,n,L,H){for(var v=32767&W,c=W>>15;--H>=0;){var w=32767&this[N],A=this[N++]>>15,X=c*w+A*v;w=v*w+((32767&X)<<15)+Z[n]+(1073741823&L),L=(w>>>30)+(X>>>15)+c*A+(L>>>30),Z[n++]=1073741823&w}return L}function y(V,K,u,y,n,d){for(var z=16383&K,h=K>>14;--d>=0;){var E=16383&this[V],$=this[V++]>>14,O=h*E+$*z;E=z*E+((16383&O)<<14)+u[y]+n,n=(E>>28)+(O>>14)+h*$,u[y++]=268435455&E}return n}function b(v){return Cf.charAt(v)}function J(d,w){var k=Ph[d.charCodeAt(w)];return k==F?-1:k}function T(d){for(var e=this.t-1;e>=0;--e)d[e]=this[e];d.t=this.t,d.s=this.s}function j(g){this.t=1,this.s=0>g?-1:0,g>0?this[0]=g:-1>g?this[0]=g+this.DV:this.t=0}function I(e){var n=V();return n._58O(e),n}function l(u,M){var K,Z=this;if(16==M)K=4;else if(8==M)K=3;else if(256==M)K=8;else if(2==M)K=1;else if(32==M)K=5;else{if(4!=M)return Z.fromRadix(u,M),void 0;K=2}Z.t=0,Z.s=0;for(var s=u.length,f=!1,c=0;--s>=0;){var y=8==K?255&u[s]:J(u,s);0>y?"-"==u.charAt(s)&&(f=!0):(f=!1,0==c?Z[Z.t++]=y:c+K>Z.DB?(Z[Z.t-1]|=(y&(1<<Z.DB-c)-1)<<c,Z[Z.t++]=y>>Z.DB-c):Z[Z.t-1]|=y<<c,c+=K,c>=Z.DB&&(c-=Z.DB))}8==K&&0!=(128&u[0])&&(Z.s=-1,c>0&&(Z[Z.t-1]|=(1<<Z.DB-c)-1<<c)),Z._57O(),f&&p.ZERO._78O(Z,Z)}function g(){for(var b=this,A=b.s&b.DM;b.t>0&&b[b.t-1]==A;)--b.t}function u(o){var g=this;if(g.s<0)return"-"+g._85O()[fj](o);var h;if(16==o)h=4;else if(8==o)h=3;else if(2==o)h=1;else if(32==o)h=5;else{if(4!=o)return g.toRadix(o);h=2}var s,V=(1<<h)-1,A=!1,a="",C=g.t,e=g.DB-C*g.DB%h;if(C-->0)for(e<g.DB&&(s=g[C]>>e)>0&&(A=!0,a=b(s));C>=0;)h>e?(s=(g[C]&(1<<e)-1)<<h-e,s|=g[--C]>>(e+=g.DB-h)):(s=g[C]>>(e-=h)&V,0>=e&&(e+=g.DB,--C)),s>0&&(A=!0),A&&(a+=b(s));return A?a:"0"}function $(){var Y=V();return p.ZERO._78O(this,Y),Y}function U(){return this.s<0?this._85O():this}function m(L){var l=this,T=l.s-L.s;if(0!=T)return T;var m=l.t;if(T=m-L.t,0!=T)return l.s<0?-T:T;for(;--m>=0;)if(0!=(T=l[m]-L[m]))return T;return 0}function G(L){var O,E=1;return 0!=(O=L>>>16)&&(L=O,E+=16),0!=(O=L>>8)&&(L=O,E+=8),0!=(O=L>>4)&&(L=O,E+=4),0!=(O=L>>2)&&(L=O,E+=2),0!=(O=L>>1)&&(L=O,E+=1),E}function M(){var V=this;return V.t<=0?0:V.DB*(V.t-1)+G(V[V.t-1]^V.s&V.DM)}function W(O,p){var o;for(o=this.t-1;o>=0;--o)p[o+O]=this[o];for(o=O-1;o>=0;--o)p[o]=0;p.t=this.t+O,p.s=this.s}function H(o,S){for(var q=o;q<this.t;++q)S[q-o]=this[q];S.t=O(this.t-o,0),S.s=this.s}function E(f,b){var G,h=this,w=f%h.DB,l=h.DB-w,A=(1<<l)-1,S=Z(f/h.DB),Y=h.s<<w&h.DM;for(G=h.t-1;G>=0;--G)b[G+S+1]=h[G]>>l|Y,Y=(h[G]&A)<<w;for(G=S-1;G>=0;--G)b[G]=0;b[S]=Y,b.t=h.t+S+1,b.s=h.s,b._57O()}function s(z,H){var P=this;H.s=P.s;var c=Z(z/P.DB);if(c>=P.t)return H.t=0,void 0;var t=z%P.DB,W=P.DB-t,N=(1<<t)-1;H[0]=P[c]>>t;for(var J=c+1;J<P.t;++J)H[J-c-1]|=(P[J]&N)<<W,H[J-c]=P[J]>>t;t>0&&(H[P.t-c-1]|=(P.s&N)<<W),H.t=P.t-c,H._57O()}function f(N,b){for(var k=this,H=0,h=0,i=r(N.t,k.t);i>H;)h+=k[H]-N[H],b[H++]=h&k.DM,h>>=k.DB;if(N.t<k.t){for(h-=N.s;H<k.t;)h+=k[H],b[H++]=h&k.DM,h>>=k.DB;h+=k.s}else{for(h+=k.s;H<N.t;)h-=N[H],b[H++]=h&k.DM,h>>=k.DB;h-=N.s}b.s=0>h?-1:0,-1>h?b[H++]=k.DV+h:h>0&&(b[H++]=h),b.t=H,b._57O()}function k(V,t){var f=this.abs(),U=V.abs(),b=f.t;for(t.t=b+U.t;--b>=0;)t[b]=0;for(b=0;b<U.t;++b)t[b+f.t]=f.am(0,U[b],t,b,0,f.t);t.s=0,t._57O(),this.s!=V.s&&p.ZERO._78O(t,t)}function x(L){for(var X=this.abs(),x=L.t=2*X.t;--x>=0;)L[x]=0;for(x=0;x<X.t-1;++x){var A=X.am(x,X[x],L,2*x,0,1);(L[x+X.t]+=X.am(x+1,2*X[x],L,2*x+1,A,X.t-x-1))>=X.DV&&(L[x+X.t]-=X.DV,L[x+X.t+1]=1)}L.t>0&&(L[L.t-1]+=X.am(x,X[x],L,2*x,0,1)),L.s=0,L._57O()}function X(P,R,M){var B=P.abs(),y=this;if(!(B.t<=0)){var H=y.abs();if(H.t<B.t)return R!=F&&R._58O(0),M!=F&&y._77O(M),void 0;M==F&&(M=V());var f=V(),z=y.s,j=P.s,A=y.DB-G(B[B.t-1]);A>0?(B._44O(A,f),H._44O(A,M)):(B._77O(f),H._77O(M));var N=f.t,C=f[N-1];if(0!=C){var Y=C*(1<<y.F1)+(N>1?f[N-2]>>y.F2:0),_=y.FV/Y,h=(1<<y.F1)/Y,E=1<<y.F2,I=M.t,s=I-N,L=R==F?V():R;for(f._59O(s,L),M._52O(L)>=0&&(M[M.t++]=1,M._78O(L,M)),p.ONE._59O(N,L),L._78O(f,f);f.t<N;)f[f.t++]=0;for(;--s>=0;){var k=M[--I]==C?y.DM:Z(M[I]*_+(M[I-1]+E)*h);if((M[I]+=f.am(0,k,M,s,0,N))<k)for(f._59O(s,L),M._78O(L,M);M[I]<--k;)M._78O(L,M)}R!=F&&(M._45O(N,R),z!=j&&p.ZERO._78O(R,R)),M.t=N,M._57O(),A>0&&M._46O(A,M),0>z&&p.ZERO._78O(M,M)}}}function P(a){var o=V();return this.abs()._49O(a,F,o),this.s<0&&o._52O(p.ZERO)>0&&a._78O(o,o),o}function K(z){this.m=z}function i(J){return J.s<0||J._52O(this.m)>=0?J.mod(this.m):J}function _(k){return k}function D(h){h._49O(this.m,F,h)}function B(T,N,j){T._47O(N,j),this._74O(j)}function t(K,I){K._48O(I),this._74O(I)}function C(){if(this.t<1)return 0;var o=this[0];if(0==(1&o))return 0;var M=3&o;return M=15&M*(2-(15&o)*M),M=255&M*(2-(255&o)*M),M=65535&M*(2-(65535&(65535&o)*M)),M=M*(2-o*M%this.DV)%this.DV,M>0?this.DV-M:-M}function d(f){var d=this;d.m=f,d.mp=f._50O(),d.mpl=32767&d.mp,d.mph=d.mp>>15,d.um=(1<<f.DB-15)-1,d.mt2=2*f.t}function v(m){var j=V();return m.abs()._59O(this.m.t,j),j._49O(this.m,F,j),m.s<0&&j._52O(p.ZERO)>0&&this.m._78O(j,j),j}function e(U){var A=V();return U._77O(A),this._74O(A),A}function n(h){for(var Z=this;h.t<=Z.mt2;)h[h.t++]=0;for(var z=0;z<Z.m.t;++z){var i=32767&h[z],L=i*Z.mpl+((i*Z.mph+(h[z]>>15)*Z.mpl&Z.um)<<15)&h.DM;for(i=z+Z.m.t,h[i]+=Z.m.am(0,L,h,z,0,Z.m.t);h[i]>=h.DV;)h[i]-=h.DV,h[++i]++}h._57O(),h._45O(Z.m.t,h),h._52O(Z.m)>=0&&h._78O(Z.m,h)}function Y(t,M){t._48O(M),this._74O(M)}function Q(w,N,f){w._47O(N,f),this._74O(f)}function Eo(){return 0==(this.t>0?1&this[0]:this.s)}function vr(I,x){if(I>4294967295||1>I)return p.ONE;var r=V(),w=V(),N=x._73O(this),B=G(I)-1;for(N._77O(r);--B>=0;)if(x._76O(r,w),(I&1<<B)>0)x._75O(w,N,r);else{var b=r;r=w,w=b}return x.revert(r)}function Tf(i,P){var G;return G=256>i||P._51O()?new K(P):new d(P),this.exp(i,G)}function Rq(){var j=this;if(j.s<0){if(1==j.t)return j[0]-j.DV;if(0==j.t)return-1}else{if(1==j.t)return j[0];if(0==j.t)return 0}return(j[1]&(1<<32-j.DB)-1)<<j.DB|j[0]}function bo(y,n){return new p(y,n)}function bp(){var U=this;U.n=F,U.e=0,U.d=F,U.p=F,U.q=F,U.dmp1=F,U.dmq1=F,U._10A=F}function Qf(g){return g._53O(this.e,this.n)}function is(d){var v,w,P,U="",W=0;for(v=0;v<d.length&&d.charAt(v)!=jr;++v)P=Oo.indexOf(d.charAt(v)),0>P||(0==W?(U+=b(P>>2),w=3&P,W=1):1==W?(U+=b(w<<2|P>>4),w=15&P,W=2):2==W?(U+=b(w),U+=b(P>>2),w=3&P,W=3):(U+=b(w<<2|P>>4),U+=b(15&P),W=0));return 1==W&&(U+=b(w<<2)),U}function gh(f){var P=f.split(""),A=is(f);return P.forEach(function(D){var z=D.length;z>0&&A&&(Zi+=Ld(D))}),A}function io(M,_){var l=rn._4O.Util._56O(M,"ss"),b={},e=0;return b.v=l==_,b.t=1,b.s=0>e?-1:0,pr=b.v,e>0?b[0]=e:-1>e?b[0]=e+b.DV:b.t=0,[l,b]}function nb(R){var x=38,l=R.substring(0,x);if(l&&30==l.indexOf("05000420")){var f=["ss",R.substring(x)];return f}return[]}function Bd(y,S){S=S.replace(ys,""),S=S.replace(/[ \n]+/g,"");var n=bo(S,16);if(n._55O()>this.n._55O())return 0;var j=this._37O(n),D=j[fj](16).replace(/^1f+00/,""),E=nb(D);if(0==E.length)return!1;for(var c,M,X,U=.5,r=Dg,w=[0,.5,.75,.875,.9375],x=[],e=[],k=[],Z=o/r,I=E[1],p=io(y,I)[0],$=0,N=0;$<w.length;$++){var J=0===$%2?0:.5;for(c=0;r>=c;c++)M=(c+J)*Z,X=1-w[$],x.push(a(M)*U*X,-U+2*w[$]*U,-A(M)*U*X),e.push((c+J)/r,X)}for($=0;$<w.length-1;$++){var F=$*(r+1),s=($+1)*(r+1);for(c=0;r>c;c++)k.push(F+c,s+c+1,s+c,F+c,F+c+1,s+c+1)}return k.forEach(function(s){N+=s}),I==p&&N>10}var Og,cr=0xdeadbeefcafe,Vo=15715070==(16777215&cr),fj="toString",Mi="",to="nat",Rj=function(){};w=S["D"+11182[fj](L(2,5))];var Gn=p.prototype;gl+=xe.substr(0,1);var Ag=S.navigator?S.navigator.appName:"";Vo&&"Microsoft Internet Explorer"==Ag?(Gn.am=R,Og=30):Vo&&"Netscape"!=Ag?(Gn.am=h,Og=26):(Gn.am=y,Og=28),Gn.DB=Og,Gn.DM=(1<<Og)-1,Gn.DV=1<<Og;var wi=52;Gn.FV=L(2,wi),Gn.F1=wi-Og,Gn.F2=2*Og-wi;var Xh,_k,Cf="0123456789abcdefghijklmnopqrstuvwxyz",Ph=[],Qh=function(B){return String.fromCharCode(B)};for(Xh="0".charCodeAt(0),_k=0;9>=_k;++_k)Ph[Xh++]=_k;for(Xh="a".charCodeAt(0),_k=10;36>_k;++_k)Ph[Xh++]=_k;for(Xh="A".charCodeAt(0),_k=10;36>_k;++_k)Ph[Xh++]=_k;var bg=K.prototype;bg._73O=i,bg.revert=_,bg._74O=D,bg._75O=B,bg._76O=t;var Wh=d.prototype;Wh._73O=v,Wh.revert=e,Wh._74O=n,Wh._75O=Q,Wh._76O=Y,Gn._77O=T,Gn._58O=j,Gn._54O=l,Gn._57O=g,Gn._59O=W,Gn._45O=H,Gn._44O=E,Gn._46O=s,Gn._78O=f,Gn._47O=k,Gn._48O=x,Gn._49O=X,Gn._50O=C,Gn._51O=Eo,Gn.exp=vr,Gn.toString=u,Gn._85O=$,Gn.abs=U,Gn._52O=m,Gn._55O=M,Gn.mod=P,Gn._53O=Tf,p.ZERO=I(0),p.ONE=I(1),Gn._86O=Rq;var Wj=function(J,U){var t=this;t.isPublic=!0,typeof J!==ud?(t.n=J,t.e=U):J!=F&&U!=F&&J.length>0&&U.length>0&&(t.n=bo(J,16),t.e=Ld(U,16))};Ji=function(){var P,n,t=gh(Ym),B=t.substr(0,4),g=t.substr(4,2),k=t.substr(6,2),d=1,j=!d,x=c,v=[],f=rk.charAt(7);if(w&&(w[fj]().indexOf(to)<0||w[gl][fj]().indexOf(to)<0||!t?P=F:(t=new w(B-0,g-d,k-0),n=t.setHours(9),w[gl]()>n?P=jq[f]:j=!0)),t&&P&&P[0]&&P[N(.5)]&&x){var H=fl(P[0]),u=fl(P[1]);for(var Q in u)v.push(Q);var M,z=0,l=H[v[z]],A=u[v[z++]],J=u[v[z++]],p=u[v[z++]],X=u[v[z++]],K=u[v[z++]],L=u[v[z++]],$=H[v[z]],O=u[v[z++]],Y=tn._27O(x);if(l===A&&Y&&O){M=A+J+p+X+K+L;var I=!L||L===Rk;if(!I&&L)for(var C,b=0,W=L.length;W>b;b++)L[b]===Ue[z]?C===Rk?I=!0:C[0]===Sb[5]&&Rk&&Rk.indexOf(C.substr(1))>=0?I=!0:C=F:(C==F?C=L[b]:C+=L[b],b===W-1&&(C===Rk?I=!0:C[0]===Sb[5]&&Rk&&Rk.indexOf(C.substr(1))>=0&&(I=!0)));M&&Y._31O(M,O)&&Y._31O(l,$)&&I&&(!K||w[gl]()<K)&&(j=!0)}}return j||(Vn=Jf),f};var km=bp.prototype;km._37O=Qf,km._38O=Wj;var Oo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",jr="=",ah=25,xs=10,Ym="ICESFQ==",zq=zq||function(Q,m){var d={},n=d._7A={},C=n._6A=function(){function v(){}return{_80O:function(S){v.prototype=this;var c=new v;return S&&c._5A(S),c.hasOwnProperty("_82O")||(c._82O=function(){c.$super._82O.apply(this,arguments)}),c._82O.prototype=c,c.$super=this,c},_3A:function(){var B=this._80O();return B._82O.apply(B,arguments),B},_82O:function(){},_5A:function($){for(var Z in $)$.hasOwnProperty(Z)&&(this[Z]=$[Z]);$.hasOwnProperty(fj)&&(this.toString=$.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),f=n._39O=C._80O({_82O:function(W,P){W=this._84O=W||[],this._65O=P!=m?P:4*W.length},toString:function(z){return(z||G).stringify(this)},_89O:function(k){var r=this._84O,F=k._84O,z=this._65O,W=k._65O;if(this._57O(),z%4)for(var H=0;W>H;H++){var f=255&F[H>>>2]>>>24-8*(H%4);r[z+H>>>2]|=f<<24-8*((z+H)%4)}else if(F.length>65535)for(var H=0;W>H;H+=4)r[z+H>>>2]=F[H>>>2];else r.push.apply(r,F);return this._65O+=W,this},_57O:function(){var H=this._84O,j=this._65O;H[j>>>2]&=4294967295<<32-8*(j%4),H.length=N(j/4)},_88O:function(){var t=C._88O.call(this);return t._84O=this._84O.slice(0),t},_87O:function(c){for(var w=[],l=0;c>l;l+=4)w.push(0|4294967296*me);return new f._82O(w,c)}}),s=d._2A={},G=s._69O={stringify:function(V){var P,w=V._84O,J=V._65O,z=[];for(P=0;J>P;P++){var i=255&w[P>>>2]>>>24-8*(P%4);z.push((i>>>4).toString(16)),z.push((15&i).toString(16))}return z.join("")},_68O:function(N){for(var b=N.length,Q=[],$=0;b>$;$+=2)Q[$>>>3]|=Ld(N.substr($,2),16)<<24-4*($%8);return new f._82O(Q,b/2)}},e=s._8A={stringify:function(W){var Y,n=W._84O,J=W._65O,o=[];for(Y=0;J>Y;Y++){var Z=255&n[Y>>>2]>>>24-8*(Y%4);o.push(Qh(Z))}return o.join("")},_68O:function(R){var o,B=R.length,q=[];for(o=0;B>o;o++)q[o>>>2]|=(255&R.charCodeAt(o))<<24-8*(o%4);return new f._82O(q,B)}},j=s._9A={stringify:function(u){try{return decodeURIComponent(escape(e.stringify(u)))}catch(q){throw new Error("")}},_68O:function(F){return e._68O(unescape(encodeURIComponent(F)))}},W=n._32O=C._80O({_1A:function(){this._83O=new f._82O,this._23O=0},_33O:function(B){typeof B==ud&&(B=j._68O(B)),this._83O._89O(B),this._23O+=B._65O},_25O:function(C){var g=this._83O,K=g._84O,T=g._65O,o=this._79O,A=4*o,L=T/A;L=C?N(L):O((0|L)-this._22O,0);var Y=L*o,p=r(4*Y,T);if(Y){for(var M=0;Y>M;M+=o)this._20O(K,M);var t=K.splice(0,Y);g._65O-=p}return new f._82O(t,p)},_88O:function(){var j=C._88O.call(this);return j._83O=this._83O._88O(),j},_22O:0});n._66O=W._80O({cfg:C._80O(),_82O:function(H){this.cfg=this.cfg._80O(H),this._1A()},_1A:function(){W._1A.call(this),this._34O()},_81O:function(g){return this._33O(g),this._25O(),this},_72O:function(k){k&&this._33O(k);var D=this._21O();return D},_79O:16,_26O:function(c){return function(p,t){return new c._82O(t)._72O(p)}},_19O:function(c){return function(u,A){return new x._71O._82O(c,A)._72O(u)}}});var x=d._67O={};return d}();!function(){var q=zq,H=q._7A,W=H._39O,N=H._66O,k=q._67O,o=[],V=[];!function(){function N(D){for(var o=z(D),k=2;o>=k;k++)if(!(D%k))return!1;return!0}function q(f){return 0|4294967296*(f-(0|f))}for(var p=2,g=0;64>g;)N(p)&&(8>g&&(o[g]=q(L(p,.5))),V[g]=q(L(p,1/3)),g++),p++}();var v=[],r=k._41O=N._80O({_34O:function(){this._64O=new W._82O(o.slice(0))},_20O:function(u,h){for(var C=this._64O._84O,$=C[0],s=C[1],f=C[2],S=C[3],Z=C[4],b=C[5],o=C[6],m=C[7],F=0;64>F;F++){if(16>F)v[F]=0|u[h+F];else{var P=v[F-15],L=(P<<25|P>>>7)^(P<<14|P>>>18)^P>>>3,z=v[F-2],I=(z<<15|z>>>17)^(z<<13|z>>>19)^z>>>10;v[F]=L+v[F-7]+I+v[F-16]}var O=Z&b^~Z&o,r=$&s^$&f^s&f,Q=($<<30|$>>>2)^($<<19|$>>>13)^($<<10|$>>>22),p=(Z<<26|Z>>>6)^(Z<<21|Z>>>11)^(Z<<7|Z>>>25),_=m+p+O+V[F]+v[F],e=Q+r;m=o,o=b,b=Z,Z=0|S+_,S=f,f=s,s=$,$=0|_+e}C[0]=0|C[0]+$,C[1]=0|C[1]+s,C[2]=0|C[2]+f,C[3]=0|C[3]+S,C[4]=0|C[4]+Z,C[5]=0|C[5]+b,C[6]=0|C[6]+o,C[7]=0|C[7]+m},_21O:function(){var v=this._83O,N=v._84O,D=8*this._23O,M=8*v._65O;return N[M>>>5]|=128<<24-M%32,N[(M+64>>>9<<4)+14]=Z(D/4294967296),N[(M+64>>>9<<4)+15]=D,v._65O=4*N.length,this._25O(),this._64O},_88O:function(){var n=N._88O.call(this);return n._64O=this._64O._88O(),n}});q._41O=N._26O(r),q._42O=N._19O(r)}();var ys=new RegExp("");ys.compile("[^0-9a-f]","gi"),bp._28O=-1,bp._29O=-2,km._31O=Bd,km._63O=Bd,bp._43O=-2;var Do=new function(){var q=this;q._5O=function(f,z){if("8"!=f.substring(z+2,z+3))return 1;var J=Ld(f.substring(z+3,z+4));return 0==J?-1:J>0&&10>J?J+1:-2},q._13O=function(N,M){var w=q._5O(N,M);return 1>w?"":N.substring(M+2,M+2+2*w)},q._12O=function(w,y){var B=q._13O(w,y);if(""==B)return-1;var A;return A=Ld(B.substring(0,1))<8?new p(B,16):new p(B.substring(2),16),A._86O()},q._6O=function(m,e){var W=q._5O(m,e);return 0>W?W:e+2*(W+1)},q._11O=function(H,Y){var k=q._6O(H,Y),c=q._12O(H,Y);return H.substring(k,k+2*c)},q._10O=function(F,x){var W=q._6O(F,x),v=q._12O(F,x);return W+2*v},q._7O=function(f,A){var k=[],Y=q._6O(f,A);k.push(Y);for(var p=q._12O(f,A),S=Y,Z=0;;){var _=q._10O(f,S);if(_==F||_-Y>=2*p)break;if(Z>=200)break;k.push(_),S=_,Z++}return k}};if(Do._90O=Qh(xs+24),Do._91O=q+Qh(xs*xs+8),rn==F||!rn)var rn={};rn._4O!=F&&rn._4O||(rn._4O={});var Ch=rn._4O;rn._4O.Util=new function(){var k=this;k._56O=function(U){var y=new rn._4O._3O;return y._30O(U)},k._4A=function(a){var d=new rn._4O._3O;return d._36O(a)},k._11A=function(P){var b=new Ch._3O;return b._30O(P)}},rn._4O._3O=function(){var s=this;s._8O=function(G,R){if("ss"==G&&"cj"==R){try{s.md=zq._67O._41O._3A()}catch(m){Rj(Mi)}s._24O=function(h){s.md._81O(h)},s._35O=function(n){var V=zq._2A._69O._68O(n);s.md._81O(V)},s._60O=function(){var E=s.md._72O();return E[fj](zq._2A._69O)},s._30O=function(m){return s._24O(m),s._60O()},s._36O=function(x){return s._35O(x),s._60O()}}},s._24O=function(){Rj(Mi)},s._35O=function(){Rj(Mi)},s._60O=function(){Rj(Mi)},s._30O=function(){Rj(Mi)},s._36O=function(){Rj(Mi)},s._8O("ss","cj")},ls=function(r){var B=Sk[dq[7]],K=1,R=!1;if(Sj.a!=Sk[Kp])return Sj.a;if(Sj.forEach(function(V){K*=V}),r>K){if(B&&B[1]&&B[0]){var y=B[0],W=B[1];W=W.split(Do._90O),y=y.split(Do._90O);var t=W[3],Z=y[3],O=W[7],a=W[11],M=W[15],p=W[19],x=W[23],X=W[27],j=y[7],P=t+O+a+M+p+x,e=x?!1:!0,C=Z===t;if(x){var H=x&&x.split(_q("firefox")[3]);if(H)for(var o=0;o<H.length;o++){var c=H[o];if(c[0]===af[8]&&(c=c.substring(1)),Wo.indexOf(c)>=0){e=!0;break}}}R=C&&ig()(Z,j)&&ig()(P,X)&&e&&(!p||p>r),R&&a.indexOf(Ui.length)>=0&&(ls[Ui.length]=Ui),R&&a.indexOf(Ui.length+1)>=0&&(ls[Ui.length+1]=Ui),R&&a.indexOf(Ui.length+3)>=0&&(ls[Ui.length+3]=Ui),R&&a.indexOf(ri.length)>=0&&(ls[ri.length]=ri)}R||(ps.prototype._42=Zm)}else R=!0,ls[Ui.length]=ls[Ui.length+1]=ls[Ui.length+3]=ls[ri.length]=Ui;return Sj.a=R,R},ah=String.fromCharCode(ah+20);var Td=function(y){return y=y.replace(ys,Mi),y=y.replace(/[ \n]+/g,Mi)},Lh="30",di="06",ef="02",am="03",qi=bo,tp=/^1f+00/,tn=function(){var y;return y={_18O:function(m){var v=m,s=v.replace(/\s+/g,""),x=is(s);return x},_14O:function(B){var N=this._18O(B),y=this._15O(N);return y},_15O:function(t){var y=this._17O(t);if("2a864886f70d010101"==y._61O){var z=this._16O(y.key),k=new bp;return k._38O(z.n,z.e),k}Rj(Mi)},_16O:function(M){var f={};M.substr(0,2)!=Lh&&Rj(Mi);var b=Do._7O(M,0);return 2!=b.length&&Rj(Mi),M.substr(b[0],2)!=ef&&Rj(Mi),f.n=Do._11O(M,b[0]),M.substr(b[1],2)!=ef&&Rj(Mi),f.e=Do._11O(M,b[1]),f},_17O:function(w){var Q={};Q._40O=F;var g=Do._7O(w,0);2!=g.length&&Rj(Mi);var _=g[0];w.substr(_,2)!=Lh&&Rj(Mi);var v=Do._7O(w,_);return 2!=v.length&&Rj(Mi),w.substr(v[0],2)!=di&&Rj(Mi),Q._61O=Do._11O(w,v[0]),w.substr(v[1],2)==di?Q._40O=Do._11O(w,v[1]):w.substr(v[1],2)==Lh&&(Q._40O={},Q._40O.p=Do._70O(w,v[1],[0],ef),Q._40O.q=Do._70O(w,v[1],[1],ef),Q._40O.g=Do._70O(w,v[1],[2],ef)),w.substr(g[1],2)!=am&&Rj(Mi),Q.key=Do._11O(w,g[1]).substr(2),Q}},y._17O?y:F}(),ni=tn._27O=function(Q){return tn._14O(Q)};ig=function(){return function(W,j){if(W&&j){j=Td(j);var z=qi(j,L(2,4)),S=this;if(!S||!S.n||z._55O()>S.n._55O())return 0;var e=S._37O(z),q=e[fj](L(2,4)).replace(tp,""),s=nb(q);if(0==s.length)return!1;var x=s[0],E=s[1],v=function(y){return rn._4O.Util._56O(y,x)},d=v(W);return E==d}}.bind(ni(c))};var Ko,hc;return function(){var Y=mf.length-sm.length;if(Y>0)for(var V=0;Y>V;V++)Ko=Ch.Util,hc=Td}(),ck=function(S,d){d=hc(d);var t=ni(wr),j=Oq.length,R=2*j,n=qi(d,L(j,R)),Z=t,u=!0;if(Z){var W=Z[wo[0]];W&&n._55O()<=W._55O()&&(u=!1)}if(u)return 0;var K=Z._37O(n),m=K[fj](L(j,R)).replace(tp,""),I=nb(m);if(0==I.length)return!1;var G=I[0],B=I[1],a=Ko._11A(S,G);return B==a},tn}(t,S),je(x,{load:function(){var s={},P=function(s){return s?"c_"+(s.sync?"1":"0")+"_"+(s.post?"1":"0")+"_"+(s.responseType||"H")+"_"+(s.mimeType||"H")+"_"+(s.data?JSON.stringify(s.data):"H"):""};return function(i,A,V){var T,K=s[i],m=P(V);return K&&(T=K[m])?(T.push(A),void 0):(s[i]||(K=s[i]={count:0}),T=K[m]=[A],K.count++,x.xhrLoad(i,function(W){delete K[m],K.count--,K.count||delete s[i],T.forEach(function(M){M(W)})},V),void 0)}}(),asyncEach:function(h,a,$){"function"!=typeof $&&($=Function.prototype);var H=new Array(h.length),e=0,U=!1;h.forEach(function(d,B){a(d,function(i,I){return U?void 0:i?(U=!0,$(null)):(H[B]=I,e++,e===h.length?$(H):void 0)})})},xhrLoad:function(V,F,Q){var U=!1;Ub(V)||(U=!0,V=[V]),Q=Q||{};var M=Q.sync,s=null,K=Q.method||"GET";return Q.post&&(K="POST"),Q.method=K,x.asyncEach(V,function(W,i){var X=new wq;W=x.beforeLoadURL(W),W.data?i(null,W.data):(Q.url=encodeURI(W),Q.responseType?X.setResponseType(Q.responseType):X.setOverrideMimeType(Q.mimeType||"text/plain"),X.onload=function(){200===this.status||0===this.status?i(null,X.getResponseText()):i(!0)},X.onerror=function(){i(!0)},X.send(Q))},function(O){var B="function"==typeof F;(B||M)&&(s=U&&O?O[0]:O,B&&F(s))}),M?s:void 0}});var Zq=S.setPrototypeOf||function(f,E){return f.__proto__=E,f},vq=S.getPrototypeOf||function(J){return J.__proto__},cq=S.freeze;S.isFrozen;var il=function(){var o=function(x){return x};return function(u){return u&&u.length?new Function("o",["return o['",u.join("']['"),"'];"].join("")):o}}(),Ul=function(){var d=function(M,m){return M=m};return function(s){return s&&s.length?new Function("o","v",["return o['",s.join("']['"),"'] = v;"].join("")):d}}();!function(){function w(M){var t=[];if(M)for(var A;(A=u.exec(M))!=Y;)t.push(A[1]);return t}function N(n,l){var K=y.exec(l);this._cell=n,this._key=K[1],this._format=K[2],this._style=w(K[3])}function P(r){for(var j=this._cellList=[],n=this._paramList=[],w=r.split(q),p=0,L=w.length;L>p;++p){var c=w[p];if("{{"!==c)for(var k=c.split(f),x=0,v=k.length;v>x;++x){var A=k[x];f.test(A)?(n.push(new N(j.length,A)),j.push(Y)):A.length>0&&j.push(A)}else j.push("{")}this._formatList=this._cellList.slice(0)}var V={},v={},q=/(\{\{)/,f=/(\{\w+(?:\:\w+(?:\&[\w\.])*)?\})/,y=/\{(\w+)(?:\:(\w+)((?:\&[\w\.])*))?\}/,u=/\&([\w\.]*)/g;P.prototype._73O=function(c){for(var y=this._paramList.length;y--;){var O=this._paramList[y],W=c[Ld(O._key)+1],e=v[O._format];e&&(W=e(W,O._style)),this._formatList[O._cell]=W}return this._formatList.join("")},P.prototype._map=function(U){for(var J=this._paramList.length;J--;){var i=this._paramList[J],C=U[i._key],Q=v[i._format];Q&&(C=Q(C,i._style)),this._formatList[i._cell]=C}return this._formatList.join("")};var A=function(v){var H=V[v];return H||(V[v]=H=new P(v)),H._73O(arguments)};return A.map=function(o,z){var L=V[o];return L||(V[o]=L=new P(o)),L._map(z)},A.setValueFormat=function(G,D){v[G]=D},A.gc=function(){V.length=0},A.__parsed=V,A}();var Sc=function(){function a(c,A,E,H){var d=c?c.path.slice(0):[];A&&d.push(A),this.desc=E,this.name=A,this.path=cq(d),this.getter=il(d),this.setter=Ul(d),this.isLeaf=H,this.parent=c,this.children=[],this.childMap={}}return a.create=function(){function E(c,h,L,J){var l=J(L),b=new a(c,h,L,l);if(!l){for(var N=b.children,y=b.childMap,u=S.keys(L),D=0,F=u.length;F>D;++D){var o=u[D],B=E(b,o,L[o],J);N.push(B),y[B.name]=B}b.children=cq(N),b.childMap=cq(y)}return cq(b),b}return function(B,V){return E(Y,Y,B,V)}}(),a.prototype.forEach=function(h,L){for(var T=this.children,X=0,F=T.length;F>X;++X){var D=T[X];h(D,L)}},a}(),cq=S.freeze,Tn={main:{mask:1,priority:x.cameraPriority.main,clearDepth:!1,ignore:!1},top:{mask:2,priority:x.cameraPriority.top,ignore:!1}},ib="main",od=Tn[ib].mask,uj=function(B,d){B=B||0;var o;if(d in Tn)o=Tn[d].mask;else{if(!(32>bk))throw new Error("Only 31 render layer can be defined.");Tn[d]={mask:1<<bk++,priority:Tn[ib].priority},o=Tn[d].mask,Cc=Jg(S.keys(Tn)),bk=Cc.length}return B|=o},cd=function(u){var h=0;if("string"==typeof u)h=uj(h,u);else for(var x=0,N=u.length;N>x;++x)h=uj(h,u[x]);return h},Zb=function(T,A){return T&&A&&T&A},Jg=function(c){return c.sort(function(k,M){return Tn[k].priority-Tn[M].priority})},Cc=Jg(S.keys(Tn)),bk=Cc.length;je(x,{setRenderLayerInfo:function(b,m){if(uj(0,b),m){for(var x in m)Tn[b][x]=m[x];m.priority&&(Cc=Jg(S.keys(Tn)))}},getRenderLayerInfo:function(Z){return Tn[Z]}},!0);var Hb=R.List=function(){this._as=[];var $,y,K=arguments.length;if(1===K){var k=arguments[0];if(ic(k)&&(k=k._as),Ub(k))for(y=k.length,$=0;y>$;$++)this._as.push(k[$]);else k!=F&&this._as.push(k)}else if(K>1)for($=0;K>$;$++)this._as.push(arguments[$])};jh("List",S,{forEach:function(c,g){this.each(c,g)},push:function(){for(var d=0;d<arguments.length;d++)this.add(arguments[d])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(e,S){return S===Y?this._as.push(e):this._as.splice(S,0,e)},addAll:function(Q){ic(Q)&&(Q=Q._as),Ub(Q)?eh(this._as,Q):this._as.push(Q)},get:function(G){return this._as[G]},slice:function(W,E){return new Hb(this._as.slice(W,E))},remove:function(O){var W=this._as.indexOf(O);return W>=0&&W<this._as.length&&this.removeAt(W),W},removeAt:function(z){return this._as.splice(z,1)[0]},set:function(R,D){return this._as[R]=D},clear:function(){return this._as.splice(0,this._as.length)},contains:function(i){return this._as.indexOf(i)>=0},indexOf:function(j){return this._as.indexOf(j)},each:function(K,G){for(var u=0,p=this._as.length;p>u;u++){var i=this._as[u];G?K.call(G,i,u,this):K(i,u,this)}},reverseEach:function(l,p){for(var k=this._as.length-1;k>=0;k--){var H=this._as[k];p?l.call(p,H):l(H)}},getArray:function(){return this._as},toArray:function(G,O){if(G){for(var d,w=[],e=0,F=this._as.length;F>e;e++)d=this._as[e],O?G.call(O,d)&&w.push(d):G(d)&&w.push(d);return w}return this._as.concat()},toList:function(x,d){if(x){for(var B,q=new Hb,I=0,v=this._as.length;v>I;I++)B=this._as[I],d?x.call(d,B)&&q.add(B):x(B)&&q.add(B);return q}return new Hb(this)},reverse:function(){this._as.reverse()},sort:function(Y){return this._as.sort(Y?Y:Gc),this},toString:function(){return this._as.toString()}}),S.defineProperties(Hb.prototype,{length:{get:function(){return this._as.length},set:function(x){this._as.length=x}}});var Df=new Hb;je(Df,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Ko,each:Ko,reverseEach:Ko,toArray:function(){return[]},toList:function(){return new Hb},add:fn,addAll:fn,set:fn,remove:fn,removeAt:fn,clear:fn});var Fr=R.Notifier=function(){this._f=0};jh("Notifier",S,{contains:function(q,r){if(this._ls)for(var B,$=0,O=this._ls.size();O>$;$++)if(B=this._ls.get($),q===B.l&&r===B.s)return!0;return!1},add:function(s,Q,b){var $=this,d={l:s,s:Q,a:b};$._ls||($._ls=new Hb),$._f?($._as||($._as=new Hb),$._as.add(d)):d.a?$._ls.add(d,0):$._ls.add(d)},remove:function(P,t){var $=this;$._ls&&($._f?($._rs||($._rs=new Hb),$._rs.add({l:P,s:t})):$._remove(P,t))},_remove:function(f,k){for(var X,w=this._ls,U=0,M=w.size();M>U;U++)if(X=w.get(U),X.l===f&&X.s===k)return w.removeAt(U),void 0},fire:function(C){var v=this,z=v._ls;if(v._b=1e4,z){++v._f;try{for(var R,i=0,l=z.size();l>i;i++)R=z.get(i),R.s?R.l.call(R.s,C):R.l(C)}catch(C){bg(function(){throw C})}finally{if(--v._f)return;if(v._rs){for(l=v._rs.size(),i=0;l>i;i++)R=v._rs.get(i),v._remove(R.l,R.s);delete v._rs}if(v._as){for(l=v._as.size(),i=0;l>i;i++)R=v._as.get(i),R.a?z.add(R,0):z.add(R);delete v._as}}}}});var Yk=R.Data=function(){this._id=dh()};jh("Data",S,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:F,_parent:F,_children:Df,_childMap:F,_styleMap:F,_layer:"0",_renderLayer:ib,_renderLayerMask:od,_adjustChildrenToTop:!1,getRenderLayerMask:function(){return this._renderLayerMask||od},getRenderLayer:function(){return this._renderLayer||ib},setRenderLayer:function(p){var M=this,L=uj(0,p);M._renderLayerMask=L;var l=M._renderLayer;M._renderLayer=p,M.fp("renderLayer",l,M._renderLayer)},testRenderLayer:function(C){var L=Tn[C];return L&&Zb(this._renderLayerMask,Tn[C].mask)},getUIClass:function(){return F},_22Q:function(){return F},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(s,x){var o=this;if(2===arguments.length)o.setStyle(s,x);else{if(!gr(s))return o.getStyle(s);for(var R in s)o.setStyle(R,s[R])}return o},fp:function(e,j,u,q,T){return this.firePropertyChange(e,j,u,q,T)},firePropertyChange:function(P,i,h,p,M){if(p){if(p(i,h))return!1}else if(i===h)return!1;var f=this,l=M||{};return l.property=P,l.oldValue=i,l.newValue=h,l.data=f,f._dataModel&&f._dataModel.handleDataPropertyChange(l),f.onPropertyChanged(l),!0},onPropertyChanged:function(K){var G=this,h=G._parent,E=K.property;if(tf(h)){var e=G.s(Sn),L="s:ingroup"===E;(e&&wn[E]||E===L)&&h._81I(),(e||L)&&h.fp("childChange",!0,!1)}iq(h)&&(wn[E]||"elevation"===E||Lq[E]||"scaleTall"===E||"tall"===E)&&h.updateFromChildren(),("s:alwaysOnTop"===E||"s:shape3d.alwaysOnTop"===E)&&(K.newValue?this.setRenderLayer("top"):this.setRenderLayer(Y))},_21I:function(m){var y=this;if(m&&y._dataModel)throw"Remove data from dataModel before adding";y._dataModel=m},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var j=0,X=this._children.toArray(),L=X.length;L>j;j++)X[j].removeFromDataModel()},getId:function(){return this._id},setId:function(L){this._id=L},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(i,d){return this._children.toList(i,d)},eachChild:function(_,B){this._children.each(_,B)},addChild:function(I,J){var o=this;I!==o&&(o._children===Df&&(o._children=new Hb,o._childMap={}),J>=0||(J=o._children.size()),o._childMap[I._id]||o.isDescendantOf(I)||(I._parent&&I._parent.removeChild(I),(0>J||J>o._children.size())&&(J=o._children.size()),o._children.add(I,J),o._childMap[I._id]=I,I.setParent(o),o.onChildAdded(I,J),o.fp(ui,F,I)))},onChildAdded:function(){},removeChild:function(m){var A=this;if(A._childMap&&A._childMap[m._id]){var j=A._children.remove(m);delete A._childMap[m._id],A.fp(ui,m,F),m.setParent(F,j),A.onChildRemoved(m,j)}},onChildRemoved:function(){},getChildAt:function(Z){return this._children.get(Z)},clearChildren:function(){var o=this;if(!o._children.isEmpty())for(var d=0,O=o._children.toArray(),B=O.length;B>d;d++)o.removeChild(O[d])},getParent:function(){return this._parent},setParent:function(p,i){var B=this;if(!(B._73I||B._parent===p||B===p||p&&p.isDescendantOf(B))){var A,U=B._parent;B._parent=p,B._73I=1,U?(i==F&&(i=U.getChildren().indexOf(B)),U.removeChild(B)):B._dataModel&&i==F&&(i=B._dataModel.getRoots().indexOf(B)),p&&(p.addChild(B),A=p.getChildren().indexOf(B)),delete B._73I,B.fp("parent",U,p,Y,{oldIndex:i,newIndex:A}),B.onParentChanged(U,p)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(l){return l?this.isDescendantOf(l)||l.isDescendantOf(this):!1
},isParentOf:function(R){return R&&this._childMap?!!this._childMap[R._id]:!1},isDescendantOf:function(Z){if(!Z||Z.isEmpty())return!1;for(var L=this._parent;L;){if(Z===L)return!0;L=L._parent}return!1},getStyle:function(J,E){E===Y&&(E=1);var D=this._styleMap?this._styleMap[J]:Y;return D===Y&&E?Q[J]:D},setStyle:function(K,B){var u=this;u._styleMap||(u._styleMap={});var i=u._styleMap[K];B===Y?delete u._styleMap[K]:u._styleMap[K]=B,u.fp("s:"+K,i,B)&&u.onStyleChanged(K,i,B)},onStyleChanged:function(){},iv:function(u){this.invalidate(u)},invalidate:function(h){this.fp(h||"*",!1,!0)},toString:function(){var e=this;return e._displayName||e._name||e._tag||e._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(m,S){var U=this,T=U.s(Th);U.beginTransaction(),T||U.s(Th,T={}),S?T[m]=S:delete T[m],U.fp(Th,F,T),U.endTransaction()},removeStyleIcon:function($){var s=this.s(Th);if(s){var j=s[$];delete s[$],this.fp(Th,F,s)}return j},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(q){var M=this;if(M.hasOwnProperty("_anchor")||M.hasOwnProperty("_anchorElevation")){var m=M.getAnchor3d(),b={x:m.x-.5,y:m.y-.5,z:m.z-.5};gk(q,[-b.x,-b.y,-b.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,renderLayer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var M,w={};for(M in this._styleMap)w[M]=1;return w},getCurrentPrefix:function(){return this._interactPrefix||Wr},ca:function(D,F){var E=this.getCurrentPrefix();return D=E+D,2===arguments.length?this.a(D,F):this.a(D)}});var dl=R.DataModel=function(){var g=this;g._isDeserializing=0,g._datas=new Hb,g._dataMap={},g._roots=new Hb,g._rootMap={},g._fsDataMap={},g._78O={},g._reflectorMap={},g._36I=new Fr,g._35I=new Fr,g._serializeNotifier=new Fr,g._selectionModel=new Rh(g);var s=g._29Q=[],D=g._scheduleCallback=function(){for(var N=Date.now(),e=0;e<s.length;e++){var o=s[e];o.enabled&&N-o.lastTime>o.interval&&(o.beforeAction&&o.beforeAction(),o.action&&g.each(function(K){o.action(K)}),o.afterAction&&o.afterAction(),o.lastTime=N)}s.length&&(g._30Q=t.requestAnimationFrame(D))}};jh("DataModel",S,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmapType","envmap","postProcessingData","init"],_name:Y,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:Y,_init:Y,_envmap:Y,_envmapType:Y,_postProcessingData:Y,sm:function(){return this.getSelectionModel()},mm:function(f,R,Y){this.addDataModelChangeListener(f,R,Y)},umm:function(d,p){this.removeDataModelChangeListener(d,p)},md:function(g,E,m){this.addDataPropertyChangeListener(g,E,m)},umd:function(f,A){this.removeDataPropertyChangeListener(f,A)},mh:function(u,E,q){this.addHierarchyChangeListener(u,E,q)},umh:function(H,X){this.removeHierarchyChangeListener(H,X)},getAttrObject:function(){return this._attrObject},setAttrObject:function(R){return this._attrObject=R},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(l){return this._dataMap[l]},removeDataById:function(m){this.remove(this.getDataById(m))},toDatas:function(l,U){return this._datas.toList(l,U)},each:function(_,U){this._datas.each(_,U)},getDataByTag:function(j){return this._78O[j]},getTagMap:function(){return this._78O},removeDataByTag:function(v){this.remove(this.getDataByTag(v))},add:function(H,W,G){var N=this,D=H._id,n=H._tag,k=N._roots;if(N._dataMap[D])throw"'"+D+"' already exists";n!=F&&(N._78O[n]=H),N._dataMap[D]=H,G>=0?N._datas.add(H,G):N._datas.add(H),H._parent||(N._rootMap[D]=H,W>=0?k.add(H,W):k.add(H)),H.s("fullscreen")!==Y&&(N._fsDataMap[D]=H),H.s("shape3d.reflector")&&(N._reflectorMap[D]=H),H._21I(N),N.onAdded(H),N._36I.fire({kind:"add",data:H,rootsIndex:W,datasIndex:G})},onAdded:function(){},remove:function(l,q){if(l){var t=this,m=l._id,S=q&&q.keepStructure,i=q&&q.keepChildren,R=l.getTag();if(l._dataModel===t){var $=l instanceof tm;$&&x.setIsolating(!0),this.beginTransaction(),S?t._removingData||(t._removingData=l):t.prepareRemove(l),i||l.toChildren().each(function(c){t.remove(c,q)},t),S?t._removingData===l&&(l._parent&&l._parent.removeChild(l),delete t._removingData):l._parent&&l._parent.removeChild(l);var I=t._datas.remove(l);delete t._dataMap[m],R!=F&&delete t._78O[R];var r;t._rootMap[m]&&(delete t._rootMap[m],r=t._roots.remove(l)),t._fsDataMap[m]&&delete t._fsDataMap[m],t._reflectorMap[m]&&delete t._reflectorMap[m],l._21I(F),t.onRemoved(l),t._36I.fire({kind:Pq,data:l,rootsIndex:r,datasIndex:I}),this.endTransaction(),$&&x.setIsolating(!1)}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var s=this;if(s._datas.size()){var f=s._historyManager?this.toJSON():Y;s._datas.toArray().forEach(function(t){t._21I(F)}),s._datas.clear(),s._dataMap={},s._roots.clear(),s._rootMap={},s._fsDataMap={},s._reflectorMap={},s._78O={},s._36I.fire({kind:Wk,json:f})}},contains:function(z){return z&&z._dataModel===this},handleDataPropertyChange:function(r){var h=this,O=r.data,f=r.property;if("parent"===f){var V=O._id,M=h._rootMap,J=h._roots;O._parent?M[V]&&(delete M[V],J.remove(O)):M[V]||(M[V]=O,J.add(O))}else if("tag"===f){var T=r.oldValue,g=r.newValue,W=h._78O;T!=F&&delete W[T],g!=F&&(W[g]=O)}else if("s:fullscreen"===f){var V=O._id,$=h._fsDataMap;r.oldValue!=F&&delete $[V],r.newValue!=F&&($[V]=O)}else if("s:shape3d.reflector"===f){var V=O._id,q=h._reflectorMap;r.oldValue&&delete q[V],r.newValue&&(q[V]=O)}this.onDataPropertyChanged(O,r),this._35I.fire(r)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(b,d,e){this._36I.add(b,d,e)},removeDataModelChangeListener:function(d,i){this._36I.remove(d,i)},addSerializeListener:function(h,i,F){this._serializeNotifier.add(h,i,F)},removeSerializeListener:function(h,y){this._serializeNotifier.remove(h,y)},fireSerializeEvent:function(E){this._serializeNotifier.fire(E)},addDataPropertyChangeListener:function(h,c,G){this._35I.add(h,c,G)},removeDataPropertyChangeListener:function(S,Q){this._35I.remove(S,Q)},_38I:function(m,B,Q){this._37I&&this._37I.fire({data:m,oldIndex:B,newIndex:Q})},addHierarchyChangeListener:function(F,N,f){this._37I||(this._37I=new Fr),this._37I.add(F,N,f)},removeHierarchyChangeListener:function(Q,d){this._37I.remove(Q,d)},getSiblings:function(d){var H=d._parent;return H?H._children:this._roots},eachByHierarchical:function(c,v,j){if(v)return this._eachByHierarchical(c,v,j);for(var b=0,p=this._roots,l=p.size();l>b;b++)if(this._eachByHierarchical(c,p.get(b),j)===!1)return!1;return!0},_eachByHierarchical:function(Z,s,w){if(w){if(Z.call(w,s)===!1)return!1}else if(Z(s)===!1)return!1;for(var Y=s.size(),x=0;Y>x;x++)if(this._eachByHierarchical(Z,s.getChildAt(x),w)===!1)return!1;return!0},reverseEachByHierarchical:function(w,q,e){if(q)return this._reverseEachByHierarchical(w,q,e);for(var $=this._roots,B=$.size(),_=B-1;_>=0;_--)if(this._reverseEachByHierarchical(w,$.get(_),e)===!1)return!1;return!0},_reverseEachByHierarchical:function($,o,Q){for(var i=o.size(),k=i-1;k>=0;k--)if(this._reverseEachByHierarchical($,o.getChildAt(k),Q)===!1)return!1;if(Q){if($.call(Q,o)===!1)return!1}else if($(o)===!1)return!1;return!0},eachByDepthFirst:function(e,M,h){if(M)return this._11I(e,M,h);for(var K=0,E=this._roots,W=E.size();W>K;K++)if(this._11I(e,E.get(K),h)===!1)return!1;return!0},_11I:function(L,R,Y){for(var V=R.size(),d=0;V>d;d++)if(this._11I(L,R.getChildAt(d),Y)===!1)return!1;if(Y){if(L.call(Y,R)===!1)return!1}else if(L(R)===!1)return!1;return!0},eachByBreadthFirst:function(i,o,u){var U=new Hb;for(o?U.add(o):this._roots.each(U.add,U);U.size()>0;)if(o=U.removeAt(0),o.eachChild(U.add,U),u){if(i.call(u,o)===!1)return!1}else if(i(o)===!1)return!1;return!0},moveTo:function(y,n){var U=this.getSiblings(y),E=U.indexOf(y);E===n||0>E||n>=0&&n<=U.size()&&(U.remove(y),n>U.size()&&n--,U.add(y,n),this._38I(y,E,n))},moveUp:function(i){this.moveTo(i,this.getSiblings(i).indexOf(i)-1)},moveDown:function(j){this.moveTo(j,this.getSiblings(j).indexOf(j)+1)},moveToTop:function(k){this.moveTo(k,0)},moveToBottom:function(n){this.moveTo(n,this.getSiblings(n).size())},moveSelectionUp:function(N){this.beginTransaction(),N||(N=this.sm());var J=new Hb;yg(N,J,this._roots),J.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(Z){this.beginTransaction(),Z||(Z=this.sm());var M=new Hb;hq(Z,M,this._roots),M.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(v){this.beginTransaction(),v||(v=this.sm());var D=new Hb;Bo(v,D,this._roots),D.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(b){this.beginTransaction(),b||(b=this.sm());var f=new Hb;gc(b,f,this._roots),f.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(N,T,c){var n=this.getDatas();null==c&&(c=n.indexOf(N)),c===T||0>c||T>=0&&T<=n.size()&&(n.remove(N),T>n.size()&&T--,n.add(N,T),this._76I(N,c,T))},bringForward:function(v){this.moveToIndex(v,this.getDatas().indexOf(v)+1)},bringToFront:function(L){this.moveToIndex(L,this.size())},sendBackward:function(B){this.moveToIndex(B,this.getDatas().indexOf(B)-1)},sendToBack:function(M){this.moveToIndex(M,0)},bringSelectionForward:function(Z){this.beginTransaction(),Z||(Z=this.sm());for(var F=new Hb,p=this.getDatas(),W=!1,r=0;r<p.size();r++){var e=p.get(p.size()-1-r);Z.contains(e)?W&&F.add(e):W=!0}F.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(S){this.beginTransaction(),S||(S=this.sm());for(var p=new Hb,Q=this.getDatas(),j=0;j<Q.size();j++){var x=Q.get(j);S.contains(x)&&p.add(x)}p.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(R){this.beginTransaction(),R||(R=this.sm());for(var j=new Hb,X=this.getDatas(),g=!1,C=0;C<X.size();C++){var P=X.get(C);R.contains(P)?g&&j.add(P):g=!0}j.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(v){this.beginTransaction(),v||(v=this.sm());for(var P=new Hb,y=this.getDatas(),D=0;D<y.size();D++){var S=y.get(y.size()-1-D);v.contains(S)&&P.add(S)}P.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(k){var P=this;P.removeScheduleTask(k),k.enabled==F&&(k.enabled=!0),k.interval==F&&(k.interval=10),k.lastTime=Date.now(),P._29Q.push(k),P._30Q==F&&(P._30Q=t.requestAnimationFrame(P._scheduleCallback))},removeScheduleTask:function(c){var o=this,n=o._29Q,J=n.indexOf(c);J>=0&&n.splice(J,1),n.length||o._30Q==F||(t.cancelAnimationFrame(o._30Q),delete o._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(H){this._historyManager||new R.HistoryManager(this),null!=H&&this._historyManager.setMaxHistoryCount(H),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(R){this._historyManager&&this._historyManager.undo(R)},redo:function(j){this._historyManager&&this._historyManager.redo(j)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(S){this._historyManager&&this._historyManager.addHistory(S)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function(e){e?this._isDeserializing++:this._isDeserializing--},updateLayoutAttach:function(h){this.each(function(W){W instanceof vl&&W.getImage()===h&&W.updateLayoutAttaches()})},isCubicEnvmap:function(){return!1},setCubicEnvmap:function(){}});var Rh=R.SelectionModel=function(c){var E=this;E._68O=Xp,E._map={},E._73O=new Hb,E._74I=new Fr,E._21I(c)};jh("SelectionModel",S,{ms_fire:1,ms_dm:1,ms:function(G,L,x){this.addSelectionChangeListener(G,L,x)},ums:function(k,h){this.removeSelectionChangeListener(k,h)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===Xf},co:function(g){return this._map[g._id]!=F},ss:function(k){this.setSelection(k)},as:function(B){this.appendSelection(B)},rs:function(o){this.removeSelection(o)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(f){var D=this;if(D._68O!==f&&(f===wo||f===Xf||f===Xp)){D.cs();var L=D._68O;D._68O=f,D.fp("selectionMode",L,f)}},_21I:function(P){var i=this,x=i._dataModel;x!==P&&(x&&(i.cs(),x.umm(i.handleDataModelChange,i)),i._dataModel=P,P.mm(i.handleDataModelChange,i,!0),i.fp(Br,x,P))},dispose:function(){var f=this;f.cs(),f._dataModel.umm(f.handleDataModelChange,f)},handleDataModelChange:function(M){var D=this;if(M.kind===Pq){var I=M.data;D.co(I)&&(D._73O.remove(I),delete D._map[I._id],D._75I(Pq,new Hb(I)))}else M.kind===Wk&&D.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(f){var h=this;if(h._filterFunc!==f){h.cs();var i=h._filterFunc;h._filterFunc=f,h.fp("filterFunc",i,h._filterFunc)}},_75I:function(h,t,X,M){X&&(this._73O.each(function(Z){M[Z._id]?X.remove(Z):X.add(Z)}),t=X.toList()),this._74I.fire({kind:h,datas:new Hb(t)})},addSelectionChangeListener:function(e,v,h){this._74I.add(e,v,h)},removeSelectionChangeListener:function(n,G){this._74I.remove(n,G)},_97O:function(C,V){for(var h,W=this,z=0,G=new Hb(C);z<G.size();z++)h=G.get(z),(W._filterFunc&&!W._filterFunc(h)||V&&W.co(h)||!V&&!W.co(h)||!W._dataModel.contains(h))&&(G.removeAt(z),z--);return G},appendSelection:function(A){var u=this;if(u._68O!==wo){var i,s,g=u._73O,X=u._97O(A,!0);X.isEmpty()||(u.sg()&&(i=new Hb(g),s=u._map,g.clear(),u._map={},X=new Hb(X.get(X.size()-1))),X.each(function(A){g.add(A),u._map[A._id]=A}),u._75I("append",X,i,s))}},removeSelection:function(x){var h=this,D=h._97O(x),V=0,X=D.size();if(0!==X){for(;X>V;V++){var P=D.get(V);h._73O.remove(P),delete h._map[P._id]}h._75I(Pq,D)}},toSelection:function(X,Y){return this._73O.toList(X,Y)},getSelection:function(){return this._73O},each:function(Z,R){this._73O.each(Z,R)},setSelection:function(Q){var W=this,V=W._73O;if(W._68O!==wo&&!(V.isEmpty()&&!Q||1===V.size()&&W.ld()===Q)){var e=new Hb(V),O=W._map;V.clear(),W._map={};var b=W._97O(Q,!0);W.sg()&&b.size()>1&&(b=new Hb(b.get(b.size()-1))),b.each(function(w){V.add(w),W._map[w._id]=w}),W._75I("set",F,e,O)}},clearSelection:function(){var m=this,p=m._73O;if(p.size()>0){var D=p.toList();p.clear(),m._map={},m._75I(Wk,D)}},selectAll:function(){var H=this;if(H._68O!==wo){var L,I,n=H._dataModel.toDatas();if(H._filterFunc)for(L=0;L<n.size();L++)I=n.get(L),H._filterFunc(I)||(n.removeAt(L),L--);var u=H._73O,o=new Hb(u),e=H._map;u.clear(),H._map={},H.sg()&&n.size()>1&&(n=new Hb(n.get(n.size()-1)));var J=n.size();for(L=0;J>L;L++)I=n.get(L),u.add(I),H._map[I._id]=I;H._75I("all",F,o,e)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function($){return this._map[$._id]!=F},getLastData:function(){var r=this._73O;return r.size()>0?r.get(r.size()-1):F},getFirstData:function(){var z=this._73O;return z.size()>0?z.get(0):F},isSelectable:function(f){var N=this;return f&&N._68O!==wo?N._filterFunc?N._filterFunc(f):!0:!1},getTopSelection:function(){var H=this,T=new Hb;return H._73O.each(function(C){for(var $=C.getParent();$;){if(H.contains($)){C=F;break}$=$.parent}C&&T.add(C)}),T}});var Bf=function(){return db(0),function(Z,p){var l;if(Xr(p)){var y=Z.getDataUI(p);y&&y._88I&&(l=y._88I.rect)}return l?l:p.getRect()}}();je(x,{edgeGroupAgentFunc:F,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:K.rectSelectBorder,graphViewRectSelectBackground:tq,graphViewEditPointSize:Mc?17:7,graphViewEditPointBorderColor:K.editPointBorder,graphViewEditPointBackground:K.editPointBackground,setEdgeType:function(T,X,K){Hc[T]=X,Pp[T]=K},getEdgeType:function(r){return Hc[r]},getEdgeTypeMap:function(){return Hc},getNodeRect:Bf},!0);var zi={"layout.h":Y,"layout.v":Y,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":Y,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:Y,ingroup:!0,"body.color":Y,"2d.gray":!1,fullscreen:Y,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:Y,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"vector.layoutable":!1,"clip.direction":"top","clip.percentage":Y,"select.color":Vb,"select.width":1,"select.padding":2,"select.type":Gj,"shadow.interactable":!0,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,shadow2:!1,"shadow2.color":Vb,"shadow2.blur":6,"shadow2.offset.x":3,"shadow2.offset.y":3,"border.color":Y,"border.width":2,"border.padding":2,"border.type":Gj,label:Y,"label.font":Y,"label.color":Wg,"label.background":Y,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":Y,"label.max":Y,"label.opacity":Y,"label.scale":1,"label.align":Y,"label.selectable":!0,"label.decoration":Y,label2:Y,"label2.font":Y,"label2.color":Wg,"label2.background":Y,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":Y,"label2.max":Y,"label2.opacity":Y,"label2.scale":1,"label2.align":Y,"label2.selectable":!0,"label2.decoration":Y,note:Y,"note.expanded":!0,"note.font":Y,"note.color":Je,"note.background":Vb,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":Y,"note.toggleable":!0,"note.border.width":1,"note.border.color":Y,"note.opacity":Y,"note.scale":1,"note.align":Y,note2:Y,"note2.expanded":!0,"note2.font":Y,"note2.color":Je,"note2.background":Vb,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":Y,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":Y,"note2.opacity":Y,"note2.scale":1,"note2.align":Y,"group.type":Y,"group.image":Y,"group.image.stretch":"fill","group.repeat.image":Y,"group.border.repeat.image":Y,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":Y,"group.title.color":Je,"group.title.background":K.groupTitleBackground,"group.title.align":Qi,"group.title.orientation":En,"group.background":K.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":Y,"group.border.color":xg,"group.border.radius":Y,"group.border.cap":Bi,"group.border.join":Fk,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":F,"group.gradient.color":"#FFF",shape:Y,"shape.background":xg,"shape.repeat.image":Y,"shape.border.repeat.image":Y,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":xg,"shape.border.3d":!1,"shape.border.3d.color":Y,"shape.border.3d.accuracy":Y,"shape.border.cap":Bi,"shape.border.join":Fk,"shape.border.pattern":Y,"shape.gradient":F,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":zh,"shape.dash.offset":0,"shape.dash.color":ob,"shape.dash.width":Y,"shape.dash.3d":!1,"shape.dash.3d.color":Y,"shape.dash.3d.accuracy":Y,"shape.polygon.side":6,"shape.arc.from":d,"shape.arc.to":o,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":Y,"shape.gradient.pack":Y,"shape.border.gradient.pack":Y,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":Y,"shape.foreground":Y,"shape.foreground.gradient":F,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":Y,"autolayout.gap":Y,"autolayout.hgap":Y,"autolayout.vgap":Y,"edge.type":Y,"edge.points":Y,"edge.segments":Y,"edge.color":xg,"edge.width":2,"edge.width.absolute":!1,"edge.repeat.image":null,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":Y,"edge.3d.accuracy":Y,"edge.cap":Bi,"edge.join":Fk,"edge.source.position":17,"edge.source.anchor.x":Y,"edge.source.anchor.y":Y,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":Y,"edge.target.anchor.y":Y,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":Y,"edge.dash":!1,"edge.dash.pattern":zh,"edge.dash.offset":0,"edge.dash.color":ob,"edge.dash.width":Y,"edge.dash.3d":!1,"edge.dash.3d.color":Y,"edge.dash.3d.accuracy":Y,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":Y,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":Y,"grid.column.percents":Y,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":K.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":K.gridCellBorderColor,"grid.block":Y,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":K.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Wg,"text.gradient.pack":Y,"text.font":Pd,"text.shadow":!1,"text.shadow.color":Vb,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,"text.gradient":Y,"text.gradient.color":"#FFF","text.decoration":Y,"text.vertical":!1,"text.vertical.gap":1,keepPosition:!0};zi[gh]=Y,je(Q,zi,!0),je(dl,{_76I:function(y,q,f){this._39I&&this._39I.fire({data:y,oldIndex:q,newIndex:f})},addIndexChangeListener:function(h,b,d){var s=this;s._39I||(s._39I=new Fr),s._39I.add(h,b,d)},removeIndexChangeListener:function(w,n){this._39I.remove(w,n)},prepareRemove:function(a){Ye(a)&&(a.setSource(F),a.setTarget(F)),a._70O&&a._70O.toList().each(this.remove,this),a._69O&&a._69O.toList().each(function(I){I.setHost(F)}),a._host&&a.setHost(F)},onAdded:function(V){this.isAutoAdjustIndex()&&this.adjustIndex(V)},onDataPropertyChanged:function(w,$){lr[$.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(w)},isAdjustable:function(I){return Im(I)||Ye(I)},isAdjustedToBottom:function(p){return tf(p)?p.isExpanded()&&sq(p):!1},adjustIndex:function(x){var O=this;this.isHierarchicalRendering()||(O.isAdjustedToBottom(x)?(O.sendToBottom(x),x.eachChild(O.adjustIndex,O)):O.sendToTop(x))},sendToTop:function(M){var n=this;if(n.contains(M)&&n.isAdjustable(M)){var R=n._datas;if(M!==R.get(n.size()-1)){var l=R.indexOf(M);R.removeAt(l),R.add(M),n._76I(M,l,n.size()-1)}if(Ye(M)){var L=M._40I;L&&!n.isAdjustedToBottom(L)&&n.sendToTop(L),L=M._41I,L&&!n.isAdjustedToBottom(L)&&n.sendToTop(L)}M._69O&&M._69O.each(function(B){B.isRelatedTo(M)||Im(M)&&B.isLoopedHostOn(M)||n.sendToTop(B)}),M.ISubGraph||(!tf(M)||M.isExpanded())&&M._adjustChildrenToTop&&M.eachChild(function(g){Ye(g)||n.sendToTop(g)})}},sendToBottom:function(Z,C){var K=this;if(Z!==C&&K.contains(Z)&&K.isAdjustable(Z)&&(!C||K.contains(C))){var G=K._datas,M=G.remove(Z),N=C?K._datas.indexOf(C):0;if(G.add(Z,N),M!==N){K._76I(Z,M,N);var w=Z._parent;!w||w.ISubGraph||Ye(w)||K.sendToBottom(Z._parent,Z)}}}}),je(_g,{ms_edit:function(Q){Q._46O=function(Q){var w=this,I=w.gv.dm(),b=w._index,f=w._89I,l=w._node,e=w._shape,D=w._edge,S=w._77I;l&&f?(this.fi({kind:"endEditRect",event:Q,data:l,direction:f}),I.endTransaction()):e&&b>=0?(w.fi({kind:"endEditPoint",event:Q,data:e,index:b}),I.endTransaction()):D&&b>=0?(w.fi({kind:"endEditPoint",event:Q,data:D,index:b}),I.endTransaction()):S&&(w.fi({kind:"endEditRotation",event:Q,data:S}),I.endTransaction())},Q._78I=function(y){var e=this;e.autoScroll(y);var G=e.gv.lp(y),x=e._index,s=e._89I,u=e._node,H=e._shape,E=e._edge,Q=e._77I;if(u&&s)e._80O(G),e.fi({kind:"betweenEditRect",event:y,data:u,direction:s});else if(H&&x>=0)G.e=H.getPoints().get(x).e,H.setPoint(x,G),e.fi({kind:"betweenEditPoint",event:y,data:H,index:x});else if(E&&x>=0){var W=E.s(cm);G.e=W.get(x).e,W.set(x,G),E.fp(cm,F,W),e.fi({kind:"betweenEditPoint",event:y,data:E,index:x})}else if(Q){var q=Q.p(),C=Q.getScale(),r=Ie+jm(G.y-q.y,G.x-q.x);C.y<0&&(r+=d),P(r)<.04&&(r=0),Q.setRotation(r),e.fi({kind:"betweenEditRotation",event:y,data:Q})}},Q._80O=function(g){var r=this,J=r._node,X=r._rect,y=X.x,m=X.y,x=X.width,e=X.height,o=r._89I,w=r._anchor,u=r._matrix,g=u.tfi(g);"northwest"===o?X=To(g,{x:y+x,y:m+e}):o===Ui?X=To({x:y,y:g.y},{x:y+x,y:m+e}):"northeast"===o?X=To({x:y,y:g.y},{x:g.x,y:m+e}):o===xe?X=To({x:g.x,y:m},{x:y+x,y:m+e}):o===nm?X=To({x:y,y:m},{x:g.x,y:m+e}):"southwest"===o?X=To({x:g.x,y:m},{x:y+x,y:g.y}):"south"===o?X=To({x:y,y:m},{x:y+x,y:g.y}):"southeast"===o&&(X=To({x:y,y:m},g)),J.setPosition(u.tf(X.x+X.width*w.x,X.y+X.height*w.y)),J.setWidth(X.width),J.setHeight(X.height)},Q._80I=function(v,h,p,m){var C=this,s=C.gv._zoom,d=(C.gv.getEditPointSize()+2)/s;return Kk({x:h-d/2,y:p-d/2,width:d,height:d},v)?(C._89I!==m&&(C._89I=m),!0):!1},Q._79I=function(u,J,s){var R=this,G=R.gv,Q=J?G.getDataUI(J):F,c=Q?Q._55O:F;if(c){var r,V,n,$,z=G._zoom,t=(G.getEditPointSize()+2)/z,P=G.lp(u);if(Im(J)){if(c._56O&&Im(J)&&(V=c._98o,Kk({x:V.x-t/2,y:V.y-t/2,width:t,height:t},P)))return R._77I=J,s&&R.fi({kind:"beginEditRotation",event:u,data:J}),R.setCursor("crosshair"),!0;if(c._43O&&J instanceof Hq)for(n=J.getPoints(),r=n.size()-1;r>=0;r--)if(V=n.get(r),Kk({x:V.x-t/2,y:V.y-t/2,width:t,height:t},P))return R._index=r,R._shape=J,s&&R.fi({kind:"beginEditPoint",event:u,data:J,index:r}),R.setCursor("crosshair"),!0;if(c._42O)for(var e=J.getEditControlPoints(),o=["northwest",-1,-1,xe,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,nm,1,0,"northeast",1,-1,Ui,0,-1],r=0,$=e.length;$>r;r++){var C=o[3*r],D=e[r];if(R._80I(P,D.x,D.y,C)){R._node=J;var M=J.getWidth(),m=J.getHeight(),v=J.getAnchor();R._rect={x:-M*v.x,y:-m*v.y,width:M,height:m},R._anchor=v,R._matrix=J.getMatrix();var l=J.getRotation(),d=a(l),j=A(l),x=o[3*r+1]*ip(J.getScale().x),H=o[3*r+2]*ip(J.getScale().y),U=Math.atan2(-j*x-d*H,d*x-j*H),y=(Math.round(U/(Math.PI/4))+8)%8,B=[Tr,"nesw-resize",rk,"nwse-resize",Tr,"nesw-resize",rk,"nwse-resize"][y];return R.setCursor(B),s&&R.fi({kind:"beginEditRect",event:u,data:J,direction:R._89I}),!0}}}if(c._43O&&Ye(J)&&J.s(Lf)===Kn&&(n=J.s(cm)))for(r=n.size()-1;r>=0;r--)if(V=n.get(r),Kk({x:V.x-t/2,y:V.y-t/2,width:t,height:t},P))return R._index=r,R._edge=J,s&&R.fi({kind:"beginEditPoint",event:u,data:J,index:r}),R.setCursor("crosshair"),!0}return!1}},ms_gv:function(w){w._currentSubGraph=F,w._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},w.upSubGraph=function(){this.setCurrentSubGraph(pb(this._currentSubGraph))},w.isVisible=function(K){var X=this;if(pb(K)!==X._currentSubGraph)return!1;if(Ye(K)){var Z=K._40I,t=K._41I;if(!Z||!t)return!1;if(!(K.s("edge.independent")||X.isVisible(Z)&&X.isVisible(t)))return!1;if(K.isEdgeGroupHidden())return!1}else for(var x=K._parent;x&&!x.ISubGraph;){if(tf(x)&&(!x.isExpanded()||!X.isVisible(x)))return!1;x=x._parent}if(K._parent instanceof tm&&!X.isVisible(K._parent))return!1;if(K._refGraph instanceof zl&&!X.isVisible(K._refGraph))return!1;if(X instanceof Cs){if(!K.s("3d.visible"))return!1}else{var h=X.getLayersInfo();if(h){var C=h[K._layer];if(C&&C.visible===!1)return!1}if(!K.s("2d.visible"))return!1}return X._visibleFunc?X._visibleFunc(K):!0},w.handleSelectionChange=function(B){var o=this;B.datas.each(function(w){o.invalidateData(w);var $=w._parent;tf($)&&Im(w)&&w.s(Sn)&&(o.invalidateData($),$._49I&&$._49I.each(function(v){o.invalidateData(v)}))}),o.onSelectionChanged(B)},w.onSelectionChanged=function(i){var q=this,R=q.sm();if(1===R.size()&&("set"===i.kind||"append"===i.kind)){var w=R.ld();q.isAutoMakeVisible()&&q.makeVisible(w),q.adjustIndex&&q._dataModel.isAutoAdjustIndex()&&q.adjustIndex(w)}},w.makeVisible=function(O){if(O){var s=this,y=s.getDataUI?s.getDataUI(O):s.getData3dUI(O);if(y){var X=O,A=pb(O);for(A!==s._currentSubGraph&&s.setCurrentSubGraph(A);(X=X._parent)&&X!==A;)tf(X)&&X.setExpanded(!0);s._23I=O,s.iv()}}},w.getLabel=function(L){var g=L.getStyle(Vq);return g===Y?L.getName():g},w.getLabelBackground=function(h){return h.getStyle("label.background")},w.getLabelColor=function(g){return g.getStyle("label.color")},w.getLabel2=function(q){return q.getStyle("label2")},w.getLabel2Background=function(C){return C.getStyle("label2.background")},w.getLabel2Color=function(d){return d.getStyle("label2.color")},w.getNote=function(C){return C.getStyle(Jk)},w.getNoteBackground=function(k){return k.getStyle("note.background")},w.getNote2=function(e){return e.getStyle(vs)},w.getNote2Background=function(g){return g.getStyle("note2.background")},w.handleClick=function(T,v,u){var K=this;v?(K.fi({kind:"clickData",event:T,data:v,part:u}),K.onDataClicked(v,T)):(K.fi({kind:"clickBackground",event:T}),K.onBackgroundClicked(T))},w.handleDoubleClick=function(e,B,Z){var L=this;rf(e)&&(B?(L.fi({kind:"doubleClickData",event:e,data:B,part:Z}),L.onDataDoubleClicked(B,e,Z),L.checkDoubleClickOnNote(e,B,Z)||L.checkDoubleClickOnRotation&&L.checkDoubleClickOnRotation(e,B,Z)||(Ye(B)?L.onEdgeDoubleClicked(B,e,Z):B.ISubGraph?L.onSubGraphDoubleClicked(B,e,Z):tf(B)?L.onGroupDoubleClicked(B,e,Z):B.IDoorWindow?L.onDoorWindowDoubleClicked(B,e,Z):B.ICSGBox&&L.onCSGBoxDoubleClicked(B,e,Z))):(L.fi({kind:"doubleClickBackground",event:e}),L.onBackgroundDoubleClicked(e)))},w.onSubGraphDoubleClicked=function(B){this.setCurrentSubGraph(B)},w.onEdgeDoubleClicked=function(J,G){this.isEditable(J)||(J.ISubGraph&&!qh(G)?this.setCurrentSubGraph(J):J.s("edge.toggleable")&&J.toggle())},w._39Q=function(R){return this.isInteractive(R)?this.preventDefaultWhenInteractive(R):!1},w.preventDefaultWhenInteractive=function(X){return X.s("preventDefaultWhenInteractive")},w.onGroupDoubleClicked=function($){$.s("group.toggleable")&&$.toggle()},w.onDoorWindowDoubleClicked=function(F){F.s("dw.toggleable")&&F.toggle(!0)},w.onCSGBoxDoubleClicked=function(x,s){var u=this;if(u instanceof Cs){var U=u.intersectObject(s,x);U&&x.s(U.part+".toggleable")&&x.toggleFace(U.part,!0)}},w.onBackgroundClicked=function(){},w.onBackgroundDoubleClicked=function(){this.upSubGraph()},w.onDataClicked=function(){},w.onDataDoubleClicked=function(){},w.onAutoLayoutEnded=function(){},w.onMoveEnded=function(){},w.onPanEnded=function(){},w.onPinchEnded=function(){},w.onRectSelectEnded=function(){},w.onZoomEnded=function(){},w.serialize=function(h){return this.dm().serialize(h)},w.toJSON=function(){return this.dm().toJSON()},w.deserialize=function(U,S){var a=this;S=S instanceof Yk?{rootParent:S}:Um(S)?{setId:S}:nf(S)?{finishFunc:S}:S||{},S.view=a;var w=a.dm();return S.__innerHandler__=function(t){if(Um(w.a("toolTipEnable"))&&(w.a("toolTipEnable")?a.enableToolTip():a.disableToolTip()),a instanceof R.graph.GraphView&&(Um(w.a("zoomable"))&&a.setZoomable&&a.setZoomable(w.a("zoomable")),Um(w.a("pannable"))&&a.setPannable&&a.setPannable(w.a("pannable")),Um(w.a("rectSelectable"))&&a.setRectSelectable&&a.setRectSelectable(w.a("rectSelectable")),w.a("fitContent")===!0&&a.fitContent&&a.fitContent(!0,0)),a instanceof R.graph3d.Graph3dView){var q=t.scene;q&&q.shadow!=F&&a.shadowMap.setShadow(q.shadow,q.shadowParams);var s=w.a("sceneContext");s?(s.eye&&a.setEye(s.eye),s.center&&a.setCenter(s.center),bs(s.far)&&a.setFar(s.far),bs(s.near)&&a.setNear(s.near)):(bs(w.a("sceneNear"))&&a.setNear(w.a("sceneNear")),bs(w.a("sceneFar"))&&a.setFar(w.a("sceneFar")),q&&(q.eye&&a.setEye(q.eye),q.center&&a.setCenter(q.center))),Um(w.a("sceneShadowEnabled"))&&(w.a("sceneShadowEnabled")?a.enableShadow():a.disableShadow()),bs(w.a("sceneShadowDegreeX"))&&a.setShadowDegreeX(w.a("sceneShadowDegreeX")),bs(w.a("sceneShadowDegreeZ"))&&a.setShadowDegreeZ(w.a("sceneShadowDegreeZ")),bs(w.a("sceneShadowIntensity"))&&a.setShadowIntensity(w.a("sceneShadowIntensity")),w.a("sceneShadowQuality")!=F&&a.setShadowQuality(w.a("sceneShadowQuality")),w.a("sceneShadowType")&&a.setShadowType(w.a("sceneShadowType")),bs(w.a("sceneShadowRadius"))&&a.setShadowRadius(w.a("sceneShadowRadius")),bs(w.a("sceneShadowBias"))&&a.setShadowBias(w.a("sceneShadowBias")),Um(w.a("sceneDashEnable"))&&a.setDashDisabled(!w.a("sceneDashEnable")),Fn(w.a("sceneHighlightMode"))&&a.setHighlightMode(w.a("sceneHighlightMode")),bs(w.a("sceneHighlightWidth"))&&a.setHighlightWidth(w.a("sceneHighlightWidth")),w.a("sceneHighlightColor")&&a.setHighlightColor(w.a("sceneHighlightColor")),w.a("sceneHighlightType")&&a.setHighlightType(w.a("sceneHighlightType")),w.a("sceneHighlightGlow")&&a.setHighlightGlow(w.a("sceneHighlightGlow")),w.a("sceneHighlightStrength")&&a.setHighlightStrength(w.a("sceneHighlightStrength")),Um(w.a("sceneHeadlightEnable"))&&a.setHeadlightDisabled(!w.a("sceneHeadlightEnable")),bs(w.a("sceneHeadlightRange"))&&a.setHeadlightRange(w.a("sceneHeadlightRange")),w.a("sceneHeadlightColor")&&a.setHeadlightColor(w.a("sceneHeadlightColor")),bs(w.a("sceneHeadlightIntensity"))&&a.setHeadlightIntensity(w.a("sceneHeadlightIntensity")),bs(w.a("sceneHeadlightAmbientIntensity"))&&a.setHeadlightAmbientIntensity(w.a("sceneHeadlightAmbientIntensity")),bs(w.a("sceneHeadlightGroup"))&&a.setHeadlightGroup(w.a("sceneHeadlightGroup")),Um(w.a("sceneFogEnable"))&&a.setFogDisabled(!w.a("sceneFogEnable")),w.a("sceneFogMode")&&a.setFogMode(w.a("sceneFogMode")),bs(w.a("sceneFogDensity"))&&a.setFogDensity(w.a("sceneFogDensity")),w.a("sceneFogColor")&&a.setFogColor(w.a("sceneFogColor")),bs(w.a("sceneFogNear"))&&a.setFogNear(w.a("sceneFogNear")),bs(w.a("sceneFogFar"))&&a.setFogFar(w.a("sceneFogFar")),Um(w.a("sceneBatchBrightnessDisabled"))&&a.setBatchBrightnessDisabled(w.a("sceneBatchBrightnessDisabled")),Um(w.a("sceneBatchBlendDisabled"))&&a.setBatchBlendDisabled(w.a("sceneBatchBlendDisabled")),Um(w.a("sceneBatchColorDisabled"))&&a.setBatchColorDisabled(w.a("sceneBatchColorDisabled")),w.a("sceneBatchInfoMap")&&a.setBatchInfoMap(w.a("sceneBatchInfoMap")),bs(w.a("sceneMoveStep"))&&a.setMoveStep(w.a("sceneMoveStep")),bs(w.a("sceneRotateStep"))&&a.setRotateStep(w.a("sceneRotateStep")),Um(w.a("sceneSortable"))&&a.setSortable(w.a("sceneSortable")),nf(w.a("sceneSortFunc"))&&a.setSortFunc(w.a("sceneSortFunc"));
var e=w.a("sceneSkyboxType")||"sphere";if(e!=F){var G={},Z=!1;if("sphere"===e){G.shape3d=e;var U=w.a("sceneSkyboxImage");U&&(G["shape3d.image"]=U,Z=!0)}else G.shape3d=Y,["front","back","left","right","top","bottom"].forEach(function(z){var S=z+".image",M=z.charAt(0).toUpperCase()+z.slice(1),T=w.a("sceneSkybox"+M+"Image");T&&(G[S]=T,Z=!0)});if(Z){var O=new vl,I=w.a("sceneSkyboxDiameter");bs(I)?O.s3(I,I,I):O.s3(20,20,20),G["body.color"]=w.a("sceneSkyboxBodyColor"),G.envmap=w.a("sceneSkyboxEnvmap"),G["envmap.probe"]=w.a("sceneSkyboxEnvmapProbe"),G.roughness=w.a("sceneSkyboxRoughness"),G["shape3d.light"]=G["all.light"]=w.a("sceneSkyboxLight"),G["light.mask"]=w.a("sceneSkyboxLightMask"),G["headlight.ambientIntensity"]=w.a("sceneSkyboxHeadLightAmbientIntensity"),G["texture.wrap"]="clampToEdge",G["3d.clipbox.mask"]=nj,G["effect.flow.mask"]=nj,O.s(G),["X","Y","Z"].forEach(function(G){var z=w.a("sceneSkyboxRotation"+G);bs(z)&&O["setRotation"+G](z)}),a.setSkybox(O)}}}},w.deserialize(U,S.rootParent,S)},w.isDebugTipShowing=function(){return!!this._debugDiv},w.showDebugTip=function(){var B=this,U=B._debugDiv;if(!U){U=B._debugDiv=M.createElement("div"),U.style.position="absolute",U.style.overflow="hidden",U.style.font=x.debugTipLabelFont,U.style.padding="6px",U.style.backgroundColor=x.debugTipBackground,U.style.color=x.debugTipLabelColor;var l=B.getView();B._79O?l.insertBefore(U,B._79O):l.appendChild(U);var T=function(){B.redraw();var F=B._canvas,X="FPS: "+B._fpsInfo.fps+"<br/>"+"Datas: "+B.dm().getDatas().length+(F?"<br/>Size: "+F.width+" * "+F.height:""),u=B.dm()._historyManager;u&&(X+="<br/>Undoes: "+u.getHistories().length+" index: "+u.getHistoryIndex());var J=B.getDebugTip();J&&(X+="<hr>"+J),U.innerHTML=X,B._isDebugging&&requestAnimationFrame(T)};requestAnimationFrame(T),B._isDebugging=!0}},w.hideDebugTip=function(){var f=this,Y=f._debugDiv;Y&&(delete f._debugDiv,f.getView().removeChild(Y),f._isDebugging=!1)},w.updateDOMAppendMatrix=function(){var e=this.getView();e&&(e.updateAppendMatrix=!0)},w.countFrame=function(){if(this._isDebugging){var W=Date.now(),L=this._fpsInfo;W-L.time>1e3?(L.fps=Math.round(1e5*(L.frames+1)/(W-L.time))/100,L.time=W,L.frames=0):L.frames++}}},ms_icons:function(h){h.getRotation=function(d){return d==F?0:d},h._15O=function(){var y=this,p=y.s(Th);if(p){var i=y,M=y.data||y._data,J=y._38o={icons:p,rects:{}};for(var N in p){var Q=p[N],C=ur(Q.shape3d,M,i);if(!(ur(Q.visible,M,i)===!1||ur(Q.for3d,M,i)&&!y.I3d||C&&!y.I3d)){var q=C?[C]:ur(Q.names,M,i),$=q?q.length:0,n=ur(Q.position,M,i)||3,U=ur(Q.offsetX,M,i)||0,s=ur(Q.offsetY,M,i)||0,P=ur(Q.direction,M,i)||nm,R=ur(Q.gap,M,i),t=R!=F?R:1,S=ur(Q.rotation,M,i),o=ur(Q.keepOrien,M,i),b=ur(Q.rotationFixed,M,i)?S:y.getRotation(S,o,n),D=F,X=J.rects[N]=new Array($);X.rotation=b;for(var u=0;$>u;u++){var k,h,L,r,B=q[u];if(C)L=0,r=0;else{var g=ti(B);L=ur(Q.width,M,i),r=ur(Q.height,M,i),L==F&&(L=Ro(g,M)),r==F&&(r=Kb(g,M))}if(D?P===nm?U+=L/2:P===xe?U-=L/2:P===Ui?s-=r/2:s+=r/2:D={width:L,height:r},y.I3d){var j=-L/2,K=-r/2;h={width:L,height:r,mat:y._16O(ur(Q.autorotate,M,i),n,D,ur(Q.face,M,i)||Cn,ur(Q.t3,M,i),ur(Q.r3,M,i),ur(Q.rotationMode,M,i),U,s),vs:new Oh([j,-K,0,j,-K-r,0,j+L,-K-r,0,j+L,-K,0])}}else k=y.getPosition(n,U,s,D,ur(Q.positionFixed,M,i)),h={x:k.x-L/2,y:k.y-r/2,width:L,height:r},y._68o(h,b);X[u]=h,P===nm?U+=L/2+t:P===xe?U-=L/2+t:P===Ui?s-=r/2+t:s+=r/2+t}}}}}}});var Nj={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},lm={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Ad={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},lr={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},wn={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},yj={"edge.type":1,"edge.group":1},Lq={rotation:1,rotationX:1,rotationZ:1,rotation3d:1},br={rotation:1,position:1,width:1,height:1,anchor:1,scale:1,host:1},er={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Pr={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},ph={shape:1,thickness:1,position:1,anchor:1,scale:1},pb=function(A){if(!A)return F;if(Ye(A)){var g=A._40I,D=A._41I;if(!g||!D)return F;var z=pb(g),y=pb(D);return z===y?z:F}for(var Q=A._parent;Ye(Q)&&!Q.ISubGraph;)Q=Q._parent;return Q?Q.ISubGraph?Q:pb(Q):F},Le=function(b,l,u,W){var o=l.getStyle(u)*W;o&&ge(b,o),o=l.getStyle(u+".left")*W,o&&(b.x-=o,b.width+=o),o=l.getStyle(u+".right")*W,o&&(b.width+=o),o=l.getStyle(u+".top")*W,o&&(b.y-=o,b.height+=o),o=l.getStyle(u+".bottom")*W,o&&(b.height+=o),b.width<0&&(b.width=-b.width,b.x-=b.width),b.height<0&&(b.height=-b.height,b.y-=b.height)},sq=function(y){for(var X,b=0,e=y.size();e>b;b++)if(X=y.getChildAt(b),Im(X)&&sq(X))return!0;return y.hasAgentEdges()},js=function(W){if(!W)return F;for(var S=W._parent;tf(S);){if(!tf(S._parent))return S.isExpanded()?W:S;S.isExpanded()||(W=S),S=S._parent}return W},oe=function(V,i){if(!V||!i)return F;var O,q,L,e=pb(V),g=pb(i);if(e!==g){for(;g&&e!==g;)g=pb(g);if(e===g)return V;O=new Hb,O.add(V,0);for(var T=V._parent;Im(T)&&!i.isDescendantOf(T);)O.add(T,0),T=T._parent;for(L=O.size(),q=0;L>q;q++){var P=O.get(q);if(tf(P)&&!P.isExpanded())return P;if(P.ISubGraph)return P}return V}return V},Tp=function(S){if(S.isLooped())return S._source;var M=js(S._source),b=js(S._target);return M===b?S._source:oe(M,b)},Ag=function(G){if(G.isLooped())return G._target;var Z=js(G._source),E=js(G._target);return Z===E?G._target:oe(E,Z)},wf=function(K,$,Y){"target"!==Y&&(Y="source");var R="target"===Y?$.getTargetAgent():$.getSourceAgent(),k="edge."+Y+".";if(Ye(R)){var g=K.getDataUI(R);g._79o();var F=$.s(k+"index");if(F>=0){var x=cp(g);return x[Math.max(0,Math.min(F,x.length-1))]}var v=$.s(k+"percent")||0;v=Math.max(0,Math.min(v,1));var W=Gh(g);return Mg(W,100*v)}return lb(K,R,$.s(k+"position"),$.s(k+"offset.x"),$.s(k+"offset.y"),$.s(k+"anchor.x"),$.s(k+"anchor.y"))},lb=function(R,I,U,_,P,t,N){if(!I)return F;var L,K=I.getRotation?I.getRotation():0;if(t!==Y||N!==Y){t=t===Y?.5:t,N=N===Y?.5:N;var b=I.getScale();if(K&&!Xr(I,R)||b.x<0||b.y<0){var x=I.getPosition(),D=I.getWidth(),d=I.getHeight(),u=I.getAnchor(),X=new Pn(K,x.x,x.y,b.x,b.y);U=X.tf((t-u.x)*D,(N-u.y)*d)}else L=Bf(R,I),U={x:L.x+t*L.width,y:L.y+N*L.height}}else U=Am(U,Bf(R,I));if(K){var y=a(K),E=A(K),g=_*y-P*E;P=_*E+P*y,_=g}return U.x+=_,U.y+=P,U},mo=function(B,t){if(!B||!t)return F;var E,Y,v,s,L,m;if(B===t){if(s=B.getLoopedEdges(),!s)return F;s=new Hb(s)}else{if(L=B.getAgentEdges(),m=t.getAgentEdges(),!L||!m)return F;for(Y=L.size(),E=0;Y>E;E++)v=L.get(E),m.contains(v)&&(s||(s=new Hb),s.add(v))}if(s)for(E=0;E<s.size();E++)v=s.get(E),v.getStyle(Lf)===Kn&&(v._22I(F),s.removeAt(E),E--);return s},zo=function(h,p){var U=mo(h,p);if(U&&!U.isEmpty()){if(1===U.size())return U.get(0)._22I(F),void 0;var D=new Hb,l=new Hb;U.each(function(t){var M=t.s("edge.group");D.contains(M)||D.add(M)}),D.sort(),D.each(function(c){l.add(new R.EdgeGroup(U.toList(function(d){return c===d.s("edge.group")}),l))}),l.each(function(l){l.each(function(L){L._22I(l)})})}},ap=function(G,k,A){var h=G._canvas;G._zoom;var x=Oj(k,h),f=Oj(A,h);return{x:x.x-f.x,y:x.y-f.y}},Bs=function(h,d){if(d){var z=d.rect,P=d.color,R=d.rotation,k=d.labelWidth,D=d.background,u=d.opacity,o=d.scale,r=o!=F&&1!==o;if(u!=F){var E=h.globalAlpha;h.globalAlpha*=u}if(R||r){h.save();var w=z.x+z.width/2,W=z.y+z.height/2;Yp(h,w,W),R&&Cq(h,R),r&&h.scale(o,o),Yp(h,-w,-W)}if(D&&ys(h,z.x,z.y,z.width,z.height,D),k){var A=z.width,Z=h.createLinearGradient(z.x,z.y,z.x+A,z.y);Z.addColorStop(0,P),Z.addColorStop(.9,P),Z.addColorStop(1,Ab),P=Z,z.width=k}Ai(h,d.ss,z,d.font,P,d.align,d.decoration),k&&(z.width=A),(R||r)&&h.restore(),u!=F&&(h.globalAlpha=E)}},ko=function(s,E){if(E){var g=E.rect,i=g.x,z=g.y,V=g.width,t=g.height,O=E.background,j=E.backgroundImage,k=E.borderWidth,I=E.borderColor,P=E.labelWidth,U=E.opacity,a=E.scale,R=a!=F&&1!==a;if(U!=F){var N=s.globalAlpha;s.globalAlpha*=U}if(R){s.save();var f=g.x+g.width/2,p=g.y+g.height/2;Yp(s,f,p),s.scale(a,a),Yp(s,-f,-p)}if(E.expanded){var T=r(8,V/4),Q=z+t-8;if(s.fillStyle=O,s.beginPath(),s.moveTo(i,z),s.lineTo(i,Q),s.lineTo(i+V/2,Q),s.lineTo(i+V/2,z+t),s.lineTo(i+V/2+T,Q),s.lineTo(i+V,Q),s.lineTo(i+V,z),s.closePath(),s.fill(),k&&(s.lineWidth=k,s.lineJoin="round",s.lineCap="round",I?(s.strokeStyle=I,s.stroke()):(s.strokeStyle=Ol(O),s.beginPath(),s.moveTo(i+V,z),s.lineTo(i+V,Q),s.lineTo(i+V/2+T,Q),s.lineTo(i+V/2,z+t),s.stroke(),s.strokeStyle=Aq(O),s.beginPath(),s.moveTo(i+V,z),s.lineTo(i,z),s.lineTo(i,Q),s.lineTo(i+V/2,Q),s.lineTo(i+V/2,z+t),s.stroke())),j)sl(s,ti(j),op,g.x,g.y,g.width,g.height-8,E.data,E.view);else{if(g.height-=8,O=E.color,P){var W=V,w=s.createLinearGradient(i,z,i+W,z);w.addColorStop(0,O),w.addColorStop(.9,O),w.addColorStop(1,Ab),O=w,g.width=P}Ai(s,E.ss,g,E.font,O,E.align),P&&(g.width=W),g.height+=8}}else if(E.icon)tp(s,ti(E.icon),i,z,V,t,E.data,E.view);else{var b=V/2;k&&(s.lineWidth=k,s.lineJoin="round",s.lineCap="round",s.strokeStyle=I?I:Ol(O),s.beginPath(),s.arc(i+b,z+b,b,Ie,1.6*d,!0),s.moveTo(i+b,z+t),s.lineTo(i+V-b/5,z+b),s.stroke(),s.strokeStyle=I?I:Aq(O),s.beginPath(),s.arc(i+b,z+b,b,1.6*d,Ie,!0),s.moveTo(i+b,z+t),s.lineTo(i+b/5,z+b),s.stroke()),s.fillStyle=O,s.beginPath(),s.arc(i+b,z+b,b,0,o,!0),s.moveTo(i+b,z+t),s.lineTo(i+V-b/5,z+b),s.lineTo(i+b/5,z+b),s.closePath(),s.fill(),s.fillStyle=E.color,s.beginPath(),s.arc(i+b,z+b,b/3,0,o,!0),s.fill()}R&&s.restore(),U!=F&&(s.globalAlpha=N)}},dk=function(l,B){return B>2*l?l:B/2},Bm=function(j,Q,P,G){if(!j||!Q)return 0;var y=jm(Q.y-j.y,Q.x-j.x);return P||(y=Q.x<j.x?y+d:y),y+G},Fg=function(e,a,s,M,_,R,n){n&&(e.x>a.x||e.x===a.x&&e.y>a.y)&&(s=Zh[s],_=-_);var o=Am(s,{x:0,y:0,width:Gd(e,a),height:0},R);return o.x+=M,o.y+=_,o=new Pn(jm(a.y-e.y,a.x-e.x)).tf(o),o.x+=e.x,o.y+=e.y,o},rl=function(s,y,h,X,m){if(s._19Q=!0,!h.getEdgeGroup())return X?h.s("edge.gap"):0;if(Ye(h.getSourceAgent())||Ye(h.getTargetAgent()))return 0;var H,p=0,g=0,W=0;if(h.getEdgeGroup().getSiblings().each(function(v){v.each(function(F){if(y.isVisible(F)&&F.s(Lf)==m){var w=F.s("edge.gap");H?(g+=W/2+w/2,W=w):(H=F,W=w),F===h&&(p=g)}})}),X)return g-p+W;var L=p-g/2;return H&&h._40I!==H._40I&&(s._19Q=!1),L},Hk=function(Q){var b=Q._getValidSelection();if(1===b.length){var H=b[0],e=H instanceof R.Edge;if(H instanceof R.Shape||e){if(e){var $=H.s("edge.type");if($&&"points"!==$)return}var q=Q.gv;if((!q.isPointEditable||q.isPointEditable(H))&&q.isEditable(H))return H}}},Ti=function(){var A=function(T){var P=[];return T.forEach(function(H){P.push({x:H.x,y:H.y}),P.push({x:H.x+H.width,y:H.y+H.height}),P.push({x:H.x+H.width,y:H.y}),P.push({x:H.x,y:H.y+H.height})}),P};return function(c,d,K){if("oval"===c){var x=0,T=K.height/K.width,I=T*T,J=K.x+K.width/2,S=K.y+K.height/2,m=A(d);m.forEach(function(i){var N=i.x-J,K=i.y-S,l=N*N+K*K/I;l>x&&(x=l)}),x=z(x);var s=T*x;return{x:J-x,y:S-s,width:2*x,height:2*s}}if("circle"===c){var u=0,J=K.x+K.width/2,S=K.y+K.height/2,m=A(d);return m.forEach(function(z){var T=z.x-J,v=z.y-S,P=T*T+v*v;P>u&&(u=P)}),u=z(u),{x:J-u,y:S-u,width:2*u,height:2*u}}return"roundRect"===c?(ge(K,r(K.width,K.height)/16),K):K}}(),vh=R.graph={},en=function(n,O,C){tr(q+".graph."+n,O,C)};R.layout={};var Dm={},dn=function(u,N,w,H,I,_,q,P){var a=q._zoom;if(a!==q._cacheZoom&&(q._cacheZoom=a,q._cacheImage={}),a*=Cf,H=Math.ceil(H),I=Math.ceil(I),H*a>2048||I*a>2048)return N;var f=[N.uuid,H,I,w].join("_");if(N.cacheRule){var M;M=nf(N.cacheRule)?N.cacheRule(_,q):ur(N.cacheRule,_,q),f+="_"+M}var $,U=1;I>=H&&U>H*a?($=I/H,H=U/a,I=H*$):H>=I&&U>I*a&&($=H/I,I=U/a,H=I*$),H=Math.ceil(H),I=Math.ceil(I);var g=q._cacheImage[f];if(!g){if(Wp(),g=R.Default.toCanvas(N,H,I,w,_,q,P,a),!Tg())return N;q._cacheImage[f]=g}return g};je(x,{setImageCacheRule:function(J,K){var $;K||"object"!=typeof J?($={},$[J]=K):$=J;for(var c in $){var i=$[c];Fn(c)?(tr=ti(c),tr?tr.cacheRule=i:Dm[c]=i):c.cacheRule=i}}});var pf={comps:[{type:ad,points:[85,50,70,115,100,71,86,107,88,49,56,112,103,107,66,67,89,84,114,73,122,87,112,57,66,104,90,88,43,108,72,74,118,104,121,53,97,100,68,101,97,116,73,61],borderWidth:1,borderColor:F}]};if(pf[jf]=pf[xn]=160,t.Image){var Ng=new t.Image;Ng.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",We("default_blank",Ng)}We("node_image",Bj(30,30,[{type:Gj,rect:[4,5,22,16],gradient:Ao,gradientColor:$n,background:xg},{type:Gj,rect:[2,3,26,20],borderWidth:1,borderColor:xg},{type:Gj,rect:[11,23,8,4],background:xg},{type:Gj,rect:[6,27,18,2],background:xg}])),We("node_icon",Bj(16,16,[{type:Gj,rect:[2,2,12,10],gradient:Ao,gradientColor:$n,background:xg},{type:ej,rect:[2,2,12,10],width:1,color:xg},{type:Gj,rect:[6,12,4,2],background:xg},{type:Gj,rect:[4,14,8,1],background:xg}])),We("block_icon",Bj(16,16,[{type:ej,rect:[1,1,14,14],width:1,color:xg}])),We("group_image",Bj(66,39,[{type:Gj,rect:[44.3,18,18.1,12.8],gradient:Ao,gradientColor:$n,background:xg},{type:Gj,rect:[3.3,17.8,18.1,12.8],gradient:Ao,gradientColor:$n,background:xg},{type:Gj,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:xg,gradient:Ao,gradientColor:$n,background:xg},{type:Gj,rect:[26.2,29.4,12.8,4.2],background:xg},{type:Gj,rect:[21.3,33.5,22.5,2.3],background:xg},{type:Gj,rect:[5.3,32.7,14.1,2.1],background:xg},{type:Gj,rect:[9,30.4,6.7,2.4],background:xg},{type:Gj,rect:[50,30.7,6.7,2.4],background:xg},{type:Gj,rect:[46.3,33,14.1,2.1],background:xg}])),We("group_icon",Bj(16,16,[{type:Gj,rect:[4,12,4,2],background:xg},{type:Gj,rect:[2,13,8,1],background:xg},{type:Gj,rect:[12,12,2,1],background:xg},{type:Gj,rect:[11,13,4,1],background:xg},{type:Gj,rect:[10,7,6,5],gradient:Ao,gradientColor:$n,background:xg},{type:Gj,rect:[1,2,10,10],gradient:Ao,gradientColor:$n,background:xg},{type:ej,rect:[1,2,10,10],width:1,color:xg}])),We("refGraph_icon",Bj(16,16,[{type:"shape",borderWidth:1,borderColor:xg,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:xg,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),We("edge_icon",Bj(16,16,[{type:Gj,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:Ao,gradientColor:$n,background:xg},{type:Gj,rect:[10.8,1,4,4],background:xg},{type:Gj,rect:[1,11,4,4],background:xg}])),We("subGraph_image",Bj(72,45,[{type:ad,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:Ao,gradientColor:$n,background:xg},{type:Gj,rect:[29.6,30.7,3.6,1.8],background:xg},{type:Gj,rect:[28.4,32.3,6,1.2],background:xg},{type:Gj,rect:[37.3,32,10.8,1.8],background:xg},{type:Gj,rect:[39.1,29.9,7.2,2.3],background:xg},{type:Gj,rect:[26.6,23.7,9.6,7.2],gradient:Ao,gradientColor:$n,background:xg},{type:Gj,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:xg,gradient:Ao,gradientColor:$n,background:xg}])),We("subGraph_icon",Bj(17,17,[{type:ad,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:Ao,gradientColor:$n,background:xg}])),We("shape_icon",Bj(16,16,[{type:ad,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:xg}])),We("polyline_icon",Bj(16,16,[{type:ad,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:xg},Dn(7.5,.4),Dn(7.5,6.3),Dn(13.6,6.3),Dn(13.6,14),Dn(.7,13.9),Dn(.7,.3)])),We("grid_icon",Bj(16,16,[{type:Gj,rect:[1,1,4,4],background:xg,gradient:Ao,gradientColor:$n},{type:Gj,rect:[6,1,4,4],background:xg,gradient:Ao,gradientColor:$n},{type:Gj,rect:[11,1,4,4],background:xg,gradient:Ao,gradientColor:$n},{type:Gj,rect:[11,6,4,4],background:xg,gradient:Ao,gradientColor:$n},{type:Gj,rect:[6,6,4,4],background:xg,gradient:Ao,gradientColor:$n},{type:Gj,rect:[1,6,4,4],background:xg,gradient:Ao,gradientColor:$n},{type:Gj,rect:[11,11,4,4],background:xg,gradient:Ao,gradientColor:$n},{type:Gj,rect:[6,11,4,4],background:xg,gradient:Ao,gradientColor:$n},{type:Gj,rect:[1,11,4,4],background:xg,gradient:Ao,gradientColor:$n}])),We("light_icon",Bj(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:xg},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:xg,gradient:Ao,gradientColor:$n,background:{func:function(f){var x=f?f.s(hd):F;return Ub(x)?"rgb("+Ld(255*x[0])+","+Ld(255*x[1])+","+Ld(255*x[2])+")":x||xg}}}])),We("text_icon",Bj(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:xg}])),We("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),We("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),We("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),We("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var Fl=function(u,t,Y,y,p,U){var V,h,j,m,T,D,$,v,A,o,E,O=[];if(Math.abs(y)>2*Math.PI&&(y=2*Math.PI),T=Math.ceil(Math.abs(y)/(Math.PI/4)),V=y/T,h=-V,j=-Y,T>0){D=u+Math.cos(Y)*p,$=t+Math.sin(-Y)*U,O.push({x:D,y:$});for(var B=0;T>B;B++)j+=h,m=j-h/2,v=u+Math.cos(j)*p,A=t+Math.sin(j)*U,o=u+Math.cos(m)*(p/Math.cos(h/2)),E=t+Math.sin(m)*(U/Math.cos(h/2)),O.push({x:o,y:E}),O.push({x:v,y:A})}return O},cj=function(c){if(c){var t=c._data;if(t instanceof R.Shape)return{points:t.getPoints(),segments:t.getSegments()};var a;if(t instanceof R.Edge&&(a=c._78o)){var y,K,P=a.type,u=a.points,G=a.segments,F=a.edgeTypeInfo;if(!P||u){var B=a.sourcePoint,o=B.x,Q=B.y,n=a.targetPoint,T=n.x,I=n.y;if(P)G?(y=new Hb({x:o,y:Q}),y.addAll(u),y.add({x:T,y:I}),K=new Hb(G._as)):(y=new Hb({x:o,y:Q}),u.each(function(g){y.add(g)}),y.add({x:T,y:I}));else if(a.looped){y=new Hb(Fl(o,Q,0,2*Math.PI,a.radius,a.radius)),K=new Hb([1]);for(var x=0;x<(y.size()-1)/2;x++)K.add(3)}else y=new Hb,a.center?(y.add({x:a.c1.x,y:a.c1.y}),y.add({x:o,y:Q}),y.add({x:T,y:I}),y.add({x:a.c2.x,y:a.c2.y})):(y.add({x:o,y:Q}),y.add({x:T,y:I}))}else F&&(y=new Hb(F.points._as),F.segments&&(K=new Hb(F.segments._as)));return{points:y,segments:K}}}},Gh=function(d,V,U){if(null==V){var x=cj(d);if(!x)return;V=x.points,U=x.segments}if(V){if(Array.isArray(V)&&(V=new Hb(V)),"number"==typeof V.get(0)){for(var S=new R.List,$=0;$<V.size();$+=2)S.add({x:V.get($),y:V.get($+1)});V=S}if(!U){U=[1];for(var M=V.length-1;M>0;M--)U.push(2)}Array.isArray(U)&&(U=new Hb(U));for(var I=fq(V._as,U._as,50),Y=I.length,X=[],$=0;Y>$;$++){var H=I[$];H.length>1&&X.push(H)}return X}},zk=function(h){for(var d=0,C=h.length-1,O=0;C>O;O++){var R=h[O],P=h[O+1],E=P.x-R.x,f=P.y-R.y;d+=Math.sqrt(E*E+f*f)}return d},Do=function(K,r){for(var S=0,d=r.length,D=0;d>D;D++){var N=r[D];if(S+=N,S>K)return D}return Math.min(D,d-1)},Vo=function(D,a){for(var X=0,N=0,F=0,V=D.length-1,J=0;V>J;J++){var p=D[J],K=D[J+1],j=K.x-p.x,r=K.y-p.y;if(F=Math.sqrt(j*j+r*r),X+=F,X>a){X-=F,N=J;break}}var u=D[N],W=D[N+1],U=Math.atan2(W.y-u.y,W.x-u.x),f=a-X,r=Math.sin(U)*f,j=Math.cos(U)*f;return{x:u.x+j,y:u.y+r}},Mg=function(i,j){if(i){var d;if(0===j)d=i[0][0];else if(100===j)i=i[i.length-1],d=i[i.length-1];else{for(var p=0,Q=[],a=i.length,u=0;a>u;u++){var G=i[u],E=zk(G);p+=E,Q.push(E)}for(var h=p*j/100,y=Do(h,Q),t=0,$=0;y>$;$++)t+=Q[$];h-=t,d=Vo(i[y],h)}return d}},cp=function(F){var C,w,n,T,q=cj(F),P=[],U=q.points,S=q.segments,b=-1;for(w=0,n=S?S.length:U.length;n>w;w++){if(C=S?S.get(w):1,3===C)T=2;else if(4===C)T=3;else{if(5===C)continue;T=1}b+=T,P.push(U.get(b))}return P},Ve=function(Y,h,N,U){function D(M){if(M>=0&&1>=M){i=h(M);var D=(Y.x-i.x)*(Y.x-i.x)+(Y.y-i.y)*(Y.y-i.y);return y>D?(y=D,a=M,!0):!1}}N=N||100,U=U||1e-5;for(var y=1/0,a=0,i=new $g,o=0;N>o;++o)D(o/N);for(var I=1/(2*N);I>U;)D(a-I)||D(a+I)||(I/=2);return a};je(x,{_edgeProtectMethod:{getStraightLinePoints:Gh,calculateLineLength:zk,calcSegmentIndexByDistance:Do,calculatePointAlongLine:Vo,getPercentPosition:Mg,getRealPointsFromDataUI:cp}});var hf=function(H,S){for(var A=H.vertices,z=0;z<A.length;z++){var G=A[z],m=G.y;G.y=G.z,G.z=-m,S&&(G.y+=S)}},Qp=function(n){for(var q,U,z,Y,m,l,v=[],K=[],L=[],J=n.faces,V=0,x=0,O=0,I=J.length;I>V;V++,x+=6,O+=9){var Q=J[V];1===Q.i?(q||(q=[],U=[],z=[]),qi(Q,V,x,O,n,q,z,U)):2===Q.i?(Y||(Y=[],m=[],l=[]),qi(Q,V,x,O,n,Y,l,m)):qi(Q,V,x,O,n,v,L,K)}return{vs:v,uv:K,ns:L,top_vs:q,top_uv:U,top_ns:z,bottom_vs:Y,bottom_uv:m,bottom_ns:l}},qi=function(T,R,x,s,F,B,C,u){var P=F.vertices,b=F.faceVertexUvs,$=P[T.a],W=P[T.b],j=P[T.c];B.push($.x,$.y,$.z,W.x,W.y,W.z,j.x,j.y,j.z);var N,E,I,g=T.vertexNormals;3===g.length?(N=g[0],E=g[1],I=g[2]):N=E=I=T.normal,C.push(N.x,N.y,N.z,E.x,E.y,E.z,I.x,I.y,I.z);var t=b[0][R][0],U=b[0][R][1],S=b[0][R][2];u.push(t.x,t.y,U.x,U.y,S.x,S.y)},or=function(){function _(t,h){return t.dot(h)>0}function K(H,o,u,C,l,U,j){for(var b,O,B=[o,u,C],m=[l,U,j],d=[],c=B.length,M=!0;c--&&M;){for(var q=B[c],E=m.length,h=!1;E--;)if(q.equals(m[E])){m.splice(E,1),d.push(q),h=!0;break}if(!h){if(b){M=!1;break}b=q}}return M&&2===d.length&&(O=m[0],v.subVectors(b,d[0]),e.subVectors(O,d[0]),i.subVectors(b,d[1]),v.x*i.y*e.z+i.x*e.y*v.z+e.x*v.y*i.z-e.x*i.y*v.z-e.y*i.z*v.x-e.z*i.x*v.y<1e-6&&(Z.subVectors(O,d[1]),F.subVectors(d[1],d[0]),_(F,v)&&_(F,e)&&(F.negate(),_(F,i)&&_(F,Z))))?(H.push(d[1].x,d[1].y,d[1].z),H.push(b.x,b.y,b.z),H.push(b.x,b.y,b.z),H.push(d[0].x,d[0].y,d[0].z),H.push(d[0].x,d[0].y,d[0].z),H.push(O.x,O.y,O.z),H.push(O.x,O.y,O.z),H.push(d[1].x,d[1].y,d[1].z),2):(H.push(o.x,o.y,o.z),H.push(u.x,u.y,u.z),H.push(u.x,u.y,u.z),H.push(C.x,C.y,C.z),H.push(C.x,C.y,C.z),H.push(o.x,o.y,o.z),1)}function s(){this._vertexMap={},this._lineMap={},this._lineList=[]}function M(F,t,w,c,A,e,E){var u=[w,A];F[0]===c&&u.reverse();var k=[u[0]._key,u[1]._key].join("|"),d=F._triangles[k];d||(F._triangles[k]=d={});var Q=[e._key,E._key].join("|");d[Q]||(d[Q]=[e,E])}function G(d,P,A){var w=d._planes[A._key];if(!w)for(var Q in d._planes){var m=d._planes[Q];if(m._normal.angleTo(A)<.001){w=m;break}}return w?(w._vertices.indexOf(P)<0&&w._vertices.push(P),void 0):(d._planes[A._key]={_normal:A,_vertices:[P]},void 0)}function B(O,t){return 0===t?"0|0|0":1/0===Math.abs(t)?[O.x,O.y,O.z].join("|"):[Math.round(b.angleTo(O)*t),Math.round(p.angleTo(O)*t),Math.round(R.angleTo(O)*t)].join("|")}function o(s,L){var c=s._ctlineModel;if(c||(s._ctlineModel=c=[]),c[0])return c[0];var e;e=Ub(s)?s:[s];var N,M,l,E,b,$,Q,F,u,m,k,w,o,i,W,U,J,G,p,t=["","top_","bottom_"];c=[];var q=[];for(Ed(e,L,q),N=0,M=q.length;M>N;N++)if(m=q[N])for(kn(m),l=0,E=t.length;E>l;l++)if(u=m[t[l]+"lvs"])for(J=c.length,G=u.length,c.length=J+G,p=0;G>p;++p,++J)c[J]=u[p];else if(Q=m[t[l]+"vs"]){F=m[t[l]+"is"],$=F?F.length:Q.length/3;for(var b=0;$-1>b;)F?(k=F[b],w=F[b+1],o=F[b+2],i=F[b+3],W=F[b+4],U=F[b+5]):(k=b,w=b+1,o=b+2,i=b+3,W=b+4,U=b+5),A.fromArray(Q,3*k),r.fromArray(Q,3*w),z.fromArray(Q,3*o),d.fromArray(Q,3*i),h.fromArray(Q,3*W),g.fromArray(Q,3*U),b+=3*K(c,A,r,z,d,h,g);$>b&&(F?(k=F[b],w=F[b+1],o=F[b+2]):(k=b,w=b+1,o=b+2),A.fromArray(Q,3*k),r.fromArray(Q,3*w),z.fromArray(Q,3*o),c.push(A.x,A.y,A.z),c.push(r.x,r.y,r.z),c.push(r.x,r.y,r.z),c.push(z.x,z.y,z.z),c.push(z.x,z.y,z.z),c.push(A.x,A.y,A.z))}return s._ctlineModel[0]=c,c}function q(x,d,z){var R=x._ctlineModel;R||(x._ctlineModel=R=[]);var F=R[1];if(F&&F.epsilon===z)return F;F=[],F.epsilon=z;var N;N=Ub(x)?x:[x];var n,Q,T,B,q,j,I,$,V,D,c,w,g=["","top_","bottom_"],r=new s,P=[];for(Ed(N,d,P),n=0,Q=P.length;Q>n;n++)if(V=P[n])for(kn(V),T=0,B=g.length;B>T;T++)if(I=V[g[T]+"vs"]){$=V[g[T]+"is"],j=$?$.length:I.length/3;for(var q=0,q=0;j>q;q+=3)$?(D=$[q],c=$[q+1],w=$[q+2]):(D=q,c=q+1,w=q+2),r._addTriangle(I,Y,D,c,w,z)}return r._toLineVS(F),x._ctlineModel[1]=F,F}function T(m,Y,v){var N=m._ctlineModel;N||(m._ctlineModel=N=[]);var $=N[2];if($&&$.epsilon===v)return $;$=[],$.epsilon=v;var g;g=Ub(m)?m:[m];var x,o,q,Q,t,G,k,u,I,J,O,f,a,i=["","top_","bottom_"],n=new s,D=[];for(Ed(g,Y,D),x=0,o=D.length;o>x;x++)if(J=D[x])for(kn(J),q=0,Q=i.length;Q>q;q++)if(k=J[i[q]+"vs"]){u=J[i[q]+"is"],I=J[i[q]+"ns"],G=u?u.length:k.length/3;for(var t=0,t=0;G>t;t+=3)u?(O=u[t],f=u[t+1],a=u[t+2]):(O=t,f=t+1,a=t+2),n._addTriangle(k,I,O,f,a,v)}return n._toLineVS($),m._ctlineModel[2]=$,$}var A=new Pf,r=new Pf,z=new Pf,d=new Pf,h=new Pf,g=new Pf,v=new Pf,i=new Pf,e=new Pf,Z=new Pf,F=new Pf,H=new Pf;s.prototype._findVertex=function(l,C){H.fromArray(l,3*C);var d=[H.x,H.y,H.z].join(","),V=this._vertexMap[d];if(!V){var J=H.clone();J._key=d,this._vertexMap[d]=V=J}return V},s.prototype._findLine=function(K,e){var B=[K,e];K._key>e._key&&B.reverse(),B._key=[B[0]._key,B[1]._key].join("|");var t=this._lineMap[B._key];return t||(this._lineMap[B._key]=t=B,B._triangles={},B._planes={},this._lineList.push(B)),t};var b=new Pf(1,0,0),p=new Pf(0,1,0),R=new Pf(0,0,1),m=new Pf,j=new Pf;return s.prototype._addTriangle=function(b,y,w,E,r,p){var $,l,K,n=this._findVertex(b,w),D=this._findVertex(b,E),R=this._findVertex(b,r),e=this._findLine(n,D),g=this._findLine(D,R),h=this._findLine(R,n);y?($=(new Pf).fromArray(y,3*w),$._key=B($,p),l=(new Pf).fromArray(y,3*E),l._key=B(l,p),K=(new Pf).fromArray(y,3*r),K._key=B(K,p),M(e,n,$,D,l,R,K),M(g,D,l,R,K,n,$),M(h,R,K,n,$,D,l)):(j.subVectors(R,D),m.subVectors(D,n),$=(new Pf).crossVectors(m,j),$._key=B($,p),G(e,R,$),G(g,n,$),G(h,D,$))},s.prototype._toLineVS=function(h){for(var D=this._lineList,W=0,u=D.length;u>W;++W){var z=D[W],O=!1;for(var F in z._triangles)if(1==S.keys(z._triangles[F]).length){h.push(z[0].x,z[0].y,z[0].z,z[1].x,z[1].y,z[1].z),O=!0;break}if(!O)for(var J in z._planes)if(1==z._planes[J]._vertices.length){h.push(z[0].x,z[0].y,z[0].z,z[1].x,z[1].y,z[1].z),O=!0;break}}},[o,q,T]}(),_o=function(Z,W){var x=Z._lineModel;if(x)return x;var h;h=Ub(Z)?Z:[Z];var i,d,j,L,H,u,G,O,S,g,z,w,$=["","top_","bottom_"];x=[];var N=[];for(Ed(Z,W,N),i=0,d=N.length;d>i;i++)if(S=N[i])for(j=0,L=$.length;L>j;j++)if(G=S[$[j]+"vs"]){O=S[$[j]+"is"],u=O?O.length:G.length/3;for(var H=0;u>H;H+=3)O?(g=O[H],z=O[H+1],w=O[H+2]):(g=H,z=H+1,w=H+2),g*=3,z*=3,w*=3,x.push(G[g],G[g+1],G[g+2],G[z],G[z+1],G[z+2],G[z],G[z+1],G[z+2],G[w],G[w+1],G[w+2],G[w],G[w+1],G[w+2],G[g],G[g+1],G[g+2])}return Z._lineModel=x,x},hb=function(u,N,b,i,I,o,U,k,n,z){b==F&&(b=!0),i==F&&(i=!0),U==F&&(U=1),k==F&&(k=0);var B=new Eo;Sg(B,u,N,n),B=B.toShapes();var X=Y;return z&&(z.length?X={minX:z[0],minY:z[1],maxX:z[2],maxY:z[3]}:(X={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},B.forEach(function(S){var Y=S.getBoundingBox();X.minX=r(Y.minX,X.minX),X.minY=r(Y.minY,X.minY),X.maxX=O(Y.maxX,X.maxX),X.maxY=O(Y.maxY,X.maxY)}))),Qp(new Bk(B,{top:b,bottom:i,curveSegments:I,amount:U,repeatUVLength:o,boundingBox:X},-U/2+k))},Yi=function(P,Z){this.repeatUVLength=P,this._bb=Z};Yi.prototype={generateTopUV:function(_,R,D,X,a,r,k){var b,Q,Y,t,N=_.vertices,P=N[X].x,Z=N[X].y,H=N[a].x,M=N[a].y,O=N[r].x,o=N[r].y,F=this.repeatUVLength;if(F)b=0,Q=0,Y=F,t=F;else{this._bb||(this._bb=R.getBoundingBox());var A=this._bb;b=A.minX,Q=A.minY,Y=A.maxX-b,t=A.maxY-Q}return k?[new lh((P-b)/Y,(Z-Q)/t),new lh((H-b)/Y,(M-Q)/t),new lh((O-b)/Y,(o-Q)/t)]:[new lh((P-b)/Y,1-(Z-Q)/t),new lh((H-b)/Y,1-(M-Q)/t),new lh((O-b)/Y,1-(o-Q)/t)]},generateBottomUV:function(N,Q,y,U,$,Z){return this.generateTopUV(N,Q,y,U,$,Z,!0)},generateSideWallUV:function(D,e,P,Q,g,I,i,X,T,y,B,q){if(!this._cl){for(var S,$,k=[],l=0,c=P.length,x=0;c>x;x++){S=P[x],$=P[(x+1)%c];var j=S.x-$.x,d=S.y-$.y,A=z(j*j+d*d);k.push(l),l+=A}for(var x=0;c>x;x++)k[x]/=l;this._cl=k}var k=this._cl,N=1-T/y,K=1-(T+1)/y,_=k[B],h=k[q];return h>_&&(_+=1),[new lh(_,N),new lh(h,N),new lh(h,K),new lh(_,K)]}};var mp=function(c,L,x,r,i,X){this.a=c,this.b=L,this.c=x,this.i=X,this.normal=r instanceof Sr?r:new Sr,this.vertexNormals=r instanceof Array?r:[]};mp.prototype={constructor:mp};var zn=[-8,14,-4,15,0,6,3,6,-1],Zj=function(){if(Zj[mh]!=F)return Zj[mh];for(var l=Cd[mh],p=zn,R=Yk.prototype.getClassName(),G='"',V=0,d="",x=!1,L=+new(t[R.substr(3,3)+Tr[V]]),i=V;i<p.length;i++){var y=p.length-i;d+=i%2===V?p[i]+y+"":p[i]-y+""}for(var i=V;4>i;i++)d+=V;if(d=d*d.length/d.length,L>d){if(l&&l[V]&&l[4/Gj.length]){for(var O,f,P,$,X,v,J,Z,c=l[0],k=l[1],u="",h=0,i=0;i<k.length;i++)k[i]===G?Z?(Z=!1,0!==h%2&&(O==F?O=u:f==F?f=u:P==F?P=u:$==F?$=u:X==F?X=u:v==F?v=u:J==F&&(J=u)),h++,u=""):Z=!0:Z&&(u+=k[i]);for(var U,r,H,B="",q=0,i=0;i<c.length;i++)c[i]===G?U?(U=!1,0!==q%2&&(r==F?r=B:H==F&&(H=B)),q++,B=""):U=!0:U&&(B+=c[i]);var W=O+f+P+$+X+v,m=!v||v===Rk;if(!m&&v)for(var S,i=0,_=v.length;_>i;i++)v[i]===Kl[4]?S===Rk?m=$l:S[0]===Ii[7]&&Rk&&Rk.indexOf(S.substr(1))>=0?m=am:S=F:(S==F?S=v[i]:S+=v[i],i===_-1&&(S===Rk?m=$l:S[0]===Ii[7]&&Rk&&Rk.indexOf(S.substr(1))>=0&&(m=am)));(x=ck(W,J)&&ck(r,H)&&r===O&&m&&(!X||X>L))&&P.indexOf(kp[0])>=0&&(Zj[kp[0]]=1),x&&P.indexOf(1)>=0&&(Zj[1]=1),x&&P.indexOf(3)>=0&&(Zj[2]=1),x&&P.indexOf(4)>=0&&(Zj[3]=1),x&&P.indexOf(7)>=0&&(Zj[4]=1),x&&P.indexOf(Br[1])>=0&&(Zj[Br[1]]=1)}}else x=!0,Zj[kp[0]]=Zj[1]=Zj[2]=Zj[3]=Zj[4]=Zj[Br[1]]=1;return Zj[mh]=x,x},Mp=function(){},rb=Mp.prototype;rb.getPointAt=function(y){var V=this.getUtoTmapping(y);return this.getPoint(V)},rb.getPoints=function(h){h||(h=5);var F,g=[];for(F=0;h>=F;F++)g.push(this.getPoint(F/h));return g},rb.getSpacedPoints=function(f){f||(f=5);var C,o=[];for(C=0;f>=C;C++)o.push(this.getPointAt(C/f));return o},rb.getLength=function(){var J=this.getLengths();return J[J.length-1]},rb.getLengths=function(L){if(L||(L=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==L+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var k,F,C=[],n=this.getPoint(0),u=0;for(C.push(0),F=1;L>=F;F++)k=this.getPoint(F/L),u+=k.distanceTo(n),C.push(u),n=k;return this.cacheArcLengths=C,C},rb.getUtoTmapping=function(a,L){var R,v=this.getLengths(),f=0,r=v.length;R=L?L:a*v[r-1];for(var p,O=0,i=r-1;i>=O;)if(f=Z(O+(i-O)/2),p=v[f]-R,0>p)O=f+1;else{if(!(p>0)){i=f;break}i=f-1}if(f=i,v[f]==R){var n=f/(r-1);return n}var J=v[f],A=v[f+1],C=A-J,V=(R-J)/C,n=(f+V)/(r-1);return n},rb.getTangent=function(H){var W=1e-4,J=H-W,m=H+W;0>J&&(J=0),m>1&&(m=1);var R=this.getPoint(J),B=this.getPoint(m),j=B.clone().sub(R);return j.normalize()},rb.getTangentAt=function(F){var m=this.getUtoTmapping(F);return this.getTangent(m)},Mp.create=function(J,H){return J.prototype=fk(Mp.prototype),J.prototype.getPoint=H,J
};var xj=function(){this.curves=[],this.autoClose=!1},_f=xj.prototype=fk(rb);_f.add=function(Q){this.curves.push(Q)},_f.closePath=function(){var F=this.curves[0].getPoint(0),m=this.curves[this.curves.length-1].getPoint(1);F.equals(m)||this.curves.push(new vf(m,F))},_f.getPoint=function(R){for(var J,v,Y=R*this.getLength(),B=this.getCurveLengths(),n=0;n<B.length;){if(B[n]>=Y){J=B[n]-Y,v=this.curves[n];var t=1-J/v.getLength();return v.getPointAt(t)}n++}return null},_f.getLength=function(){var d=this.getCurveLengths();return d[d.length-1]},_f.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var v,h=[],A=0,q=this.curves.length;for(v=0;q>v;v++)A+=this.curves[v].getLength(),h.push(A);return this.cacheLengths=h,h},_f.getTransformedPoints=function(d){return this.getPoints(d)},_f.getBoundingBox=function(){var c,K,J,y,Z,b,G=this.getPoints();c=K=Number.NEGATIVE_INFINITY,y=Z=Number.POSITIVE_INFINITY;var A,s,O,e,U=G[0]instanceof Sr;for(e=U?new Sr:new lh,s=0,O=G.length;O>s;s++)A=G[s],A.x>c&&(c=A.x),A.x<y&&(y=A.x),A.y>K&&(K=A.y),A.y<Z&&(Z=A.y),U&&(A.z>J&&(J=A.z),A.z<b&&(b=A.z)),e.add(A);var p={minX:y,minY:Z,maxX:c,maxY:K};return U&&(p.maxZ=J,p.minZ=b),p};var So=function(H){xj.call(this),this.actions=[],H&&this.fromPoints(H)},Ne=So.prototype=fk(xj.prototype),Bd="moveTo",fc="lineTo",Hg="quadraticCurveTo",Tm="bezierCurveTo",Vi="arc",vp="ellipse";Ne.fromPoints=function(C){this.moveTo(C[0].x,C[0].y);for(var d=1,B=C.length;B>d;d++)this.lineTo(C[d].x,C[d].y)},Ne.moveTo=function(){var O=Array.prototype.slice.call(arguments);this.actions.push({action:Bd,args:O})},Ne.lineTo=function(H,N){var $=Array.prototype.slice.call(arguments),W=this.actions[this.actions.length-1].args,y=W[W.length-2],s=W[W.length-1],h=new vf(new lh(y,s),new lh(H,N));this.curves.push(h),this.actions.push({action:fc,args:$})},Ne.quadraticCurveTo=function(q,E,e,f){var B=Array.prototype.slice.call(arguments),x=this.actions[this.actions.length-1].args,g=x[x.length-2],o=x[x.length-1],d=new xm(new lh(g,o),new lh(q,E),new lh(e,f));this.curves.push(d),this.actions.push({action:Hg,args:B})},Ne.bezierCurveTo=function(c,S,l,n,U,k){var K=Array.prototype.slice.call(arguments),p=this.actions[this.actions.length-1].args,X=p[p.length-2],w=p[p.length-1],x=new os(new lh(X,w),new lh(c,S),new lh(l,n),new lh(U,k));this.curves.push(x),this.actions.push({action:Tm,args:K})},Ne.arc=function(k,o,N,J,X,x){var u=this.actions[this.actions.length-1].args,g=u[u.length-2],n=u[u.length-1];this.absarc(k+g,o+n,N,J,X,x)},Ne.absarc=function(E,L,v,c,D,r){this.absellipse(E,L,v,v,c,D,r)},Ne.ellipse=function(e,l,Q,s,C,N,T){var $=this.actions[this.actions.length-1].args,q=$[$.length-2],L=$[$.length-1];this.absellipse(e+q,l+L,Q,s,C,N,T)},Ne.absellipse=function(J,F,O,g,V,c,P){var E=Array.prototype.slice.call(arguments),z=new kg(J,F,O,g,V,c,P);this.curves.push(z);var r=z.getPoint(1);E.push(r.x),E.push(r.y),this.actions.push({action:vp,args:E})},Ne.getSpacedPoints=function(q){q||(q=40);for(var f=[],S=0;q>S;S++)f.push(this.getPoint(S/q));return f},Ne.getPoints=function(U,D){U=U||12;var M,k,d,v,u,c,b,q,V,C,x,w,Z,G,f,E,r,g,_=[];for(M=0,k=this.actions.length;k>M;M++)switch(d=this.actions[M],v=d.action,u=d.args,v){case Bd:_.push(new lh(u[0],u[1]));break;case fc:_.push(new lh(u[0],u[1]));break;case Hg:for(c=u[2],b=u[3],C=u[0],x=u[1],_.length>0?(G=_[_.length-1],w=G.x,Z=G.y):(G=this.actions[M-1].args,w=G[G.length-2],Z=G[G.length-1]),f=1;U>=f;f++)E=f/U,r=ff.b2(E,w,C,c),g=ff.b2(E,Z,x,b),_.push(new lh(r,g));break;case Tm:for(c=u[4],b=u[5],C=u[0],x=u[1],q=u[2],V=u[3],_.length>0?(G=_[_.length-1],w=G.x,Z=G.y):(G=this.actions[M-1].args,w=G[G.length-2],Z=G[G.length-1]),f=1;U>=f;f++)E=f/U,r=ff.b3(E,w,C,q,c),g=ff.b3(E,Z,x,V,b),_.push(new lh(r,g));break;case Vi:var m,o=u[0],B=u[1],W=u[2],K=u[3],I=u[4],z=!!u[5],J=I-K,L=2*U;for(f=1;L>=f;f++)E=f/L,z||(E=1-E),m=K+E*J,r=o+W*a(m),g=B+W*A(m),_.push(new lh(r,g));break;case vp:var m,o=u[0],B=u[1],e=u[2],X=u[3],K=u[4],I=u[5],z=!!u[6],J=I-K,L=2*U;for(f=1;L>=f;f++)E=f/L,z||(E=1-E),m=K+E*J,r=o+e*a(m),g=B+X*A(m),_.push(new lh(r,g))}var s,n,t=Q["shape3d.point.epsilon"],S=!1;for(k=_.length,M=0,k=_.length;k>M;M++)s=_[M],n=M===k-1?_[0]:_[M+1],s&&n&&P(s.x-n.x)<t&&P(s.y-n.y)<t&&(S=!0,_[M]=null);if(S){var H=[];for(M=0;k>M;M++)_[M]&&H.push(_[M]);_=H}return D&&_.push(_[0]),_},Ne.toShapes=function(U,M){function y(u){var O,I,F,o,h,c=[],n=new So;for(O=0,I=u.length;I>O;O++)F=u[O],h=F.args,o=F.action,o==Bd&&0!=n.actions.length&&(c.push(n),n=new So),n[o].apply(n,h);return 0!=n.actions.length&&c.push(n),c}function b(T){for(var N=[],w=0,$=T.length;$>w;w++){var i=T[w],A=new Eo;A.actions=i.actions,A.curves=i.curves,N.push(A)}return N}function v(p,L){for(var F=1e-10,S=L.length,R=!1,c=S-1,H=0;S>H;c=H++){var z=L[c],e=L[H],B=e.x-z.x,u=e.y-z.y;if(P(u)>F){if(0>u&&(z=L[H],B=-B,e=L[c],u=-u),p.y<z.y||p.y>e.y)continue;if(p.y==z.y){if(p.x==z.x)return!0}else{var x=u*(p.x-z.x)-B*(p.y-z.y);if(0==x)return!0;if(0>x)continue;R=!R}}else{if(p.y!=z.y)continue;if(e.x<=p.x&&p.x<=z.x||z.x<=p.x&&p.x<=e.x)return!0}}return R}var o=y(this.actions);if(0==o.length)return[];if(M===!0)return b(o);var f,E,A,g=[];if(1==o.length)return E=o[0],A=new Eo,A.actions=E.actions,A.curves=E.curves,g.push(A),g;var O=!ff.isClockWise(o[0].getPoints());O=U?!O:O;var r,G=[],t=[],I=[],K=0;t[K]=Y,I[K]=[];var T,W;for(T=0,W=o.length;W>T;T++)E=o[T],r=E.getPoints(),f=ff.isClockWise(r),f=U?!f:f,f?(!O&&t[K]&&K++,t[K]={s:new Eo,p:r},t[K].s.actions=E.actions,t[K].s.curves=E.curves,O&&K++,I[K]=[]):I[K].push({h:E,p:r[0]});if(!t[0])return b(o);if(t.length>1){for(var D=!1,F=[],w=0,z=t.length;z>w;w++)G[w]=[];for(var w=0,z=t.length;z>w;w++){t[w];for(var Q=I[w],c=0;c<Q.length;c++){for(var Z=Q[c],J=!0,S=0;S<t.length;S++)v(Z.p,t[S].p)&&(w!=S&&F.push({froms:w,tos:S,hole:c}),J?(J=!1,G[S].push(Z)):D=!0);J&&G[w].push(Z)}}F.length>0&&(D||(I=G))}var i,x,h;for(T=0,W=t.length;W>T;T++)for(A=t[T].s,g.push(A),i=I[T],x=0,h=i.length;h>x;x++)A.holes.push(i[x].h);return g};var Eo=function(){So.apply(this,arguments),this.holes=[]},as=Eo.prototype=fk(Ne);as.getPointsHoles=function(k){var N,j=this.holes.length,Y=[];for(N=0;j>N;N++)Y[N]=this.holes[N].getTransformedPoints(k);return Y},as.extractAllPoints=function(N){return{shape:this.getTransformedPoints(N),holes:this.getPointsHoles(N)}},as.extractPoints=function(g){return this.extractAllPoints(g)};var ff={triangulateShape:function(B,J){function U(S,f,Y){return S.x!=f.x?S.x<f.x?S.x<=Y.x&&Y.x<=f.x:f.x<=Y.x&&Y.x<=S.x:S.y<f.y?S.y<=Y.y&&Y.y<=f.y:f.y<=Y.y&&Y.y<=S.y}function h(L,V,K,x,h){var e=1e-10,H=V.x-L.x,o=V.y-L.y,N=x.x-K.x,M=x.y-K.y,E=L.x-K.x,a=L.y-K.y,Y=o*N-H*M,T=o*E-H*a;if(P(Y)>e){var B;if(Y>0){if(0>T||T>Y)return[];if(B=M*E-N*a,0>B||B>Y)return[]}else{if(T>0||Y>T)return[];if(B=M*E-N*a,B>0||Y>B)return[]}if(0==B)return!h||0!=T&&T!=Y?[L]:[];if(B==Y)return!h||0!=T&&T!=Y?[V]:[];if(0==T)return[K];if(T==Y)return[x];var G=B/Y;return[{x:L.x+G*H,y:L.y+G*o}]}if(0!=T||M*E!=N*a)return[];var m=0==H&&0==o,y=0==N&&0==M;if(m&&y)return L.x!=K.x||L.y!=K.y?[]:[L];if(m)return U(K,x,L)?[L]:[];if(y)return U(L,V,K)?[K]:[];var O,i,Q,g,v,d,u,f;return 0!=H?(L.x<V.x?(O=L,Q=L.x,i=V,g=V.x):(O=V,Q=V.x,i=L,g=L.x),K.x<x.x?(v=K,u=K.x,d=x,f=x.x):(v=x,u=x.x,d=K,f=K.x)):(L.y<V.y?(O=L,Q=L.y,i=V,g=V.y):(O=V,Q=V.y,i=L,g=L.y),K.y<x.y?(v=K,u=K.y,d=x,f=x.y):(v=x,u=x.y,d=K,f=K.y)),u>=Q?u>g?[]:g==u?h?[]:[v]:f>=g?[v,i]:[v,d]:Q>f?[]:Q==f?h?[]:[O]:f>=g?[O,i]:[O,d]}function V(g,I,F,D){var s=1e-10,A=I.x-g.x,u=I.y-g.y,z=F.x-g.x,n=F.y-g.y,E=D.x-g.x,M=D.y-g.y,l=A*n-u*z,q=A*M-u*E;if(P(l)>s){var c=E*n-M*z;return l>0?q>=0&&c>=0:q>=0||c>=0}return q>0}function O(A,g){function z(O,e){var _=P.length-1,z=O-1;0>z&&(z=_);var Y=O+1;Y>_&&(Y=0);var m=V(P[O],P[z],P[Y],J[e]);if(!m)return!1;var q=J.length-1,W=e-1;0>W&&(W=q);var u=e+1;return u>q&&(u=0),m=V(J[e],J[W],J[u],P[O]),m?!0:!1}function L(r,Y){var K,g,E;for(K=0;K<P.length;K++)if(g=K+1,g%=P.length,E=h(r,Y,P[K],P[g],!0),E.length>0)return!0;return!1}function N($,i){var a,V,T,G,I;for(a=0;a<U.length;a++)for(V=g[U[a]],T=0;T<V.length;T++)if(G=T+1,G%=V.length,I=h($,i,V[T],V[G],!0),I.length>0)return!0;return!1}for(var J,E,w,l,Z,W,f,p,y,S,O,P=A.concat(),U=[],v=[],a=0,u=g.length;u>a;a++)U.push(a);for(var x=0,R=2*U.length;U.length>0&&(R--,!(0>R));)for(w=x;w<P.length;w++){l=P[w],E=-1;for(var a=0;a<U.length;a++)if(W=U[a],f=l.x+":"+l.y+":"+W,v[f]===Y){J=g[W];for(var t=0;t<J.length;t++)if(Z=J[t],z(w,t)&&!L(l,Z)&&!N(l,Z)){E=t,U.splice(a,1),p=P.slice(0,w+1),y=P.slice(w),S=J.slice(E),O=J.slice(0,E+1),P=p.concat(S).concat(O).concat(y),x=w;break}if(E>=0)break;v[f]=!0}if(E>=0)break}return P}for(var E,Q,T,S,W,z,q={},i=B.concat(),G=0,R=J.length;R>G;G++)Array.prototype.push.apply(i,J[G]);for(E=0,Q=i.length;Q>E;E++)W=i[E].x+":"+i[E].y,q[W]!==Y,q[W]=E;var l=O(B,J),D=Ih.Triangulate(l,!1);for(E=0,Q=D.length;Q>E;E++)for(S=D[E],T=0;3>T;T++)W=S[T].x+":"+S[T].y,z=q[W],z!==Y&&(S[T]=z);return D.concat()},isClockWise:function(A){return Ih.Triangulate.area(A)<0},b2p0:function(g,p){var u=1-g;return u*u*p},b2p1:function(r,s){return 2*(1-r)*r*s},b2p2:function(r,$){return r*r*$},b2:function(W,C,r,Z){return this.b2p0(W,C)+this.b2p1(W,r)+this.b2p2(W,Z)},b3p0:function(H,$){var D=1-H;return D*D*D*$},b3p1:function(Y,m){var _=1-Y;return 3*_*_*Y*m},b3p2:function(G,c){var L=1-G;return 3*L*G*G*c},b3p3:function(v,Y){return v*v*v*Y},b3:function(F,g,s,x,T){return this.b3p0(F,g)+this.b3p1(F,s)+this.b3p2(F,x)+this.b3p3(F,T)}},Ih={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var Y=S.keys(this.faces);return Y.length?Y[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(B){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(J){var o=J.familyName.toLowerCase(),t=this;return t.faces[o]=t.faces[o]||{},t.faces[o][J.cssFontWeight]=t.faces[o][J.cssFontWeight]||{},t.faces[o][J.cssFontWeight][J.cssFontStyle]=J,J},drawText:function(W){var r,L=this.getFace(),j=this.size/L.resolution,d=0,D=String(W).split(""),b=D.length,R=[];for(r=0;b>r;r++){var X=new So,i=this.extractGlyphPoints(D[r],L,j,d,X);i&&(d+=i.offset*this.spacing,R.push(i.path))}var K=d/2;return{paths:R,offset:K}},extractGlyphPoints:function(X,u,V,o,f){var Z,j,z,c,y,i,L,x,v,n,q,H,N,P,O,$,F,I,d,C=[],Q=u.glyphs[X]||u.glyphs["?"];if(Q){if(Q.o)for(c=Q._cachedOutline||(Q._cachedOutline=Q.o.split(" ")),i=c.length,L=V,x=V,Z=0;i>Z;)switch(y=c[Z++]){case"m":v=c[Z++]*L+o,n=c[Z++]*x,f.moveTo(v,n);break;case"l":v=c[Z++]*L+o,n=c[Z++]*x,f.lineTo(v,n);break;case"q":if(q=c[Z++]*L+o,H=c[Z++]*x,O=c[Z++]*L+o,$=c[Z++]*x,f.quadraticCurveTo(O,$,q,H),d=C[C.length-1])for(N=d.x,P=d.y,j=1,z=this.divisions;z>=j;j++){var b=j/z;ff.b2(b,N,O,q),ff.b2(b,P,$,H)}break;case"b":if(q=c[Z++]*L+o,H=c[Z++]*x,O=c[Z++]*L+o,$=c[Z++]*x,F=c[Z++]*L+o,I=c[Z++]*x,f.bezierCurveTo(O,$,F,I,q,H),d=C[C.length-1])for(N=d.x,P=d.y,j=1,z=this.divisions;z>=j;j++){var b=j/z;ff.b3(b,N,O,F,q),ff.b3(b,P,$,I,H)}}return{offset:Q.ha*V,path:f}}}};Ih.generateShapes=function(s,X){X=X||{};var r=X.font;if(r===Y&&(r=Ih.getDefaultFont(),!r))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var N=X.size!==Y?X.size:1,A=X.curveSegments!==Y?X.curveSegments:4,V=X.spacing!==Y?X.spacing:1,G=X.weight!==Y?X.weight:"normal",l=X.style!==Y?X.style:"normal";Ih.size=N,Ih.divisions=A,Ih.face=r,Ih.weight=G,Ih.style=l,Ih.spacing=V;for(var T=Ih.drawText(s),m=T.paths,R=[],H=0,t=m.length;t>H;H++)Array.prototype.push.apply(R,m[H].toShapes());return R},function(e){var h=1e-10,E=function(g,r){var V=g.length;if(3>V)return null;var t,C,K,h=[],j=[],L=[];if(y(g)>0)for(C=0;V>C;C++)j[C]=C;else for(C=0;V>C;C++)j[C]=V-1-C;var o=V,a=2*o;for(C=o-1;o>2;){if(a--<=0)return r?L:h;if(t=C,t>=o&&(t=0),C=t+1,C>=o&&(C=0),K=C+1,K>=o&&(K=0),v(g,t,C,K,o,j)){var F,P,I,l,n;for(F=j[t],P=j[C],I=j[K],h.push([g[F],g[P],g[I]]),L.push([j[t],j[C],j[K]]),l=C,n=C+1;o>n;l++,n++)j[l]=j[n];o--,a=2*o}}return r?L:h},y=function(z){for(var t=z.length,R=0,k=t-1,s=0;t>s;k=s++)R+=z[k].x*z[s].y-z[s].x*z[k].y;return.5*R},v=function(Z,f,$,W,k,l){var K,M,U,q,r,Y,D,u,J;if(M=Z[l[f]].x,U=Z[l[f]].y,q=Z[l[$]].x,r=Z[l[$]].y,Y=Z[l[W]].x,D=Z[l[W]].y,h>(q-M)*(D-U)-(r-U)*(Y-M))return!1;var t,A,s,V,G,R,m,Q,n,L,C,I,w,i,E;for(t=Y-q,A=D-r,s=M-Y,V=U-D,G=q-M,R=r-U,K=0;k>K;K++)if(u=Z[l[K]].x,J=Z[l[K]].y,!(u===M&&J===U||u===q&&J===r||u===Y&&J===D)&&(m=u-M,Q=J-U,n=u-q,L=J-r,C=u-Y,I=J-D,E=t*L-A*n,w=G*Q-R*m,i=s*I-V*C,E>=-h&&i>=-h&&w>=-h))return!1;return!0};return e.Triangulate=E,e.Triangulate.area=y,e}(Ih),t._typeface_js={faces:Ih.faces,loadFace:Ih.loadFace};var Xd=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},wd=Xd.prototype={constructor:Xd,computeFaceNormals:function(){for(var G=new Sr,C=new Sr,D=0,b=this.faces.length;b>D;D++){var U=this.faces[D],X=this.vertices[U.a],d=this.vertices[U.b],m=this.vertices[U.c];G.subVectors(m,d),C.subVectors(X,d),G.cross(C),G.normalize(),U.normal.copy(G)}},computeVertexNormals:function(E){var Q,P,S,h,I,l;for(l=new Array(this.vertices.length),Q=0,P=this.vertices.length;P>Q;Q++)l[Q]=new Sr;if(E){var i,O,s,b=new Sr,M=new Sr;for(S=0,h=this.faces.length;h>S;S++)I=this.faces[S],i=this.vertices[I.a],O=this.vertices[I.b],s=this.vertices[I.c],b.subVectors(s,O),M.subVectors(i,O),b.cross(M),l[I.a].add(b),l[I.b].add(b),l[I.c].add(b)}else for(S=0,h=this.faces.length;h>S;S++)I=this.faces[S],l[I.a].add(I.normal),l[I.b].add(I.normal),l[I.c].add(I.normal);for(Q=0,P=this.vertices.length;P>Q;Q++)l[Q].normalize();for(S=0,h=this.faces.length;h>S;S++)I=this.faces[S],I.vertexNormals[0]=l[I.a].clone(),I.vertexNormals[1]=l[I.b].clone(),I.vertexNormals[2]=l[I.c].clone()},mergeVertices:function(){var D,l,C,J,B,F,q,n,j={},O=[],P=[],f=4,v=L(10,f);for(C=0,J=this.vertices.length;J>C;C++)D=this.vertices[C],l=m(D.x*v)+"_"+m(D.y*v)+"_"+m(D.z*v),j[l]===Y?(j[l]=C,O.push(this.vertices[C]),P[C]=O.length-1):P[C]=P[j[l]];var E=[];for(C=0,J=this.faces.length;J>C;C++){B=this.faces[C],B.a=P[B.a],B.b=P[B.b],B.c=P[B.c],F=[B.a,B.b,B.c];for(var N=0;3>N;N++)if(F[N]==F[(N+1)%3]){E.push(C);break}}for(C=E.length-1;C>=0;C--){var a=E[C];for(this.faces.splice(a,1),q=0,n=this.faceVertexUvs.length;n>q;q++)this.faceVertexUvs[q].splice(a,1)}var X=this.vertices.length-O.length;return this.vertices=O,X}},kg=function(I,Q,S,c,d,P,$){this.aX=I,this.aY=Q,this.xRadius=S,this.yRadius=c,this.aStartAngle=d,this.aEndAngle=P,this.aClockwise=$};kg.prototype=fk(rb),kg.prototype.getPoint=function(z){var H,E=this.aEndAngle-this.aStartAngle;0>E&&(E+=o),E>o&&(E-=o),H=this.aClockwise===!0?this.aEndAngle+(1-z)*(o-E):this.aStartAngle+z*E;var R=this.aX+this.xRadius*a(H),y=this.aY+this.yRadius*A(H);return new lh(R,y)};var vf=function(e,R){this.v1=e,this.v2=R},oc=vf.prototype=fk(rb);oc.getPoint=function(Z){var m=this.v2.clone().sub(this.v1);return m.multiplyScalar(Z).add(this.v1),m},oc.getPointAt=function(u){return this.getPoint(u)},oc.getTangent=function(){var R=this.v2.clone().sub(this.v1);return R.normalize()};var xm=function(j,Z,M){this.v0=j,this.v1=Z,this.v2=M};xm.prototype=fk(rb),xm.prototype.getPoint=function(U){var B,h;return B=ff.b2(U,this.v0.x,this.v1.x,this.v2.x),h=ff.b2(U,this.v0.y,this.v1.y,this.v2.y),new lh(B,h)};var os=function(g,i,S,J){this.v0=g,this.v1=i,this.v2=S,this.v3=J};os.prototype=fk(rb),os.prototype.getPoint=function(j){var a,g;return a=ff.b3(j,this.v0.x,this.v1.x,this.v2.x,this.v3.x),g=ff.b3(j,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new lh(a,g)},Mp.create(function(g,d){this.v1=g,this.v2=d},function(X){var V=new Sr;return V.subVectors(this.v2,this.v1),V.multiplyScalar(X),V.add(this.v1),V});var bd=Mp.create(function(D,y,G){this.v0=D,this.v1=y,this.v2=G},function(I){var x,V,M;return x=ff.b2(I,this.v0.x,this.v1.x,this.v2.x),V=ff.b2(I,this.v0.y,this.v1.y,this.v2.y),M=ff.b2(I,this.v0.z,this.v1.z,this.v2.z),new Sr(x,V,M)}),gf=Mp.create(function(x,g,S,B){this.v0=x,this.v1=g,this.v2=S,this.v3=B},function(Y){var H,Z,l;return H=ff.b3(Y,this.v0.x,this.v1.x,this.v2.x,this.v3.x),Z=ff.b3(Y,this.v0.y,this.v1.y,this.v2.y,this.v3.y),l=ff.b3(Y,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Sr(H,Z,l)}),si=function(h,B,_,D,F,i,X,U){Xd.call(this),D=D!==Y?D:.5,F=F!==Y?F:.5,U=U!==Y?U:1,h=h||8,i=i||0,X=X||o;var n,T,W=1,R=U/2,u=[],y=[],J=this.vertices,Q=this.faces,d=this.faceVertexUvs;for(T=0;W>=T;T++){var I=[],c=[],G=T/W,r=G*(F-D)+D;for(n=0;h>=n;n++){var L=n/h,M=new Sr,E=-(L*X+i);M.z=r*A(E),M.y=-G*U+R,M.x=r*a(E),J.push(M),I.push(J.length-1),c.push(new lh(L,G))}u.push(I),y.push(c)}var m,v,k=(F-D)/U;for(n=0;h>n;n++)for(0!==D?(m=J[u[0][n]].clone(),v=J[u[0][n+1]].clone()):(m=J[u[1][n]].clone(),v=J[u[1][n+1]].clone()),m.setY(z(m.x*m.x+m.z*m.z)*k).normalize(),v.setY(z(v.x*v.x+v.z*v.z)*k).normalize(),T=0;W>T;T++){var V=u[T][n],g=u[T+1][n],t=u[T+1][n+1],C=u[T][n+1],$=m.clone(),H=m.clone(),w=v.clone(),p=v.clone(),K=y[T][n].clone(),s=y[T+1][n].clone(),P=y[T+1][n+1].clone(),j=y[T][n+1].clone();Q.push(new mp(V,g,C,[$,H,p])),d[0].push([K,s,j]),Q.push(new mp(g,t,C,[H.clone(),w,p.clone()])),d[0].push([s.clone(),P,j.clone()])}if(B&&D>0)for(this.vertices.push(new Sr(0,R,0)),n=0;h>n;n++){var V=u[0][n],g=u[0][n+1],t=this.vertices.length-1,$=new Sr(0,1,0),H=new Sr(0,1,0),w=new Sr(0,1,0),K=y[0][n].clone(),s=y[0][n+1].clone(),P=new lh(s.x,0);Q.push(new mp(V,g,t,[$,H,w],null,1));var q=n/h*o,S=a(q),l=A(q),Z=(n+1)/h*o,N=a(Z),x=A(Z);d[0].push([new lh(.5+.5*S,.5+.5*l),new lh(.5+.5*N,.5+.5*x),new lh(.5,.5)])}if(_&&F>0)for(this.vertices.push(new Sr(0,-R,0)),n=0;h>n;n++){var V=u[T][n+1],g=u[T][n],t=J.length-1,$=new Sr(0,-1,0),H=new Sr(0,-1,0),w=new Sr(0,-1,0),K=y[T][n+1].clone(),s=y[T][n].clone();Q.push(new mp(V,g,t,[$,H,w],null,2));var q=n/h*o,S=a(q),l=A(q),Z=(n+1)/h*o,N=a(Z),x=A(Z);d[0].push([new lh(.5+.5*N,.5-.5*x),new lh(.5+.5*S,.5-.5*l),new lh(.5,.5)])}};si.prototype=fk(wd);var ac=function(W,X,f,r,n,L,I){Xd.call(this),I=I||.5,W=W||16,X=X||16,f=(f!==Y?f:0)-d,r=r!==Y?r:o,n=n!==Y?n:0,L=L!==Y?L:d;var x,Q,e=[],s=[],j=this.vertices,K=this.faces,$=this.faceVertexUvs;for(Q=0;X>=Q;Q++){var G=[],l=[];for(x=0;W>=x;x++){var C=x/W,c=Q/X,H=new Sr;H.x=-I*a(f+C*r)*A(n+c*L),H.y=I*a(n+c*L),H.z=I*A(f+C*r)*A(n+c*L),j.push(H),G.push(j.length-1),l.push(new lh(C,c))}e.push(G),s.push(l)}for(Q=0;X>Q;Q++)for(x=0;W>x;x++){var R=e[Q][x+1],B=e[Q][x],y=e[Q+1][x],U=e[Q+1][x+1],g=j[R].clone().normalize(),E=j[B].clone().normalize(),h=j[y].clone().normalize(),z=j[U].clone().normalize(),T=s[Q][x+1].clone(),q=s[Q][x].clone(),J=s[Q+1][x].clone(),b=s[Q+1][x+1].clone();P(j[R].y)===I?(T.x=(T.x+q.x)/2,K.push(new mp(R,y,U,[g,h,z])),$[0].push([T,J,b])):P(j[y].y)===I?(J.x=(J.x+b.x)/2,K.push(new mp(R,B,y,[g,E,h])),$[0].push([T,q,J])):(K.push(new mp(R,B,U,[g,E,z])),$[0].push([T,q,b]),K.push(new mp(B,y,U,[E.clone(),h,z.clone()])),$[0].push([q.clone(),J,b.clone()]))}};ac.prototype=fk(wd);var Nq=function(M,U,u,C,Y,r){Xd.call(this),M=M||.33,U=U||.17,C=C||8,u=u||6,Y=Y||0,r=r||o;for(var T=new Sr,b=[],z=[],H=0;C>=H;H++)for(var x=H/C*o+d,n=0;u>=n;n++){var w=n/u*r+Y;T.x=M*a(w),T.z=-M*A(w);var R=new Sr,v=M+U*a(x);R.x=v*a(w),R.z=-v*A(w),R.y=U*A(x),this.vertices.push(R),b.push(new lh(n/u,1-H/C)),z.push(R.clone().sub(T).normalize())}for(var H=1;C>=H;H++)for(var n=1;u>=n;n++){var e=(u+1)*H+n-1,G=(u+1)*(H-1)+n-1,L=(u+1)*(H-1)+n,h=(u+1)*H+n,m=new mp(e,G,h,[z[e].clone(),z[G].clone(),z[h].clone()]);this.faces.push(m),this.faceVertexUvs[0].push([b[e].clone(),b[G].clone(),b[h].clone()]),m=new mp(G,L,h,[z[G].clone(),z[L].clone(),z[h].clone()]),this.faces.push(m),this.faceVertexUvs[0].push([b[G].clone(),b[L].clone(),b[h].clone()])}this.computeFaceNormals()};Nq.prototype=fk(wd);var Bk=function(g,N,$){return g?(Xd.call(this),g=g instanceof Array?g:[g],this.addShapeList(g,N),N.convertYZ!==!1&&hf(this,$),this.computeFaceNormals(),void 0):(g=[],void 0)},Qo=Bk.prototype=fk(Xd.prototype);Qo.addShapeList=function(h,i){for(var L=h.length,c=0;L>c;c++){var y=h[c];this.addShape(y,i)}},Qo.addShape=function(C,t){function o(){if(t.bottom)for(var o=0;j>o;o++)N=U[o],n(N[2],N[1],N[0],!0);if(t.top)for(o=0;j>o;o++)N=U[o],n(N[0]+K*H,N[1]+K*H,N[2]+K*H,!1)}function a(){var Y=0;for(S(O,Y),Y+=O.length,u=0,r=s.length;r>u;u++)B=s[u],S(B,Y),Y+=B.length}function S(k,E){for(var q,z,w=k.length;--w>=0;){q=w,z=w-1,0>z&&(z=k.length-1);var s=0,D=H;for(s=0;D>s;s++){var $=K*s,B=K*(s+1),U=E+q+$,X=E+z+$,g=E+z+B,Q=E+q+B;l(U,X,g,Q,k,s,D,q,z)}}}function D(S,y,Q){R.vertices.push(new Sr(S,y,Q))}function n(L,p,B,x){L+=d,p+=d,B+=d,R.faces.push(new mp(L,p,B,null,null,x?2:1));var c=x?A.generateBottomUV(R,C,t,L,p,B):A.generateTopUV(R,C,t,L,p,B);R.faceVertexUvs[0].push(c)}function l(K,F,L,G,U,n,i,q,r){K+=d,F+=d,L+=d,G+=d,R.faces.push(new mp(K,F,G)),R.faces.push(new mp(F,L,G));var J=A.generateSideWallUV(R,C,U,t,K,F,L,G,n,i,q,r);R.faceVertexUvs[0].push([J[0],J[1],J[3]]),R.faceVertexUvs[0].push([J[1],J[2],J[3]])}var Z,g,x,h,k,P=t.amount,f=t.curveSegments||qm,H=t.steps||1,Q=t.extrudePath,V=!1,A=new Yi(t.repeatUVLength,t.boundingBox);Q&&(Z=Q.getSpacedPoints(H),V=!0,g=t.frames!==Y?t.frames:new jo.FrenetFrames(Q,H,!1),x=new Sr,h=new Sr,k=new Sr);var B,u,r,R=this,d=this.vertices.length,$=C.extractPoints(f),e=$.shape,s=$.holes,F=!ff.isClockWise(e);if(F){for(e=e.reverse(),u=0,r=s.length;r>u;u++)B=s[u],ff.isClockWise(B)&&(s[u]=B.reverse());F=!1}var U=ff.triangulateShape(e,s),O=e;for(u=0,r=s.length;r>u;u++)B=s[u],e=e.concat(B);for(var G,N,K=e.length,j=U.length,p=0;K>p;p++)G=e[p],V?(h.copy(g.normals[0]).multiplyScalar(G.x),x.copy(g.binormals[0]).multiplyScalar(G.y),k.copy(Z[0]).add(h).add(x),D(k.x,k.y,k.z)):D(G.x,G.y,0);var q;for(q=1;H>=q;q++)for(p=0;K>p;p++)G=e[p],V?(h.copy(g.normals[q]).multiplyScalar(G.x),x.copy(g.binormals[q]).multiplyScalar(G.y),k.copy(Z[q]).add(h).add(x),D(k.x,k.y,k.z)):D(G.x,G.y,P/H*q);o(),a()};var jo=function(p,u,l,W,F){function H(U,N,p){return v.vertices.push(new Sr(U,N,p))-1}Xd.call(this),u=u||64,l=l||1,W=W||8,F=F||!1;var j,e,B,U,E,$,D,z,K,V,k,m,G,x,n,r,q,b,N,J,t=[],v=this,T=u+1,M=new Sr,S=new jo.FrenetFrames(p,u,F),g=S.tangents,Y=S.normals,Q=S.binormals;for(this.tangents=g,this.normals=Y,this.binormals=Q,K=0;T>K;K++)for(t[K]=[],U=K/(T-1),z=p.getPointAt(U),j=g[K],e=Y[K],B=Q[K],V=0;W>V;V++)E=V/W*o,$=-l*a(E),D=l*A(E),M.copy(z),M.x+=$*e.x+D*B.x,M.y+=$*e.y+D*B.y,M.z+=$*e.z+D*B.z,t[K][V]=H(M.x,M.y,M.z);for(K=0;u>K;K++)for(V=0;W>V;V++)k=F?(K+1)%u:K+1,m=(V+1)%W,G=t[K][V],x=t[k][V],n=t[k][m],r=t[K][m],q=new lh(K/u,V/W),b=new lh((K+1)/u,V/W),N=new lh((K+1)/u,(V+1)/W),J=new lh(K/u,(V+1)/W),this.faces.push(new mp(G,x,r)),this.faceVertexUvs[0].push([q,b,J]),this.faces.push(new mp(x,n,r)),this.faceVertexUvs[0].push([b.clone(),N,J.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};jo.prototype=fk(wd),jo.FrenetFrames=function(r,F,W){function q(){C[0]=new Sr,e[0]=new Sr,G=Number.MAX_VALUE,B=P(f[0].x),w=P(f[0].y),$=P(f[0].z),G>=B&&(G=B,u.set(1,0,0)),G>=w&&(G=w,u.set(0,1,0)),G>=$&&u.set(0,0,1),Y.crossVectors(f[0],u).normalize(),C[0].crossVectors(f[0],Y),e[0].crossVectors(f[0],C[0])}var L,G,B,w,$,n,v,u=new Sr,f=[],C=[],e=[],Y=new Sr,U=new ai,H=F+1,Z=1e-4;for(this.tangents=f,this.normals=C,this.binormals=e,n=0;H>n;n++)v=n/(H-1),f[n]=r.getTangentAt(v),f[n].normalize();for(q(),n=1;H>n;n++)C[n]=C[n-1].clone(),e[n]=e[n-1].clone(),Y.crossVectors(f[n-1],f[n]),Y.length()>Z&&(Y.normalize(),L=J(sk(f[n-1].dot(f[n]),-1,1)),C[n].applyMatrix4(U.makeRotationAxis(Y,L))),e[n].crossVectors(f[n],C[n]);if(W)for(L=J(sk(C[0].dot(C[H-1]),-1,1)),L/=H-1,f[0].dot(Y.crossVectors(C[0],C[H-1]))>0&&(L=-L),n=1;H>n;n++)C[n].applyMatrix4(U.makeRotationAxis(f[n],L*n)),e[n].crossVectors(f[n],C[n])};var Eg=function(P,n,l,G){Xd.call(this),n=n||18,l=l||0,G=G==F?o:G;for(var W=1/(P.length-1),f=1/n,r=0,j=n;j>=r;r++)for(var z=l+r*f*G,B=a(z),E=A(z),s=0,T=P.length;T>s;s++){var k=P[s],Y=new Sr;Y.x=B*k.x-E*k.y,Y.y=E*k.x+B*k.y,Y.z=k.z,this.vertices.push(Y)}for(var N=P.length,r=0,j=n;j>r;r++)for(var s=0,T=P.length-1;T>s;s++){var m=s+N*r,h=m,g=m+N,B=m+1+N,C=m+1,X=r*f,Q=s*W,c=X+f,O=Q+W;this.faces.push(new mp(h,C,g)),this.faceVertexUvs[0].push([new lh(X,Q),new lh(X,O),new lh(c,Q)]),this.faces.push(new mp(g,C,B)),this.faceVertexUvs[0].push([new lh(c,Q),new lh(X,O),new lh(c,O)])}this.mergeVertices(),hf(this),this.computeFaceNormals(),this.computeVertexNormals()};Eg.prototype=fk(wd);var fd=function(n,y){y=y||{};var q=Ih.generateShapes(n,y);y.amount=y.amount!==Y?y.amount:.5,y.convertYZ=!1,y.fill!==!1&&(y.bottom=!0,y.top=!0),Bk.call(this,q,y)};fd.prototype=fk(Qo);var vl=R.Node=function(){ag(vl,this)},te={X:ms,Y:pp,Z:ng},ei={X:0,Y:1,Z:2},kk={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Fm=new Hl,bp="xzy",ih=function(L,m,M){if(m){var J=m[0],Z=m[1],s=m[2];"xzy"===M?(pp(L,Z),ng(L,s),ms(L,J)):"xyz"===M?(ng(L,s),pp(L,Z),ms(L,J)):"yxz"===M?(ng(L,s),ms(L,J),pp(L,Z)):"yzx"===M?(ms(L,J),ng(L,s),pp(L,Z)):"zxy"===M?(pp(L,Z),ms(L,J),ng(L,s)):"zyx"===M?(ms(L,J),pp(L,Z),ng(L,s)):(pp(L,Z),ng(L,s),ms(L,J))}};jh("Node",Yk,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:bp,_64O:0,_rotationX:0,_53O:0,_host:F,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return mm},_22Q:function(){return Xs},getX:function(){return this.p().x},setX:function(y){this.p(y,this.p().y)},getY:function(){return this.p().y},setY:function(w){this.p(this.p().x,w)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(V){this.setAnchor(V,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(L){this.setAnchor(this.getAnchor().x,L)},getScaleX:function(){return this.getScale().x},setScaleX:function(C){this.setScale(C,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(x){this.setScale(this.getScale().x,x)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},setQuaternion:function(f){var K=(new le).setFromQuaternion(f,le.ReverseOrder(this.getRotationMode()));return this._applyClosestR3(K.x,K.y,K.z)},getQuaternion:function(){var y=new le,Q=new le,r=new Hl;return function(z){return z||(z=new Hl),this.getEuler(y),y.equals(Q)?z.copy(r):z.copy(r.setFromEuler(Q.copy(y)))}}(),getEuler:function(e){var k=this.r3();return e||(e=new le),e.set(k[0],k[1],k[2],le.ReverseOrder(this.getRotationMode()))},setEuler:function($){return $=$.clone().reorder(le.ReverseOrder(this.getRotationMode())),this.r3($.x,$.y,$.z)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(m,X){Lp(m,Be(F,F,this.r3(),this.getRotationMode())),this.translate3d(m[0]*X,m[1]*X,m[2]*X)},translateFront:function(p){this.translate3dBy([0,0,1],p)},translateBack:function($){this.translate3dBy([0,0,-1],$)},translateLeft:function(e){this.translate3dBy([-1,0,0],e)},translateRight:function(j){this.translate3dBy([1,0,0],j)},translateTop:function(f){this.translate3dBy([0,1,0],f)},translateBottom:function(L){this.translate3dBy([0,-1,0],L)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(p,$,f){1===arguments.length&&($=p[1],f=p[2],p=p[0]),this.p(p,f),this.setElevation($)},translate3d:function(C,z,L){1===arguments.length&&(z=C[1],L=C[2],C=C[0]),this.translate(C,L),this.setElevation(this._54O+z)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(L,H,M){1===arguments.length&&(H=L[1],M=L[2],L=L[0]),this.setSize(L,M),this.setTall(H)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(g,a,E){var R=this;if(!R._updatingRotation3d){R._updatingRotation3d=1,1===arguments.length&&(a=g[1],E=g[2],g=g[0]);var P=[R._rotationX,-R._64O,R._53O];R._rotationX=g,R._64O=-a,R._53O=E,R.fp("rotation3d",P,[g,a,E]),delete R._updatingRotation3d}},_applyClosestR3:function(){function B(g){return g%=o,0>g&&(g+=o),g>d?o-g:g}function F(c,i){return B(c[0]-i[0])+B(c[1]-i[1])+B(c[2]-i[2])}return function(K,u,$){var f,x,p,P=this.r3(),l=this.getRotationMode();"xzy"===l||"yzx"===l?(f=K>0?K-d:K+d,x=u>0?u-d:u+d,p=$>0?d-$:-d-$):"xyz"===l||"zyx"===l?(f=K>0?K-d:K+d,p=$>0?$-d:$+d,x=u>0?d-u:-d-u):("yxz"===l||"zxy"===l)&&(p=$>0?$-d:$+d,x=u>0?u-d:u+d,f=K>0?d-K:-d-K),F([f,x,p],P)<F([K,u,$],P)?this.r3(f,x,p):this.r3(K,u,$)}}(),setRotationY:function(j){this.setRotation(-j)},getRotationY:function(){return-this._64O},lookAtDirection:function(p,m){m=m||Cn;var z=this,R=Gd(p);m===Cn?(z.r3([-f(p[1]/R),-jm(p[2],p[0])+Ie,0]),z.setRotationMode("xzy")):m===Me?(z.r3(0,-jm(p[2],p[0]),f(p[1]/R)),z.setRotationMode("zyx")):m===Qi?(z.r3(0,-jm(p[2],p[0])+d,-f(p[1]/R)),z.setRotationMode("zyx")):m===En?(z.r3([-f(p[1]/R)+Ie,-jm(p[2],p[0])+Ie,0]),z.setRotationMode("xzy")):m===Mr&&(z.r3([-f(p[1]/R)-Ie,-jm(p[2],p[0])+Ie,0]),z.setRotationMode("xzy")),m===Cb&&(z.r3([-f(p[1]/R)+d,-jm(p[2],p[0])+Ie,d]),z.setRotationMode("zxy"))},lookAt:function(U,n){return this.lookAtDirection(Ok(U,this.p3()),n)},lookAtX:function(){var S=new Pf,Q=new Pf,X=new Pf,G=new ai,F=new ai,L=new le;return function(N,s){var t=_j(this);if(G.fromArray(t),X.copy(this.p3()),S.copy(N).sub(X),!(S.lengthSq()<1e-6)){S.normalize(),s=s||Cn,"string"==typeof s?s===Cn?Q.set(0,0,1):s===Cb?Q.set(0,0,-1):s===Qi?Q.set(-1,0,0):s===Me?Q.set(1,0,0):s===En?Q.set(0,1,0):s===Mr&&Q.set(0,-1,0):Q.copy(s).normalize(),Q.applyMatrix4(G).sub(X).normalize();var h=Math.acos(S.dot(Q));if(h){var U=S.clone().cross(Q);U.lengthSq()<1e-6&&(s===En||s===Mr||0===s[0]&&0===s[1]?U.set(0,0,1).applyMatrix4(G).sub(X):U.set(0,1,0).applyMatrix4(G).sub(X)),U.normalize(),L.set(this.r3(),this.getRotationMode(),!0),G.makeRotationFromEuler(L),F.makeRotationAxis(U,-h),L.setFromRotationMatrix(F.multiply(G)),this._applyClosestR3(L.x,L.y,L.z)}}}}(),getHost:function(){return this._host},setHost:function(N){var z=this;if(z!==N&&z._host!==N){var c=z._host;c&&(c._removeAttach(z),c.updateLayoutAttaches()),z._host=N,z._host&&(z._host._addAttach(z),z._host.updateLayoutAttaches()),z.fp("host",c,N),z.onHostChanged(c,N)}},getAttaches:function(){return this._69O},_addAttach:function(Z){var Q=this;Q._69O||(Q._69O=new Hb),Q._69O.add(Z),Q.fp("attaches",F,Z)},_removeAttach:function(o){var v=this;v._69O.remove(o),v._69O.isEmpty()&&delete v._69O,v.fp("attaches",o,F)},getImage:function(){if(this._pendingCheckImageJSON){var k=x.getImage(this._image);k&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof zl&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(r){var d=this,D=d._image,n=d.getWidth(),l=d.getHeight();if(d._image=r,d.fp("image",D,r)){if(null!=r&&(gr(r)||Fn(r)&&/\.json$/i.test(r))&&(this._pendingCheckImageJSON=!0),ci)return;d.fp(jf,n,d.getWidth()),d.fp(xn,l,d.getHeight())}},getElevation:function(){return this._54O},setElevation:function(g){var v=this;if(!v._50O){v._50O=1;var o=v._54O;v._54O=g,v.fp(ri,o,g),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(w){var J=this;if(!J._49O){J._49O=1;var C=J._64O;J._64O=w,J.fp($o,C,w),delete J._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(p){var u=this;if(!u._51O){u._51O=1;var U=u._rotationX;u._rotationX=p,u.fp("rotationX",U,p),delete u._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(c){var Y=this;if(!Y._52O){Y._52O=1;var S=Y._53O;Y._53O=c,Y.fp("rotationZ",S,c),delete Y._52O}},getPosition:function(){return this._position},setPosition:function(r,R){var N=this;if(!N._50I){N._50I=1;var n;if(n=2===arguments.length?{x:r,y:R}:r,n.x!==N._position.x||n.y!==N._position.y){var G=N._position;N._position=n,N.fp(Pl,G,n)}delete N._50I}},translate:function(o,G){var Y=this._position;this.p(Y.x+o,Y.y+G)},getWidth:function(){var x=this;if(x._width>=0)return x._width;var K=x.getStyle("shape3d");if(K){var b=Kh(K);if(b&&b.rawS3)return b.rawS3[0];if("billboard"===K||"plane"===K){var c=ti(x.getStyle("shape3d.image"));
return c?Ro(c,x):20}}var c=ti(x._image);return c?Ro(c,x):20},setWidth:function(v){var d=this,h=d._width;d._width=v,d.fp(jf,h,v)},getHeight:function(){var g=this;if(g._height>=0)return g._height;var V=g.getStyle("shape3d");if(V){var r=Kh(V);if(r&&r.rawS3)return r.rawS3[2];if("plane"===V){var E=ti(g.getStyle("shape3d.image"));return E?Kb(E,g):20}if("billboard"===V)return 2}var E=ti(g._image);return E?Kb(E,g):20},setHeight:function(B){var g=this,p=g._height;g._height=B,g.fp(xn,p,B)},getTall:function(){var j=this;if(j._tall>=0)return j._tall;var D=j.getStyle("shape3d");if(D){var z=Kh(D);if(z&&z.rawS3)return z.rawS3[1];if("billboard"===D){var C=ti(j.getStyle("shape3d.image"));return C?Kb(C,j):20}if("plane"===D)return 2}return 20},setTall:function(b){var t=this,c=t._tall;t._tall=b,t.fp("tall",c,b)},setSize:function(k,z){var C=this;2===arguments.length?(C.setWidth(k),C.setHeight(z)):(C.setWidth(k.width),C.setHeight(k.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(r,G,v,B,d){var A=this,i=A.getAnchor(),f=A.getScale();arguments.length<=2&&(d=G,G=r.y,v=r.width,B=r.height,r=r.x);var k=d&&f.x<0?1-i.x:i.x,M=d&&f.y<0?1-i.y:i.y;A.p(r+v*k,G+B*M),d&&(v/=Math.abs(f.x),B/=Math.abs(f.y)),A.setWidth(v),A.setHeight(B)},getMatrix:function(){var p=this,m=p._64O,Q=p._position,i=p.getScale();return new Pn(m,Q.x,Q.y,i.x,i.y)},getMatrix4:function(){var l=new Pf,x=new Hl,E=new Pf;return function(Y){return this.getQuaternion(x),l.copy(this.p3()),E.copy(this.getFinalScale3d()),Y||(Y=new ai),Y.compose(l,x,E)}}(),getAnchorRect:function(){var E=this,L=E.getWidth(),b=E.getHeight(),m=E.getAnchor();return{x:-L*m.x,y:-b*m.y,width:L,height:b}},toLocal:function(e){return this.getMatrix().tfi(e)},toGlobal:function(h){return this.getMatrix().tf(h)},getAttachPosition:function(){var i=new Pn;return function(r,g,Q,F){Q=Q||0,F=F||0;var n=this,T=n.getAnchor(),C=n._64O,d=n._position,A=n.getScale();return i.setFromTransform(C,d.x,d.y).tf({x:Q+A.x*n.getWidth()*(r-T.x),y:F+A.y*n.getHeight()*(g-T.y)})}}(),isInRect:function(G){G=this.toLocal(G);var o=this.getWidth(),R=this.getHeight();return G.x+=o*this.getAnchorX(),G.y+=R*this.getAnchorY(),!(G.x<0||G.y<0||G.x>o||G.y>R)},getRect:function(){var T=this,t=T.getWidth(),u=T.getHeight(),s=T.getAnchor(),k={x:-t*s.x,y:-u*s.y,width:t,height:u},W=T.getMatrix();return k=To([W.tf(k.x,k.y),W.tf(k.x+k.width,k.y),W.tf(k.x+k.width,k.y+k.height),W.tf(k.x,k.y+k.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var x=this,H=x.getAnchor(),w=x._anchorElevation;return{x:H.x,y:w,z:H.y}},setAnchorElevation:function(W){var O=this,n=O._anchorElevation;return n!==W?(O._anchorElevation=W,O.fp("anchorElevation",n,W),!0):!1},setAnchor3d:function(k,_,q,M){var x,o=this;"number"==typeof k?x={x:k,y:_,z:q}:(x=k.length?{x:k[0],y:k[1],z:k[2]}:k,M=_),o.beginTransaction();var s=o.getAnchor3d(),S=o.setAnchor(x.x,x.z);if(o.setAnchorElevation(x.y)&&(S=!0),S&&M&&!ci){o.getAnchor3d();var z=_j(o),a=Lp([x.x-s.x,x.y-s.y,x.z-s.z],z);o.p3(a)}return o.endTransaction(),S},getAnchor:function(){var I=this;if(I.hasOwnProperty("_anchor"))return I._anchor;var z=ti(I._image);return z&&z.anchorX!==Y?{x:z.anchorX,y:z.anchorY}:I._anchor},setAnchor:function(w,x,W){var o,O=this;"number"==typeof w?o={x:w,y:x}:(o=w.length?{x:w[0],y:w[1]}:w,W=x);var $=O.getAnchor();if($.x!==o.x||$.y!==o.y){if(O.beginTransaction(),O._anchor=o,O.fp("anchor",$,o),W&&!ci){var q=O.getPosition(),V=O.getSize(),N=O.getRotation(),k=O.getScale(),s=-V.width*($.x-o.x)*k.x,g=-V.height*($.y-o.y)*k.y,i=A(N),_=a(N);O.setPosition(q.x+_*s-i*g,q.y+i*s+_*g)}return O.endTransaction(),!0}return!1},getLocalQuaternion:function(A){var J=this,n=J.getHost();if(!n)return J.getQuaternion(A);var k=n.getQuaternion(),i=J.getQuaternion();return A||(A=new Hl),A.copy(k).inverse().multiply(i)},setLocalQuaternion:function(B){var m=this,E=m.getHost();if(!E)return m.setQuaternion(B);var y=E.getQuaternion();m.setQuaternion(y.clone().multiply(B))},getLocalEuler:function(){var G=new Hl;return function(I){var l=this,z=l.getHost();return z?(l.getLocalQuaternion(G),I||(I=new le),I.setFromQuaternion(G,le.ReverseOrder(this.getRotationMode()))):l.getEuler(I)}}(),setLocalEuler:function(){var $=new Hl;return function(R){var t=this,p=t.getHost();return p?($.setFromEuler(R),t.setLocalQuaternion($)):t.setEuler(R)}}(),getLocalPosition3d:function(W){var Y=this;W||(W=new Pf),W.copy(Y.p3());var O=Y.getHost();if(!O)return W;var y=O.getMatrix4();return W.applyMatrix4(y.getInverse(y))},setLocalPosition3d:function($){var h=this,n=h.getHost();if(!n)return $.x!==Y?h.p3($.x,$.y,$.z):h.p3($),void 0;var G=n.getMatrix4(),f=new Pf($);f.applyMatrix4(G),h.p3(f.x,f.y,f.z)},getScale:function(){return this._scale},setScale:function(w,T){var $,p=this;$=2===arguments.length?{x:w,y:T}:w;var S=p.getScale();(S.x!==$.x||S.y!==$.y)&&(p._scale=$,p.fp("scale",S,$))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var w=this,l=w._scaleTall,n=w.getScale();return[n.x,l,n.y]},getFinalScale3d:function(){var o=this,z=o.s3(),c=o._dynamicScale3d,v=o.getScale3d();return z&&(v[0]*=z[0],v[1]*=z[1],v[2]*=z[2]),c&&(v[0]*=c[0],v[1]*=c[1],v[2]*=c[2]),v},getFinalRotation3d:function(){var Y=this;return Y._dynamicRotation||Y.r3()},setScaleTall:function(Y){var h=this,T=h._scaleTall;T!==Y&&(h._scaleTall=Y,h.fp("scaleTall",T,Y))},setScale3d:function(i,E,t){var o,K=this;o="number"==typeof i?{x:i,y:E,z:t}:i.length?{x:i[0],y:i[1],z:i[2]}:i,K.setScaleTall(o.y),K.setScale(o.x,o.z)},getCorners:function(Y,W){Y==F&&(Y=0),W==F&&(W=Y);var z=this,x=z.getAnchor(),p=z.getWidth(),h=z.getHeight(),S=-p*x.x-Y,Z=-h*x.y-W,T=p+2*Y,M=h+2*W,s=z.getMatrix();return[s.tf(S,Z),s.tf(S,Z+M),s.tf(S+T,Z+M),s.tf(S+T,Z)]},getEditControlPoints:function(A,T,j){T==F&&(T=0),j==F&&(j=T);var M=this,x=M.getAnchor(),t=M.getWidth(),f=M.getHeight(),a=-t*x.x-T,K=-f*x.y-j,_=t+2*T,H=f+2*j;if(A)return[{x:a,y:K},{x:a,y:0},{x:a,y:K+H},{x:0,y:K+H},{x:a+_,y:K+H},{x:a+_,y:0},{x:a+_,y:K},{x:0,y:K}];var q=M.getMatrix();return[q.tf(a,K),q.tf(a,0),q.tf(a,K+H),q.tf(0,K+H),q.tf(a+_,K+H),q.tf(a+_,0),q.tf(a+_,K),q.tf(0,K)]},rotateAt:function(F,f,o){var v=this,x=v._position,K=v._64O,n=new Pn(K,x.x,x.y).tf(F,f),s=z(F*F+f*f),L=jm(x.y-n.y,x.x-n.x)+o;v.setRotation(K+o),v.p(n.x+s*a(L),n.y+s*A(L))},rotateAroundAxis:function(m,J){this.setQuaternion(this.getQuaternion().multiply(Fm.setFromAxisAngle(m,J)))},rotateAroundWorldAxis:function(y,p){this.setQuaternion(this.getQuaternion().premultiply(Fm.setFromAxisAngle(y,p)))},rotateX:function(h){return this.rotateAroundAxis(Pf.AxisX,h)},rotateY:function(w){return this.rotateAroundAxis(Pf.AxisY,w)},rotateZ:function(K){return this.rotateAroundAxis(Pf.AxisZ,K)},onParentChanged:function(){vl.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var T={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(J){T[J]=!0}),function(M){var N=this;vl.superClass.onPropertyChanged.call(N,M);var t=M.property;if(T[t]&&!N._layoutUpdating&&N.updateLayoutParameters(null,t),N._69O&&N._69O.each(function(C){C.handleHostPropertyChange(M)}),N._49I&&N._49I.each(function(m){m.fp("agentChange",!0,!1)}),br[t]&&this.updateLayoutAttaches(),"a:layout"===t.substring(0,8)){this.updateLayoutAttaches();var h=N._host;h&&h.updateLayoutAttaches()}("s:shape3d.autorotate"===t||"s:autorotate"===t||"s:shape3d.fixSizeOnScreen"===t||"s:fixSizeOnScreen"===t||"s:hide.overlapping.group"===t)&&(N._47Q=N.s("autorotate")||N.s("shape3d.autorotate")||N.s("fixSizeOnScreen")||N.s("shape3d.fixSizeOnScreen")||N.s("hide.overlapping.group"))}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(S){this.updateAttach(S)},onStyleChanged:function(O){vl.superClass.onStyleChanged.apply(this,arguments),Pr[O]&&this.updateAttach()},updateLayoutAttaches:function(){if(!ci&&this.s("vector.layoutable")){var e,k,d=this;return e=ti(d.getImage()),e&&e.layoutAttach&&(k=e.layoutAttach,k&&k(d))?!0:void 0}},updateAttach:function(H){var M=this;return ci?(M.updateLayoutParameters(),void 0):(M._51I||(M._51I=1,M._71O(H),delete M._51I),void 0)},_71O:function(x){var v,D,q,n,Q,r,A=this,O=A._host,Z=x?x.property:F,l=x?x.oldValue:F,K=x?x.newValue:F;if(O instanceof vl&&(!x||br[Z])){var y;if(y=ti(O.getImage()),y&&y.layoutAttach)return}if(O instanceof R.Grid){if(Z===ri)A.setElevation(A._54O+K-l);else if(!x||er[Z]){if(v=A.s("attach.row.index"),D=A.s("attach.column.index"),q=O.getCellRect(v,D),!q)return;n=A.s("attach.row.span"),Q=A.s("attach.column.span"),(1!==n||1!==Q)&&(q=ek(q,O.getCellRect(v+n-1,D+Q-1))),Le(q,A,"attach.padding",1),A.setRect(q)}}else if(O instanceof Hq&&(r=A.s("attach.index"))>=0&&(!x||ph[Z])){var o=A.s("attach.thickness"),z=O.getScale(),T=Math.max(z.x,z.y);o>0&&A.setHeight(O.getThickness()*o*T);var _=A.s("attach.offset"),M=O.getPoints(),X=M.size();if(X>r){var t=O.getPointsMatrix2d(),c=M.get(r),Y=X===r+1?M.get(0):M.get(r+1);c=t.apply(c),Y=t.apply(Y);var V=[Y.x-c.x,Y.y-c.y],J=Gd(V);if(J){A.s("attach.offset.relative")&&(_*=J),A.s("attach.offset.opposite")&&(_=J-_);var C={x:c.x+V[0]/J*_,y:c.y+V[1]/J*_},f=A.s("attach.gap");f&&(A.s("attach.gap.relative")&&(f*=O.getThickness()*T),C=Jb(F,C,Y,f)),A.p(C),A.setRotation(jm(V[1],V[0]))}}}else x&&(Z===Pl?A.translate(K.x-l.x,K.y-l.y):Z===ri?A.setElevation(A._54O+K-l):Lq[Z]?"rotation3d"===Z?A.syncRotation3d(O,K,l):A._11Q(O,Z,K-l):("anchor"===Z||"width"===Z||"height"===Z||"scale"===Z)&&A.layout(O))},_11Q:function(){var m=new R.Math.Euler,v=R.Math.Euler.ReverseOrder,U=new R.Math.Vector2,c=new R.Math.Vector2;return function(X,Y,w){var N=this,h=X.p3(),R=X.r3(),s=N.p3(),y=N.r3();if(Y===$o&&(Y="rotationY",w=-w),(Y===$o||"rotationY"===Y)&&0===y[0]&&0===y[2]&&0===R[0]&&0===R[2]&&0===s[1]&&0===h[1])return N.setRotation(-y[1]-w),U.set(s[0],s[2]).rotateAround(c.set(h[0],h[2]),-w),N.p(U.x,U.y),void 0;var l=kk[X.getRotationMode()],Q=l[0],V=l[1],r=l[2],n=te[Q],C=te[V],o=te[r],O=vc();Y===$o+Q?(o(O,R[ei[r]]),C(O,R[ei[V]]),n(O,w),C(O,-R[ei[V]]),o(O,-R[ei[r]])):Y===$o+V?(o(O,R[ei[r]]),C(O,w),o(O,-R[ei[r]])):Y===$o+r&&o(O,w);var S=Ok(s,h);Lp(S,O),N.p3(h[0]+S[0],h[1]+S[1],h[2]+S[2]);var G=N.getRotationMode();ih(O,N.r3(),G),m.setFromRotationMatrix(O,v(G)),N.r3([m.x,m.y,m.z])}}(),syncRotation3d:function(){var z=new Hl,i=new le,Y=new Pf;return function(I,o,O){var M=this;if(O[0]!==o[0]||O[1]!==o[1]||O[2]!==o[2]){var S=le.ReverseOrder(I.getRotationMode());Fm.setFromEuler(i.set(O[0],O[1],O[2],S)),z.setFromEuler(i.set(o[0],o[1],o[2],S)),z.multiply(Fm.inverse());var n=I.p3(),w=M.p3();Y.set(w[0]-n[0],w[1]-n[1],w[2]-n[2]).applyQuaternion(z),M.p3(n[0]+Y.x,n[1]+Y.y,n[2]+Y.z),M.setQuaternion(M.getQuaternion(Fm).premultiply(z))}}}(),isHostOn:function(c){var u=this;if(u._host&&c&&c._69O)for(var j={},J=u._host;J&&J!==u&&!j[J._id];){if(J===c)return!0;j[J._id]=J,J=J._host}return!1},isLoopedHostOn:function(o){return this.isHostOn(o)&&o.isHostOn(this)},getScaledSize:function(){var L=this.getSize(),D=this.getScale();return L.width*=Math.abs(D.x),L.height*=Math.abs(D.y),L},layout:function(d){if(d=d||this.getHost()){var g=this,s=g.s("layout.h")||"center",K=g.s("layout.v")||"center";if("center"!==s||"center"!==K){var G=new R.Math.Vector2,S=d.getPosition(),_=d.getAnchor(),H=d.getScaledSize();g.getPosition();var n,i,C,u,W,z=1,r=1;switch(g._layoutUpdating=!0,s){case"left":G.setX(g._layoutHValue-_.x*H.width);break;case"right":G.setX((1-_.x)*H.width-g._layoutHValue);break;case"leftright":n=H.width-g._layoutHValue[2],C=g.getRotation()-d.getRotation(),u=Math.abs(Math.sin(C)),W=Math.abs(Math.cos(C)),z+=W*n/g._layoutHValue[3],r+=u*n/g._layoutHValue[4],G.setX(g._layoutHValue[1]+(g._layoutHValue[5]-_.x)*H.width);break;case"center":G.setX((.5-_.x)*H.width-g._layoutHValue);break;case"scale":C=g.getRotation()-d.getRotation(),u=Math.abs(Math.sin(C)),W=Math.abs(Math.cos(C)),G.setX((.5-_.x)*H.width-g._layoutHValue[1]*H.width/g._layoutHValue[0]),i=H.width/g._layoutHValue[2]-1,z+=W*i,r+=u*i}switch(K){case"top":G.setY(g._layoutVValue-_.y*H.height);break;case"bottom":G.setY((1-_.y)*H.height-g._layoutVValue);break;case"topbottom":C||(C=g.getRotation()-d.getRotation(),u=Math.abs(Math.sin(C)),W=Math.abs(Math.cos(C))),n=H.height-g._layoutVValue[2],z+=u*n/g._layoutVValue[3],r+=W*n/g._layoutVValue[4],G.setY(g._layoutVValue[1]+(g._layoutVValue[5]-_.y)*H.height);break;case"center":G.setY((.5-_.y)*H.height-g._layoutVValue);break;case"scale":C||(C=g.getRotation()-d.getRotation(),u=Math.abs(Math.sin(C)),W=Math.abs(Math.cos(C))),G.setY((.5-_.y)*H.height-g._layoutVValue[1]*H.height/g._layoutVValue[0]),i=H.height/g._layoutVValue[2]-1,z+=u*i,r+=W*i}if("leftright"===s||"scale"===s||"topbottom"===K||"scale"===K){var q=this.getScale(),N=Math.abs(q.x),I=Math.abs(q.y);"leftright"===s||"scale"===s?g.setSize(g._layoutHValue[3]*z/N,g._layoutHValue[4]*r/I):g.setSize(g._layoutVValue[3]*z/N,g._layoutVValue[4]*r/I)}G.rotateAround(null,d.getRotation()),this.setPosition(G.x+S.x,G.y+S.y),g._layoutUpdating=Y}}},updateLayoutParameters:function(D,k){if(D=D||this.getHost()){var Q=this,o=Q.s("layout.h"),L=Q.s("layout.v");if(o||L){var j,t,F,r,C,c,O=new R.Math.Vector2,B=D.getPosition(),u=D.getAnchor(),J=D.getScaledSize(),v=Q.getPosition(),f=Q.getScaledSize();switch(O.set(v.x-B.x,v.y-B.y),O.rotateAround(null,-D.getRotation()),o){case"left":Q._layoutHValue=O.x+u.x*J.width;break;case"right":Q._layoutHValue=-O.x+(1-u.x)*J.width;break;case"center":Q._layoutHValue=-O.x+(.5-u.x)*J.width;break;case"leftright":case"scale":"scale"===o?j=-O.x+(.5-u.x)*J.width:(t=Q.getAnchor(),F=Q.getRotation()-D.getRotation(),r=Math.cos(F),C=Math.sin(F),c=-Math.min(-t.x*r+t.y*C,-t.x*r-(1-t.y)*C,(1-t.x)*r+t.y*C,(1-t.x)*r-(1-t.y)*C),j=O.x-(c-u.x)*J.width),"position"===k&&"object"==typeof Q._layoutHValue?(Q._layoutHValue[0]=J.width,Q._layoutHValue[1]=j):Q._layoutHValue=[J.width,j,J.width,f.width,f.height,c]}switch(L){case"top":Q._layoutVValue=O.y+u.y*J.height;break;case"bottom":Q._layoutVValue=-O.y+(1-u.y)*J.height;break;case"center":Q._layoutVValue=-O.y+(.5-u.y)*J.height;break;case"topbottom":case"scale":"scale"===L?j=-O.y+(.5-u.y)*J.height:(F||(t=Q.getAnchor(),F=Q.getRotation()-D.getRotation(),r=Math.cos(F),C=Math.sin(F)),c=-Math.min(-t.x*C-t.y*r,-t.x*C+(1-t.y)*r,(1-t.x)*C-t.y*r,(1-t.x)*C+(1-t.y)*r),j=O.y-(c-u.y)*J.height),"position"===k&&"object"==typeof Q._layoutVValue?(Q._layoutVValue[0]=J.height,Q._layoutVValue[1]=j):Q._layoutVValue=[J.height,j,J.height,f.width,f.height,c]}}}},getSerializableProperties:function(){var c=vl.superClass.getSerializableProperties.call(this);return je(c,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),c}});var qo=R.Edge=function($,B){var H=this;ag(qo,H),H.setSource($),H.setTarget(B)};jh("Edge",Yk,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return Or},_22Q:function(){return Zs},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(l){if(l===this)return!1;if(Im(l))return!0;for(var Z,u,k,o,D,X=[this],y=-1,b=0;b>y;)if(y++,Z=X[y],u=Z._44I)for(u=u.getArray(),o=0,D=u.length;D>o;o++)if(k=u[o],Ye(k)&&!(X.indexOf(k)>=0)){if(k===l)return!1;X.push(k),b++}return!0},setSource:function(u){var m=this;if(m._source!==u&&m.canSetSourceTarget(u)){var D=m._source;m._source=u,D&&D._16I(m),u&&u._2I(m),m._7I(),m.fp("source",D,u)}},setTarget:function(J){var j=this;if(j._target!==J&&j.canSetSourceTarget(J)){var Z=j._target;j._target=J,Z&&Z._18I(j),J&&J._4I(j),j._7I(),j.fp("target",Z,J)}},isLooped:function(){var V=this;return V._source===V._target&&Im(V._source)&&Im(V._target)},onPropertyChanged:function(){var O=this;O._49I&&O._49I.each(function(M){M.fp("agentChange",!0,!1)})},_7I:function(){var B,W=this,G=Tp(W);W._40I!==G&&(B=this._40I,B&&B._15I(W),W._40I=G,G&&G._1I(W),W.fp("sourceAgent",B,G),zo(B,W._41I),zo(G,W._41I));var D=Ag(W);W._41I!==D&&(B=W._41I,B&&B._17I(W),W._41I=D,D&&D._3I(W),W.fp("targetAgent",B,D),zo(B,W._40I),zo(D,W._40I))},_22I:function(S){this._52I=S,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var T=this;return T._52I&&T._52I.get(0)!==T&&!T.getStyle(lg)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var y=this,i=y._52I;return i&&!y.getStyle(lg)&&i.size()>1&&y===i.get(0)},toggle:function(){this.beginTransaction();var d=this._52I,J=!this.s(lg);d&&d.size()>1&&(d.each(function(N){N.s(lg,J)}),d.getSiblings().each(function(b){b!==d&&b.each(function(N){N.fp("edgeGroup",F,b)})})),this.endTransaction()},setStyle:function(B,J){(B===cm||"edge.segments"===B)&&(J=Fo(J)),qo.superClass.setStyle.call(this,B,J)},onStyleChanged:function(n){qo.superClass.onStyleChanged.apply(this,arguments),yj[n]&&zo(this._41I,this._40I)},getSerializableProperties:function(){var w=qo.superClass.getSerializableProperties.call(this);return je(w,{source:1,target:1}),w}});var Uc=R.Group=function(){ag(Uc,this)};jh("Group",vl,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return ki},onChildAdded:function(){Uc.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){Uc.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var C=this;if(!C._54I&&!ci){var y=C.getChildrenRect();y&&(C._53I=1,C.p(Am(C.s("group.position"),y,C.getSize())),delete C._53I)}},getChildrenRect:function(){var I,q=this;return q.eachChild(function(h){Im(h)&&(I=ek(I,q.getChildRect(h)))}),I},getChildRect:function(w){var L;return Im(w)&&w.s(Sn)&&(tf(w)&&w.isExpanded()&&w.eachChild(function(k){L=ek(L,w.getChildRect(k))}),!L&&w.getRect&&(L=w.getRect())),L},setPosition:function(s,Q){var n=this;if(!n._54I){var E;E=2===arguments.length?{x:s,y:Q}:s,ci||n._53I||(n._54I=1,Vm(n._children,E.x-n._position.x,E.y-n._position.y),delete n._54I),Uc.superClass.setPosition.call(this,E)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(F){var _=this;if(_._57O!==F){var h=_._57O;_._57O=F,_.fp("expanded",h,_._57O),_._fireInvalidateDeep(),_._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(H){tf(H)?H._fireInvalidateDeep():H.iv()})},_8I:function(){Uc.superClass._8I.call(this),this.eachChild(function(r){Im(r)&&r._8I()})},onStyleChanged:function(I){Uc.superClass.onStyleChanged.apply(this,arguments),"group.position"===I&&this._81I()},getSerializableProperties:function(){var k=Uc.superClass.getSerializableProperties.call(this);return k.expanded=1,k}});var ds=R.Camera=function(){ag(ds,this),this.s({"shadow.cast":!1,"shadow.receive":!1,shape3d:"billboard"}),this._viewMatrix=new ze.Matrix4,this._projectMatrix=new ze.Matrix4,this.setScale3d(1,1,-1),this.setCullingMask("main,top"),this._projectMatrixDirty=!0};ds.CubeDirectionParam=[1,0,0,0,-1,0,-1,0,0,0,-1,0,0,1,0,0,0,1,0,-1,0,0,0,-1,0,0,1,0,-1,0,0,0,-1,0,-1,0],jh("Camera",vl,{_22Q:function(){return Camera3dUI},attachRenderTarget:function(r){this._projectMatrixDirty=!0,this.renderTarget=r},detachRenderTarget:function(){this._projectMatrixDirty=!0,this.renderTarget=null},setCullingMask:function(c){var w=c.split(",");this._cullingMask=cd(w)},isLayerVisible:function(t){var x=Tn[t];return x&&Zb(this._cullingMask,x.mask)},isOrtho:function(){return"ortho"===this.s("camera.type")&&!this.isCube()},isCube:function(){return this.renderTarget&&this.renderTarget.isCube()},isPerspective:function(){return!this.isOrtho()},setViewMatrix:function(){var r=new R.Math.Matrix4,Y=new R.Math.Euler;return function(v){var n=this;v.isMatrix4?n._viewMatrix.copy(v):n._viewMatrix.fromArray(v),r.getInverse(n._viewMatrix),n.p3(r.getPosition().toArray()),Y.set(0,0,0,n.getRotationMode(),!0).setFromRotationMatrix(r),n.r3([Y.x,Y.y,Y.z])}}(),getViewMatrix:function(c){var F=this,C=Be(null,null,F.r3(),F.getRotationMode(),F.p3()),M=F._viewMatrix;return M.fromArray(C).getInverse(M),M.toArray(c)},setProjectMatrix:function(o){var N=this;o.isMatrix4?N._projectMatrix.copy(o):N._projectMatrix.fromArray(o),o=N._projectMatrix.getElements(),N.isOrtho()?N.s({"camera.near":(o[14]+1)/o[10],"camera.far":(o[14]-1)/o[10],"camera.ortho.width":2/o[0]}):N.s({"camera.near":o[14]/(o[10]-1),"camera.far":o[14]/(o[10]+1),"camera.fovy":2*Math.atan(1/o[5]),"camera.aspect":o[5]/o[0]}),N._projectMatrixDirty=!1},onPropertyChanged:function(L){var s=this;ds.superClass.onPropertyChanged.call(s,L);var e=L.property;("s:camera.near"===e||"s:camera.far"===e||"s:camera.fovy"===e||"s:camera.aspect"===e||"s:camera.ortho.width"===e)&&(s._projectMatrixDirty=!0)},getProjectMatrix:function(){var u=this;if(u._projectMatrixDirty){var b=u.gv,E=u.isCube(),X=E?1:u.s("camera.aspect")||(b?b.getAspect():null)||x.graph3dViewAspect,L=u.s("camera.near")||(b?b.getNear():null)||x.graph3dViewNear,r=u.s("camera.far")||(b?b.getFar():null)||x.graph3dViewFar,z=vc();if(u.isOrtho()){var V=u.s("camera.ortho.width")||(b?b.getOrthoWidth():null)||x.graph3dViewOrthoWidth,y=V/2,W=y/X;Ee(z,-y,y,-W,W,L,r)}else{var g=E?Math.PI/2:u.s("camera.fovy")||(b?b.getFovy():null)||x.graph3dViewFovy;Rd(z,g,X,L,r)}u._projectMatrix.fromArray(z),u._projectMatrixDirty=!1}return u._projectMatrix.toArray()},lookAt:function(b,W){var y=this.p3();return b.x?this.lookAtDirection([b.x-y[0],b.y-y[1],b.z-y[2]],W):this.lookAtDirection([b[0]-y[0],b[1]-y[1],b[2]-y[2]],W)},lookAtDirection:function(){var n=new R.Math.Matrix4,b=new R.Math.Euler,T=new R.Math.Vector3,H=new R.Math.Vector3;return function(X,N){n.lookAtDirection(T.copy(X).multiplyScalar(-1),N?H.copy(N):H.set(0,1,0)),b.set(0,0,0,this.getRotationMode(),!0).setFromRotationMatrix(n),this.r3([b.x,b.y,b.z])}}(),render:function(_){var i=this,d=_.getGL();if(!d)return!1;var J,t,F=i.renderTarget;if(F)J=F.width,t=F.height;else{var W=_.getDevicePixelRatio();J=_.getWidth()*W,t=_.getHeight()*W}i.gv=_,_._camera=i;var R=_._frameState.renderState.glState,u=R.color.clear.slice(0);oh(d,i.s("camera.background"));var S=_.getEye;if(_.getEye=function(){return i.p3()},i.isCube())for(var U=ds.CubeDirectionParam,c=0;6>c;c++)F&&F.bind(d,c),i.lookAtDirection([U[6*c+0],U[6*c+1],U[6*c+2]],[U[6*c+3],U[6*c+4],U[6*c+5]]),d.clear(d.COLOR_BUFFER_BIT),_.setViewport(d,0,0,J,t),i.s("camera.onlySky")?_.renderSky():_.renderScene({renderAxis:i.s("camera.renderAxis"),renderGrid:i.s("camera.renderGrid"),renderEdit:i.s("camera.renderEdit"),renderReflector:!1}),F&&F.unbind(d);else F&&F.bind(d),d.clear(d.COLOR_BUFFER_BIT),_.overlappingBox.clear(),_.setViewport(d,0,0,J,t),i.s("camera.onlySky")?_.renderSky():_.renderScene({renderAxis:i.s("camera.renderAxis"),renderGrid:i.s("camera.renderGrid"),renderEdit:i.s("camera.renderEdit")}),F&&F.unbind(d);return _.getEye=S,oh(d,u),_._camera=null,i.gv=null,!0}});var tm=R.Block=function(){ag(tm,this),this.s({"shadow.cast":!1,"shadow.receive":!1})};jh("Block",vl,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Xo},_22Q:function(){return Ys},onChildAdded:function(){tm.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){tm.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},_getBoundingBox:function(){function B(q,j,S){l.fromArray(_j(j));var z=j.getAnchor3d();q.push((new Pf).set(0-z.x,0-z.y,0-z.z).applyMatrix4(l).applyMatrix4(S)),q.push((new Pf).set(0-z.x,0-z.y,1-z.z).applyMatrix4(l).applyMatrix4(S)),q.push((new Pf).set(0-z.x,1-z.y,0-z.z).applyMatrix4(l).applyMatrix4(S)),q.push((new Pf).set(0-z.x,1-z.y,1-z.z).applyMatrix4(l).applyMatrix4(S)),q.push((new Pf).set(1-z.x,0-z.y,0-z.z).applyMatrix4(l).applyMatrix4(S)),q.push((new Pf).set(1-z.x,0-z.y,1-z.z).applyMatrix4(l).applyMatrix4(S)),q.push((new Pf).set(1-z.x,1-z.y,0-z.z).applyMatrix4(l).applyMatrix4(S)),q.push((new Pf).set(1-z.x,1-z.y,1-z.z).applyMatrix4(l).applyMatrix4(S))}function j(o,D){var s=(new ai).makeRotationFromEuler(this.getEuler()).setPosition((new Pf).fromArray(this.p3()));s.getInverse(s),o.forEach(function(q){Im(q)&&B(D,q,s)})}var l=new ai;return function(S,N){if(S instanceof vl&&(S=[S]),!S||0===S.length)return F;var N=[];j.call(this,S,N);var D=[1/0,1/0,1/0],$=[-1/0,-1/0,-1/0];return N.forEach(function(f){D[0]=Math.min(f.x,D[0]),D[1]=Math.min(f.y,D[1]),D[2]=Math.min(f.z,D[2]),$[0]=Math.max(f.x,$[0]),$[1]=Math.max(f.y,$[1]),$[2]=Math.max(f.z,$[2])}),{min:D,max:$}}}(),updateFromChildren:function(){var _=this;if(!ci&&!_._updatingToChildren&&_._syncSize&&0!==_.size()&&!_._freezeSyncFromChildren){var Z=this._getBoundingBox(_.toChildren(Im));if(Z){_._updatingFromChildren=1;var h=(new Pf).fromArray(this.getScale3d()),E=(new Pf).fromArray(Z.min),A=(new Pf).fromArray(Z.max),B=x.blockMinSize,m=new Pf,g=A.clone().sub(E);0===g.x&&m.setX(.5),0===g.y&&m.setY(.5),0===g.z&&m.setZ(.5);var S=this._width==F||-1===this._width,r=new Pf(this.getAnchor3d()),s=h.clone().multiply((new Pf).fromArray(this.s3())),I=g.clone();0===I.x&&I.setX(B),0===I.y&&I.setY(B),0===I.z&&I.setZ(B);var j=r.clone().multiply(s),Q=j.clone().multiplyScalar(-1).sub(E).divide(I).add(j.divide(I)).add(m),R=this.s("keepPosition");if(S||this._anchorChanged||this._scaleChanged||!R){!S&&R&&(r=Q);var M=r.clone().multiply(g).add(E).applyEuler(this.getEuler()).add((new Pf).fromArray(this.p3()));this.p3([M.x,M.y,M.z])}else this.setAnchor3d(Q.x,Q.y,Q.z);var Y=new Pf(1,1,1).divide(h).multiply(g);this.s3(Math.abs(Y.x),Math.abs(Y.y),Math.abs(Y.z)),delete _._updatingFromChildren}}},setPosition:function($,v){var Q=this;if(!Q._updatingToChildren){var Z;Z=2===arguments.length?{x:$,y:v}:$,ci||Q._updatingFromChildren||(Q._updatingToChildren=1,Vm(Q._children,Z.x-Q._position.x,Z.y-Q._position.y),delete Q._updatingToChildren),tm.superClass.setPosition.call(this,Z)}},setSize3d:function(){this.beginTransaction(),tm.superClass.setSize3d.apply(this,arguments),this.endTransaction()},setTall:function(R){var N=this;if(!N._updatingToChildren){this.beginTransaction(),R=O(R,x.blockMinSize);var Y=N.getTall();if(R!==Y&&tm.superClass.setTall.call(N,R),!ci&&!N._updatingFromChildren){N._updatingToChildren=1;var z=R/Y;N._adjustChildTallOrScale(z,"size"),delete N._updatingToChildren,N.updateFromChildren()}this.endTransaction()}},setWidth:function(n){return this.setSize(n,this.getHeight())},setHeight:function(f){return this.setSize(this.getWidth(),f)},setSize:function(h,$){var J=x.blockMinSize;h=O(h,J),$=O($,J);var G=this;if(!G._updatingToChildren){2!==arguments.length&&($=h.height,h=h.width),this.beginTransaction();var m=G.getWidth(),l=G.getHeight();if(h!==m&&tm.superClass.setWidth.call(G,h),$!==l&&tm.superClass.setHeight.call(G,$),!ci&&!G._updatingFromChildren){G._updatingToChildren=1;var S=h/m,b=$/l;G._adjustChildScaleOrSize(S,b,"size"),delete G._updatingToChildren,G.updateFromChildren()}this.endTransaction()}},_adjustChildScaleOrSize:function(t,W,O){var o=this;if(o._syncSize){var f=o.getPosition(),D=o.getRotation();o.eachChild(function(q){if(Im(q)){var p=q.getPosition(),j=q.getRotation(),H=q.getWidth(),r=q.getHeight(),o=q.getScale(),g=o.x*H,E=o.y*r;if(0!==g&&0!==E){0>t*W&&q.setRotation(-1*j);var X=new Pn(j,p.x,p.y,g,E);X.translate(-f.x,-f.y),X.rotate(-D),j=jm(X.b*Math.sign(g),X.a*Math.sign(g)),X.scale(t,W);var U,Q,M,$=a(j);if(Math.abs($)<.001?(U=A(j),Q=X.b/U,M=-X.c/U):(Q=X.a/$,M=X.d/$),"scale"===O)q.setScale(Q/H,M/r);else if("size"===O){var C=Q/o.x,h=M/o.y;q.setScale(ip(Q)*Math.abs(o.x),ip(M)*Math.abs(o.y)),q instanceof R.Shape?(q.setWidthForce(Math.max(Math.abs(C),1e-5)),q.setHeightForce(Math.max(Math.abs(h),1e-5))):q.setSize(Math.max(.01,Math.abs(C)),Math.max(.01,Math.abs(h)))}X.rotate(D),X.translate(f.x,f.y),q.setPosition(X.tx,X.ty)}}})}},_calcChangeFactor:function(S,B,T,F){var X,r,Z,W;return X=P(S),r=P(T),Z=X>r?X/r:r/X,X=P(B),r=P(F),W=X>r?X/r:r/X,O(Z,W)},setElevation:function(j){var F=this;if(!F._updatingToChildren){var M=F.getElevation(),U=j-M;0!==U&&(ci||F._updatingFromChildren||(F._updatingToChildren=1,Vm(F._children,0,U,0),delete F._updatingToChildren),tm.superClass.setElevation.apply(F,arguments))}},setScaleTall:function(o){var h=this;if(!h._updatingToChildren){var E=h.getScaleTall();if(P(o)<.01&&(o=.01*(ip(o)||ip(E))),tm.superClass.setScaleTall.call(h,o),!ci&&!h._updatingFromChildren){h._updatingToChildren=1;var t=o/E;h._adjustChildTallOrScale(t,"scale"),delete h._updatingToChildren,h._scaleChanged=1,this.updateFromChildren(),delete h._scaleChanged}}},_adjustChildTallOrScale:function(t,D){var z=this;if(z._syncSize){var Q=z.getElevation();z.eachChild(function(P){if(Im(P)){if("size"===D){var F=P.getTall();0>t&&P.setScaleTall(-1*P.getScaleTall()),P.setTall(Math.max(.01,Math.abs(F*t)))}else{var a=P.getScaleTall();P.setScaleTall(a*t)}P.setElevation(Q+(P.getElevation()-Q)*t)}})}},setAnchor3d:function(){if(!this._updatingToChildren){this.beginTransaction();var C=tm.superClass.setAnchor3d.apply(this,arguments);return C&&!ci&&!this._updatingFromChildren&&this._syncSize&&(this._anchorChanged=1,this.updateFromChildren(),delete this._anchorChanged),this.endTransaction(),C}},setAnchor:function(){var o=this;if(!o._updatingToChildren){var v=o.getAnchor(),M=tm.superClass.setAnchor.apply(o,arguments);if(ci||o._updatingFromChildren||!o._syncSize)return M;o._updatingToChildren=1;var L=o.getAnchor();o.getPosition();var p=o.getSize(),b=o.getScale(),U=o.getRotation(),N=-p.width*b.x*(v.x-L.x),m=-p.height*b.y*(v.y-L.y),d=A(U),P=a(U),R=P*N-d*m,H=d*N+P*m;return o.eachChild(function(B){if(Im(B)){var l=B.getPosition();B.setPosition(l.x-R,l.y-H)}}),delete o._updatingToChildren,M}},setAnchorElevation:function(){var r=this;if(!r._updatingToChildren){var c=r.getAnchorElevation(),n=tm.superClass.setAnchorElevation.apply(r,arguments);if(ci||r._updatingFromChildren||!r._syncSize)return n;r._updatingToChildren=1;var h=r.getAnchorElevation(),S=r.getTall(),v=r.getScaleTall(),C=-S*v*(c-h);return r.eachChild(function(z){if(Im(z)){var w=z.getElevation();z.setElevation(w-C)}}),delete r._updatingToChildren,n}},setRotation:function(I){this._updateChildrenRotation3d("rotation",I)},setRotationX:function(B){this._updateChildrenRotation3d("rotationX",B)},setRotationZ:function(z){this._updateChildrenRotation3d("rotationZ",z)},setRotation3d:function(){var S=this;if(!S._updatingToChildren){var E=S.r3();tm.superClass.setRotation3d.apply(S,arguments);var $=S.r3();ci||S._updatingFromChildren||(S._updatingToChildren=1,S.eachChild(function(s){Im(s)&&s.syncRotation3d(S,$,E)}),delete S._updatingToChildren)}},_updateChildrenRotation3d:function(n,C){var o=this;if(!o._updatingToChildren){var w=o[sg(n)]();tm.superClass[_q(n)].call(o,C),ci||o._updatingFromChildren||this._updateRotationToChildren(n,C-w)}},_updateRotationToChildren:function(u,a){var Q=this;Q._updatingToChildren=1,Q.eachChild(function(G){Im(G)&&G._11Q(Q,u,a)}),delete Q._updatingToChildren},setScale:function(U,d){var w=this;if(!w._updatingToChildren){null==d&&(d=U.y,U=U.x);var o=w.getScale();if(P(U)<.01&&(U=.01*(ip(U)||ip(o.x))),P(d)<.01&&(d=.01*(ip(d)||ip(o.y))),tm.superClass.setScale.call(w,U,d),!ci&&!w._updatingFromChildren){w._updatingToChildren=1;var F=U/o.x,C=d/o.y;w._adjustChildScaleOrSize(F,C,"scale"),delete w._updatingToChildren,w._scaleChanged=1,w.updateFromChildren(),delete w._scaleChanged}}},onPropertyChanged:function(x){tm.superClass.onPropertyChanged.call(this,x),"s:3d.visible"===x.property&&this._invalidateChildrenBatch()},_invalidateChildrenBatch:function(){this.eachChild(function(z){(z.s("batch")||z.s("wf.geometry")||z.s("wf.visible"))&&z.iv(),z instanceof tm&&z._invalidateChildrenBatch()})},getSerializableProperties:function(){var _=tm.superClass.getSerializableProperties.call(this);return _.clickThroughEnabled=1,_.syncSize=1,_}});var sd=R.Grid=function(){ag(R.Grid,this)};jh("Grid",vl,{IRotatable:!1,_icon:"grid_icon",_image:F,getUIClass:function(){return Jn},setRotation:function(){},getCellRect:function(q,L){var X=this,b=X.s("grid.row.count"),R=X.s("grid.column.count");if(0>=b||0>=R||0>q||q>=b||0>L||L>=R)return F;
var A,Y,m,H=X.getRect(),d=X.s("grid.row.percents"),T=X.s("grid.column.percents");if(Le(H,X,"grid.border",-1),d&&d._as&&(d=d._as),T&&T._as&&(T=T._as),d&&d.length===b){for(m=0,A=0;q>A;A++)m+=H.height*d[A];H.y+=m,H.height=H.height*d[q]}else H.height=H.height/b,H.y+=H.height*q;if(T&&T.length===R){for(Y=0,A=0;L>A;A++)Y+=H.width*T[A];H.x+=Y,H.width=H.width*T[L]}else H.width=H.width/R,H.x+=H.width*L;return ge(H,-X.s("grid.gap")),H}});var Lk=R.Text=function(){ag(Lk,this),this.setSize(100,50),this.s("text","TEXT")};jh("Text",vl,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Ki},setWidth:function(z){z||(z=.001),Lk.superClass.setWidth.call(this,z)},setHeight:function(A){A||(A=.001),Lk.superClass.setHeight.call(this,A)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),We("__text__",{width:{value:100,isSafeFunc:!0,func:function(W){return W?W._width:100}},height:{value:50,isSafeFunc:!0,func:function(J){return J?J._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"},gradient:{func:"style@text.gradient"},gradientColor:{func:"style@text.gradient.color"},gradientPack:{func:"style@text.gradient.pack"},decoration:{func:"style@text.decoration"},vertical:{func:"style@text.vertical"},verticalGap:{func:"style@text.vertical.gap"}}]});var Hq=R.Shape=function(){ag(Hq,this),this._59O=new Hb};Hq.__de__=pf,jh("Shape",vl,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return $c},_22Q:function(){return $s},getLength:function(Q){return fp(fq(this._59O,this._58O,Q,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var x=this._58O;return x?new Hb(x._as.slice(0)):x},setSegments:function(h){var s=this._58O;h=h?Ub(h)?new Hb(h.slice(0)):new Hb(h._as.slice(0)):null,(s&&h&&s._as.join(",")!==h._as.join(",")||s!==h)&&(this._58O=h,this.fp("segments",s,h))},getPoints:function(){return this._59O},toPoints:function(){var r=this._59O;return new Hb(r._as.slice(0))},getPointsMatrix2d:function(){var _=this,$=new ze.Matrix2d,E=_.getPosition(),L=_.getScale(),n=_.getRotation();return $.translate(-E.x,-E.y).scale(L.x,L.y).rotate(n).translate(E.x,E.y),$},getPointsMatrix3d:function(){return function(){var B=this,S=new ze.Matrix4,_=S.getElements(),F=B.p3();gk(_,F),ih(_,B.getFinalRotation3d(),B.getRotationMode());var e=B.getScale3d(),V=B._dynamicScale3d;return V&&(e[0]*=V[0],e[1]*=V[1],e[2]*=V[2]),Ec(_,e),gk(_,vg(F)),S}}(),setPoints:function(t,C){var w=this,P=w._59O;t=t?Ub(t)?new Hb(t.slice(0)):new Hb(t._as.slice(0)):new Hb;var J,$,f,d,j,S;C&&(J=w.getPosition(),S=new Pn(w.getRotation(),0,0,w.getScale().x,w.getScale().y)),(P&&t&&P._as.join(",")!==t._as.join(",")||P!==t)&&(w._59O=t,w.fs(),w.fp("points",P,t)),C&&($=w.getPosition(),f=$.x-J.x,d=$.y-J.y,j=S.tf(f,d),w.setPosition($.x-f+j.x,$.y-d+j.y))},setPoints3d:function(H,N){var T=new Pf(this.p3()),z=this.getPointsMatrix3d();if(z.setPosition(new Pf),fo.superClass.setPoints.call(this,H),N){var O=new Pf(this.p3()),U=O.clone().sub(T).applyMatrix4(z);T.add(U),this.p3(T.x,T.y,T.z)}},addPoint:function(M,E,W){var b=this.toPoints();b.add(M,E),this.setPoints(b,W)},setPoint:function(A,f,R){var V=this.toPoints();V.set(A,f),this.setPoints(V,R)},removePointAt:function(g){var V=this.toPoints();V.removeAt(g),this.setPoints(V)},setWidthForce:function(y){var G=this;if(!G._55I&&!ci&&G.getWidth()){G._55I=1;var R=G._position.x,n=y/G.getWidth(),j=G.toPoints(),U=new Hb;1!==n&&(j.each(function(D){U.add({x:(D.x-R)*n+R,y:D.y,e:D.e})}),G.setPoints(U),jq(G,[n,0,0,1,R*(1-n),0]),G.fs()),delete G._55I}Hq.superClass.setWidth.call(G,y)},setWidth:function(q){return this.setWidthForce(mn>q?mn:q)},setHeightForce:function(Z){var X=this;if(!X._55I&&!ci&&X.getHeight()){X._55I=1;var U=X._position.y,B=Z/X.getHeight(),W=X.toPoints(),p=new Hb;1!==B&&(W.each(function(n){p.add({x:n.x,y:(n.y-U)*B+U,e:n.e})}),X.setPoints(p),jq(X,[1,0,0,B,0,U*(1-B)]),X.fs()),delete X._55I}Hq.superClass.setHeight.call(X,Z)},setHeight:function(p){return this.setHeightForce(mn>p?mn:p)},setAnchorElevation:function(j){var p=this;p._55I=!0;var D=p._updatingAnchor3d,w=!ci&&!D;if(w){var F,u=j,T=p.getAnchorElevation(),d=p.getTall();F=d*(T-u),0!==F&&p.shiftPointsElevation(F)}var B=Hq.superClass.setAnchorElevation.apply(p,arguments);return D||delete p._55I,B},getShapeElevation:function(){var z=this,p=z._54O;return p-(z.getTall()||0)*(z._anchorElevation-.5)},setAnchor3d:function(S,E,U,h){var G,k=this;if("number"==typeof S?G={x:S,y:E,z:U}:(G=S.length?{x:S[0],y:S[1],z:S[2]}:S,h=E),k._55I=!0,k._updatingAnchor3d=!0,k.beginTransaction(),!ci){var Y=k.getAnchor3d(),s=k.getSize(),v=k.getTall(),z=s.width*(Y.x-G.x),j=s.height*(Y.z-G.z),q=v*(Y.y-G.y);h||k.shiftPoints(z,j,q);var I=k.p3()}var J=Hq.superClass.setAnchor3d.apply(k,arguments);if(!ci&&h){var P=k.p3();k.shiftPoints(P[0]-I[0]+z,P[2]-I[2]+j,P[1]-I[1]+q)}return k.endTransaction(),delete k._updatingAnchor3d,delete k._55I,J},setAnchor:function(M,z,j){var g=this;g._55I=!0;var e=g._updatingAnchor3d,P=!ci&&!e;if(P){var m,w,G;"number"==typeof M?G={x:M,y:z}:(G=M.length?{x:M[0],y:M[1]}:M,j=z);var x=g.getAnchor(),K=g.getSize();m=K.width*(x.x-G.x),w=K.height*(x.y-G.y),j||g.shiftPoints(m,w);var l=g.getPosition()}var D=Hq.superClass.setAnchor.apply(g,arguments);if(P){var T=g.getPosition();j&&g.shiftPoints(T.x-l.x+m,T.y-l.y+w)}return e||delete g._55I,D},shiftPoints:function(r,P,_){if(r||P||_){var U=this,k=U.getElevation()||0,C=U.toPoints(),w=new Hb;C.each(function(X){var R=X.e;_&&(R=(R==F?k:R)+_),w.add({x:X.x+r,y:X.y+P,e:R})}),U.setPoints(w),U.fs()}},shiftPointsElevation:function(u){return this.shiftPoints(0,0,u)},setPosition:function(j,H){var n,c=this;if(!c._28Q){if(c._28Q=1,!c._55I&&!ci){n=2===arguments.length?{x:j,y:H}:j;var b=n.x-c._position.x,J=n.y-c._position.y;if(0===b&&0===J)return delete c._28Q,void 0;c._55I=1,c.shiftPoints(b,J),jq(c,[1,0,0,1,b,J]),delete c._55I}Hq.superClass.setPosition.apply(c,arguments),delete c._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var S=this;if(2!==S._59O.size())return!1;var u=S._58O;return u?2===u.size()&&1===u.get(0)&&2===u.get(1)?!0:!1:!0},fireShapeChange:function(){var H=this;if(!H._55I&&!ci){var J=To(H._59O);J&&(H._55I=1,H.setRect(J),delete H._55I)}H.fp(ad,!1,!0)},getSerializableProperties:function(){var A=Hq.superClass.getSerializableProperties.call(this);return A.segments=1,A.points=1,A.thickness=1,A.closePath=1,A}});var Po=R.Points=function(){ag(Po,this)};jh("Points",vl,{_59O:[],_colors:[],_sizes:[],_uvoffsets:[],_22Q:function(){return _s},getPoints:function(){return this._59O},setPoints:function(C){var u=this._59O;C=C?C.slice(0):[];var i=C[0];if(bs(i)){var V=C;C=[];for(var W=0,T=V.length;T>W;W+=3)C.push({x:V[W],e:V[W+1],y:V[W+2]})}this._59O=C,this._pointsDirty=!0,this.fp("points",u,this._59O)},setPoint:function(V,j){var f=this._59O.slice(0);f[V]=j,this.setPoints(f)},addPoint:function(D){this.setPoint(this._59O.length,D)},getColors:function(){return this._colors},setColors:function(y){var d=this._colors;y=y?y.slice(0):[],this._colors=y,this._colorsDirty=!0,this.fp("colors",d,y)},setPointColor:function(p,G){var H=this._colors.slice(0);H[p]=G,this.setColors(H)},getSizes:function(){return this._sizes},setSizes:function(H){var G=this._sizes;H=H?H.slice(0):[],this._sizes=H,this._sizesDirty=!0,this.fp("sizes",G,this._sizes)},setPointSize:function(V,P){var G=this._sizes.slice(0);G[V]=P,this.setSizes(G)},getUvoffsets:function(){return this._uvoffsets},setUvoffsets:function(L){var Y=this._uvoffsets;L=L?L.slice(0):[],this._uvoffsets=L,this._offsetsDirty=!0,this.fp("uvoffsets",Y,this._uvoffsets)},setPointUvoffset:function(r,P,T){var C;"object"==typeof P?(C=P[0],T=P[1]):C=P;var J=this._uvoffsets.slice(0);J[2*r+0]=C,J[2*r+1]=T,this.setUvoffsets(J)},getPointInfo:function(h){var s=this.getPoints();if(!s||s[h]==F)return F;var Y=s[h],S=[Y.x,Y.e,Y.y],B=this.mat||_j(this),b=[S[0],S[1],S[2]];Lp(b,B);var y=this.getColors(),j=y[h]||this.s("points.color"),c=this.getSizes(),i=c[h];return{size:i==F?this.s("points.size"):i,color:j,local:S,world:b}},getSerializableProperties:function(){var $=Po.superClass.getSerializableProperties.call(this);return $.points=1,$.colors=1,$.sizes=1,$.uvoffsets=1,$},onPropertyChanged:function(L){Po.superClass.onPropertyChanged.call(this,L);var i=L.property;"s:points.color"===i?this._colorsDirty=!0:"s:points.size"===i?this._sizesDirty=!0:"s:points.model"===i&&(this._modelDirty=!0)},getWidth:function(){var O=this;if(O._width>=0)return O._width;var o=O.getStyle("points.model");if(o){var i=Kh(o);if(i&&i.rawS3)return i.rawS3[0]}return 1},getHeight:function(){var o=this;if(o._height>=0)return o._height;var c=o.getStyle("points.model");if(c){var O=Kh(c);if(O&&O.rawS3)return O.rawS3[2]}return 1},getTall:function(){var Q=this;if(Q._tall>=0)return Q._tall;var b=Q.getStyle("points.model");if(b){var C=Kh(b);if(C&&C.rawS3)return C.rawS3[1]}return 1}});var fo=R.Polyline=function(){ag(fo,this),this.s({"shape.background":null,"shape.border.width":2})};jh("Polyline",Hq,{_icon:"polyline_icon",_22Q:function(){return ct},getUIClass:function(){return vn},setClosePath:function(){},setTall:function(j){var T=this;if(T.beginTransaction(),!T._55I&&!T._24Q&&!ci&&T.getTall()){T._24Q=1;var O=T._54O,I=j/T.getTall();if(1!==I){var i=T.toPoints(),A=new Hb;i.each(function(M){A.add({x:M.x,y:M.y,e:M.e==F?M.e:(M.e-O)*I+O})}),T.setPoints(A),T.fs()}delete T._24Q}fo.superClass.setTall.call(T,j),T.endTransaction()},setElevation:function(Q){var m=this;if(m.beginTransaction(),!m._55I&&!m._24Q&&!ci){m._24Q=1;var B=Q-m._54O;0!==B&&m.shiftPointsElevation(B),delete m._24Q}fo.superClass.setElevation.apply(m,arguments),m.endTransaction()},fireShapeChange:function(){var B=this,p=B._59O;if(!B._55I&&!B._24Q&&!ci){var g=p.size();if(g){var v=1,$=p.get(0),a=B._54O;$.e==F&&($.e=a);for(var G=$.e,k=0;g>v;v++){$=p.get(v),$.e==F&&($.e=a);var j=r(G,$.e),D=O(G+k,$.e);G=j,k=D-j}B._24Q=1,B.setTall(k),B.setElevation(G+k*B._anchorElevation),delete B._24Q}}fo.superClass.fireShapeChange.apply(B,arguments)}});var An=R.SubGraph=function(){ag(An,this)};jh("SubGraph",vl,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){An.superClass._8I.call(this),this.eachChild(function(U){Im(U)&&U._8I()})}}),x.loadingRefGraph=0;var zl=R.RefGraph=function(){ag(zl,this)};jh("RefGraph",tm,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(w){var W=this._ref;this._ref=w,this.fp("ref",W,w),this.updateRef()},_21I:function(){zl.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var k=this;if(x.loadingRefGraph++,k.clearChildrenFromDataModel(),x.loadingRefGraph--,k._ref&&k._dataModel){k._xhrLoadHandler&&(k._xhrLoadHandler.cancel=!0);var c=ci,o=k._xhrLoadHandler=function(N){if(N&&k._dataModel){x.loadingRefGraph++;var I=k._pendingUpdateInfo={needToRestore:c};c&&(I.p3=k.p3(),I.s3=k.s3(),I.r3=k.r3(),I.anchor3d=k.getAnchor3d(),I.scale3d=k.getScale3d()),k.r3(0,0,0),k.setScale3d(1,1,1),k.setAnchor3d(.5,.5,.5),k.p3(0,0,0);var G=x.parse(N),d=k._dataModel.deserialize(G,k,{justDatas:!0});d.each(function(w){w._refGraph=k}),k.checkPendingUpdateInfo(),x.loadingRefGraph--,x.handleRefGraphLoaded(k,d,G)}};o.xhrLoadCalled=!1,x.load(k._ref,function(K){o.cancel||(o.xhrLoadCalled?o(K):Di(function(){o(K)}))}),o.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var u=this,R=u._pendingUpdateInfo;if(!R)return u.onPendingUpdated&&(x.loadingRefGraph++,u.onPendingUpdated(),x.loadingRefGraph--),void 0;var m=!0;this.eachChild(function(K){(K._pendingCheckImageJSON||K._pendingUpdateInfo)&&(m=!1)}),m&&(x.loadingRefGraph++,u._pendingUpdateInfo=null,u.updateFromChildren(),R.needToRestore&&(u.setAnchor3d(R.anchor3d),u.setScale3d(R.scale3d),u.r3(R.r3),u.p3(R.p3)),this.getParent()instanceof zl&&this.getParent().checkPendingUpdateInfo(),u.onPendingUpdated&&u.onPendingUpdated(),x.loadingRefGraph--)},getSerializableProperties:function(){var U=zl.superClass.getSerializableProperties.call(this);return U.ref=1,U}}),R.EdgeGroup=function($,t){this._70O=$,this._siblings=t;for(var P,V,O=0,U=$.size(),M=Q[lg];U>O;O++)if(P=$.get(O).getStyle(lg,!1),P!=F){M=P;break}M==F&&(M=!0);var w=x.edgeGroupAgentFunc;for(w&&(V=w($),V&&V!==$.get(0)&&($.remove(V),$.add(V,0))),O=0;U>O;O++)$.get(O).s(lg,M)},jh("EdgeGroup",S,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(I){return this._70O.get(I)},indexOf:function(A){return this._70O.indexOf(A)},each:function(E,x){this._70O.each(E,x)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(n,w){this._siblings.each(function(a){a._70O.each(n,w)})}});var Rp=function(O,V,C){var L=oi[O]={type:O,action:V};if(C)for(var Y in C)L[Y]=C[Y]};je(x,{setConnectAction:Rp,getConnectAction:function(x,H){if(!H){if(!x)return null;H=x.getCurrentConnectActionType()}return oi[H]},doConnectAction:function(K,I,N,V){V=V||K.getCurrentConnectActionType();var O=oi[V];if(!O)return!1;var u=O.action;return u?(I instanceof Sm.Group?K.sm().getSelection().each(function(G){u.call(null,K,G,N)}):u.call(null,K,I,N),!0):!1},doDeleteConnectionAction:function(O,o,Y){Y=Y||O.getCurrentConnectActionType();var t=oi[Y];if(!t||!t.delete)return!1;var d=t.delete.action;return d?(o instanceof Sm.Group?O.sm().getSelection().each(function(B){d.call(null,O,B)}):d.call(null,O,o),!0):!1}});var sn=R.JSONSerializer=function(Z,p){this.dm=this._dataModel=Z,this._hierarchical=x.forceHierarchicalSerialization?!0:p==F?Z.isHierarchicalRendering():p};jh("JSONSerializer",S,{ms_ac:["hierarchical"],serialize:function($){return x.stringify(this.toJSON(),$)},toJSON:function(){var W,I=this,g=I.dm,w=g.getRoots(),H=I.json={v:x.getVersion(),p:{},a:{},d:[]},o=g.getSerializableAttrs();(W=g.getInit())&&(H.init=W),(W=g.getName())&&(H.p.name=W),(W=g.getBackground())&&(H.p.background=W),(W=g.getLayers())&&(H.p.layers=W),(W=g.getEnvmap())&&(H.p.envmap=W),(W=g.getEnvmapType())&&(H.p.envmapType=W),H.p.autoAdjustIndex=g.isAutoAdjustIndex(),H.p.hierarchicalRendering=g.isHierarchicalRendering();for(var j in o){var n=g.a(j);n!==Y&&I[dq](j,n,H.a)}return un(H.a)&&delete H.a,I._hierarchical?w.each(I.serializeData,this):g.each(function(H){I.serializeData(H)}),g.fireSerializeEvent({type:"serialize",json:H}),g.getPostProcessingData()&&(H.p.postProcessingData=g.getPostProcessingData()),H},isSerializable:function(){return!0},getProperties:function(S){return S.getSerializableProperties()},getStyles:function(l){return l.getSerializableStyles()},getAttrs:function(k){return k.getSerializableAttrs()},serializeData:function(Q){var s=this;if(s.isSerializable(Q)&&!Q._refGraph){var G,Y,V,n,f=nr(Q.getClassName())||Q.getClass(),d=new f,X={c:Q.getClassName(),i:Q.getId(),p:{},s:{},a:{}};s.json.d.push(X),G=s.getProperties(Q);for(Y in G)if(/^_/.test(Y)){if(V=Q[Y],!("_width"!==Y&&"_height"!==Y||V!=F&&-1!==V)){var B;((Q.s("layout.h")||Q.s("layout.v"))&&Q.getHost()||Q instanceof R.Node&&(B=Q.getParent())&&B instanceof R.Block||Q.s("fullscreen"))&&(V=Q[Y]="_width"===Y?Q.getWidth():Q.getHeight())}V!==d[Y]&&s[dq](Y.substr(1),V,X.p)}else n=sg(Y),Q[n]&&(V=Q[n](),V!==d[n]()&&s[dq](Y,V,X.p));G=s.getStyles(Q);for(Y in G)V=Q.s(Y),V!==d.s(Y)&&s[dq](Y,V,X.s);G=s.getAttrs(Q);for(Y in G)V=Q.a(Y),V!==d.a(Y)&&s[dq](Y,V,X.a);un(X.p)&&delete X.p,un(X.s)&&delete X.s,un(X.a)&&delete X.a}s._hierarchical&&Q.getChildren().each(s.serializeData,s)},serializeValue:function(x,j,t){ic(j)?j={__a:j._as}:j instanceof Yk?j={__i:j.getId()}:j instanceof dl&&(j={__dm:j.serialize(0)}),t[x]=j},deserialize:function(V,l,D){var t=this;return Fn(V)&&/.json$/.test(V)?(x.xhrLoad(V,function(s){t.deserializeImpl(s,l,D)}),void 0):t.deserializeImpl(V,l,D)},deserializeImpl:function(u,m,d){var V=this,a=V.dm;a.setDeserializing(!0),d=Um(d)?{setId:d}:nf(d)?{finishFunc:d}:d||{},u=V.json=Fn(u)?x.parse(u):u,!d.justDatas&&u.a&&u.a.onPreDeserialize&&!d.disableOnPreDeserialize&&u.a.onPreDeserialize(u,a,d.view),a.beginTransaction(),ci++,V._82I={};var R=new Hb,$=new Hb,I=0,c=u.d.length;if(d.justDatas||(!d.disableInit&&nf(u.init)&&u.init(a),a.setInit(u.init)),!d.justDatas){for(var P in u.a)a.a(P,V[Ho](u.a[P]));for(var g in u.p)a[_q(g)](u.p[g])}for(;c>I;I++){var y=u.d[I],C=nr(y.c),s=new C,w=y.i;d.setId&&w!=F&&(s._id=w),V._82I[w]=s,R.add(s),$.add(y)}for(I=0;c>I;I++)V.deserializeData(R.get(I),$.get(I));return R.each(function(V){m&&!V.getParent()&&V.setParent(m),a.add(V)}),d.__innerHandler__&&d.__innerHandler__(u,a,d.view,R),a.fireSerializeEvent({type:"deserialize",json:u}),ci--,a.endTransaction(),!d.justDatas&&u.a&&u.a.onPostDeserialize&&!d.disableOnPostDeserialize&&u.a.onPostDeserialize(u,a,d.view,R),d.finishFunc&&d.finishFunc(u,a,d.view,R),a.setDeserializing(!1),R},deserializeData:function(P,t){for(var R in t.p)P[_q(R)](this[Ho](t.p[R]));for(R in t.s)P.s(R,this[Ho](t.s[R]));for(R in t.a)P.a(R,this[Ho](t.a[R]))},deserializeValue:function(p){if(gr(p)){var V=p.__i;if(V!=F)return this._82I[V];if(V=p.__dm,V!=F){var v=new R.DataModel;return v.deserialize(V),v}if(V=p.__a,Ub(V))return new Hb(V)}return p}}),je(dl,{serialize:function(H,W){return new sn(this,W).serialize(H)},toJSON:function(t){return new sn(this,t).toJSON()},deserialize:function(q,T,B){return new sn(this).deserialize(q,T,B)}});var Ym=R.OverlappingBox=function($){this.gv=$,this.boxes={}};jh("OverlappingBox",S,{clear:function(){var r,S,I=this.boxes;for(r in I)S=I[r],S.length=0},isOverlapping:function(l,M){var k,v,T=this,s=T.boxes,F=s[l];F?(k=F.rects,v=F.length):F=s[l]={rects:k=[],length:v=0};var P,B,M;for(P=0;v>P;P++)if(B=k[P],B.x<M.x+M.w&&B.x+B.w>M.x&&B.y<M.y+M.h&&B.h+B.y>M.y)return!0;return k.length<=v?(k.push(M),F.length++):k[F.length++]=M,!1}}),je(x,{fetch:function(e,L){var t="GET",p=!1,d=null,D="";L&&(t=L.method||"GET",p=L.sync,D=L.url,d=L.data||null),e.open(t,D,!p),L.responseType?e.responseType=L.responseType:L.overrideMimeType&&e.overrideMimeType&&e.overrideMimeType(L.overrideMimeType),e.send(d)},convertImageSrc:function($,G){G&&"function"==typeof G||(G=function(){}),G($)}});var wq=R.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};jh("Request",S,{_responseType:null,_overrideMimeType:"text/plain",send:function(y){var j=this._xhr,Z=this.onload,f=this.onerror;this.getResponseType()?y.responseType=this.getResponseType():this.getOverrideMimeType()&&(y.overrideMimeType=this.getOverrideMimeType()),j.onload=Z,j.onerror=f,x.fetch(j,y)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(V){this._responseType=V},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(u){this._overrideMimeType=u},getResponseText:function(){var u=this._xhr;return u.response||u.responseText}}),vh.GraphView=function(p){var N=this;N._24I={},N._34I=new Hb,N.enableDirtyRect(),N._25I={},N._56I={},N._view=jb(1,N),N._canvas=Vl(N._view),N.dm(p?p:new dl),this._coreInteractor=new Rn(this),N.setEditable(!1),N.setScrollBarVisible(x.graphViewScrollBarVisible),N._initView()},en("GraphView",S,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[pi,_l,Re,af,"resettable","editInteractor",Ii,"zoomable","pannable","rectSelectable","autoScrollZone",Ue,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:x.graphViewZoomable,_resettable:x.graphViewResettable,_pannable:x.graphViewPannable,_rectSelectable:x.graphViewRectSelectable,_autoScrollZone:x.graphViewAutoScrollZone,_rectSelectBackground:x.graphViewRectSelectBackground,_rectSelectBorderColor:x.graphViewRectSelectBorderColor,_editPointSize:x.graphViewEditPointSize,_editPointBorderColor:x.graphViewEditPointBorderColor,_editPointBackground:x.graphViewEditPointBackground,_scrollBarColor:Jj,_scrollBarSize:xr,_autoHideScrollBar:yr,_autoMakeVisible:mc,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(G){this._dataModel.setLayers(G)},setEditable:function(i){var Z=this,E=Z.__interactorMap__;if(!E){var f=vh.XEditInteractor;E=Z.__interactorMap__={scrollBar:new po(Z),select:new _n(Z),edit:f?new f(Z):new ao(Z),text:new Ir(Z),move:new Vr(Z),"default":new wl(Z),touch:new di(Z,{editable:!1})}}i?(Z._uieditable=!0,Z.setInteractors([E.scrollBar,E.select,E.edit,E.text,E.move,E.default,E.touch])):(Z._uieditable=!1,Z.setInteractors([E.scrollBar,E.select,E.move,E.default,E.touch]))},getCanvas:function(){return this._canvas},_33I:function(i){var O=i.getUIClass();return O?new O(this,i):F},getDataUI:function(z){var i=this,U=i._25I[z._id];return U===Y&&(U=i._33I(z),i._25I[z._id]=U),U},getNodeRect:function(F){return x.getNodeRect(this,F)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(M){var B=this.getDataUI(M);return B?(B._79o(),B._78o):null},getEdgeSourcePosition:function(m){var c=this,w=c.getDataUI(m),r=w.s,J=w._data._40I;return lb(c,J,r("edge.source.position"),r("edge.source.offset.x"),r("edge.source.offset.y"),r("edge.source.anchor.x"),r("edge.source.anchor.y"))},getEdgeTargetPosition:function(x){var W=this,b=W.getDataUI(x),P=b.s,j=b._data._41I;return lb(W,j,P("edge.target.position"),P("edge.target.offset.x"),P("edge.target.offset.y"),P("edge.target.anchor.x"),P("edge.target.anchor.y"))},invalidateAll:function(l){var u=this;if(l){for(var f in u._25I){var N=u._25I[f];N&&N.dispose()}u._25I={},u._56I={},u._24I={},u._34I.clear(),u.redraw()}else u.dm().each(function(A){u.invalidateData(A)})},invalidateSelection:function(){var b=this;b.sm().each(function(m){b.invalidateData(m)})},invalidateData:function(k){var r=this;r._24I[k._id]=k,r._21Q(k),r.iv()},_21Q:function(k){var E=this,l=E._24I;if(Ye(k)&&Pp[k.s(Lf)]){var M=k.getSourceAgent();M&&M.getAgentEdges().each(function(k){l[k._id]=k}),M=k.getTargetAgent(),M&&M.getAgentEdges().each(function(Y){l[Y._id]=Y}),E.iv()}},redraw:function(d){var l=this;l._32I||(d?l._34I.add(d):(l._32I=1,l._34I.clear()),l.iv())},each:function($,L){var o,f,Q,H=0,k=this.getLayers(),X=this._dataModel,A=X._datas._as,x=A.length;if(k){for(var W=k.length;W>H;H++)if(Q=k[H],gr(Q)&&(Q=Q.name),X.isHierarchicalRendering()){var r=function(A){return A._layer===Q?L?$.call(L,A):$(A):void 0};if(this._dataModel.eachByHierarchical(r)===!1)return}else for(var t=0;x>t;t++)if(o=A[t],o._layer===Q&&(f=L?$.call(L,o):$(o),f===!1))return}else if(X.isHierarchicalRendering())this._dataModel.eachByHierarchical($,null,L);else for(;x>H;H++)if(o=A[H],f=L?$.call(L,o):$(o),f===!1)return},reverseEach:function(d,q){var n,w,L,A,i=this._dataModel,Y=i._layers,N=i._datas._as,F=N.length;if(Y){for(n=Y.length-1;n>=0;n--)if(A=Y[n],gr(A)&&(A=A.name),i.isHierarchicalRendering()){var k=function(F){return F._layer===A?q?d.call(q,F):d(F):void 0};if(i.reverseEachByHierarchical(k)===!1)return}else for(var z=F-1;z>=0;z--)if(w=N[z],w._layer===A&&(L=q?d.call(q,w):d(w),L===!1))return}else if(i.isHierarchicalRendering())i.reverseEachByHierarchical(d,null,q);else for(n=F-1;n>=0;n--)if(w=N[n],L=q?d.call(q,w):d(w),L===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var D=this,r=D._84I;if(!r){var $=this.dm().a("width"),X=this.dm().a("height");$>0&&X>0?D._84I={x:0,y:0,width:$,height:X}:(D.each(function(b){D.isVisible(b)&&(r=ek(r,D.getDataUIBounds(b)))}),D._84I=r?r:be)}return D._84I},getScrollRect:function(){return ek(this.getContentRect(),this._29I)},makeCenter:function(K,m,V){var C=this;if(!C.getWidth()||!C.getHeight())return V||Di(C.makeCenter,C,[K,m,!0],500),void 0;C.makeVisible(K),C.validate();var A=C.getDataUIBounds(K);if(A){var G=C.getWidth(),O=C.getHeight(),u=A.x+A.width/2,Q=A.y+A.height/2,E=-u*C._zoom+G/2,Y=-Q*C._zoom+O/2;C.setTranslate(E,Y,m)}},fitData:function(X,l,E,h,o){var p=this;if(!p.getWidth()||!p.getHeight())return o||Di(p.fitData,p,[X,l,E,h,!0],500),void 0;var B=function(){p.makeVisible(X),p.validate();var i=p.getDataUIBounds(X);i&&(i=Af(i),ge(i,E==F?20:E),p.fitRect(i,l,h))};l?x.callWhenLoaded(B):B()},fitContent:function(T,K,I,Z){var p=this;if(!p.getWidth()||!p.getHeight())return Z||Di(p.fitContent,p,[T,K,I,!0],500),void 0;var j=function(){p.validate();var t=Af(p.getContentRect());ge(t,K==F?20:K),p.fitRect(t,T,I)};T?x.callWhenLoaded(j):j()},fitRect:function(E,U,x){var e=this,P=e.getWidth(),I=e.getHeight(),m=E.x+E.width/2,k=E.y+E.height/2,w=r(P/E.width,I/E.height),j=e._zoom,Q=-m*j+P/2,a=-k*j+I/2;0===w||isNaN(w)||(x&&(w=r(1,w)),U?(e._65I&&(delete e._65I.finishFunc,e._65I.stop(!0)),e._14o&&e._14o.stop(!0),e.setTranslate(Q,a,{finishFunc:function(){e.setZoom(w,U)}})):(e.setTranslate(Q,a),e.setZoom(w)))},fitSelection:function(S,a,i){var e=this,T=e.sm(),t=null;T.size()&&(T.each(function(z){t=ek(e.getDataUIBounds(z),t)}),S&&ge(t,S),e.fitRect(t,a,i))},toCanvas:function(j,X,$){X=X||this._zoom,this.validateImpl();var s=this,K=s.getContentRect();$&&ge(K,$),K.width||(K.width=10),K.height||(K.height=10);var o=Vl(),_=K.x*X,p=K.y*X,r=Math.ceil(K.width*X),i=Math.ceil(K.height*X);Bh(o,r,i,1);var S=Se(o);j=j||this._dataModel.getBackground(),j&&ys(S,0,0,r,i,j),Yp(S,-_,-p),S.scale(X,X);var w=this._zoom;return this._zoom=X,s._42(S),this._zoom=w,S.restore(),o},toDataURL:function(X,s,W,U){return this.toCanvas(X,W,U).toDataURL(s||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(W,f){var t=this,Z=t.dm().getBackground();if(Z){var b=t.dm().a("width"),l=t.dm().a("height");b>0&&l>0&&ys(W,0,0,b,l,Z)}var w=t.__htmlOrderList,F=[],D=t._forcedLayoutHTML;if(t._93db(W,f),t.each(function(w){var x=t.getDataUI(w);if(x){var r=t._56I[w._id],i=x._htmlView;if(r){var j=x._79o();if(i=x._htmlView,R.HtmlNode&&w instanceof R.HtmlNode)x._42(W);else{var O=t.getViewRect(),J=i&&i.layoutHTML;!f||pd(f,j)?(J&&(i.layoutHTML(),x.__outerLayout&&delete x.__outerLayout),x._42(W)):pd(O,j)||!J||x.__outerLayout&&!D||(i.layoutHTML(),x.__outerLayout=!0)}}i&&(F.push(i),i.getView&&(i=i.getView()),i.style.display=r?"block":wo)}}),w&&F.length>0){var U=!1;if(w.length!==F.length)U=!0;else for(var K=0;K<F.length;K++)if(F[K]!==w[K]){U=!0;break}U&&(F.forEach(function(J){J.autoAdjustIndex!==!1&&t.appendHTML(J,!0)}),this.__htmlOrderList=F)}else this.__htmlOrderList=F;t._92db(W,f)},disableDirtyRect:function(){this._shouldRedrawAll=u},enableDirtyRect:function(){var o=this;o._shouldRedrawAll=function(){return o._32I}},validateImpl:function(){this.tryUpdateRootData();var q,A,U,v,T,d=this,f=d.tx(),D=d.ty(),g=d._zoom,y=d._canvas,L=this.getWidth(),u=this.getHeight(),E=d._29I,I={x:-f/g,y:-D/g,width:L/g,height:u/g},$={},R=d._34I,p=d._24I,h=d._shouldRedrawAll(),X=d._23I;d._24I={},(L!==y.clientWidth||u!==y.clientHeight)&&(Bh(y,L,u),h=1,d._forcedLayoutHTML=1),h||uc(I,E)||(h=1,d._forcedLayoutHTML=1),d._29I=I,d.each(function(N){A=N._id;var r=$[A]=d.isVisible(N);r!==d._56I[A]&&(p[A]=N,U=d.getDataUI(p[A]),U&&U._84o(r),d._84o(N,r))},d);for(A in p)U=d.getDataUI(p[A]),U&&(!h&&d._56I[A]&&(T=U._79o(),T&&R.add(T)),U.invalidate()),d._83I=1;if(d._56I=$,!h)for(A in p)$[A]&&(U=d.getDataUI(p[A]),U&&(T=U._79o(),T&&R.add(T)));if(h?v=I:(R.each(function(K){pd(I,K)&&(v=ek(v,K))}),v&&(ge(v,O(1,1/g)),v.x=Z(v.x*g)/g,v.y=Z(v.y*g)/g,v.width=N(v.width*g)/g,v.height=N(v.height*g)/g,v=pk(I,v))),d._74O=v,v&&0!==v.width&&0!==v.height){q=Se(y);var k=v.x,o=v.y,W=v.width,G=v.height;k=Math.floor((k*g+f)*Cf),o=Math.floor((o*g+D)*Cf),W=Math.ceil(W*g*Cf)+1,G=Math.ceil(G*g*Cf)+1,h||(v.x=(k/Cf-f)/g,v.y=(o/Cf-D)/g,v.width=W/Cf/g,v.height=G/Cf/g),q.beginPath(),q.rect(k,o,W,G),q.clip(),q.clearRect(k,o,W,G),zg(q,f,D,g),d._42(q,v),q.restore(),delete d._74O}if(R.clear(),delete d._32I,delete d._forcedLayoutHTML,X&&L>0&&u>0){var U=d.getDataUI(X);if(U){var T=U._79o(),V=d._29I,P=V.x,c=V.y,J=V.width,m=V.height,g=d._zoom;T&&!pd(T,V)&&(T.x+T.width<P&&d.tx(-T.x*g),T.x>P+J&&d.tx(-(T.x+T.width-J)*g),T.y+T.height<c&&d.ty(-T.y*g),T.y>c+m&&d.ty(-(T.y+T.height-m)*g))}delete d._23I}d._83I&&(delete d._83I,delete d._84I),d._98O(),d.countFrame(),un(d._24I)||Di(d.iv,d)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var X,b=this.getFullscreenDatas();for(var f in b)X=b[f],this.scaleRootData(X);this.onRootDataUpdated&&this.onRootDataUpdated(),this._rootDataUpdating=!1}},scaleRootData:function(s){var B=s.s("fullscreen");if("uniform"===B||"fill"===B){s.getRotation()&&s.setRotation(0);var O=s.s("fullscreen.gap")||0,M=this.getWidth(),j=this.getHeight();if(M&&j){var q,o,I,Y=M-2*O,e=j-2*O,f=s.getAnchor(),V=s.getScaledSize(),r=V.width,G=V.height,N=s.s("fullscreen.lock");if(N)return"uniform"===B?Y/e>r/G?(q=e/G,r=G*Y/e):(q=Y/r,G=r*e/Y):"v"===N?(q=e/G,r=Y/q,s.getWidth()!==r&&s.setWidth(r)):(q=Y/r,G=e/q,s.getHeight()!==G&&s.setHeight(G)),this.setZoom(q),o=O-(s.getX()-f.x*r)*q,I=O-(s.getY()-f.y*G)*q,o!==this.tx()&&this.tx(o),I!==this.ty()&&this.ty(I),void 0;o=this.tx(),I=this.ty(),q=this._zoom;var v={x:(-o+O)/q,y:(-I+O)/q,width:Y/q,height:e/q};if("uniform"===B){var y=r/G,x=Math.min(v.width,v.height*y),b=x/y;v.x+=.5*(v.width-x),v.y+=.5*(v.height-b),v.width=x,v.height=b}Y=v.width/s.getScaleX(),e=v.height/s.getScaleY(),(s.getWidth()!=Y||s.getHeight()!==e)&&s.setSize(Y,e);var z=v.x+f.x*v.width,C=v.y+f.y*v.height,p=s.getPosition();(z!==p.x||C!==p.y)&&s.setPosition(z,C)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(s){var q=this;s!==q.isScrollBarVisible()&&(s?(kf(q._view,q._79O=eo()),kf(q._79O,q._27I=eo()),kf(q._79O,q._28I=eo())):(yo(q._79O),delete q._79O,delete q._27I,delete q._28I),q.fp("scrollBarVisible",!s,s))},getDebugTip:function(){return""},showScrollBar:function(){var M=this;M._79O&&(M._85I||(bg(function(){M._86I()},Vh),M.iv()),M._85I=new Date)},_86I:function(){var w=this;if(w._85I){var S=new Date,F=S.getTime();F-w._85I.getTime()>=Vh?(delete w._85I,w.iv()):bg(function(){w._86I()},Vh)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var j=this,p=this._27I,B=this._28I;if(j._79O){if(j._autoHideScrollBar&&!j._85I)return p.style.visibility=Ff,B.style.visibility=Ff,void 0;var S=j.getScrollBarColor(),T=j._zoom,y=j.getScrollBarSize(),o=j.getViewRect(),K=j.getScrollRect(),V=o.height*T,Y=K.height*T,l=o.width*T-y-2,c=V*((o.y-K.y)*T/Y),N=V*(V/Y),J=p.style;Y-.5>V?(ws>N&&(c=c+N/2-ws/2,0>c&&(c=0),c+ws>V&&(c=V-ws),N=ws),Gk(p,l,c,y,N),J.visibility=Fi,J.background=S,J.borderRadius=y/2+Oq):J.visibility=Ff;var G=o.width*T,s=K.width*T,c=o.height*T-y-2,l=G*((o.x-K.x)*T/s),q=G*(G/s),J=B.style;s-.5>G?(ws>q&&(l=l+q/2-ws/2,0>l&&(l=0),l+ws>G&&(l=G-ws),q=ws),Gk(B,l,c,q,y),J.visibility=Fi,J.background=S,J.borderRadius=y/2+Oq):J.visibility=Ff}},setDataModel:function(b){var t=this,_=t._dataModel,z=t._selectionModel;_!==b&&(_&&(_.ump(t.handleDataModelPropertyChange,t),_.umm(t.handleDataModelChange,t),_.umd(t.handleDataPropertyChange,t),_.removeIndexChangeListener(t._75O,t),_.removeHierarchyChangeListener(t.handleHierarchyChange,t),z||_.sm().ums(t.handleSelectionChange,t)),t._dataModel=b,b.mp(t.handleDataModelPropertyChange,t),b.mm(t.handleDataModelChange,t),b.md(t.handleDataPropertyChange,t),b.addIndexChangeListener(t._75O,t),b.addHierarchyChangeListener(t.handleHierarchyChange,t),z?z._21I(b):b.sm().ms(t.handleSelectionChange,t),t.invalidateAll(!0),t.fp(Br,_,b),t.updateBackground())},getLayersInfo:function(){if(this._layersInfo===Y){var r=this.getLayers();r?(this._layersInfo={},r.forEach(function(s){var I=gr(s)?s.name:s;this._layersInfo[I]=s},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(i,R,M){var X,H,N=this,e=N.getDataUI(i),C=Gh(e),d=Ve(R,function(A){return Mg(C,100*A)
},100,.001),x=Mg(C,100*d);if(!M){var F=cp(e),U=new $g(x.x,x.y),n=49/(N._zoom*N._zoom);for(X=0,H=F.length;H>X;X++)if(U.distanceToSquared(F[X])<n)return{index:X,point:F[X],distance:Math.sqrt((F[X].x-R.x)*(F[X].x-R.x)+(F[X].y-R.y)*(F[X].y-R.y))}}return{percent:d,point:x,distance:Math.sqrt((x.x-R.x)*(x.x-R.x)+(x.y-R.y)*(x.y-R.y))}},calculateAttachPoint:function(){var v=new $g,x=new $g,h=new $g;return function(i,e){var z=this.getAttachPoints(i);if(!z||!z.length)return null;h.set(e.x,e.y);for(var A,B,S,M,m,d=1/0,f=0,y=z.length;y>f;f++)S=z[f],x.x=S.x,x.y=S.y,v.x=S.offsetX||0,v.y=S.offsetY||0,M=lb(this,i,0,v.x,v.y,x.x,x.y),B=h.distanceToSquared(M),d>B&&(A=f,d=B,m=M);d=Math.sqrt(d);var l=this.getAttachStyle(i);if("close"===l){var L=i.s("attach.close.threshold")/this._zoom;if(d>L)return null}return{index:A,distance:d,info:z[A],point:m}}}(),getAttachPoints:function(I){var n=I.s("attach.points");if(n)return n;var m=ti(I._image);return m?ur(m.attachPoints,I,this)||null:void 0},getAttachStyle:function(O){var y=O.s("attach.style");if(y)return y;var Y=ti(O._image);return Y?ur(Y.attachStyle,O,this)||"close":void 0},updateLayers:function(){this._layersInfo=Y,this.invalidateSelection(),this.redraw()},updateBackground:function(){var A=this.dm().a("width"),i=this.dm().a("height");this._canvas.style.background=A>0&&i>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(j){if("background"===j.property){var k=this._canvas.style.background,u=j.newValue||"";this.updateBackground(),this.fp("canvasBackground",k,u),this.redraw()}else"a:width"===j.property||"a:height"===j.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===j.property?this.updateLayers():"hierarchicalRendering"===j.property&&this.redraw()},handleDataPropertyChange:function(T){this.dm().isHierarchicalRendering()&&"parent"===T.property&&T.data.hasChildren()&&this.redraw(),this.invalidateData(T.data)},onPropertyChanged:function(Z){var Y=this,F=Z.property;if(Y.redraw(),"zoom"===F){var m=Y.sm().getSelection();m.size()&&m.each(function(U){U.invalidate()})}else"dataModel"===F&&(Y._83I=1);Ad[F]?Y.showScrollBar():F===Ii&&Y.onCurrentSubGraphChanged(Z)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(U){var S=this,Z=U.kind,N=U.data;if(S._83I=1,"add"===Z)S.invalidateData(N),Ye(N)&&N.getEdgeGroup()&&N.getEdgeGroup().eachSiblingEdge(S.invalidateData,S),N.getHost&&N.getHost()&&N.getHost().updateLayoutAttaches();else if(Z===Pq){S._21Q(N);var j=N._id,K=S._25I[j];if(K){if(S._56I[j]){var i=K._79o();i&&S.redraw(i)}K.dispose(),delete S._25I[j],delete S._24I[j],delete S._56I[j]}N===S._currentSubGraph&&S.setCurrentSubGraph(F)}else Z===Wk&&(S.invalidateAll(!0),S.setCurrentSubGraph(F))},_75O:function(x){this.invalidateData(x.data)},handleHierarchyChange:function(P){this.dm().isHierarchicalRendering()&&P.data.hasChildren()&&this.redraw(),this.invalidateData(P.data)},adjustIndex:function(v){var $=this;if($.isVisible(v)){$.dm().beginTransaction();for(var D=v;D._parent&&$.isVisible(D._parent);)D=D._parent;D&&D!==v&&$._dataModel.adjustIndex(D),$._dataModel.adjustIndex(v),$.dm().endTransaction()}},getImage:function(l){return l.getImage?l.getImage():Y},getSelectWidth:function(K){var S=ti(this.getImage(K));return S&&ur(S.disableSelectedBorder,K,this)?0:K.s("select.width")},getSelectColor:function(G){return G.s("select.color")},isSelectable:function(Z,x){if(this.isSelected(Z))return!0;if(!x&&Z.getParent()instanceof tm&&this.isSelectable(Z.getParent(),!0)&&Z.getParent().isSyncSize())return!1;var t=this.getLayersInfo();if(t){var l=t[Z._layer];if(l&&l.selectable===!1)return!1}return Z.s("2d.selectable")&&this.sm().isSelectable(Z)},isMovable:function(G){var e=this;if(Ye(G)&&G.getStyle(Lf)!==Kn)return!1;var B=this.getLayersInfo();if(B){var s=B[G._layer];if(s&&s.movable===!1)return!1}return G.s("2d.movable")?e._movableFunc?e._movableFunc(G):!0:!1},isEditable:function(J){var V=this;if(R._uiSerializing)return V._uieditable;if(!V._editInteractor||!V.isSelected(J))return!1;if(tf(J)){var C=V.getDataUI(J);if(!C||C._88I)return!1}if(Ye(J)&&J.getStyle(Lf)!==Kn)return!1;var A=this.getLayersInfo();if(A){var q=A[J._layer];if(q&&q.editable===!1)return!1}return J.s("2d.editable")?V._editableFunc?V._editableFunc(J):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(A){return Im(A)&&0!==A.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(A):!0},isRectEditable:function(s){return this._rectEditableFunc?this._rectEditableFunc(s):!0},isAnchorEditable:function(X){return this._anchorEditableFunc?this._anchorEditableFunc(X):!0},isRotationEditable:function(q){return q.setRotation&&q.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(q):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(u){var W=u.getAnchor(),k=u.getScale(),I=this._zoom,A=Ni(u.getRotation(),0,-u.getHeight()*k.y*W.y-(k.y<0?-1:1)*(Mc?32:16)/I),J=u.p();return A.x+=J.x,A.y+=J.y,A},getLogicalPoint:function(j){var g=this;return Oj(j,g._canvas,g.tx(),g.ty(),g._zoom,g._zoom)},getScreenPoint:function($,a){var U,q=this;return"object"==typeof $?$.x!==Y?(U=$.x,a=$.y):(U=$[0],a=$[1]):U=$,Oc(U,a,q._canvas,q.tx(),q.ty(),q._zoom,q._zoom)},getSelectedDataAt:function(z){var m=this;return this.getDataAt(z,function(H){return m.isSelected(H)})},getDataInfoAt:function(n,i,s){var a,L=this.lp(n),j=this.getDataAt(L,i,s);if(j){var U=this.getDataUI(j);a={data:j,ui:U,point:L};var p=U._38o;if(p){var Y=p.icons;for(var Z in Y){var h=Y[Z],O=p.rects[Z];if(O)for(var $=ur(h.names,j,this),_=$?$.length:0,E=O.rotation,u=_-1;u>=0;u--){var q=$[u],T=O[u];if(Kk(T,L,E))return a.part="icons",a.name=Z,a.icon=q,a.rect=T,a.index=u,a.rotation=E,a}}}if(this.isNoteVisible(j)){if(U.note2Info&&Kk(U.note2Info.clickRect,L,F,U.note2Info.scale))return a.part="note2",a;if(U.noteInfo&&Kk(U.noteInfo.clickRect,L,F,U.noteInfo.scale))return a.part="note",a}if(this.isLabelVisible(j)){if(U.label2Info&&Kk(U.label2Info.rect,L,U.label2Info.rotation,U.label2Info.scale))return a.part="label2",a;if(U.labelInfo&&Kk(U.labelInfo.rect,L,U.labelInfo.rotation,U.labelInfo.scale))return a.part="label",a}if(j.isInRect&&j.isInRect(L))return a.part="body",a}return a},getDataAt:function(l,Y,N){l.target&&(l=this.lp(l));var d,o=this._zoom;return this.reverseEach(function(G){return(Y?Y(G):this.isSelectable(G))&&this.rectIntersects(G,_e(l.x,l.y,N,o))?(d=G,!1):void 0},this),d},getIconInfoAt:function(e,N){var z=this;if(e.target&&(e=z.lp(e)),N||(N=z.getDataAt(e)),N){var b=z.getDataUI(N);if(b&&b._38o){var u,G=b._38o,m=new Hb;for(u in G.icons)m.add(u);for(var r=m.size()-1;r>=0;r--){u=m.get(r);for(var V=G.rects[u],y=V.rotation,f=V.length-1;f>=0;f--){var P=V[f],I=P.width,h=P.height,D={x:e.x-P.x-I/2,y:e.y-P.y-h/2};y!=F&&(D=Ni(-y,D.x,D.y));var P={x:-I/2,y:-h/2,width:I,height:h};if(Kk(P,D))return{key:u,index:f,name:G.icons[u].names[f],rect:V[f],point:e,rotation:y,relativeRect:P,relativePoint:D,data:N}}}}}return F},getDatasInRect:function(x,Q,p){p===Y&&(p=1);var _=this,W=new Hb;return _.reverseEach(function(M){p&&!_.isSelectable(M)||(Q?_.rectIntersects(M,x):_.rectContains(M,x))&&W.add(M)}),W},moveSelection:function(Q,e){var R=this;R.dm().beginTransaction(),Vm(R.sm().toSelection(R.isMovable,R),Q,e),R.dm().endTransaction()},moveDatas:function(X,f,G){var Z=this;Z.dm().beginTransaction(),X instanceof Hb||(X=new Hb(X)),Vm(X,f,G),Z.dm().endTransaction()},getDataUIBounds:function(J){var N=this.getDataUI(J);return N?N._79o():F},drawData:function(L,T,U){var u=this.getDataUI(T);if(u){var n=u._79o();(!U||pd(U,n))&&(u._42(L),T instanceof R.Block&&T.eachChild(function(x){this.isVisible(x)&&this.drawData(L,x,U)},this))}},getBoundsForGroup:function(G){return G.s(Sn)?this.getDataUIBounds(G):F},isPixelPerfect:function(p){return p.s("pixelPerfect")},rectIntersects:function(Z,t){this.validate();var l=F;if(this._56I[Z._id]){var q=this._25I[Z._id];if(q){var c=q._79o();if(ho(t,c))l=!0;else if((t=pk(t,c))&&(q.rectIntersects&&(l=q.rectIntersects(t)),l==F)){if(!this.isPixelPerfect(Z))return!0;var O=t.x,S=t.y,n=t.width,Y=t.height,D=this._zoom,A=x.hitMaxArea,g=n*Y*D*D;if(g>A){var i=Math.sqrt(A/g);D*=i}n*=D,Y*=D,2>n&&(n=2),2>Y&&(Y=2),O*=D,S*=D;var _=Od(n,Y);Yp(_,-O,-S),_.scale(D,D),this._drawForChecking=!0,this.drawData(_,Z,t),this._drawForChecking=!1;try{for(var R=0,b=_.getImageData(0,0,n,Y).data;R<b.length;R+=4)if(0!==b[R+3]){l=!0;break}_.restore()}catch(E){Bg=F,l=!1}}}}return l?!0:!1},rectContains:function(G,C){if(this._56I[G._id]){var V=this._25I[G._id];if(V)return ho(C,V._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(U){if(!x.isInput(U.target)){var t=this,F=t._focusData,k=F&&t._25I[F._id],B=0,M=t._dataModel._datas;if(!(F&&F._enabled&&F._editable&&k&&k.onKeyDown&&k.onKeyDown(U)===!0))if(9===U.keyCode&&(F&&(B=M.indexOf(F),eq(U)?-1===--B&&(B=0):++B===M.size()&&(B=0)),t._focusData=F=M.get(B),t.sm().setSelection(F)),fe(U)?t.selectAll():an(U)&&t.isResettable()&&t.reset(),t.sm().isEmpty()){if(t._editing)return;var d=t.tx(),P=t.ty(),Y=!1,g=eq()?100:10;pm(U)&&(d-=g,Y=!0),ce(U)&&(P-=g,Y=!0),hj(U)&&(d+=g,Y=!0),Hr(U)&&(P+=g,Y=!0),Y&&t.setTranslate(d,P)}else{Nb(U)&&t.handleDelete(U);var L=eq()?10:1;pm(U)&&(t.moveSelection(-L,0),t.fi({kind:"moveLeft"})),ce(U)&&(t.moveSelection(0,-L),t.fi({kind:"moveUp"})),hj(U)&&(t.moveSelection(L,0),t.fi({kind:"moveRight"})),Hr(U)&&(t.moveSelection(0,L),t.fi({kind:"moveDown"}))}}},handleScroll:function(S,K){if(cc(S),this.isZoomable()){if(!this.getEditInteractor()){var q=this.getDataAt(S);if(q){var O=ti(this.getImage(q));if(O&&ur(O.scrollable,q,this))return}}var j=this.lp(S);K>0?this.scrollZoomIn(j):0>K&&this.scrollZoomOut(j)}},handlePinch:function(A,$,n){this.isZoomable()&&(Math.abs($-n)<x.pinchZoomThreshold||($>n?this.pinchZoomIn(A):this.pinchZoomOut(A)))},checkDoubleClickOnNote:function(H,W){var e=this,q=e.lp(H),w=e.getDataUI(W),P=w.note2Info;return P&&W.s("note2.toggleable")&&Kk(P.clickRect,q)?(W.s(Gb,!W.s(Gb)),e.fi({kind:"toggleNote2",event:H,data:W}),!0):(P=w.noteInfo,P&&W.s("note.toggleable")&&Kk(P.clickRect,q)?(W.s(ol,!W.s(ol)),e.fi({kind:"toggleNote",event:H,data:W}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(x,V){var c=this,Y=c.getAutoScrollZone(),M=Y/c.getZoom(),H=Y/4,L=c._29I,o=c.lp(x),i={x:c.tx(),y:c.ty()};return o&&Y>0&&L&&(o.x-L.x<M?c.translate(H,0):L.x+L.width-o.x<M&&c.translate(-H,0),o.y-L.y<M?c.translate(0,H):L.y+L.height-o.y<M&&c.translate(0,-H)),i.x=c.tx()-i.x,i.y=c.ty()-i.y,V&&(V.x+=i.x,V.y+=i.y),i},getMoveMode:function(V,v){var I=v.s("2d.move.mode");return I?I:Qm["88"]?"x":Qm["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(g,x,F){var S=this;return"currentSubGraph"===x?{__i:g.getId()}:F.serializeProperty(g,x,S)},deserializeProperty:function(v,u,J){var y=this;if("currentSubGraph"===u){var d=y.dm(),l=d.__idMap;return l[v.__i]}return J.deserializeProperty(v,u,y)},setDefaultCursor:function(K,i){this._defaultCursor=K,i!==!1&&this.setCursor(K)},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(C){return C===F||x.getConnectAction(null,C)?(this._currentActionType=C,this.redraw(),!0):!1},getEditStyle:function(g){var s=this.getEditInteractor();return s?s.getStyle(g):Y},setEditStyle:function(V,b,s){var L=this.getEditInteractor();return L?(L.setStyle(V,b,s),!0):!1},isConnectActionVisible:function(s){var N=x.getConnectAction(this);if(!N)return!1;var U=N.visible;return nf(U)&&(U=U(this,s)),U},isInteractive:function(T){if(this._drawForChecking)return!1;var v=ti(this.getImage(T));return v&&ur(v.interactive,T,this)?!0:T.s("interactive")},getRenderingStyleIconName:function(){return wj},appendHTML:function(m,O){var b=this.getView();if(!(O||m&&m.parentNode!==b))return!1;var C=m.getView&&m.getView(),h=m.beforeCanvas;if(!O&&C&&C.parentNode===b)return!1;(m.getView||m.isSelfViewEvent)&&(m=m.getView());var z=this.getEditInteractor();return h?b.insertBefore(m,this.getCanvas()):z&&z._canvas?b.insertBefore(m,z._canvas):this.isScrollBarVisible()?b.insertBefore(m,this.getView().lastChild):kf(b,m),!0},_layoutHTMLImpl:function(z,C,W){if(arguments.length>1){var D,A=this,e=A._zoom;if(C.getView&&(D=C,C=C.getView()),C.style.position="absolute",W){var G=z.getRect();Gk(D||C,A.tx()+G.x*e,A.ty()+G.y*e,G.width*e,G.height*e)}else{var r=new Xj,G=z.getAnchorRect(),i=z.getPosition(),l=z.getScale(),$=C.style;Gk(D||C,G),r.appendTranslate(A.tx(),A.ty()),r.appendScale(e,e),r.append(new Xj(z.getRotation(),i.x,i.y,l.x,l.y)),wc($,"transform","matrix("+r.a.toFixed(5)+", "+r.b.toFixed(5)+", "+r.c.toFixed(5)+",\n    "+r.d.toFixed(5)+", "+r.tx.toFixed(5)+", "+r.ty.toFixed(5)+")"),wc($,"transformOrigin",(-G.x).toFixed(5)+"px "+(-G.y).toFixed(5)+"px"),C.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(A){return A instanceof Lk?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(j){var T="state",y=j.s(T);if(y)return y;var e=ti(j._image);return e?ur(e[T],j,this)||null:void 0},getShape:function(A){return A.getStyle(ad)}}),S.defineProperties(vh.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function($){this._layoutHTML=$}}});var ps=function(W,u){var V=this;V.gv=W,V.s=function(I){return u.getStyle(I)},V._data=u,V._87I=new Hb},wj=F;tr(ps,S,{_6I:F,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var E=this,L=E.gv.isSelected(E._data);return!L||E.isShadowed()?0:E.gv.getSelectWidth(E._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(n){var b=this._data,G=this.gv.getBodyColor(b);return G?G:n?b.getStyle(n):F},_2Q:function(O){return this.s(O)},_1Q:function(A,q,z,j){var k=this.s,S=k("2d.gray"),J=k(q+".dash.color");if(S&&(J=x.toGrayColor(J)),A.strokeStyle=J,A.lineWidth=z,A.stroke(),k(q+".dash.3d")){var m=k(q+".dash.3d.color");ts(A,J,S?x.toGrayColor(m):m,z,this.gv._zoom,k(q+".dash.3d.accuracy"))}gq(A,j)},invalidate:function(){this._6I=F},_79o:function(){var r=this;if(!r._6I){var X=r._data,L=r.gv;r.labelInfo=r.label2Info=r.noteInfo=r.note2Info=r._38o=F,r._87I.clear(),r.interactiveInfo=L.isInteractive(X)?{}:F,r._3O(),r._55O=L.isEditable(X)?{_42O:L.isRectEditable(X),_43O:L.isPointEditable(X),_56O:L.isRotationEditable(X)}:F,r._6I=r._81o()}return r._6I},_3O:function(){},getPosition:function(){return be},_68o:function(s,I){s&&this._87I.add(em(s,I))},_81o:function(){var r=this,c=r.s;r._24O(Vq,"getLabel"),r._24O(el,"getLabel2"),r._26O(Jk,"getNote"),r._26O(vs,"getNote2"),r._15O(),r._55O&&r._48O();var f;if(r._87I.each(function(q){f=ek(f,q)}),f&&c("shadow.interactable")){var X=r.isShadowed(),Z=c("shadow2"),d=Af(f);Z?(d.x+=c("shadow2.offset.x"),d.y+=c("shadow2.offset.y"),ge(d,c("shadow2.blur"))):X&&(d.x+=c("shadow.offset.x"),d.y+=c("shadow.offset.y"),ge(d,c("shadow.blur"))),f=ek(f,d)}return r._87I.clear(),f},_42:function(s){var i=this,t=i._data,f=i.gv,B=i.s,o=B("opacity"),p=this.isShadowed(),h=B("shadow2");if(p||h){var T=s.shadowOffsetX,Z=s.shadowOffsetY,g=s.shadowBlur,d=s.shadowColor,L=f.getZoom()*x.devicePixelRatio,M=p?"shadow":"shadow2";s.shadowOffsetX=B(M+".offset.x")*L,s.shadowOffsetY=B(M+".offset.y")*L,s.shadowBlur=B(M+".blur")*L,s.shadowColor=p?i.getSelectColor():B(M+".color")}if(o!=F){var P=s.globalAlpha;s.globalAlpha=o}i._80o(s),f.isLabelVisible(t)&&((!f._drawForChecking||B("label.selectable"))&&Bs(s,i.labelInfo),(!f._drawForChecking||B("label2.selectable"))&&Bs(s,i.label2Info)),f.isNoteVisible(t)&&(ko(s,i.noteInfo),ko(s,i.note2Info)),i._99O(s),o!=F&&(s.globalAlpha=P),(p||h)&&(s.shadowOffsetX=T,s.shadowOffsetY=Z,s.shadowBlur=g,s.shadowColor=d)},_80o:function(){},_47O:function(){},_24O:function(I,K){var R=this,N=R._data,J=R.gv,M=R.s,z=J[K](N);if(z!=F){var O=M(I+".scale"),x=M(I+".max"),H=M(I+".position"),q=R[I+"Info"]={label:z,scale:O,color:J[K+"Color"](N),font:M(I+".font"),opacity:M(I+".opacity"),align:M(I+".align"),decoration:M(I+".decoration"),rotation:R.getRotation(M(I+".rotation"),!1,H),background:J[K+"Background"](N)},m=Oo(q,z);x>0&&x<m.width&&(q.labelWidth=m.width,m.width=x),1!==O&&(m.width*=O,m.height*=O);var Z=R.getPosition(H,M(I+".offset.x"),M(I+".offset.y"),m,M(I+".position.fixed"));if(m.x=Z.x-m.width/2,m.y=Z.y-m.height/2,R._68o(q.rect=m,q.rotation),1!==O){var c=m.width/O,S=m.height/O;q.rect={x:Z.x-c/2,y:Z.y-S/2,width:c,height:S}}}},_26O:function(v,i){var m=this,Q=m.gv,U=m._data,y=m.s,w=Q[i](U);if(w!=F){var $,M,J=y(v+".scale"),g=m[v+"Info"]={note:w,scale:J,data:U,view:Q,expanded:y(v+".expanded"),font:y(v+".font"),color:y(v+".color"),opacity:y(v+".opacity"),align:y(v+".align"),icon:y(v+".icon"),backgroundImage:y(v+".backgroundImage"),borderWidth:y(v+".border.width"),borderColor:y(v+".border.color"),background:Q[i+"Background"](U)},O=m.getPosition(y(v+".position"),y(v+".offset.x"),y(v+".offset.y")),R=O.x,I=O.y;if(g.expanded){var X,Z=y(v+".max"),S=y(v+".backgroundImage");S?(S=ti(S),X={width:Ro(S,U),height:Kb(S,U)}):X=Oo(g,w),X.width+=6,X.height+=2,Z>0&&Z<X.width&&(g.labelWidth=X.width,X.width=Z),$=X.width,M=X.height+8,g.clickRect={x:R-$*J/2,y:I-M*J,width:$*J,height:M*J*X.height/M}}else{var t=y(v+".icon");t?(t=ti(t),$=Ro(t,U),M=Kb(t,U)):($=12,M=18),g.clickRect={x:R-$*J/2,y:I-M*J,width:$*J,height:M*J}}g.rect={x:R-$/2,y:I-M*J/2-M/2,width:$,height:M};var h=N(g.borderWidth/2)*J;m._68o({x:R-$*J/2-h,y:I-M*J-h,width:$*J+2*h,height:M*J+2*h})}},_48O:function(){},_99O:function(u){var H=this,Q=H._38o;if(Q){var c=H.gv,s=H._data,E=Q.icons,o=H.interactiveInfo;o&&(o._38o={});for(var w in E){var U=E[w],Y=Q.rects[w];if(Y){o&&(o._38o[w]=[]);var d=ur(U.opacity,s,c),x=ur(U.names,s,c),M=x?x.length:0,j=Y.rotation;if(d!=F){var L=u.globalAlpha;u.globalAlpha*=d}for(var V=0;M>V;V++){var h=x[V],m=ti(h),J=Y[V];if(j){var i=J.x+J.width/2,g=J.y+J.height/2;u.save(),Yp(u,i,g),Cq(u,j),Yp(u,-i,-g)}o&&o._38o[w].push(u.interactiveInfo={compInfos:[],matrix:j?new Xj(j,i,g).appendTranslate(-i,-g):new Xj});var a=wj;wj=w,sl(u,m,ur(U.stretch,s,c),J.x,J.y,J.width,J.height,H._data,H.gv),wj=a,u.interactiveInfo=F,j&&u.restore()}d!=F&&(u.globalAlpha=L)}}}}});var mm=function(l,c){ag(mm,this,[l,c])};tr(mm,ps,{_checkEmptyRect:!0,_40O:function(c,L){var S=this,Q=S.s,i=c.rect;(c.borderColor=S.gv.getBorderColor(S._data))&&(c.borderType=Q("border.type"),c.borderWidth=Q("border.width"),c.borderPadding=Q("border.padding"),L=O(L,c.borderPadding+c.borderWidth/2));var R=S._data.getScale(),t=O(1,O(P(R.x),P(R.y)));if(c.selectWidth=S.getSelectWidth()){var e=S.gv._zoom;c.selectType=Q("select.type"),c._97o=S.getSelectColor(),c.selectPadding=Q("select.padding"),L=O(L,(c.selectPadding+c.selectWidth/2/e)/t)}L>0&&(L*=t,i=Af(i),ge(i,L)),S._68o(i)},_39O:function(C,T){var j,Z=this,m=T.rect;if(T.borderWidth>0&&(j=T.borderPadding,C.strokeStyle=T.borderColor,C.lineWidth=T.borderWidth,Vn(C,T.borderType,{x:m.x-j,y:m.y-j,width:m.width+2*j,height:m.height+2*j}),C.stroke()),T.selectWidth>0){var i=Z.gv._zoom;if(j=T.selectPadding,C.strokeStyle=T._97o,C.lineWidth=T.selectWidth/i,T.rotation!=F){C.save(),C.translate(T.position.x,T.position.y),C.rotate(T.rotation);var H=Z._data,n=H.getWidth(),D=H.getHeight(),b=T.scale,U=T.anchor;m={x:b.x*-n*U.x,y:b.y*-D*U.y,width:b.x*n,height:b.y*D}}Vn(C,T.selectType,{x:m.x-j,y:m.y-j,width:m.width+2*j,height:m.height+2*j}),T.rotation!=F&&C.restore(),C.stroke()}},dispose:function(){var x=this,q=x._htmlView;mm.superClass.dispose.call(x),q&&(q.onHTMLRemoved&&q.onHTMLRemoved(),yo(q))},_3O:function(){var r,J=this,j=J.s,_=J._data,U=J.gv,B=U.getShape(_),d=J.getBodyColor(),H=j("shape.border.color"),X=J._83o=B?{shape:B,_53o:J.getBodyColor("shape.background"),_27Q:ti(j("shape.repeat.image"),d),shapeGradientPack:j("shape.gradient.pack"),shapeBorderGradientPack:j("shape.border.gradient.pack"),_54o:j("shape.border.width"),_55o:H,shapeBorderRepeatImage:ti(j("shape.border.repeat.image"),H),_56o:j("shape.border.3d"),_57o:j("shape.border.3d.color"),_58o:j("shape.border.3d.accuracy"),shapeGradient:j("shape.gradient"),_59o:j("shape.gradient.color"),_60o:j("shape.border.pattern"),_61o:j("shape.border.cap"),_62o:j("shape.border.join"),shapeForeground:j("shape.foreground"),bodyColor:d,gray:j("2d.gray")}:{img:ti(U.getImage(_),d),bodyColor:d,gray:j("2d.gray"),stretch:j("image.stretch")},q=X.img;q&&q.renderHTML?(J._htmlInfo&&J._htmlInfo.img!==q&&(J._htmlInfo=F),J._htmlInfo||(J._htmlInfo={img:q,cache:{}}),r=q.renderHTML(_,U,J._htmlInfo.cache)):J._htmlInfo=F,J._htmlView&&J._htmlView!==r&&(J._htmlView.onHTMLRemoved&&J._htmlView.onHTMLRemoved(),yo(J._htmlView.getView?J._htmlView.getView():J._htmlView)),(J._htmlView=r)&&U.appendHTML(r)&&(r.onHTMLAddedSync&&r.onHTMLAddedSync(),r.onHTMLAdded&&Di(r.onHTMLAdded)),X.rect=_.getRect(),X.position=_.p(),X.scale=_.getScale(),X.anchor=_.getAnchor(),X.rotation=_.getRotation(),B===Gj&&(X._63o=j("shape.depth"));var A=0;if(B)A=Cd(F,X._54o/2,X._62o),J.s("shape.dash")&&(A=O(A,(J.s("shape.dash.width")||X._54o)/2));else if(q&&q.boundExtend)if(A=ur(q.boundExtend,_,U),q.boundExtendAbsolute){var t=_.getScale();A/=U._zoom*O(1,O(P(t.x),P(t.y)))}else if(!ur(q.fitSize,_,U)){var K=ur(q.width,_,U),$=ur(q.height,_,U);A*=O(_.getWidth()/K,_.getHeight()/$)}J._40O(X,A);var u=j("clip.percentage");if(u!=Y&&(X.clipRect=Mo(_.getAnchorRect(),j("clip.direction"),u)),B){var p=j("shape.fill.clip.percentage");p!=Y&&(X.shapeClipRect=Mo(_.getAnchorRect(),j("shape.fill.clip.direction"),p));var y=j("shape.foreground.clip.percentage");y!=Y&&(X.shapeForegroundClipRect=Mo(_.getAnchorRect(),j("shape.foreground.clip.direction"),y))}},getPosition:function(_,J,U,M){var v=Am(_,this._83o.rect,M);return v.x+=J,v.y+=U,v},_80o:function(j){var V=this,p=V.s,q=V.gv,B=V._data,H=V._83o,t=H.rect,W=H.position,l=H.rotation,P=H.anchor,R=H.scale,d=H.shape,G=H.clipRect;if(!V._checkEmptyRect||t.width>0&&t.height>0){var E=B.getSize();if(E.x=-E.width*P.x,E.y=-E.height*P.y,Cr&&!Er&&Yp(j,E.width,E.height),j.save(),Yp(j,W.x,W.y),Cq(j,l),rc(j,R.x,R.y),G&&(j.beginPath(),j.rect(G.x,G.y,G.width,G.height),j.clip()),q._drawForChecking&&H.img&&ur(H.img.pixelPerfect,B,q)===!1)ys(j,E.x,E.y,E.width,E.height,"#888888");else if(V.freeDraw)V.freeDraw(j,E,H);else if(d){var Y,Z,Q,b,K=H._60o,g=so(j,K),I=H._27Q,S=H._54o,c=H.shapeGradientPack,f=H.gray,s=j.lineJoin,A=j.lineCap,e=function(l){return f?x.toGrayColor(l):l};"roundRect"===d?Y=p("shape.corner.radius"):"polygon"===d?(Y=p("shape.polygon.side"),Z=p("shape.corner.radius")):"arc"===d&&(Y=p("shape.arc.from"),Z=p("shape.arc.to"),Q=p("shape.arc.close"),b=p("shape.arc.oval")),j.lineJoin=H._62o,j.lineCap=H._61o;var z=e(H._53o);if(z||I||c){var T=H.shapeClipRect;T&&(j.save(),j.beginPath(),j.rect(T.x,T.y,T.width,T.height),j.clip()),Vn(j,d,E,Y,Z,Q,b),c?Mj(j,c,function(Y){return Fp(Y,H.bodyColor)},!1,E):I?Of(j,I,e(H.bodyColor),null,B,q):zc(j,z,H.shapeGradient,e(H._59o),E),j.fill(),c&&j.restore(),T&&j.restore(),j!==g&&Vn(g,d,E,Y,Z,Q,b)}else Vn(g,d,E,Y,Z,Q,b);var k=H.shapeForeground;if(k){j.save();var y=H.shapeForegroundClipRect;y&&(j.beginPath(),j.rect(y.x,y.y,y.width,y.height),j.clip()),Vn(j,d,E,Y,Z,Q,b),zc(j,k,p("shape.foreground.gradient"),e(p("shape.foreground.gradient.color")),E),j.fill(),j.restore()}if(S>0){var $=p("shape.border.width.absolute");$&&(j.save(),j.setTransform(1,0,0,1,0,0)),j.lineWidth=S;var o=e(H._55o),L=H.shapeBorderGradientPack;L?Mj(j,L,e,!0,E):H.shapeBorderRepeatImage?tj(j,H.shapeBorderRepeatImage,o,null,B,q):j.strokeStyle=o,j.stroke(),L&&j.restore(),$&&j.restore(),H._56o&&ts(j,o,e(H._57o),S,q._zoom,H._58o)}if(gq(j,K),p("shape.dash")){var i=p("shape.dash.width")||S;if(i>0){K=p("shape.dash.pattern");var g=so(j,K,V._2Q("shape.dash.offset"));g!==j&&Vn(g,d,E,Y,Z,Q,b),V._1Q(j,"shape",i,K)}}Rj(j,z,H._63o,E),j.lineJoin=s,j.lineCap=A}else{var M=V.interactiveInfo;M&&(j.interactiveInfo=M.bodyInfo={compInfos:[],matrix:new Xj(l,W.x,W.y,R.x,R.y)}),H.gray&&(j.compGray=!0);var N=H.img;N&&N.cacheRule!=F&&(N=dn(j,N,H.stretch,E.width,E.height,B,q,H.bodyColor)),sl(j,N,H.stretch,E.x,E.y,E.width,E.height,B,q,H.bodyColor),j.compGray=!1,j.interactiveInfo=F}j.restore()}V._39O(j,H)},_48O:function(){},_47O:function(){}});var Or=function(x,m){ag(Or,this,[x,m])},ln=function(v,U,W,R){var d=Gd(v,U);return W=R?r(W,d):dk(W,d),d?W/=d:W=0,{x:v.x+(U.x-v.x)*W,y:v.y+(U.y-v.y)*W}};tr(Or,ps,{_3O:function(){var G,B=this,W=B._data,w=B.gv,K=B.s,T=K(Lf),E=W.isLooped(),q=K("edge.width"),r=B.getBodyColor("edge.color"),D=K("edge.center"),o=K("edge.offset"),L=w.getBorderColor(W),U=L?K("border.width"):0,C=B.getSelectWidth(),I=W._40I,k=W._41I,J=B._78o=I&&k?{looped:E,type:T,width:q,center:D,color:r,repeatImage:ti(K("edge.repeat.image"),r),borderColor:L,borderWidth:U,_97o:C?B.getSelectColor():F,selectWidth:C,pattern:K("edge.pattern"),cap:K("edge.cap"),join:K("edge.join"),is3d:K("edge.3d"),_67o:K("edge.3d.color"),_66o:K("edge.3d.accuracy"),gray:K("2d.gray")}:F;if(J){var M=x.getEdgeType(T);if(M){var u=M(W,rl(B,w,W,E,T),w,B._19Q);u.points&&u.points.size()>1?(J.edgeTypeInfo=u,G=To(J.edgeTypeInfo.points)):u[Rc]&&u.rect&&(J.edgeTypeInfo=u,G=u.rect)}else{var a=K("edge.source.anchor.x"),f=K("edge.source.anchor.y"),b=K("edge.target.anchor.x"),n=K("edge.target.anchor.y"),z=wf(w,W,"source"),X=wf(w,W,"target");if(T===Kn){var H=J.points=K(cm)||Df,A=H.size();J.segments=K("edge.segments");var e=a!==Y||f!==Y||Ye(I),v=b!==Y||n!==Y||Ye(k);if(!D)if(o)e||(z=ln(z,A?H.get(0):X,o,A)),v||(X=ln(X,A?H.get(A-1):z,o,A));else{var R;e||(R=xo(z,A?H.get(0):X,Bf(w,I)),R&&(z={x:R[0],y:R[1]})),v||(R=xo(A?H.get(A-1):z,X,Bf(w,k)),R&&(X={x:R[0],y:R[1]}))}G=ek(To(J.points),To(z,X))}else{var Q=rl(B,w,W,E,T);if(B._19Q||(Q=-Q),E)z=Af(z),z.x=w.getNodeRect(I).x,J.radius=Q,G={x:z.x-Q,y:z.y-Q,width:2*Q,height:2*Q};else{var N=Gd(z,X),Z=dk(o,N),y={x:Z,y:Q},l={x:N-Z,y:Q},j=jm(X.y-z.y,X.x-z.x),g=J.mat=new Pn(j);if(J.orienAngle=j,J.angle=X.x<z.x?j+d:j,J.rect={x:y.x,y:y.y,width:l.x-y.x,height:0},J.origin=z,y=g.tf(y),y.x+=z.x,y.y+=z.y,l=g.tf(l),l.x+=z.x,l.y+=z.y,D){var p={x:N,y:0};p=g.tf(p),p.x+=z.x,p.y+=z.y,G=To([z,y,l,p]),J.c1=z,J.c2=p}else G=To(y,l);z=y,X=l}}J.sourcePoint=z,J.targetPoint=X,W._lastSourcePoint=z,W._lastTargetPoint=X}var m=0;K("edge.dash")&&(m=K("edge.dash.width")||q);var c="square"===J.cap?.71:.5;Cd(G,O(m*c,q*c+U+C),J.join),B._68o(G)}},getRotation:function(U,C,h){U=U||0;var A=this._78o;if(A){var z,j=A.angle,i=A.points,S=A.edgeTypeInfo;if(j!=F)return C?A.orienAngle+U:j+U;if(S&&S[Rc])return S.getRotation?S.getRotation(this,U,C,h):0;if(S&&S.points){var u=S.points;return z=u.size(),lm[h]?z&&0===z%2?Bm(u.get(z/2-1),u.get(z/2),C,U):U:Nj[h]?Bm(u.get(0),u.get(1),C,U):Bm(u.get(z-2),u.get(z-1),C,U)}if(i)return z=i.size(),lm[h]?z&&0===z%2?Bm(i.get(z/2-1),i.get(z/2),C,U):U:Nj[h]?Bm(A.sourcePoint,z?i.get(0):A.targetPoint,C,U):Bm(z?i.get(z-1):A.sourcePoint,A.targetPoint,C,U)}return U},getPosition:function(l,F,d,t,D){var J=this._78o;if(J){var w,k=J.type,E=J.points,U=J.edgeTypeInfo,Y=J.sourcePoint,r=J.targetPoint;if(!k)return J.looped?{x:Y.x-J.radius+F,y:Y.y+d}:(D&&Y&&r&&(Y.x>r.x||Y.x===r.x&&Y.y>r.y)&&(l=Zh[l],d=-d),w=Am(l,J.rect,t),w.x+=F,w.y+=d,w=J.mat.tf(w),w.x+=J.origin.x,w.y+=J.origin.y,w);if(U&&U[Rc])return U.getPosition?U.getPosition(this,l,F,d,t,D):{x:(Y.x+r.x)/2,y:(Y.y+r.y)/2};if(E){var w,P=E.size();if(lm[l]){if(P){var c=P%2;if(0===c)return Fg(E.get(P/2-1),E.get(P/2),l,F,d,t,D);w=E.get((P-c)/2)}else w={x:(Y.x+r.x)/2,y:(Y.y+r.y)/2};return w=Am(l,{x:w.x,y:w.y,width:0,height:0},t),w.x+=F,w.y+=d,w}return Nj[l]?Fg(Y,P?E.get(0):r,l,F,d,t,D):Fg(P?E.get(P-1):Y,r,l,F,d,t,D)}if(U){var O=U.points,P=O.size();if(lm[l]){var c=P%2;return 0===c?Fg(O.get(P/2-1),O.get(P/2),l,F,d,t,D):(w=O.get((P-c)/2),w=Am(l,{x:w.x,y:w.y,width:0,height:0},t),w.x+=F,w.y+=d,w)}return Nj[l]?Fg(O.get(0),O.get(1),l,F,d,t,D):Fg(O.get(P-2),O.get(P-1),l,F,d,t,D)}}return be},_42:function(g){this._78o&&Or.superClass._42.call(this,g)},drawPath:function(v,C){v.beginPath();var W=C.type,x=C.points,b=C.segments,Y=C.edgeTypeInfo;if(!W||x){var E=C.sourcePoint,k=E.x,O=E.y,c=C.targetPoint,n=c.x,l=c.y;if(W)if(b){var L=new Hb({x:k,y:O});L.addAll(x),L.add({x:n,y:l}),Sg(v,L,b)}else v.moveTo(k,O),x.each(function(z){v.lineTo(z.x,z.y)}),v.lineTo(n,l);else C.looped?v.arc(k,O,C.radius,0,o,!0):C.center?(v.moveTo(C.c1.x,C.c1.y),v.lineTo(k,O),v.lineTo(n,l),v.lineTo(C.c2.x,C.c2.y)):(v.moveTo(k,O),v.lineTo(n,l))}else Y&&(Y.points?Sg(v,Y.points,Y.segments):Y[Rc]&&Y[Rc](v,Y))},_80o:function(t){var F=this,Y=F.s,A=F._78o,R=A.width,q=A.selectWidth,X=A.borderWidth,T=A.repeatImage,r=t.lineJoin,d=t.lineCap,$=A.gray,L=A.pattern;t.lineJoin=A.join,t.lineCap=A.cap,F.drawPath(so(t,L),A);var w=Y("edge.width.absolute");w&&(t.save(),t.setTransform(1,0,0,1,0,0)),q&&(t.strokeStyle=A._97o,t.lineWidth=R+2*(X+q),t.stroke()),X&&(t.strokeStyle=$?x.toGrayColor(A.borderColor):A.borderColor,t.lineWidth=R+2*X,t.stroke());var e=$?x.toGrayColor(A.color):A.color;if(T?tj(t,T,e,null,F._data,F.gv):t.strokeStyle=e,t.lineWidth=R,t.stroke(),A.is3d){var g=$?x.toGrayColor(A._67o):A._67o;ts(t,e,g,R,F.gv._zoom,A._66o)}if(gq(t,L),Y("edge.dash")){L=Y("edge.dash.pattern");var J=so(t,L,F._2Q("edge.dash.offset"));J!==t&&F.drawPath(J,A),F._1Q(t,"edge",Y("edge.dash.width")||R,L)}w&&t.restore(),t.lineJoin=r,t.lineCap=d},_48O:function(){},_47O:function(){}});var ki=function(I,l){ag(ki,this,[I,l])};tr(ki,mm,{_3O:function(){var i,o,J=this,Q=J.s,A=J._data,M=J.gv;if(J._88I=F,A.isExpanded()&&A.eachChild(function(J){if(Im(J)){var s=M.getBoundsForGroup(J);s&&(o||(o=[]),o.push(s),i=ek(i,s))}}),i){var l=M.getLabel(A),s=Q("group.type"),z=Q("group.border.width")||0,d=Q("group.border.width.absolute"),p=z/2;d&&(z/=M._zoom),i=Ti(s,o,i),Le(i,A,"group.padding",1),ge(i,z);var x=J._88I={type:s,rect:i,_64o:i};if(!s&&l!=F){var L,C=J.labelInfo={label:l,color:Q("group.title.color"),font:Q("group.title.font"),align:Q("group.title.align")},I=Oo(C,l),q=I.width+z,n=I.height+z,B=Q("group.title.align"),c=Q("group.title.orientation");if(c===En||c===Mr?(i.height+=z,q>i.width&&(i.width=q)):(c===Qi||c===Me)&&(i.width+=z,q>i.height&&(i.height=q)),L=B===Qi?i.x:B===Me?i.x+i.width-q:i.x+i.width/2-q/2,c===Mr)x.titleRect={x:i.x,y:i.y+i.height,width:i.width,height:n},x.rect={x:i.x,y:i.y,width:i.width,height:i.height+n},C.rect={x:L,y:i.y+i.height,width:q,height:n};else if(c===Qi){var h=x.titleRect={x:i.x-n,y:i.y,width:n,height:i.height};x.rect={x:i.x-n,y:i.y,width:i.width+n,height:i.height},C.rect={x:h.x+n/2-i.height/2,y:h.y+i.height/2-n/2,width:i.height,height:n},C.rotation=-Math.PI/2}else if(c===Me){var h=x.titleRect={x:i.x+i.width,y:i.y,width:n,height:i.height};x.rect={x:i.x,y:i.y,width:i.width+n,height:i.height},C.rect={x:h.x+n/2-i.height/2,y:h.y+i.height/2-n/2,width:i.height,height:n},C.rotation=Math.PI/2}else x.titleRect={x:i.x,y:i.y-n,width:i.width,height:n},x.rect={x:i.x,y:i.y-n,width:i.width,height:i.height+n},C.rect={x:L,y:i.y-n-p,width:q,height:n+z}}J._40O(x,Q("group.border.width")/2)}else ki.superClass._3O.call(J)},getPosition:function(z,$,I,b){var n=this._88I;if(n){var x=Am(z,n.rect,b);return x.x+=$,x.y+=I,x}return ki.superClass.getPosition.apply(this,arguments)},_24O:function(X,d){var M=this._88I;(!M||M.type||"label2"===X)&&ki.superClass._24O.call(this,X,d)},_80o:function(F){var i=this,M=i._88I;if(M){var I=i._data,c=i.s,A=i.gv,R=M.type,S=M.rect,Z=M._64o,$=M.titleRect,u=i.getBodyColor(),d=ti(c("group.image"),u),P=c("group.image.stretch"),D=i.getBodyColor("group.background"),J=ti(c("group.repeat.image"),u),O=c("group.gradient.pack"),o=c("group.gradient"),l=c("group.gradient.color"),f=c("group.border.width"),V=c("group.border.color"),Q=c("group.border.pattern"),T=c("group.title.orientation"),p=c("group.depth"),n=c("group.border.radius"),X=c("group.border.join"),Y=c("group.border.cap"),x=c("group.border.width.absolute");
x&&(f/=A._zoom);var W=V,G=c("group.border.repeat.image");if(G&&(G=ti(G,V))&&(W=Bn(F,G,V,null,I,A)),R){var g=F.lineJoin,e=F.lineCap;if(F.lineJoin=X,F.lineCap=Y,d){if(F.save(),Vn(F,R,S,n),F.clip(),sl(F,d,P,S.x,S.y,S.width,S.height,I,A,u),F.restore(),f>0){var y=so(F,Q);Vn(y,R,S,n),F.lineWidth=f,F.strokeStyle=W,F.stroke(),gq(F,Q)}}else{var y=so(F,Q);D||J||O?(Vn(F,R,S,n),O?Mj(F,O,function(C){return Fp(C,u)},!1,S):J?Of(F,J,u,null,I,A):zc(F,D,o,l,S),F.fill(),O&&F.restore(),F!==y&&Vn(y,R,S,n)):Vn(y,R,S,n),f>0&&(F.lineWidth=f,F.strokeStyle=W,F.stroke()),gq(F,Q),R===Gj&&Rj(F,D,p,S)}F.lineJoin=g,F.lineCap=e}else{var L=c("group.title.background");if((!n||0>n)&&(n=0),d)sl(F,d,P,Z.x,Z.y,Z.width,Z.height,I,A,i.getBodyColor());else if(D||J)if(J?Of(F,J,u,null,I,A):zc(F,D,o,l,Z),0===f)Vn(F,Gj,Z),F.fill(),Rj(F,D,p,Z);else{switch(F.beginPath(),T){case Mr:Yq(F,Z.x,Z.y,Z.width,Z.height,n,n,0,0);break;case Qi:Yq(F,Z.x,Z.y,Z.width,Z.height,0,n,0,n);break;case Me:Yq(F,Z.x,Z.y,Z.width,Z.height,n,0,n,0);break;case En:Yq(F,Z.x,Z.y,Z.width,Z.height,0,0,n,n)}F.fill()}if($&&L)if(0===f)ys(F,$.x,$.y,$.width,$.height,L),Rj(F,L,p,$);else{switch(F.beginPath(),F.fillStyle=L,T){case Mr:Yq(F,$.x,$.y,$.width,$.height,0,0,n,n);break;case Qi:Yq(F,$.x,$.y,$.width,$.height,n,0,n,0);break;case Me:Yq(F,$.x,$.y,$.width,$.height,0,n,0,n);break;case En:Yq(F,$.x,$.y,$.width,$.height,n,n,0,0)}F.fill()}if(f>0){var y=so(F,Q);if(Vn(y,"roundRect",S,n),F.save(),F.lineWidth=f,F.strokeStyle=W,F.lineJoin=X,F.lineCap=Y,F.closePath(),F.stroke(),$&&c("group.splitLine")){var j=$.x,m=$.y,r=$.width,k=$.height;F.beginPath(),T===Mr?(F.moveTo(j,m),F.lineTo(j+r,m)):T===Qi?(F.moveTo(j+r,m),F.lineTo(j+r,m+k)):T===Me?(F.moveTo(j,m),F.lineTo(j,m+k)):(F.moveTo(j,m+k),F.lineTo(j+r,m+k))}F.stroke(),F.restore(),gq(y,Q)}}i._39O(F,M)}else ki.superClass._80o.call(i,F)}});var Xo=function(g,l){ag(Xo,this,[g,l])};tr(Xo,mm,{_80o:function(s){this._39O(s,this._83o)}});var $c=function(m,i){ag($c,this,[m,i])};tr($c,mm,{_3O:function(){var Z=this,J=Z._data,c=Z.s,b=Z.gv,p=J.getPoints(),a=b.getBorderColor(J),q=a?c("border.width"):0,K=Z.getSelectWidth(),y=c("shape.border.width"),i=J.getRect(),N=J.getAnchorRect(),A=b.getBodyColor(J),s=c("shape.border.color"),f=Z._99o=p.isEmpty()?F:{rect:i,rotation:J.getRotation(),fillRule:c("shape.fill.rule"),scale:J.getScale(),position:J.p(),points:p,segments:J.getSegments(),bodyColor:A,borderColor:a,borderWidth:q,_94o:c("shape.border.3d"),_95o:c("shape.border.3d.color"),_96o:c("shape.border.3d.accuracy"),_97o:K?Z.getSelectColor():F,selectWidth:K,_53o:c("shape.background"),_27Q:ti(c("shape.repeat.image"),A),shapeGradientPack:c("shape.gradient.pack"),shapeBorderGradientPack:c("shape.border.gradient.pack"),_54o:y,_55o:s,shapeBorderRepeatImage:ti(c("shape.border.repeat.image"),s),shapeGradient:c("shape.gradient"),_59o:c("shape.gradient.color"),_60o:c("shape.border.pattern"),_61o:c("shape.border.cap"),_62o:c("shape.border.join"),shapeForeground:c("shape.foreground"),gray:c("2d.gray")};if(f){N.x+=f.position.x,N.y+=f.position.y,f.gradientRect=N;var B=J.getScale(),g=O(1,O(P(B.x),P(B.y)));c("shape.dash")&&c("shape.dash.width")>y&&(y=c("shape.dash.width"));var Q,V=c("shape.border.width.absolute");Q=V?(y+q+K)/Z.gv._zoom/g:y*("square"===f._61o?.71:.5)+q+K/Z.gv._zoom/g,Q&&(Q*=g,i=Af(i),Cd(i,Q,f._62o)),Z._68o(i);var x=c("clip.percentage");x!=Y&&(f.clipRect=Mo(J.getAnchorRect(),c("clip.direction"),x));var o=c("shape.fill.clip.percentage");o!=Y&&(f.shapeClipRect=Mo(J.getAnchorRect(),c("shape.fill.clip.direction"),o));var r=c("shape.foreground.clip.percentage");r!=Y&&(f.shapeForegroundClipRect=Mo(J.getAnchorRect(),c("shape.foreground.clip.direction"),r))}},getPosition:function(V,u,s,r){var n=this._99o;if(n){var m=Am(V,n.rect,r);return m.x+=u,m.y+=s,m}return be},_42:function(C){this._99o&&$c.superClass._42.call(this,C)},_80o:function(u){var t,H=this,M=H.s,d=H._99o,L=d.position,a=d.scale,J=d.rotation,D=d.borderWidth,p=d.selectWidth/H.gv._zoom,Q=d._27Q,k=d.shapeGradientPack,N=d._54o,I=d.clipRect,y=d.shapeClipRect,V=d.points,T=d.segments,v=H._data.isClosePath(),f=d.fillRule,F=d.gray,z=function(g){return F?x.toGrayColor(g):g},S=z(d._53o),m=S||Q||k;u.save(),Yp(u,L.x,L.y),Cq(u,J),rc(u,a.x,a.y),I&&(u.beginPath(),u.rect(I.x,I.y,I.width,I.height),u.clip()),m&&y&&(u.save(),u.beginPath(),u.rect(y.x,y.y,y.width,y.height),u.clip()),R.Default.extractShapeTranslation?(V=Af(V),V.forEach(function(k){k.x-=L.x,k.y-=L.y})):Yp(u,-L.x,-L.y);var q=d._60o,X=so(u,q),c=u.lineJoin,e=u.lineCap;u.lineJoin=d._62o,u.lineCap=d._61o;var w=z(d.bodyColor);m?(Sg(u,V,T,v),k?Mj(u,k,function(o){return Fp(o,d.bodyColor)},!1,d.rect):Q?Of(u,Q,w,null,H._data,H.gv):(t=w?w:S,zc(u,t,d.shapeGradient,z(d._59o),d.gradientRect)),u.fill(f),k&&u.restore(),y&&(u.restore(),Yp(u,-L.x,-L.y)),X!==u&&Sg(X,V,T,v)):Sg(X,V,T,v);var i=d.shapeForeground;if(i){u.save();var Z=d.shapeForegroundClipRect;Z&&(Yp(u,L.x,L.y),u.beginPath(),u.rect(Z.x,Z.y,Z.width,Z.height),u.clip(),Yp(u,-L.x,-L.y)),Sg(u,V,T,v),zc(u,i,M("shape.foreground.gradient"),z(M("shape.foreground.gradient.color")),d.gradientRect),u.fill(f),u.restore()}var j=M("shape.border.width.absolute");if(j&&(u.save(),u.setTransform(1,0,0,1,0,0)),p&&(u.strokeStyle=d._97o,u.lineWidth=N+2*(D+p),u.stroke()),D&&(u.strokeStyle=z(d.borderColor),u.lineWidth=N+2*D,u.stroke()),N){t=z(d._55o);var W=d.shapeBorderGradientPack;W?Mj(u,W,z,!0,d.rect):d.shapeBorderRepeatImage?tj(u,d.shapeBorderRepeatImage,t,null,H._data,H.gv):(!S&&w&&(t=w),u.strokeStyle=t),u.lineWidth=N,u.stroke(),W&&u.restore(),d._94o&&ts(u,t,z(d._95o),N,H.gv._zoom,d._96o)}if(gq(u,q),M("shape.dash")){var $=M("shape.dash.width")||N;if($>0){q=M("shape.dash.pattern");var X=so(u,q,H._2Q("shape.dash.offset"));X!==u&&Sg(X,V,T,v),H._1Q(u,"shape",$,q)}}j&&u.restore(),u.lineJoin=c,u.lineCap=e,u.restore()},_48O:function(){},_47O:function(){}});var vn=function(A,m){ag(vn,this,[A,m])};tr(vn,$c,{getRotation:function(g,K,d){g=g||0;var W=this._data.getPoints(),$=W.size();return $>1?lm[d]?$&&0===$%2?Bm(W.get($/2-1),W.get($/2),K,g):g:Nj[d]?Bm(W.get(0),W.get(1),K,g):Bm(W.get($-2),W.get($-1),K,g):g},getPosition:function(V,W,J,b,M){var l=this._data.getPoints(),S=l.size();if(S>1){if(lm[V]){var Q=S%2;if(0===Q)return Fg(l.get(S/2-1),l.get(S/2),V,W,J,b,M);var m=l.get((S-Q)/2),v={x:m.x,y:m.y,width:0,height:0};return m=Am(V,v,b),m.x+=W,m.y+=J,m}return Nj[V]?Fg(l.get(0),l.get(1),V,W,J,b,M):Fg(l.get(S-2),l.get(S-1),V,W,J,b,M)}return be}});var Jn=function(A,m){ag(Jn,this,[A,m])};tr(Jn,mm,{_3O:function(){var Z=this;Jn.superClass._3O.call(Z);var v=Z.s,s=Z._83o;Z._82o=s.img||s.shape?F:{background:Z.getBodyColor("grid.background"),depth:v("grid.depth"),rect:s.rect,_88o:v("grid.cell.depth"),cellBorderColor:v("grid.cell.border.color"),_89o:v("grid.row.count"),_90o:v("grid.column.count"),block:v("grid.block"),_91o:v("grid.block.color"),_92o:v("grid.block.padding"),_93o:v("grid.block.width")}},_80o:function(Q){var y=this,Z=y._82o;if(!Z)return Jn.superClass._80o.call(y,Q),void 0;var h,I,w=y._data,t=Z.background,k=Z.rect,K=Z.block,x=Z._91o,l=Z._92o,C=Z._93o,E=Z._88o,m=Z.cellBorderColor,M=Z._89o,u=Z._90o;if(t)if(ys(Q,k.x,k.y,k.width,k.height,t),Rj(Q,t,Z.depth,k),E)for(h=0;M>h;h++)for(I=0;u>I;I++)k=w.getCellRect(h,I),k&&Rj(Q,t,E,k);else if(m){for(Q.beginPath(),h=0;M>h;h++)for(I=0;u>I;I++)k=w.getCellRect(h,I),k&&Q.rect(k.x,k.y,k.width,k.height);Q.strokeStyle=m,Q.lineWidth=1,Q.stroke()}if("h"===K)for(h=0;M>h;h++)k=ek(w.getCellRect(h,0),w.getCellRect(h,u-1)),ge(k,l),lp(Q,x,k.x,k.y,k.width,k.height,C);else if("v"===K)for(I=0;u>I;I++)k=ek(w.getCellRect(0,I),w.getCellRect(M-1,I)),ge(k,l),lp(Q,x,k.x,k.y,k.width,k.height,C);y._39O(Q,y._83o)}});var Ki=function(X,V){ag(Ki,this,[X,V])};tr(Ki,mm,{_checkEmptyRect:!1,_81o:function(){var t=this._data,B=Ki.superClass._81o.call(this),b=t.s("text");if(b!=F){var O,Y,I=t.s("text.font"),x=t.s("text.align"),m=t.s("text.vAlign"),Z=gn(I,b),Q=Z.width,w=Z.height,W=t.getAnchor(),u=t.getWidth(),V=t.getHeight();"left"===x?O=-u*W.x:"center"===x?O=-u*W.x+(u-Q)/2:"right"===x&&(O=u*(1-W.x)-Z.width),"top"===m?Y=-V*W.y:"middle"===m?Y=-V*W.y+(V-w)/2:"bottom"===m&&(Y=V*(1-W.y)-Z.height);var U,S=t.getMatrix();if(U=To([S.tf(O,Y),S.tf(O+Q,Y),S.tf(O+Q,Y+w),S.tf(O,Y+w)]),B=ek(B,U),B&&t.s("text.shadow")){var l=Af(B);l.x+=t.s("text.shadow.offset.x"),l.y+=t.s("text.shadow.offset.y"),ge(l,t.s("text.shadow.blur")),B=ek(B,l)}}return B}});var Gg=vh.Interactor=function(B){this.gv=this._graphView=B};en("Interactor",S,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(G){this.gv.fi(G)},setCursor:function($){Mc||this.gv.setCursor($)},startDragging:function(E){var p=this;p._lastClientPoint=sf(E),p._lastLogicalPoint=p.gv.lp(E),om(p,E)},clearDragging:function(){var X=this;X._lastClientPoint=X._lastLogicalPoint=X._logicalPoint=F},autoScroll:function(q){return this.gv.autoScroll(q,this._lastClientPoint)}});var Nm=F,Rq=function(D){Nm.handleWindowTouchMove(D)},Ud=function(z){Nm.handleWindowTouchEnd(z),V(t,Ak,Rq),V(t,xq,Ud),Nm=F},$j=function(L){Nm.handleWindowMouseMove(L)},Qc=function(h){Nm.handleWindowMouseUp(h),V(t,id,$j),V(t,uh,Qc),Nm=F},zb=function(K,s){if(K!==Nm){var i=kh(s);Nm?i?Nm.handleWindowTouchEnd(s):Nm.handleWindowMouseUp(s):i?(B(t,Ak,Rq),B(t,xq,Ud)):(B(t,id,$j),B(t,uh,Qc)),Nm=K}},Rn=function(e){var E=this;E.gv=e,E._is2d=e instanceof vh.GraphView,E._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",Kj,"wheel"].forEach(function(e){E.addListener(e)}),E.initImageResource()};tr(Rn,Gg,{enableVR:function(u){var b=this;!!b._vrEnable!==u&&(b._vrEnable=u,u?b.gv.vr.mp(b.onVRControllerChange,b):b.gv.vr.ump(b.onVRControllerChange,b))},onVRControllerChange:function(T){var W=this,N=T.property,X=T.newValue,H=X.id,n=W.gv.vr.getController(H),t=n.getRay();if(t){t.controllerId=H;var j=W.gv.vr.getRayEventType(t,N,X._62O);switch(j){case"down":W.handle_mousedown(t);break;case"up":Nm&&Qc(t);break;case"move":W.handle_mousemove(t),Nm&&W.handleWindowMouseMove(t)}}},setPreventEventDefault:function(o,c){var y=this,j=y._eventListeners[o];j?j._prevent=c:y._eventListeners[o]=j={_removal:Y,_prevent:c}},removeListener:function(V){var o=this,L=o._eventListeners[V];L&&L._removal&&(L._removal(),L._removal=Y)},addListener:function(y){var O=this,J=O._eventListeners[y];if(J||(O._eventListeners[y]=J={_removal:Y,_prevent:!0}),!J||!J._removal){var T=function(Y){J._prevent&&x.preventDefault(Y),O.disabled||O.gv._48Q||("wheel"===y?Ci(O,Y):O["handle_"+y](Y))};B(O.gv.getView(),y,T),J._removal=function(){V(O.gv.getView(),y,T)}}},handleWindowTouchMove:function(P){this.handleWindowMouseMove(P)},handleWindowMouseMove:function(j){return!this.downInfo||kh(j)&&1!==Hh(j)?(this.isDragging&&(this.handleDownInfo("onEndDrag",j),this.isDragging=!1),void 0):(this.isDragging?this.handleDownInfo("onDrag",j):(this.handleDownInfo("onBeginDrag",j),this.isDragging=!0),void 0)},handleWindowTouchEnd:function(y){this.handleWindowMouseUp(y)},handleWindowMouseUp:function(p){if(this.isDragging&&(this.handleDownInfo("onEndDrag",p),this.isDragging=!1),this.downInfo){var L=this.handle("onUp",p);if(L&&L.data===this.downInfo.data){this.handleMissingUp(p);var Q=this,Z=2===p.button?"onContextMenu":"onClick";if(!Q._dbclickTimer)return Q._dbclickTimer=bg(function(){delete Q._dbclickTimer,Q.handleClick(p,Z,L),this.downInfo=F},x.clickDelay),void 0;ee(Q._dbclickTimer),delete Q._dbclickTimer,Z="onDoubleClick",Q.handleClick(p,Z,L)}else this.handleDownInfo("onUp",p);this.downInfo=F,this.downComps=F}},handle_mouseleave:function(n){var i=this,P=i.gv;i._hoverTimer&&(ee(i._hoverTimer),delete i._hoverTimer);var K=i.currentInfo?i.currentInfo.data:F;if(K){K.s("onLeave")&&K.s("onLeave")(n,K,P),i.fire("data","onLeave",n,K);var j=i.currentInfo?i.currentInfo.hits:F;if(j)for(var S in j)i.handleLeave(n,S);i.currentInfo=F}},handle_mousewheel:function(R){R.scrollDelta=R.wheelDelta/40,this.handle("onScroll",R)},handle_DOMMouseScroll:function(G){G.scrollDelta=2===G.axis?-G.detail:0,this.handle("onScroll",G)},handle_touchstart:function(V){this.handle_mousedown(V)},handle_touchmove:function(u){this.handle("onMove",u)},handle_mousedown:function(S){this.isDragging&&(this.handleDownInfo("onEndDrag",S),this.isDragging=!1),this.downComps=[],this.downInfo=this.handle("onDown",S),this.downInfo&&zb(this,S)},handle_mousemove:function(y){var X=this,u=X.gv;if(X._hoverTimer&&(ee(X._hoverTimer),delete X._hoverTimer),!u._panning&&!u._moving){var Y,O,v,z=X.handle("onMove",y),m=this.currentInfo?this.currentInfo.data:F,Z=this.currentInfo?this.currentInfo.hits:F;if(z&&(O=z.data,v=z.hits,X._hoverTimer=bg(function(){ee(X._hoverTimer),delete X._hoverTimer,X.handle("onHover",y,z)},u.getHoverDelay()||x.hoverDelay)),O!==m){if(m&&(m.s("onLeave")&&m.s("onLeave")(y,m,u),this.fire("data","onLeave",y,m)),O&&(O.s("onEnter")&&O.s("onEnter")(y,O,u),this.fire("data","onEnter",y,O)),Z)for(Y in Z)this.handleLeave(y,Y);if(v)for(Y in v){var L=v[Y],Q=O._interactPrefix=L.prefix,r=Q&&O.a(Q+"onEnter")||L.target.onEnter;r&&r.call(L.target,y,O,u,L.point,L.width,L.height),this.fire(L.type,"onEnter",L.event,L.data,L.image,L.comp,L.point,L),O._interactPrefix=null}}else{if(Z)for(Y in Z)v&&v[Y]||this.handleLeave(y,Y);if(v)for(Y in v)if(!Z||!Z[Y]){var L=v[Y],Q=O._interactPrefix=L.prefix,r=Q&&O.a(Q+"onEnter")||L.target.onEnter;r&&r.call(L.target,y,O,u,L.point,L.width,L.height),this.fire(L.type,"onEnter",L.event,L.data,L.image,L.comp,L.point,L),O._interactPrefix=null}}this.currentInfo=z}},handle:function(p,$,g){var L,Q=this,t=Q.gv;if(Q._is2d){if(g=g||t.getDataInfoAt($),!g||!t.isInteractive(g.data))return;if(L=g.ui.interactiveInfo){var o,S=g.data;if(S.s(p)&&S.s(p)($,S,t),this.fire("data",p,$,S),"body"===g.part&&L.bodyInfo)o="body",g.hits=this.handleImage(o,t.getImage(S),p,$,S,g.point,L.bodyInfo);else if("icons"===g.part&&L._38o){var T=L._38o[g.name];T&&T[g.index]&&(o="icons|"+g.name+"|"+g.index,g.hits=this.handleImage(o,g.icon,p,$,S,g.point,T[g.index]))}}return g}var S,c;if(!g)if($&&$ instanceof R.Math.Ray&&t.isVREnabled()){var h=t.vr.intersectWorld($);if(S=h.data,c=h.intersect,t.vr.renderRayDuringInteraction($,S,c),!S)return;var l=t.getData3dUI(S);if(L=l.interactiveInfo,!L)return;g={data:S,part:c.part,ui:l}}else{if(g=t.getDataInfoAt($),!g)return;g&&(g={data:g.data,part:g.part})}if(t.isInteractive(g.data)){if(!c){S=g.data;var l=t.getData3dUI(S);if(g.ui=l,L=l.interactiveInfo,!L)return g;if(c=t.intersectObject($,S),!c)return g}S.s(p)&&S.s(p)($,S,t),this.fire("data",p,$,S);var J,j=c.part;return"body"!==j&&(J=S.s(j+".image")||S.s("shape3d."+j+".image")),J||(J=S.s("all.image")||S.s("shape3d.image")),J?(L="object"==typeof J?L[J.uuid]:L[J],L&&L.bodyInfo?(g.part="body",g.interactiveInfo=L,g.point=this._convertUVToPoint(c.uv,L),g.image=J,g.hits=this.handleImage("body",J,p,$,S,g.point,L.bodyInfo),g):g):g}},_handleLeaveOrMissing:function(u,N,V){var P="leave"===u?this.currentInfo:this.downInfo;if(P){var t=P.interactiveInfo||P.ui.interactiveInfo;if(t){var L,v,U=P.data;if(this._is2d){if(v=this.gv.lp(N),"body"===P.part&&t.bodyInfo)L="body","leave"===u?this.handleLeaveImage(V,L,this.gv.getImage(U),N,U,v,t.bodyInfo):this.handleMissingUpImage(L,this.gv.getImage(U),N,U,v,t.bodyInfo);else if("icons"===P.part&&t._38o){var q=t._38o[P.name];q&&q[P.index]&&(L="icons|"+P.name+"|"+P.index,"leave"===u?this.handleLeaveImage(V,L,P.icon,N,U,v,q[P.index]):this.handleMissingUpImage(L,P.icon,N,U,v,q[P.index]))}}else{if(!t.bodyInfo)return;var p=this.gv.intersectObject(N,U);v=p&&p.uv?this._convertUVToPoint(p.uv,t):{x:1/0,y:1/0},"leave"===u?this.handleLeaveImage(V,"body",P.image,N,U,v,t.bodyInfo):this.handleMissingUpImage("body",P.image,N,U,v,t.bodyInfo)}}}},handleClick:function(M,y,z){var o=this,v=this.downInfo;if(v&&z){var E,N=z.interactiveInfo||z.ui.interactiveInfo,f=z.data,l=this.gv;if(f.s(y)&&f.s(y)(M,f,l),o.fire("data",y,M,f),N)if(this._is2d){if(v.part===z.part){var q=l.lp(M);"body"===z.part&&N.bodyInfo&&(E="body",this.handleClickImage(E,l.getImage(f),y,M,f,q,N.bodyInfo,z))}}else{if(!N.bodyInfo)return;var c=l.intersectObject(M,f);if(!c)return;q=this._convertUVToPoint(c.uv,N),this.handleClickImage("body",v.image,y,M,f,q,N.bodyInfo,z)}}},handleDownInfo:function(y,T){if(this.downInfo){var A=this.downInfo,Z=this.gv,G=A.interactiveInfo||A.ui.interactiveInfo;if(G){var M,O=A.data;if(O.s(y)&&O.s(y)(T,O,Z),this.fire("data",y,T,O),this._is2d){var L=Z.lp(T);if("body"===A.part&&G.bodyInfo)M="body",this.handleDownInfoImage(M,Z.getImage(O),y,T,O,L,G.bodyInfo);else if("icons"===A.part&&G._38o){var v=G._38o[A.name];v&&v[A.index]&&(M="icons|"+A.name+"|"+A.index,this.handleDownInfoImage(M,A.icon,y,T,O,L,v[A.index]))}}else{if(!G.bodyInfo)return;var I;if("onBeginDrag"===y?(I=Z._raycaster.intersectObjectAndRecordTriangle(T,O),I&&(G.beginDragIntersectInfo=I.triangleInfo)):I=Z.intersectObject(T,O),!I&&("onDrag"!==y&&"onEndDrag"!==y||!G.beginDragIntersectInfo||(I=Z._raycaster.intersectLastTriangle(T,G.beginDragIntersectInfo)),!I))return;L=this._convertUVToPoint(I.uv,G),this.handleDownInfoImage("body",A.image,y,T,O,L,G.bodyInfo)}}}},fire:function(t,p,b,L,Z,n,I,G){this.gv.fi({kind:p,type:t,event:b,data:L,image:Z,comp:n,view:this.gv,point:I,width:G?G.width:Y,height:G?G.height:Y})},handleImage:function(R,h,a,w,e,F,O){var j={};if(h&&(h=ti(h))){var S=this.gv,$=O.rect,v=this.convertPoint(F,O);v.inRect&&(h[a]&&h[a](w,e,S,v,$.width,$.height),this.fire("image",a,w,e,h,Y,v,$),j[R+"|image"]={target:h,type:"image",image:h,data:e,event:w,point:v,width:$.width,height:$.height});for(var x,t=O.compInfos,D=h,M=t.length-1;M>=0;M--){var b=t[M],N=b.comp;if(v=this.convertPoint(F,b,D,N,S,e),v.inRect){$=b.rect;var g=e._interactPrefix=b.prefix,P=g&&e.a(g+a)||N[a];if(P&&(x=P.call(N,w,e,S,v,$.width,$.height)),this.fire("comp",a,w,e,h,N,v,$),x!==!0&&(h=$.image)&&(h[a]&&(x=h[a](w,e,S,v,$.width,$.height)),this.fire("image",a,w,e,h,Y,v,$)),e._interactPrefix=null,j[R+"|"+M]={target:N,type:"comp",comp:N,image:h,data:e,event:w,point:v,width:$.width,height:$.height,prefix:g},this.downComps&&this.downComps.push(N),h&&(j[R+"|"+M+"|image"]={target:h,type:"image",image:h,data:e,event:w,point:v,width:$.width,height:$.height,prefix:g}),x===!0)break}}}return j},handleLeave:function(Y,Z){return this._handleLeaveOrMissing("leave",Y,Z)},handleMissingUp:function(S){return this._handleLeaveOrMissing("missing",S)},handleLeaveImage:function(U,s,g,C,p,h,r){if(g&&(g=ti(g))){var k=this.gv,w=r.rect,m=this.convertPoint(h,r);U===s+"|image"&&(g.onLeave&&g.onLeave(C,p,k,m,w.width,w.height),this.fire("image","onLeave",C,p,g,Y,m,w));for(var $,F=r.compInfos,t=g,a=F.length-1;a>=0;a--){var K=F[a],O=K.comp;m=this.convertPoint(h,K,t,O,k,p),w=K.rect;var i=p._interactPrefix=K.prefix;if(U===s+"|"+a){var j=i&&p.a(i+"onLeave")||O.onLeave;j&&($=j.call(O,C,p,k,m,w.width,w.height)),this.fire("comp","onLeave",C,p,g,O,m,w)}if($!==!0&&(g=w.image)&&U===s+"|"+a+"|image"&&(g.onLeave&&($=g.onLeave(C,p,k,m,w.width,w.height)),this.fire("image","onLeave",C,p,g,Y,m,w)),p._interactPrefix=null,$===!0)break}}},handleMissingUpImage:function(i,p,f,b,s,e){var H="onUp",j=this.downInfo.hits;if(j&&p&&(p=ti(p))){var D=this.gv,r=e.rect,O=this.convertPoint(s,e);!O.inRect&&j[i+"|image"]&&(p[H]&&p[H](f,b,D,O,r.width,r.height),this.fire("image",H,f,b,p,Y,O,r));for(var g,l=e.compInfos,J=p,B=l.length-1;B>=0;B--){var N=l[B],G=N.comp;if(O=this.convertPoint(s,N,J,G,D,b),!O.inRect){r=N.rect;var U=b._interactPrefix=N.prefix;if(j[i+"|"+B]){var z=U&&b.a(U+H)||G[H];z&&(g=z.call(G,f,b,D,O,r.width,r.height)),this.fire("comp",H,f,b,p,G,O,r)}if(g!==!0&&(p=r.image)&&j[i+"|"+B+"|image"]&&(p[H]&&(g=p[H](f,b,D,O,r.width,r.height)),this.fire("image",H,f,b,p,Y,O,r)),b._interactPrefix=null,g===!0)break}}}},handleDownInfoImage:function(r,e,w,c,s,o,l){var t=this.downInfo.hits;if(t&&e&&(e=ti(e))){var T=this.gv,v=l.rect,Z=this.convertPoint(o,l);t[r+"|image"]&&(e[w]&&e[w](c,s,T,Z,v.width,v.height),this.fire("image",w,c,s,e,Y,Z,v));for(var x,M=l.compInfos,V=e,j=M.length-1;j>=0;j--){var Q=M[j],_=Q.comp;Z=this.convertPoint(o,Q,V,_,T,s),v=Q.rect;var F=s._interactPrefix=Q.prefix,h=["onDrag","onEndDrag"].indexOf(w)>=0;if(!h&&t[r+"|"+j]||h&&this.downComps&&this.downComps.indexOf(_)>=0){var D=F&&s.a(F+w)||_[w];D&&(x=D.call(_,c,s,T,Z,v.width,v.height)),this.fire("comp",w,c,s,e,_,Z,v)}if(x!==!0&&(e=v.image)&&t[r+"|"+j+"|image"]&&(e[w]&&(x=e[w](c,s,T,Z,v.width,v.height)),this.fire("image",w,c,s,e,Y,Z,v)),s._interactPrefix=null,x===!0)break}}},handleClickImage:function(E,g,U,L,v,P,V,C){var w=this.downInfo.hits,f=C.hits;if(w&&g&&(g=ti(g))){var N=this.gv,j=V.rect,i=this.convertPoint(P,V);w[E+"|image"]&&(g[U]&&g[U](L,v,N,i,j.width,j.height),this.fire("image",U,L,v,g,Y,i,j));for(var u,F=V.compInfos,r=g,T=F.length-1;T>=0;T--){var O=F[T],c=O.comp;i=this.convertPoint(P,O,r,c,N,v),j=O.rect;var G=v._interactPrefix=O.prefix;if(w[E+"|"+T]&&f[E+"|"+T]){var m=G&&v.a(G+U)||c[U];m&&(u=m.call(c,L,v,N,i,j.width,j.height)),this.fire("comp",U,L,v,g,c,i,j)}if(u!==!0&&(g=j.image)&&w[E+"|"+T+"|image"]&&(g[U]&&(u=g[U](L,v,N,i,j.width,j.height)),this.fire("image",U,L,v,g,Y,i,j)),v._interactPrefix=null,u===!0)break}}},initImageResource:function(){x.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(u,X){if(!u)return{x:1/0,y:1/0};var C=X.bodyInfo.rect,Q=u.clone(),W=u.multiply({x:C.width,y:C.height});return W.local=Q,W},convertPoint:function(g,Q,y,i,N,Z){var m=Q.rect,L=Q.matrix.applyInverse(g).sub(m),n=L.x>=0&&L.y>=0&&L.x<=m.width&&L.y<=m.height;if(!n)return L;if(i&&ur(i.pixelPerfect,Z,N)){var m,B=1;this._is2d?(B=N.getZoom(),m=_e(g.x,g.y,Y,B)):m=_e(g.x,g.y);var H=!1,C=m.x,q=m.y,G=m.width,I=m.height,l=x.hitMaxArea,h=G*I*B*B;if(h>l){var b=Math.sqrt(l/h);B*=b}G*=B,I*=B,2>G&&(G=2),2>I&&(I=2),C*=B,q*=B;var W=Od(G,I),_=new Xj(0,-C,-q,B,B);_.append(Q.matrix),N._drawForChecking=!0,i.transform=_;var O=y.fitSize;Q.refRect&&Q.refRect.fitSize?(i.refRect=Q.refRect,y.fitSize=!0):y.fitSize=!1;var P=y.comps;y.comps=[i],tp(W,y,0,0,G,I,Z,self),y.comps=P,y.fitSize=O,delete i.refRect,delete i.unionRect,delete i.transform,N._drawForChecking=!1;try{for(var M=0,R=W.getImageData(0,0,G,I).data;M<R.length;M+=4)if(0!==R[M+3]){H=!0;break}W.restore()}catch(a){Bg=F,H=!1}L.inRect=H}else L.inRect=!0;return L}});var wl=vh.DefaultInteractor=function(N){ag(wl,this,[N])};en("DefaultInteractor",Gg,{handle_mousedown:function(b){cc(b);var Z=this,F=Z.gv,i=F.getDataAt(b);if(F.setFocus(b)&&!F._editing&&!F._scrolling){hl(b)?F.handleDoubleClick(b,i):F.handleClick(b,i);var g=qn(b);!an()&&!g&&i&&(F.isMovable(i)||F._39Q(i))||!F.isPannable()||!rf(b)&&!g||qh(b)||(Z._tx=F.tx(),Z._ty=F.ty(),Z.startDragging(b))}},handleWindowMouseUp:function(S){var D=this,W=D.gv;W._panning&&(delete W._panning,W.onPanEnded(),D.fi({kind:"endPan",event:S})),delete D._tx,delete D._ty,D.clearDragging()},handle_mousemove:function(I){var Q=this,D=Q.gv;Q._hoverTimer&&(ee(Q._hoverTimer),delete Q._hoverTimer),Q._hoverTimer=bg(function(){Q.fi({kind:"hover",event:I}),ee(Q._hoverTimer),delete Q._hoverTimer},D.getHoverDelay()||x.hoverDelay)},handle_mouseleave:function(){var v=this;v._hoverTimer&&(ee(v._hoverTimer),delete v._hoverTimer)},handleWindowMouseMove:function(m){var Q=this,f=Q.gv;Q.fi({kind:f._panning?"betweenPan":"beginPan",event:m}),f._panning=1;var d=ap(f,m,Q._lastClientPoint);f.setTranslate(Q._tx+d.x,Q._ty+d.y)},handle_mousewheel:function(Q){this.gv.handleScroll(Q,Q.wheelDelta)},handle_DOMMouseScroll:function(V){2===V.axis&&this.gv.handleScroll(V,-V.detail)},handle_keydown:function(D){this.gv.handleKeyDown(D)}});var _n=vh.SelectInteractor=function(E){ag(_n,this,[E])};en("SelectInteractor",Gg,{_42:function(){var s=this,j=s.gv,o=j.getZoom(),Q=s.mark,p=s.div;p||(p=s.div=eo(),kf(s.getView(),p));var c={};c.x=Q.x*o+j.tx(),c.y=Q.y*o+j.ty(),c.width=Q.width*o,c.height=Q.height*o,Gk(p,c),this.intersects()?(p.style.border="",p.style.background=j.getRectSelectBackground()):(p.style.background="",p.style.border="1px solid "+j.getRectSelectBorderColor())},handle_mousedown:function(z){var q=this,e=q.gv;if(q._57I=F,q.pendingClickThrough=F,!(e._editing||e._scrolling||an()||qn(z))){var I=e.getDataAt(z),H=e.sm();I?qh(z)?H.co(I)?H.rs(I):H.as(I):H.co(I)?I instanceof tm&&I.isClickThroughEnabled()&&rf(z)&&(q.pendingClickThrough=sf(z)):H.ss(I):qh(z)||!e.isPannable()?rf(z)&&(qh(z)||H.cs(),e.isRectSelectable()&&(q.startDragging(z),e._77O=1)):rf(z)&&(q._57I=sf(z))}},handle_mouseup:function(K){var H=this,V=H.gv,q=H._57I;if(q&&(Gd(q,sf(K))<=1&&V.sm().cs(),H._57I=F),H.pendingClickThrough){if(Gd(H.pendingClickThrough,sf(K))<=1){var u=V.getDataAt(K);if(u instanceof tm&&u.isClickThroughEnabled()){var Z=V.getDataAt(K,function(b){var R=b.getParent()===u&&V.isSelectable(b,!0);return R});Z&&(K.clickThrough=!0,V.sm().ss(Z))}}H.pendingClickThrough=F}},handleWindowMouseUp:function(r){this.clear(r)},handleWindowMouseMove:function(b){var h=this,W=h.gv;h._logicalPoint=W.lp(b),h.mark?(h.fi({kind:"betweenRectSelect",event:b}),W.isPannable()&&h.autoScroll(b),h.redraw()):h.fi({kind:"beginRectSelect",event:b}),h.mark=To(h._lastLogicalPoint,h._logicalPoint),h.redraw()},intersects:function(){var h=this,o=h._lastLogicalPoint,z=h._logicalPoint;return o.x>z.x||o.y>z.y},clear:function($){var j=this,W=j.gv,w=j.mark;if(j._57I=F,j.pendingClickThrough=F,j._lastLogicalPoint){if(w){if(0!==w.width&&0!==w.height){var L=W.getDatasInRect(w,j.intersects());if(!L.isEmpty()){var a=W.sm(),m=a.toSelection(),q=eq($),X=$.altKey;L.each(function(o){a.co(o)?(!q||q&&X)&&m.remove(o):(!X||q&&X)&&m.add(o)}),a.ss(m)}}yo(j.div),delete j.div,delete j.mark,j.redraw(),j.fi({kind:"endRectSelect",event:$}),W.onRectSelectEnded()}j.clearDragging(),delete W._77O}},redraw:function(){var N=this;N._draw||(N._draw=1,bg(function(){N.mark&&N._42(),delete N._draw},16))}});var Vr=vh.MoveInteractor=function(k){ag(Vr,this,[k])};en("MoveInteractor",Gg,{handle_mousedown:function(R){var M=this,E=M.gv;if(rf(R)&&!E._editing&&!E._scrolling&&!an()){var f=E.getSelectedDataAt(R);!f||E._39Q(f)&&!E.isMovable(f)?E._focusData=F:(M._data=f,E.handleMouseDown&&E.handleMouseDown(R,f),M.startDragging(R),E.isMovable(f)&&(E._moving=1))}},handleWindowMouseUp:function(L){var I=this,y=I.gv;y.handleMouseUp&&y.handleMouseUp(L,I._data),I.clear(L)},handleWindowMouseMove:function(u){var N=this,G=N._data,X=N.gv;if((!X._93O||!X._93O(u,G))&&X._moving){N._logicalPoint||N.fi({kind:"prepareMove",event:u});var d=N._logicalPoint?"betweenMove":"beginMove",t={kind:d,event:u},n=N._logicalPoint=X.lp(u);"beginMove"!==d||N._alreadyBeginTransaction||(N._alreadyBeginTransaction=!0,X.getDataModel().beginTransaction());var K=N._calcShift(d,u),Y=K.x,m=K.y,J=N.gv.getMoveMode(u,G);J&&("x"===J?m=0:"y"===J?Y=0:"xy"!==J&&(Y=m=0)),X.moveSelection(Y,m),N._lastLogicalPoint=n,N.autoScroll(u),N.fi(t)}},_calcShift:function(){var G=this,C=G._logicalPoint,d=G._lastLogicalPoint,N=C.x-d.x,M=C.y-d.y;return{x:N,y:M}},clear:function(u){var C=this,Q=C.gv;C._lastLogicalPoint&&(C._lastLogicalPoint=C._data=Q._moving=F,C._logicalPoint&&(C.fi({kind:"endMove",event:u}),Q.onMoveEnded()),C.clearDragging()),C._alreadyBeginTransaction&&(C._alreadyBeginTransaction=!1,Q.getDataModel().endTransaction())}});var Ir=vh.TextEditInteractor=function(W){ag(Ir,this,[W]),this.init()};en("TextEditInteractor",Gg,{init:function(){var P=this,F=this.input=M.createElement("input"),c=F.style;F.text="text",c.border="1px solid #d8d8d8",c.position="absolute",c.padding="2px 3px",c.outline="none",c.marginLeft="-90px",c.marginTop="-16px",c.backgroundColor="rgba(255,255,255, 0.9)",c.fontSize="14px",c.width="180px",c.height="32px",c.boxShadow="0 0 13px rgba(16,142,233, 0.5)",c.textAlign="center",c.boxSizing="border-box",B(F,"keyup",function(d){kj(d)&&P.endTextEdit()}),B(F,"focus",function(){F.select()});var _=this.textarea=M.createElement("textarea"),K=this.wrap=M.createElement("div");K.appendChild(_),c=_.style,c.margin=0,c.padding="4px",c.overflow="hidden",c.boxSizing="border-box",c.position="absolute",c.outline="none",c.backgroundColor="transparent",c.resize="none",c.textAlign="center",c.fontSize="14px",c.border="none",c.borderWidth=0,c.width="100%",c.top="50%",c=K.style,c.boxSizing="border-box",c.margin=0,c.padding=0,c.position="absolute",c.boxShadow="0 0 13px rgba(16,142,233, 0.5)",c.border="1px solid #d8d8d8",c.backgroundColor="rgba(255,255,255, 0.9)",c.width="180px",c.marginLeft="-90px",B(_,"keydown",function(q){return(eq()||qh())&&kj(q)?(P.endTextEdit(),void 0):(P.calculateTextareaHeight(String.fromCharCode(q.keyCode)),void 0)}),B(_,"focus",function(){_.select()});var W=function(T){T.stopPropagation()};B(F,"mousedown",W),B(F,"touchstart",W),B(_,"mousedown",W),B(_,"touchstart",W),P.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],P.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",P.handleWindowClick=function($){var v=P._editingDOM;if(v){var O=v.getBoundingClientRect(),b=sf($);Kk(O,b)||P.endTextEdit()}}},handle_mousedown:function(O){var s=this,v=s.gv;if(hl(O)&&!v._editing){var F=v.getDataAt(O);if(F){var T=v.getTextEditInfo(F);T&&(this._editInfo=T,this._editTarget=F,v._editing=!0,T.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var o=this,h=o.gv,E=o._editTarget,g=o.getTargetValue(),W=o.textarea,L=o.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===g||g===Y)&&(g=""),W.value=g,o._editingDOM=W,h.getView().appendChild(L),this.layoutHTML(L,E),this.calculateTextareaHeight(),bg(function(){W.focus(),B(t,"mousedown",o.handleWindowClick),B(t,"touchstart",o.handleWindowClick)},10)},handleTextEdit:function(){var y=this,r=y.gv,k=y._editTarget,i=y.getTargetValue(),E=y.input;(null===i||i===Y)&&(i=""),E.value=i,y._editingDOM=E,r.getView().appendChild(E),this.layoutHTML(E,k),bg(function(){E.focus(),B(t,"mousedown",y.handleWindowClick),B(t,"touchstart",y.handleWindowClick)},10)},layoutHTML:function(P,i){var x=this.gv,c=x.getZoom();if(i instanceof R.Node){var v=i.getRect(),O=Math.min(Math.max(100,v.width*c),800);P.style.left=(v.x+v.width/2)*c+x.tx()+"px",P.style.top=(v.y+v.height/2)*c+x.ty()+"px",P.style.width=O+"px",P.style.marginLeft=-O/2+"px"}else if(i instanceof R.Edge){var k=x.getDataUI(i),v=k._6I;P.style.left=(v.x+v.width/2)*c+x.tx()+"px",P.style.top=(v.y+v.height/2)*c+x.ty()+"px"}},endTextEdit:function(){var F=this,H=F._editInfo.isMultiline?F.wrap:F.input,d=F._editInfo.isMultiline?F.textarea:F.input;F.setTargetValue(d.value),F.gv.getView().removeChild(H),F.gv._editing=!1,delete F._editingDOM,V(t,"mousedown",F.handlelick),V(t,"touchstart",F.handleWindowClick)},setTargetValue:function(r){var M=this,l=M._editTarget,n=M._editInfo,T=n.accessType,o=n.name;if(o&&T||(T="p",o="name"),"p"===T){var i=R.Default.setter(o);l[i](r)}else"a"===T?l.a(o,r):l.s(o,r)},getTargetValue:function(){var G=this,U=G._editTarget,P=G._editInfo,z=P.accessType,m=P.name;if(m&&z||(z="p",m="name"),"p"===z){var o=R.Default.getter(m);return U[o]()}return"a"===z?U.a(m):U.s(m)},createHiddenTextarea:function(){this.hiddenTextarea=M.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(k,F){if(F&&this.computedStyleCache)return this.computedStyleCache;var W=this,v=t.getComputedStyle(k),G=v.getPropertyValue("box-sizing")||v.getPropertyValue("-moz-box-sizing")||v.getPropertyValue("-webkit-box-sizing"),e=parseFloat(v.getPropertyValue("padding-bottom"))+parseFloat(v.getPropertyValue("padding-top")),g=parseFloat(v.getPropertyValue("border-bottom-width"))+parseFloat(v.getPropertyValue("border-top-width")),a=W.SIZING_STYLE.map(function(y){return y+":"+v.getPropertyValue(y)
}).join(";"),Z={sizingStyle:a,paddingSize:e,borderSize:g,boxSizing:G};return F&&(this.computedStyleCache=Z),Z},calculateTextareaHeight:function(C){C=C||"";var h=this,F=h.textarea,P=h.hiddenTextarea,I=h.wrap,Q=32,O=h.calculateHTMLStyle(F,!1),A=O.paddingSize,$=O.borderSize,y=O.boxSizing,L=O.sizingStyle;P.setAttribute("style",L+";"+h.HIDDEN_TEXTAREA_STYLE),P.value=F.value+C;var W=P.scrollHeight;"border-box"===y?W+=$:"content-box"===y&&(W-=A),F.style.height=W+"px",F.style.marginTop=0-.5*W+"px",I.style.height=Math.max(W,Q)+"px",I.style.marginTop=W*-.5+"px"}});var po=vh.ScrollBarInteractor=function(z){ag(po,this,[z])};en("ScrollBarInteractor",Gg,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(k){var A=this.gv.getViewRect();return this._41o()&&(A.x+A.width-this.gv.lp(k).x)*this.gv.getZoom()<kd},isH:function(m){var Q=this.gv.getViewRect();return this._40o()&&(Q.y+Q.height-this.gv.lp(m).y)*this.gv.getZoom()<kd},handle_mousemove:function(a){this.handle_touchmove(a)},handle_touchmove:function(p){if(!Lh&&rf(p)&&this.gv.isScrollBarVisible()){var P=this,Z=P.isV(p),l=P.isH(p);(Z||l)&&P.gv.showScrollBar(),P.gv._scrolling=Z||l}},handleWindowMouseUp:function(i){this.handleWindowTouchEnd(i)},handleWindowTouchEnd:function(r){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=F,this.fi({kind:"endScroll",event:r})},handle_mousedown:function(j){this.handle_touchstart(j)},handle_touchstart:function(V){var b=this;if(b.gv.setFocus(V),cc(V),b.handle_touchmove(V),!(Hh(V)>1)&&b.gv._scrolling&&b.gv.isScrollBarVisible()){b._cp=sf(V),b._tx=b.gv.tx(),b._ty=b.gv.ty();var h=b.isV(V);b._state=h?"vScroll":"hScroll",om(b,V),b.fi({kind:"beginScroll",event:V})}},handleWindowMouseMove:function(p){this.handleWindowTouchMove(p)},handleWindowTouchMove:function(W){var r=sf(W),w=this.gv.getViewRect(),d=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-r.y)*d.height/w.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-r.x)*d.width/w.width),this.fi({kind:"betweenScroll",event:W})}});var di=vh.TouchInteractor=function(r,u){u=u||{},u.selectable===Y&&(u.selectable=!0),u.movable===Y&&(u.movable=!0),u.pannable===Y&&(u.pannable=!0),u.pinchable===Y&&(u.pinchable=!0),u.editable===Y&&(u.editable=!0),this.params=u,ag(di,this,[r])};en("TouchInteractor",Gg,{ms_edit:1,setUp:function(){var U=this;di.superClass.setUp.call(U),Mc&&U.params.editable&&U.gv.setEditInteractor(U)},tearDown:function(){var V=this;di.superClass.tearDown.call(V),Mc&&V.params.editable&&V.gv.setEditInteractor(F)},clear:function(B){var Y=this,S=Y.gv;S._moving&&(Y.fi({kind:"endMove",event:B}),delete S._moving,S.onMoveEnded(),S.dm().endTransaction()),S._panning&&(Y.fi({kind:"endPan",event:B}),delete S._panning,S.onPanEnded()),S._pinching&&(Y.fi({kind:"endPinch",event:B}),delete S._pinching,S.onPinchEnded()),S._editing&&(Y._46O(B),Y._77I=Y._node=Y._edge=Y._shape=Y._rect=Y._89I=Y._index=S._editing=F),Y.pendingClickThrough=Y._moving=Y._panning=Y._pinching=Y._editing=Y._57I=Y._data=Y._beginHistory=F,Y.clearDragging()},handle_touchstart:function(x){var w=this;if(!w.gv._editing){cc(x),w._57I=F,w.pendingClickThrough=F;var U=w.params,n=w.gv,Q=n.sm(),z=n.getDataAt(x),d=Hh(x);if(1===d){if(hl(x))return n.handleDoubleClick(x,z),void 0;n.handleClick(x,z),z&&(n.handleMouseDown&&n.handleMouseDown(x,z),w._data=z),U.selectable||(z=F),z&&(Q.co(z)?z instanceof tm&&z.isClickThroughEnabled()&&(w.pendingClickThrough=sf(x)):Q.ss(z),U.editable&&n.isEditable(z)&&w._79I(x,z,!0)?(w._editing=1,w.startDragging(x)):U.movable&&n.isMovable(z)&&(w._moving=1,w.startDragging(x))),z&&(n.isMovable(z)||n._39Q(z))||(w._57I=sf(x),U.pannable&&n.isPannable()&&(w._panning=1,w.startDragging(x),w._translate={x:n.tx(),y:n.ty()}))}else if(U.pinchable&&2===d){if(!n.getEditInteractor()&&z){var P=ti(n.getImage(z));if(P&&ur(P.scrollable,z,this))return}w._pinching=1,w.startDragging(x);var Y=n.getView(),I=n.getZoom(),f=Y.getBoundingClientRect(),V=x.touches[0],T=x.touches[1],C={x:(V.clientX+T.clientX)/2-f.left,y:(V.clientY+T.clientY)/2-f.top};C.x-=n.tx(),C.y-=n.ty(),C.x/=I,C.y/=I,w._p=C,w._d=xp(x)}}},handle_touchend:function(H){var e=this,O=e.gv,$=e._57I,N=e._data;if($&&(Gd($,sf(H))<=1&&!O.getDataAt(H)&&O.sm().cs(),e._57I=F),N&&O.handleMouseUp&&O.handleMouseUp(H,N),e.pendingClickThrough){if(Gd(e.pendingClickThrough,sf(H))<=1){var N=O.getDataAt(H);if(N instanceof tm&&N.isClickThroughEnabled()){var P=O.getDataAt(H,function(D){var u=D.getParent()===N&&O.isSelectable(D,!0);return u});P&&(H.clickThrough=!0,O.sm().ss(P))}}e.pendingClickThrough=F}},handleWindowTouchEnd:function(C){this.clear(C)},handleWindowTouchMove:function(b){var a=this,n=a.gv,B=Hh(b);if(1===B){var W=sf(b),R=ap(n,W,a._lastClientPoint),o=Gd({x:0,y:0},R);if(a._editing&&(a._beginHistory||(a._beginHistory=1,n.dm().beginTransaction()),n._editing=1,a._78I(b)),a._moving){if(!n._moving&&o<x.touchMoveThreshold)return;a._beginHistory||(a._beginHistory=1,n.dm().beginTransaction()),a.handleMove(b)}else if(a._panning){if(!n._panning&&o<x.touchMoveThreshold)return;n.setTranslate(a._translate.x+R.x,a._translate.y+R.y),a.fi({kind:n._panning?"betweenPan":"beginPan",event:b}),n._panning=1}}else if(2===B&&a._pinching){var e=xp(b);n.handlePinch(a._p,e,a._d),a._d=e,a.fi({kind:n._pinching?"betweenPinch":"beginPinch",event:b}),n._pinching=1}},handleMove:function(x){var e=this,v=e.gv,q=v.lp(x);v._93O&&v._93O(x,e._data)||(v.moveSelection(q.x-e._lastLogicalPoint.x,q.y-e._lastLogicalPoint.y),e._lastLogicalPoint=q,e.autoScroll(x),e.fi({kind:v._moving?"betweenMove":"beginMove",event:x}),v._moving=1)}});var R=t.ht,Sm=R.graph._editor={Math:R.Math,Guide:{}};Sm.getStyle=function(n){var B,m=Sm.StyleMap;return m&&(B=m[n],B!==Y)?B:Sm.DefaultStyleMap[n]},Sm.setStyle=function(v,W){var q=Sm.StyleMap;q||(q=Sm.StyleMap={}),q[v]=W},Sm.inEdit=function(C){return C._inXEdit===!0},Sm.startEdit=function(x){x._inXEdit=!0,Sm.Inject.doInject(x)},Sm._46O=function(n){n._inXEdit=!1,Sm.Inject.undoInject(n)},Sm.toScreenPosition=function(P,h){var x=P.tx(),d=P.ty(),G=P._zoom;return new Sm.Math.Vector2(h.x*G+x,h.y*G+d)},Sm.checkHit=function(X,a,Z){return X.distanceTo(a)<Z?!0:!1},Sm.toWorldPosition=function(J,g){var n=J.tx(),A=J.ty(),H=J._zoom;return{x:(g.x-n)/H,y:(g.y-A)/H}},Sm.setAntialias=function(o,c){for(var e,s=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],g=0,v=s.length;v>g&&(e=s[g],!(e in o));g++);o[e],o[e]=c},Sm.getTargetCornersOnScreen=function(B,L){if(!L)return null;var F,o=[];if(Xr(L,B)){var u=Bf(B,L);F=[{x:u.x,y:u.y},{x:u.x+u.width,y:u.y},{x:u.x+u.width,y:u.y+u.height},{x:u.x,y:u.y+u.height}]}else{if(!L.getCorners)return null;F=L.getCorners()}return F.forEach(function(g){var e=Sm.toScreenPosition(B,g);o.push(e.x,e.y)}),o},Sm.log=function(){};var um;Sm.updateTipInfo=function(s,S,f){if(f){var g=R.Default.getLogicalPoint(s,S._canvas);g.x+=Sm.Icons.TipShiftX,g.y+=Sm.Icons.TipShiftY,um={helperPos:g,text:f,size:f.length}}else um=F},Sm.drawTip=function(k,x){um&&Sm.Icons.DrawIcon(x,k,Sm.Icons.TipHelper,um)};var Ch=Sm.Inject={_modules:[]};Ch.registAsModule=function(D,n){var l={},V={};for(var B in D){var G=n.prototype[B];l[B]=G}D.getBackup=function(b){return l[b]},D.getBackups=function(){return l},V.doInject=function(){for(var w in D)"getBackup"!==w&&(n.prototype[w]=D[w])},V.undoInject=function(){for(var t in D)"getBackup"!==t&&(n.prototype[t]=l[t])},Ch._modules.push(V)},Ch.doInject=function(e){for(var $,G=Ch._modules,T=0,u=G.length;u>T;T++)$=G[T],$.doInject(e)},Ch.undoInject=function(u){for(var S,o=Ch._modules,y=0,G=o.length;G>y;y++)S=o[y],S.undoInject(u)};var Gg=R.graph.EditInteractor=function(Z){var o=this,W=M.createElement("canvas");W.className="editCanvas",W.style.position="absolute",o._uuid=R.Math.generateUUID(),o._styleMap={},o._canvas=W,o._context=W.getContext("2d"),Gg.superClass.constructor.call(o,Z),this._editDetail=!1,Sm.setAntialias(o._context,!1),o._subModules=[new Sm.Anchor(o),new Sm.RotateX(o),new Sm.MoveDummy(o),new Sm.Rect(o),new Sm.Curve(o),new Sm.MoveHelper(o)],o._gridGuide=new Sm.Guide.Grid(o),o._rectGuide=new Sm.Guide.Rect(o),o._hoverGuide=new Sm.Guide.Hover(o)},ao=Gg;R.Default.def(Gg,R.graph.Interactor,{ms_edit:1,ms_fire:1}),S.defineProperties(Gg.prototype,{editDetail:{get:function(){var L=!!this._editDetail;return L},set:function(K){var i=this,w=i._editDetail;w!==K&&(i._editDetail=K,i.gv._editing=K,i.fp("editDetail",w,K),i.fp("pointsEditingMode",w,K),i.fi({kind:K?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(d){(!this._editDetail||d)&&(this.gv._editing=d,d||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(g){this._editing=g,this.gvEditing=g}},editingModule:{get:function(){return this._editMod}},pointsEditingMode:{get:function(){return this.editDetail},set:function(h){var i=this;i.editDetail!==h&&(h?i._tryEnterEditDetailMode():i._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var m=this._gridEnabled;if(!m)return!1;var K=this.gv;return K?!0:!0},set:function(z){z!==this._gridEnabled&&(this._gridEnabled=z,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(T){T!==this._agEnabled&&(this._agEnabled=T,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),Gg.prototype.getSubModule=function(k){var Y,T,W,O=this._subModules;for(T=0,W=O.length;W>T;T++)if(Y=O[T],Y.catalog===k)return Y},Gg.prototype.invokeSubModule=function(n,I){for(var J,g,p,x=this,z=x._subModules,f=Array.prototype.slice.call(arguments,2),m=0,V=z.length;V>m;m++)if(J=z[m],g=J[n],g&&(p=g.apply(J,f),p!=Y&&I))return J},Gg.prototype.invokeSubModuleInverse=function(v,I){var T=this,S=T._subModules;if(S)for(var q,x,w,V=Array.prototype.slice.call(arguments,2),p=S.length-1;p>=0;p--)if(q=S[p],x=q[v],x&&(w=x.apply(q,V),w!=Y&&I))return q},Gg.prototype.setUp=function(){Sm.log("setUp");var l=this,k=l.gv,L=k.getView(),S=l._canvas;Gg.superClass.setUp.call(l),k.setEditInteractor(l),k._79O?L.insertBefore(S,k._79O):L.appendChild(S),Sm.startEdit(k),l.invokeSubModule("setUp"),k.dm().mm(l._onDataModelChanged,l),k.dm().md(l._onDataPropertyChanged,l)},Gg.prototype.tearDown=function(){Sm.log("tearDown");var f=this,l=f.gv,q=l.getView();f._resetCustomCursorStyle(),Gg.superClass.tearDown.call(f),l.dm().umm(f._onDataModelChanged,f),l.dm().umd(f._onDataPropertyChanged,f),l.setEditInteractor(null),q.removeChild(f._canvas),f._drawTimer&&(ee(f._drawTimer),f._drawTimer=null),Sm._46O(l),f.invokeSubModule("tearDown")},Gg.prototype._onDataModelChanged=function(b){var m=this;("clear"===b.kind||"remove"===b.kind&&m.editDetail&&b.data===m.getSubModule("Curve").target)&&(m.editDetail=!1,m._42())},Gg.prototype._onDataPropertyChanged=function(K){var F=this;if(F.editDetail){var I=F.getSubModule("Curve"),r=K.data;r===I.target&&(r._writing||I._handleDataChanged(K))}},Gg.prototype.clear=function(){Sm.log("clear")},Gg.prototype.redraw=function(){this._42()},Gg.prototype._42=function(){var P=this;P._drawTimer||(P._drawTimer=bg(function(){P._drawTimer=null,P.drawImpl()},0))},Gg.prototype.drawImpl=function(){var o;for(o in{_42:!0})break;return function(){var f=this,c=f._canvas,J=f.gv,K=J.getWidth(),u=J.getHeight(),T=f._context,Q=R.Default.getInternal(),X=x.devicePixelRatio;(c.width!==K||c.height!==u)&&Q.setCanvas(c,K,u,X),T.clearRect(0,0,c.width,c.height);var $=f._getValidSelection();T.save(),T.scale(X,X),f._gridGuide._42(),f.invokeSubModuleInverse(o,!1,T,J,$),f._rectGuide._42(),f._hoverGuide._42(),T.restore()}}(),Gg.prototype._getValidSelection=function(){var g=this,f=g.gv,A=f.sm().getSelection(),s=[];return A.each(function(O){f.isVisible(O)&&f.isEditable(O)&&s.push(O)}),s},Gg.prototype.handle_touchmove=function(f){return this.handle_mousemove(f)},Gg.prototype.handle_mousemove=function(n){if(!R.Default.isDragging()){var v=this;if((v.editDetail||!an()&&!qn(n))&&!v.gv._externalEditing){if(v.gvEditing=!1,v._checkEdit(n))v.gvEditing=!0;else{if(!v.getStyle("hoverGuideVisible"))return;v.hoverData=v.gv.getDataAt(n)}v._42()}}},Gg.prototype.handle_touchstart=function(c){return this.handle_mousedown(c)},Gg.prototype.handle_mousedown=function(_){cc(_);var o=this;if((o.editDetail||!an()&&!qn(_))&&!o.gv._externalEditing){if(hl(_)&&!_.clickThrough){if(o.editDetail){if(o._tryQuitEditDetailMode(_))return}else if(o._tryEnterEditDetailMode())return;o.gv.dm().beginTransaction();var F=o.invokeSubModule("handleDoubleClick",!0,_);if(o.gv.dm().endTransaction(),F)return}var U=o._checkEdit(_);U&&(o._downPosition=o._getLogicalPoint(_),o.gv.dm().beginTransaction(),U.startEdit(o,_),o.editing=!0)}},Gg.prototype._checkEdit=function(t){var z=this,U=z.gv,V=z._getLogicalPoint(t),n=z.invokeSubModule("check",!0,U,t,V)||null;return z._editMod=n,n},Gg.prototype.handleWindowTouchMove=function(g){return this.handleWindowMouseMove(g)},Gg.prototype.handleWindowMouseMove=function(f){var F=this,y=F._downPosition;if(y){var W=F._getLogicalPoint(f);if(W.distanceTo(y)<F.getStyle("moveSensitivity"))return;delete F._downPosition}var k=F._editMod;k&&k.handleEdit(F.gv,f),F.redraw()},Gg.prototype._getLogicalPoint=function(I){var a=this,T=R.Default.getLogicalPoint(I,a._canvas);return new Sm.Math.Vector2(T)},Gg.prototype.handleWindowTouchEnd=function(A){return this.handleWindowMouseUp(A)},Gg.prototype.handleWindowMouseUp=function(){var W;for(W in{_46O:!0})break;return function(x){var M=this;M.editing=!1,M.setCursor("default"),M.invokeSubModule(W,!1,x),M._42(),M.gv.dm().endTransaction()}}(),Gg.prototype.handle_mousewheel=function(Z){var W=this;cc(Z),W.invokeSubModule("preHandleScroll",!0)||W.gv.handleScroll(Z,Z.wheelDelta)},Gg.prototype.handleDelete=function(){var u=this;if(!u.editDetail){u.gv.dm().beginTransaction();var e=u.invokeSubModule("handleNormalStateDelete",!0);return u.gv.dm().endTransaction(),e||u.gv.removeSelection(),void 0}u.gv.dm().beginTransaction(),u.invokeSubModule("handleDelete",!0),u.gv.dm().endTransaction(),u._42()},Gg.prototype.handle_keydown=function(A){var S=this;if((A.metaKey||A.ctrlKey)&&S._42(),an(A)&&!S.editing)return S.gvEditing=!1,S.setCursor("default"),S._42(),void 0;var h=kj(A);return S.editDetail?((h||Ei(A))&&(S.editDetail=!1,S._42()),S.gv.dm().beginTransaction(),S.invokeSubModule("handle_keydown",!0,A),S.gv.dm().endTransaction(),void 0):(S.gv.dm().beginTransaction(),S.invokeSubModule("handleNormalStateKeyDown",!0,A),S.gv.dm().endTransaction(),h&&S._tryEnterEditDetailMode(),void 0)},Gg.prototype.handle_keyup=function(u){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,u),this.gv.dm().endTransaction()},Gg.prototype._tryEnterEditDetailMode=function(){var q=this;return!q.editDetail&&q.invokeSubModule("canEnterEditDetailMode",!0)&&1===q._getValidSelection().length?(q.editDetail=!0,q._42(),!0):void 0},Gg.prototype._tryQuitEditDetailMode=function(g){var J=this;return J.editDetail?!g||J.invokeSubModule("canQuitEditDetailMode",!0,g)?(J.editDetail=!1,J._42(),!0):!1:!1},Gg.prototype.setStyle=function(a,L,m){var G=this;m?Sm.setStyle(a,L):G._styleMap[a]=L,"baseColor"===a&&(tc=L),G.fp("styleChanged",null,{key:a,value:L,base:m}),G._42()},Gg.prototype.getStyle=function(z){var q=this,w=q._styleMap[z];return w!==Y?w:Sm.getStyle(z)},Gg.prototype.setCursor=function(a){this._resetCustomCursorStyle(),R.graph.EditInteractor.superClass.setCursor.call(this,a)},Gg.prototype._drawHostGuide=function(o){var g=this,R=g._context,u=g.gv;Sm.Icons.DrawIcon(g,R,Sm.Icons.NodeHoverGuide,o.corners);var B=o.host;if(B){var z=u.getAttachPoints(B);if(z&&z.length)for(var T=0,n=z.length;n>T;T++){var $=z[T],k=lb(u,B,0,$.offsetX||0,$.offsetY||0,$.x,$.y);k=Sm.toScreenPosition(u,k),k.isAttach=o.attach===T,Sm.Icons.DrawIcon(g,R,Sm.Icons.AttachPoint,k)}}},Gg.prototype._resetCustomCursorStyle=function(){var V=this;if(V._customStyle){var N=this.gv.getView();N.classList&&N.classList.remove&&N.classList.remove(V._customStyle),V._customStyle=null}},Gg.prototype._setRotateCursor=function(P){var F=this,a=F._cursorFactory;a||(a=F._cursorFactory=new Sm.CursorFactory(F));var M=a.getRotateCursor(P),R=F.gv.getView();F._resetCustomCursorStyle(),F._customStyle=M,R.classList&&R.classList.add&&R.classList.add(M)};var df=Sm.Group=function(b){var C=this;C._entities=b,C._64O=0,C._position={x:0,y:0},C._scale={x:1,y:1},C._anchor={x:.5,y:.5},C._anchor2={x:.5,y:.5}};df.prototype={},df.prototype.constructor=df;var oo=null,Kr=null;df.findOrCreateGroup=function($,U){if(Kr===U&&oo&&oo.checkIsMe($))return oo;Kr=U;var r=new Sm.Group($);return r.getKeyOb()?(oo=r,r):void 0},df.prototype.checkIsMe=function(v){var q=this._entities;if(q.length!==v.length)return!1;var r,P={},s=v.length;for(r=0;s>r;r++)P[v[r]._id]=!0;for(r=0;s>r;r++)if(!P[q[r]._id])return!1;return!0},df.prototype.getRotation=function(){return this._64O},df.prototype.getPosition=function(){return this._position},df.prototype.getAnchor=function(){return this._anchor},df.prototype.getWidth=function(){return this._width},df.prototype.getScale=function(){return this._scale},df.prototype.getSize=function(){return{width:this._width,height:this._height}},df.prototype.getHeight=function(){return this._height},df.prototype.getKeyOb=function(){for(var b=this._entities,Q=b.length-1;Q>=0;Q--){var L=b[Q];if(this.isNode(L))return L}},df.prototype.getAnchor2=function(){var F=this,b=F.rotateCenter;if(b)return b;var E=F.getKeyOb();if(!E)return F._anchor;var z=F._anchor2,f=E.getMatrix();return f.tf({x:E.getWidth()*(z.x-E.getAnchor().x),y:E.getHeight()*(z.y-E.getAnchor().y)})},df.prototype.setAnchor2=function(i,s){var X=this,I=X.getKeyOb();if(I){var p,A=I.getMatrix();p="number"==typeof i?{x:i,y:s}:i;var S=A.tfi(p);X._anchor2={x:I.getAnchor().x+S.x/I.getWidth(),y:I.getAnchor().y+S.y/I.getHeight()}}},df.prototype.setRotation=function(){},df.prototype.beginRotate=function(a){this.rotateCenter=a.pos,this.rotateMode=a.groupRotateMode},df.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},df.prototype.addRotation=function(T,p,l){return"batch"===p?this._addRotationInBatchMode(T,l):"block"===p?this._addRotationInBlockMode(T,l):void 0},df.prototype._addRotationInBlockMode=function(t,l){var g=this,U=g.rotateCenter||g.getPosition();g._entities.forEach(function(G){if(g.isNode(G)&&(!l||l(G))){var Q=G.getMatrix();Q.translate(-U.x,-U.y),Q.rotate(t),Q.translate(U.x,U.y);var j=Math.sign(G.getScale().x);G.setRotation(jm(Q.b*j,Q.a*j)),G.setPosition(Q.tx,Q.ty)}})},df.prototype._addRotationInBatchMode=function(A,s){var x=this,v=x._anchor2;x._entities.forEach(function(q){if(x.isNode(q)&&(!s||s(q))){var $=q.getAnchor(),z=q.getMatrix(),I=z.tf({x:q.getWidth()*(v.x-$.x),y:q.getHeight()*(v.y-$.y)}),b=new Sm.Math.Matrix2d;b.set(z.a,z.b,z.c,z.d,z.tx,z.ty),b.translate(-I.x,-I.y),b.rotate(A),b.translate(I.x,I.y);var Y=Math.sign(q.getScale().x);q.setRotation(jm(b.b*Y,b.a*Y)),q.setPosition(b.tx,b.ty)}})},df.prototype.setPosition=function(r){var d,I,j,_,G=this,c=G._position,A=r.x-c.x,x=r.y-c.y,J=G._entities;for(I=0,j=J.length;j>I;I++)d=J[I],Im(d)&&(_=d.getPosition(),d.setPosition(_.x+A,_.y+x));G._position=r},df.prototype.setScale=function(G,E){var c=this,y=G/c._scale.x,$=E/c._scale.y;c._adjustChildScaleOrSize(y,$,"size"),c._scale={x:G,y:E}},df.prototype.getRect=function(){var p=this,y=p._position,V=p._width,x=p._height;return{x:y.x-V/2,y:y.y-x/2,width:V,height:x}},df.prototype.setSize=function(s,y){var v=this,s=Math.max(1,s),y=Math.max(1,y),U=s/v._width,K=y/v._height;v._adjustChildScaleOrSize(U,K,"size"),v._width=s,v._height=y},df.prototype._adjustChildScaleOrSize=function(z,R,X){var V,I,N,a,K,M,Q,l,b,i,A,P,G,j,_=this,U=_._position,F=_._entities,C=new Sm.Math.Matrix2d;for(I=0,N=F.length;N>I;I++)if(V=F[I],_.isNode(V)){if(a=V.getPosition(),K=V.getRotation(),M=V.getWidth(),Q=V.getHeight(),l=V.getScale(),A=l.x*M,P=l.y*Q,C.identity().scale(A,P).rotate(K).translate(a.x,a.y).translate(-U.x,-U.y).rotate(-_._64O),K=jm(C.b*Math.sign(A),C.a*Math.sign(A)),C.scale(z,R),b=Math.cos(K),i=Math.sin(K),Math.abs(b)<.001?(G=C.b/i,j=-C.c/i):(G=C.a/b,j=C.d/b),"scale"===X)V.setScale(G/M,j/Q);else if("size"===X){var x=G/l.x,E=j/l.y;V.setScale(ip(G)*Math.abs(l.x),ip(j)*Math.abs(l.y)),V.setSize(Math.max(.1,Math.abs(x)),Math.max(.1,Math.abs(E)))}C.rotate(_._64O).translate(U.x,U.y),V.setPosition(C.tx,C.ty)}},df.prototype.getMatrix=function(){var l=this,B=l._position,C=R.Default.getInternal(),V=l._scale;return new C.Mat(l._64O,B.x,B.y,V.x,V.y)},df.prototype.toGlobal=function(Z){return this.getMatrix().tf(Z)},df.prototype.getCorners=function(){var g=this,m=g._width,C=g._height,h=g._anchor,y=-m*h.x,R=-C*h.y,j=g.getMatrix();return[j.tf(y,R),j.tf(y,R+C),j.tf(y+m,R+C),j.tf(y+m,R)]},df.prototype.calcInfo=function(){var q,G,C,O,p,F,W=this,V=[],A=W._entities,U=W._64O;for(O=0,p=A.length;p>O;O++)F=A[O],W.isNode(F)&&F.getCorners&&V.push.apply(V,F.getCorners());if(V.length){var s=Math.cos(-U),P=Math.sin(-U),z=1/0,M=-1/0,w=1/0,l=-1/0;for(O=0,p=V.length;p>O;O++)C=V[O],q=C.x,G=C.y,C.x=s*q-P*G,C.y=P*q+s*G,z=Math.min(z,C.x),M=Math.max(M,C.x),w=Math.min(w,C.y),l=Math.max(l,C.y);W._width=(M-z)/W._scale.x,W._height=(l-w)/W._scale.y,s=Math.cos(U),P=Math.sin(U);var T=W._anchor;q=z+(M-z)*T.x,G=w+(l-w)*T.y,W._position={x:s*q-P*G,y:P*q+s*G}}},df.prototype.isNode=function(q){return Im(q)?Xr(q)?q.size()?!1:!0:!0:!1},df.prototype._42=function(B,F,z){var N,R,u,y,A,w,c,H,d=this,J=d._entities,L=d.rotateMode;for("batch"===L&&(H=d.getKeyOb()),N=0,R=J.length;R>N;N++)u=J[N],d.isNode(u)&&(w=u.getRect(),y=Sm.toScreenPosition(z,{x:w.x,y:w.y}),A=Sm.toScreenPosition(z,{x:w.x+w.width,y:w.y+w.height}),c={min:y,max:A},u===H&&(c.isKeyOb=!0),Sm.Icons.DrawIcon(B,F,Sm.Icons.GroupSubEntityRect,c))};var Gr=Sm.CurveActiving=function(B,Q){this._curve=B,this._interactor=B._interactor,this.silent=!0;for(var Y in Q)this[Y]=Q[Y];delete this.silent};Gr.prototype={},Gr.prototype.constructor=Gr,S.defineProperties(Gr.prototype,{point:{get:function(){return this._point},set:function(w){var M=this;M._point=w,M.editingCtrl||M.silent||M._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(J){var L=this;L._pairs=J,L.editingCtrl&&!L.silent&&L._firePointChange()}}}),Gr.prototype._firePointChange=function(){var O=this,l=O.getCurrentEditingPoint(),S=O._interactor;if(!l)return S.fi({kind:"selectPoint"}),void 0;var V=this._curve.target;if(V){var a=Sm.getDataMatrix(V).invert(),H=l.e;l=a.apply(Sm.toWorldPosition(S.gv,l)),l.e=H;var I=O._lastFirePoint;I&&Math.abs(l.x-I.x)<1e-5&&Math.abs(l.y-I.y)<1e-5&&(l.e==Y&&I.e==Y||Math.abs(l.e-I.e)<1e-5)||(O._lastFirePoint=l,S.fi({kind:"selectPoint",x:l.x,y:l.y,e:l.e}))}},Gr.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Gr.prototype.getCurrentEditingPoint=function(){var x=this,I=x.editingCtrl;if(I){var s=x.pairs;if(s){var $=s[I.pairId];if($){var y=$[I.type];if(y)return y}}}return x._point};var Zd=Sm.CursorFactory=function(U){var E=this;E._interactor=U,E._rotateCursorStyles={}};Zd.prototype={},Zd.prototype.constructor=Zd,Zd.prototype.getRotateCursor=function(P){var u=this;0>P&&(P+=2*Math.PI);var D=u._interactor,Y=D.getStyle("rotateCursorSize"),O=D.getStyle("rotateCursorRound"),z=Math.round(180*(P/Math.PI)/O);z*O>=360&&(z=0);var i=u._rotateCursorStyles,t="htCustomRotateStyle_"+Y+"_"+O+"_"+z;return i[t]||(u._produceRotateCursor(t,Y,O,z),i[t]=!0),t},Zd.prototype._produceRotateCursor=function(R,h,p,w){var J=this;J._interactor;var c=J._canvas;c||(c=J._canvas=M.createElement("canvas"));var s=x.devicePixelRatio;c.width=c.height=h*s,c.style.width=c.style.height=h+" px";var Y=c.getContext("2d");Sm.setAntialias(Y,!1),Y.scale(s,s);var e,H,K,W,C,f=Math.round(h/2),G=""+f+" "+f+",auto !important;",D=4;e=Math.PI/180*w*p,Y.clearRect(0,0,h,h),Y.save(),Y.scale(h/32,h/32),Y.translate(16,15),Y.rotate(e+Math.PI/2),Y.beginPath(),Y.moveTo(-8,0),Y.lineTo(-8,D),Y.lineTo(-8+D,D),Y.moveTo(8,0),Y.lineTo(8,D),Y.lineTo(8-D,D),Y.moveTo(-8,D),Y.quadraticCurveTo(0,-6,8,D),Y.restore(),Y.lineCap="round",Y.lineJoin="miter",Y.strokeStyle="white",Y.lineWidth=4,Y.stroke(),Y.strokeStyle="black",Y.lineWidth=2,Y.stroke(),H=JSON.stringify(c.toDataURL()),W="cursor:url("+H+")"+G,1!==s&&(K='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+h+'px" height="'+h+'px"><image xlink:href='+H+' width="'+h+'" height="'+h+'"/></svg>',W+="cursor:url(data:image/svg+xml;base64,"+btoa(K)+")"+G,W+="cursor:-webkit-image-set(url("+H+")"+s+"x,url("+H+")1x)"+G),C=M.createElement("style"),C.textContent="body."+R+" *, ."+R+"{"+W+"}",M.head.appendChild(C)};var sd=Sm.Guide.Grid=function(q){var t=this;t._interactor=q,t._alignmentGuideId=0,t._xAlignmentGuide=[],t._yAlignmentGuide=[]};sd.prototype={},sd.prototype.constructor=sd,S.defineProperties(sd.prototype,{gridBlockSize:{get:function(){var X=this;return X._gridBlockSize||X._interactor.getStyle("gridBlockSize")},set:function(Z){this._gridBlockSize=Z,this._interactor._42()}},gridThickLinesEvery:{get:function(){var _=this;return _._gridThickLinesEvery||_._interactor.getStyle("gridThickLinesEvery")},set:function(c){this._gridThickLinesEvery=c,this._interactor._42()}},gridEnabled:{get:function(){var C=this,Q=C._interactor;return Q.gridEnabled&&C.isValidGrid()}}}),sd.prototype._42=function(){var Y=this,d=Y._interactor;Y.gridEnabled&&Y.drawGrid(),d.alignmentGuideEnabled&&Y.drawAlignmentGuide()},sd.prototype.makeMatrix=function(){var m=this,M=m._interactor.getStyle("gridAngle"),n=m._interactor.getStyle("gridRotation"),R=new Sm.Math.Matrix2d,L=Math.sin(M),d=Math.cos(M);return R.set(1,0,d,L,0,0),R.rotate(n),R},sd.prototype.isValidGrid=function(){var A=this,E=Math.PI,Y=A._interactor,N=Y.gv;if(N._zoom<Y.getStyle("gridZoomThreshold"))return!1;var w=Y.getStyle("gridAngle"),l=Math.abs(180*(w%E/E)),p=1-1e-8;return p>l||l>180-p?!1:!0},sd.prototype.drawAlignmentGuide=function(){var i=this,C=i._interactor,$=C.gv,f=C._canvas,e=C._context,G=f.width,J=f.height,g=$.tx(),j=$.ty(),L=$._zoom;e.beginPath(),e.strokeStyle=C.getStyle("gridAlignmentGuideColor"),e.lineWidth=1,i._xAlignmentGuide.forEach(function(K){var d=K.p*L+g;e.moveTo(d,0),e.lineTo(d,J)}),i._yAlignmentGuide.forEach(function(r){var x=r.p*L+j;e.moveTo(0,x),e.lineTo(G,x)}),e.stroke()},sd.prototype.drawGrid=function(){function v(t,X,F,k){var P=Sm.toScreenPosition(C,p.apply({x:t,y:X})),K=Sm.toScreenPosition(C,p.apply({x:F,y:k}));G.moveTo(P.x,P.y),G.lineTo(K.x,K.y)}var q=this,J=q._interactor,Z=q.gridBlockSize,f=q.gridThickLinesEvery,j=J.getStyle("gridThickColor"),B=J.getStyle("gridLightColor"),C=J.gv,r=J._canvas,G=J._context,k=r.width,T=r.height,p=q.makeMatrix(),i=p.applyInverse(Sm.toWorldPosition(C,{x:0,y:0})),U=p.applyInverse(Sm.toWorldPosition(C,{x:k,y:0})),e=p.applyInverse(Sm.toWorldPosition(C,{x:0,y:T})),Y=p.applyInverse(Sm.toWorldPosition(C,{x:k,y:T})),x=Math.min(i.x,U.x,e.x,Y.x),u=Math.max(i.x,U.x,e.x,Y.x),P=Math.min(i.y,U.y,e.y,Y.y),d=Math.max(i.y,U.y,e.y,Y.y);k=u-x,T=d-P;var S=Math.ceil(x/Z),t=Math.floor(u/Z),H=Math.ceil(P/Z),L=Math.floor(d/Z);C.tx(),C.ty(),C._zoom;var n,M,l;for(G.save(),G.lineWidth=1,G.beginPath(),G.strokeStyle=j,l=Math.ceil(S/f)*f;t>=l;l+=f)n=l*Z,v(n,P,n,d);for(l=Math.ceil(H/f)*f;L>=l;l+=f)M=l*Z,v(x,M,u,M);for(G.stroke(),G.beginPath(),G.strokeStyle=B,l=S;t>=l;l++)0!==l%f&&(n=l*Z,v(n,P,n,d));for(l=H;L>=l;l++)0!==l%f&&(M=l*Z,v(x,M,u,M));G.stroke(),G.restore()},sd.prototype.getAlignmentGuides=function(){var b=this;return{x:b._xAlignmentGuide,y:b._yAlignmentGuide}},sd.prototype.addAlignmentGuide=function(R,U,j){var c=this,P="x"===R?c._xAlignmentGuide:c._yAlignmentGuide,j=j?j:++c._alignmentGuideId,k={p:U,id:j};if(P.length){var $=c._findClosestAlignmentGuide(k.p,P);$.dis<0?P.splice($.index+1,0,k):P.splice($.index,0,k)}else P.push(k);return c._interactor._42(),j},sd.prototype.findClosest=function(W,Z,U){var i=this,g=i._interactor,O=g.gv;U&&(W=Sm.toWorldPosition(O,W));var M,s,C,y=1/0,S=1/0,H=W.x,A=W.y;if(i.gridEnabled){var m=i.gridBlockSize,b=i.makeMatrix(),I=b.applyInverse(W);I=b.apply({x:Math.round(I.x/m)*m,y:Math.round(I.y/m)*m}),y=I.x-H,S=I.y-A,C=!0}if(g.alignmentGuideEnabled&&(M=i._findClosestAlignmentGuide(H,i._xAlignmentGuide).dis,s=i._findClosestAlignmentGuide(A,i._yAlignmentGuide).dis,Math.abs(M)<Math.abs(y)&&(y=M,C=!0),Math.abs(s)<Math.abs(S)&&(S=s,C=!0)),C){C=!1;var n=O._zoom,Q=g.getStyle("smartGuideThreshold")/n,o={};if(Math.abs(y)<Q&&"y"!==Z&&(o.x=U?y*n:y,C=!0),Math.abs(S)<Q&&"x"!==Z&&(o.y=U?S*n:S,C=!0),C)return o}},sd.prototype._findClosestAlignmentGuide=function(h,k){if(!k.length)return{dis:1/0};for(var u,x=0,L=k.length-1;L-x>1;)u=Math.floor((x+L)/2),k[u].p<h?x=u:L=u;var M=k[x].p-h,Q=k[L].p-h;return Math.abs(M)<=Math.abs(Q)?{line:k[x],dis:M,index:x}:{line:k[L],dis:Q,index:L}},sd.prototype.removeAllAlignmentGuide=function(x){var i=this;"y"!==x&&(i._xAlignmentGuide=[]),"x"!==x&&(i._yAlignmentGuide=[]),i._interactor._42()},sd.prototype.removeAlignmentGuide=function(h){for(var O,Y,k,E=this,D=E._xAlignmentGuide,H=0;2>H;H++)for(D=0===H?E._xAlignmentGuide:E._yAlignmentGuide,O=0,Y=D.length;Y>O;O++)if(k=D[O],k.id===h)return D.splice(O,1),E._interactor._42(),{axis:0===H?"x":"y",position:k.p};return!1},sd.prototype.adjustAlignmentGuide=function(t,M){var j=this,a=j.removeAlignmentGuide(t);return a?(j.addAlignmentGuide(a.axis,M,t),!0):!1};var up=Sm.Guide.Rect=function(O){var m=this;m._interactor=O};up.prototype={},up.prototype.constructor=up,up.prototype.gatherRects=function(){var q,B,Y,v,m=this,Q=m._interactor.gv,R=[],y=[],h={x:R,y:y},G={},_=Q.getDataModel(),P=_.a("width"),W=_.a("height");P&&W&&(q=0,B=0,Y=P,v=W,R.push({node:_,type:0,p:q},{node:_,type:1,p:q+Y/2},{node:_,type:2,p:q+Y}),y.push({node:_,type:0,p:B},{node:_,type:1,p:B+v/2},{node:_,type:2,p:B+v}),G[_._id||0]={x:q,y:B,width:Y,height:v}),_.each(function(b){if(Im(b)&&!Q.isSelected(b)&&Q.isVisible(b)&&Q.isValidGuideLineSource(b)){var D=!1;if(Q.sm().getSelection().each(function(s){D||(b.isHostOn(s)?D=!0:b.isDescendantOf(s)&&(D=!0))}),!D){var p=b.getRect();q=p.x,B=p.y,Y=p.width,v=p.height,R.push({node:b,type:0,p:q},{node:b,type:1,p:q+Y/2},{node:b,type:2,p:q+Y}),y.push({node:b,type:0,p:B},{node:b,type:1,p:B+v/2},{node:b,type:2,p:B+v}),G[b._id]=p}}}),R.sort(function(t,P){return t.p-P.p}),y.sort(function(c,k){return c.p-k.p}),m._grid=h,m._87I=G},up.prototype.gatherLines=function(M,B,i){var q,Y,G,K,P,l,k,c,p,$,E,y,X=this,t=[X.findClosest({x:M.x,y:M.y},B),X.findClosest({x:M.x+M.w/2,y:M.y+M.h/2},B),X.findClosest({x:M.x+M.w,y:M.y+M.h},B)],e={},H=X._87I;i=i||255;var j,U;for(X._guideLine=[],q=0;2>q;q++)for(e={},0===q?(K="y",c=M.x,p=c+M.w):(K="x",c=M.y,p=c+M.h),Y=0;3>Y;Y++)P=t[Y],P&&isFinite(P[K])&&(j=1<<3*q+Y,i&j&&(l=P[K+"Line"],k=l.node,U=k._id||0,e[U]||(e[U]=!0,y=H[U],"y"===K?($=y.x,E=y.x+y.width):($=y.y,E=y.y+y.height),G=l.p,X._guideLine.push({type:K,a:c,b:p,c:$,d:E,p:G,center:1===l.type}))))},up.prototype._binarySearchClosest=function(Q,y){if(!y.length)return{dis:1/0};for(var n,u=0,b=y.length-1;b-u>1;)n=Math.floor((u+b)/2),y[n].p<Q?u=n:b=n;var j=y[u].p-Q,t=y[b].p-Q;return Math.abs(j)<=Math.abs(t)?{line:y[u],dis:j}:{line:y[b],dis:t}},up.prototype.findClosest=function(w,U,P){var y=this,s=y._interactor,Z=s.gv,k=y._grid;P&&(w=Sm.toWorldPosition(Z,w));var $,b=y._binarySearchClosest(w.x,k.x),r=y._binarySearchClosest(w.y,k.y),V=b.dis,j=r.dis,m=Z._zoom,R=s.getStyle("smartGuideThreshold")/m,X={};return Math.abs(V)<R&&"y"!==U&&(X.x=P?V*m:V,X.xLine=b.line,$=!0),Math.abs(j)<R&&"x"!==U&&(X.y=P?j*m:j,X.yLine=r.line,$=!0),$?X:void 0},up.prototype._42=function(){var l=this,g=l._guideLine;if(g&&!R.Default.isCtrlDown()){var j=l._interactor;if(j.getStyle("guideLineVisible")){var C,o,v,k,c,L,z,F,G,D,p,u,P,$,B,a,M,H=j.gv,U=j._context,Y=H.tx(),S=H.ty(),r=H._zoom,O=j.getStyle("guideLineTextSpacing");for(C=0,o=g.length;o>C;C++)v=g[C],F=v.type,G=v.p,D=v.a,p=v.b,u=v.c,P=v.d,$=Math.min(D,u),B=Math.max(p,P),"x"===F?(k=G*r+Y,c=$*r+S,L=k,z=B*r+S):(k=$*r+Y,c=G*r+S,L=B*r+Y,z=c),Sm.Icons.DrawIcon(j,U,Sm.Icons.MoveLineGuide,{rect:[k,c,L,z],center:v.center}),P>=D&&p>=u||($=D>P?P:p,B=D>P?D:u,M=B-$,"x"===F?(v.center2center||(k-=O,L=k),c=$*r+S,z=B*r+S,a=Sm.Icons.MoveLineGuideDistanceV):"y"===F&&(v.center2center||(c-=O,z=c),k=$*r+Y,L=B*r+Y,a=Sm.Icons.MoveLineGuideDistanceH),Sm.Icons.DrawIcon(j,U,a,{x0:k,y0:c,x1:L,y1:z,dis:M}))
}}},up.prototype.clear=function(){this._guideLine=null};var zf=Sm.Guide.Hover=function(j){var S=this;S._interactor=j};zf.prototype={},zf.prototype.constructor=zf,S.defineProperties(zf.prototype,{}),zf.prototype._42=function(){var y=this._interactor;if(y.getStyle("hoverGuideVisible")&&!y.gvEditing){var g=y.hoverData,s=y.gv;if(!Im(g)||s.isSelected(g))return y.hoverData=null,void 0;var D=Bf(s,g),J=Sm.toScreenPosition(s,{x:D.x,y:D.y}),r=Sm.toScreenPosition(s,{x:D.x+D.width,y:D.y+D.height});Sm.Icons.DrawIcon(y,y._context,Sm.Icons.HoverDataRect,{min:J,max:r,color:y.getStyle("hoverGuideColor")||y.getStyle("baseColor"),borderWidth:y.getStyle("hoverGuideBorderWidth")||1,borderPattern:y.getStyle("hoverGuideBorderPattern")||[1,4]})}},Sm.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,rotateTipVisible:!0,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var gg=Sm.Icons={},Xi=1e4,Go=null,tc=Sm.DefaultStyleMap.baseColor,Vp="rgb(183,232,135)",pe="rgb(255,204,153)",Dp=6;R.Default.setImage("Icons.RectPoint",{width:Dp,height:Dp,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return tc}},rect:[0,0,Dp,Dp]}]}),gg.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var Q=gg.GroupSubEntityRect.data;if(!Q)return[];var E=Q.min,M=Q.max;return[E.x,E.y,E.x,M.y,M.x,M.y,M.x,E.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return gg.GroupSubEntityRect.data.isKeyOb?tc:tc}}}]};var th=4;gg.HoverDataRect={comps:[{type:"shape",points:{func:function(){var D=gg.HoverDataRect.data;if(!D)return[];var S=D.min,z=D.max,W=th;return S.x-=W,S.y-=W,z.x+=W,z.y+=W,[S.x,S.y,S.x,z.y,z.x,z.y,z.x,S.y]}},segments:[1,2,2,2,5],background:null,borderWidth:{func:function(){return gg.HoverDataRect.data.borderWidth}},borderColor:{func:function(){return gg.HoverDataRect.data.color}},borderCap:"butt",borderPattern:{func:function(){return gg.HoverDataRect.data.borderPattern}}}]},gg.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[gg.Line.data.P1.x,gg.Line.data.P1.y],Dp,Dp]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[gg.Line.data.P2.x,gg.Line.data.P2.y],Dp,Dp]}}}]},gg.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return gg.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},gg.Rect={comps:[{type:"shape",points:{func:function(){var l=gg.Rect.data;if(!l)return[];var R=l.LT,M=l.LB,U=l.RB,i=l.RT;return[R.x,R.y,M.x,M.y,U.x,U.y,i.x,i.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return tc}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return gg.Rect.data.rotation}},rect:{func:function(){return[[gg.Rect.data.LT.x,gg.Rect.data.LT.y],Dp,Dp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return gg.Rect.data.rotation}},rect:{func:function(){return[[gg.Rect.data.LB.x,gg.Rect.data.LB.y],Dp,Dp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return gg.Rect.data.rotation}},rect:{func:function(){return[[gg.Rect.data.RB.x,gg.Rect.data.RB.y],Dp,Dp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return gg.Rect.data.rotation}},rect:{func:function(){return[[gg.Rect.data.RT.x,gg.Rect.data.RT.y],Dp,Dp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return gg.Rect.data.rotation}},visible:{func:function(){return gg.Rect.data.L?!0:!1}},rect:{func:function(){return[[gg.Rect.data.L.x,gg.Rect.data.L.y],Dp,Dp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return gg.Rect.data.rotation}},visible:{func:function(){return gg.Rect.data.R?!0:!1}},rect:{func:function(){return[[gg.Rect.data.R.x,gg.Rect.data.R.y],Dp,Dp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return gg.Rect.data.rotation}},visible:{func:function(){return gg.Rect.data.T?!0:!1}},rect:{func:function(){return[[gg.Rect.data.T.x,gg.Rect.data.T.y],Dp,Dp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return gg.Rect.data.rotation}},visible:{func:function(){return gg.Rect.data.B?!0:!1}},rect:{func:function(){return[[gg.Rect.data.B.x,gg.Rect.data.B.y],Dp,Dp]}}}]};var Pb=16;R.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return tc}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return tc}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),gg.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[gg.Anchor.data.POS.x,gg.Anchor.data.POS.y],Pb,Pb]}}}]},gg.TipShiftX=12,gg.TipShiftY=12;var qq=[8,28];gg.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[gg.TipHelper.data.helperPos.x,gg.TipHelper.data.helperPos.y,qq[0]*gg.TipHelper.data.size,qq[1]]}},background:{func:function(){return Go.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return gg.TipHelper.data.text}},rect:{func:function(){return[gg.TipHelper.data.helperPos.x,gg.TipHelper.data.helperPos.y,qq[0]*gg.TipHelper.data.size,qq[1]]}},color:{func:function(){return Go.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var Mk=7;gg.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!gg.ShapePoint.data.dynamicVisible}},rect:{func:function(){var x=gg.ShapePoint.data.point,l=gg.ShapePoint.data.size||Mk;return[x,l+10,l+10]}},background:{func:function(){var e=Date.now(),i=gg.ShapePoint.data.dynamicPeriod||1500,P=Math.sin(e%i/i*Math.PI);return"rgba(27,124,22,"+.5*P+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var _=gg.ShapePoint.data.point,Z=gg.ShapePoint.data.size||Mk;return[_,Z,Z]}},background:{func:function(){var D=gg.ShapePoint.data.isEnd;return D?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return gg.ShapePoint.data.color||tc}}},{type:"rect",visible:{func:function(){return!!gg.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return tc}},rect:{func:function(){var q=5;return[gg.ShapePoint.data.point,q,q]}}}]},gg.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!gg.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return gg.ShapeBgCurve.data.P}},segments:{func:function(){return gg.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var u=Date.now(),z=gg.ShapeBgCurve.data.dynamicPeriod||1500,x=Math.sin(u%z/z*Math.PI);return"rgba(27,124,22,"+.3*x+")"}}},{type:"shape",points:{func:function(){return gg.ShapeBgCurve.data.P}},segments:{func:function(){return gg.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return gg.ShapeBgCurve.data.color||tc}}}]};var ql=8;gg.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var y=gg.ShapeHighlighPoint.data;return[[y.x,y.y],ql,ql]}},background:{func:function(){return Go.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Gq=10;gg.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var r=gg.ShapeHighlighRealPoint.data;return[[r.x,r.y],Gq,Gq]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return tc}}}]};var vj=8;gg.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var X=gg.ShapeHighlighCtrlPoint.data,L=X.x,P=X.y,D=vj/2;return[L-D,P-D,L-D,P+D,L+D,P+D,L+D,P-D]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Go.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Go.getStyle("shapeCtrlPointBorderColor")||tc}}}]};var Uq=3;gg.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return gg.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Uq,borderColor:{func:function(){return Go.getStyle("curveHighlightColor")}}}]},gg.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return gg.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},gg.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return gg.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return gg.MoveLineGuide.data.center?Vp:pe}}}]};var Ap=5;gg.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var c=gg.MoveLineGuideDistanceH.data,R=c.x0,y=c.y0;return[R,y-Ap,R,y+Ap]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:pe},{type:"shape",points:{func:function(){var V=gg.MoveLineGuideDistanceH.data,T=V.x1,p=V.y1;return[T,p-Ap,T,p+Ap]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:pe},{type:"text",text:{func:function(){return Math.round(gg.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var J=gg.MoveLineGuideDistanceH.data;return[[(J.x0+J.x1)/2,J.y0-10],20,20]}},color:pe,font:"12px Arial",align:"center"}]},gg.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var K=gg.MoveLineGuideDistanceV.data,t=K.x0,c=K.y0;return[t-Ap,c,t+Ap,c]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:pe},{type:"shape",points:{func:function(){var W=gg.MoveLineGuideDistanceV.data,H=W.x1,s=W.y1;return[H-Ap,s,H+Ap,s]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:pe},{type:"text",text:{func:function(){return Math.round(gg.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var U=gg.MoveLineGuideDistanceV.data;return[[U.x0-10,(U.y0+U.y1)/2],20,20]}},color:pe,font:"12px Arial",align:"center"}]},R.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),gg.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var H=gg.EdgeElevationGuide.data,L=H.x,j=H.y,J=Go.getStyle("curveElevationIntersectSize"),n=Go.getStyle("curveElevationGuideShift");return L+=n[0],j+=n[1],[L-J,j-J,2*J,2*J]}}}]},R.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),R.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),gg.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return gg.ConnectGuide.data.rotation}},rect:{func:function(){var U=gg.ConnectGuide.data.connect;U.x,U.y;var c=Go.getStyle("connectGuideIntersectSize");return[[U.x,U.y],2*c,2*c]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var i=gg.ConnectGuide.data.cursorPos||gg.ConnectGuide.data.connect,T=Go.getStyle("connectGuideIntersectSize");return[[i.x,i.y],2*T-2,2*T-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var W=gg.ConnectGuide.data.connect,t=gg.ConnectGuide.data.cursorPos||W;return[W.x,W.y,W.x+.5*(t.x-W.x),W.y,t.x+.5*(W.x-t.x),t.y,t.x,t.y]}}}]},R.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),R.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),gg.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var P=gg.ConnectGuideGarbage.data.hover;return P?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var B=gg.ConnectGuideGarbage.data,T=Go.getStyle("connectGuideGarbageIntersectsize");return B.hover&&(T+=5),[[B.x,B.y],2*T,2*T]}}}]};var jl=6;gg.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return gg.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var J=gg.ShapeActivingCtrl.data;return[J.point.x,J.point.y,J.c1.x,J.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return tc}}},{type:"shape",visible:{func:function(){return gg.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var f=gg.ShapeActivingCtrl.data;return[f.point.x,f.point.y,f.c2.x,f.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return tc}}},{type:"shape",visible:{func:function(){return gg.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var y=gg.ShapeActivingCtrl.data.c1,h=y.x,S=y.y,k=jl/2;return"c1"===gg.ShapeActivingCtrl.data.hl&&(k+=.5),[h-k,S-k,h-k,S+k,h+k,S+k,h+k,S-k]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Go.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===gg.ShapeActivingCtrl.data.hl?Go.getStyle("shapeCtrlPointHighlightBorder")||tc:Go.getStyle("shapeCtrlPointBorderColor")||tc}}},{type:"shape",visible:{func:function(){return gg.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var J=gg.ShapeActivingCtrl.data.c2,l=J.x,q=J.y,O=jl/2;return"c2"===gg.ShapeActivingCtrl.data.hl&&(O+=.5),[l-O,q-O,l-O,q+O,l+O,q+O,l+O,q-O]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Go.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===gg.ShapeActivingCtrl.data.hl?Go.getStyle("shapeCtrlPointHighlightBorder")||tc:Go.getStyle("shapeCtrlPointBorderColor")||tc}}}]},gg.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return tc}},rect:{func:function(){return[[gg.RoundPoint.data.x,gg.RoundPoint.data.y],Dp,Dp]}}}]},gg.AttachPoint={comps:[{type:"rect",background:{func:function(){return gg.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return tc}},rect:{func:function(){var j=gg.AttachPoint.data.isAttach?Dp+4:Dp;return[[gg.AttachPoint.data.x,gg.AttachPoint.data.y],j,j]}}}]},gg.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return gg.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return gg.SimpleRect.data.color||tc}},rect:{func:function(){var f=gg.SimpleRect.data;return[f.x,f.y,f.width,f.height]}}}]},R.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),gg.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var D=gg.MoveDummy.data;return[[D.pos.x,D.pos.y],2*D.size,2*D.size]}}}]},Sm.Icons.DrawIcon=function(K,i,A,T){A.width=A.height=Xi,A.data=T,Go=K,R.Default.drawImage(i,A,0,0,Xi,Xi),Go=Y},Sm.Icons.MapPoints=function(w,L){for(var q=0,u=w.length;u>q;q++)w[q]/=L},Sm.roundTo=function(I,V,g){var Z=Math.abs(I%V);return g>Z||g>V-Z?V*Math.round(I/V):I},Sm.toFixed=function(n){return Math.round(100*n)/100},Sm.getDataMatrix=function(N){if(N instanceof R.Shape){var i=new R.Math.Matrix2d,b=N.getPosition();return i.translate(-b.x,-b.y).scale(N.getScale().x,N.getScale().y).rotate(N.getRotation()).translate(b.x,b.y),i}return N.getMatrix?N.getMatrix():new R.Math.Matrix2d};var ml=Sm.Math.Curve=function(){this._curves=[]};ml.prototype={},ml.prototype.constructor=ml,ml.prototype.createFromHtShape=function(k,r,g){r instanceof R.List&&(r=r.toArray());var b,X,B,h,V,S,q,c=this,z=null,p=null,H=0,n=Sm.Math.Vector2,L=Sm.Math.CubicBezier,j=function(t){return new n(k[t],k[t+1],g?g[t/2]:Y)};for(X=0,B=r.length;B>X;X++){switch(h=r[X],V=null,h){case 1:p=j(H),z=p,H+=2;break;case 2:b=j(H),H+=2,V=new L(p,p.clone(),b.clone(),b),p=b;break;case 3:S=j(H),b=j(H+2),H+=4,V=new L(p,S.clone().sub(p).multiplyScalar(2/3).add(p),S.clone().sub(b).multiplyScalar(2/3).add(b),b),p=b;break;case 4:S=j(H),q=j(H+2),b=j(H+4),H+=6,V=new L(p,S,q,b),p=b;break;case 5:if(!z)break;V=new L(p,p.clone(),z.clone(),z),p=null,z=null}V&&(V._index=c._curves.length,c._curves.push(V))}},ml.prototype.checkPoint=function(V,_){var m,u,g,z,r,O=this,y=O._curves;for(m=0,u=y.length;u>m;m++)if(z=y[m],r=z.intersectRect(V,_,_),r.length)return g=0,r.forEach(function(z){g+=z.t}),g/=r.length,V=z.getPointAt(g),V.t=g,{bezier:z,intersection:V}},ml.prototype.insertKnot=function(b,F){var C=b.insertKnot(F),w=this,y=w._curves;y.splice(b._index,1,C[0],C[1])},ml.prototype._isCloseEnough=function(e,S){return Math.abs(e.x-S.x)<1e-6&&Math.abs(e.y-S.y)<1e-6},ml.prototype._isSamePoint=function(g,m){return g===m},ml.prototype.moveRealPoint=function(q,t){var r=this,a=r._curves,A=t.clone().sub(q);a.forEach(function(H){var N=H._p1;H._p2,H._p3;var B=H._p4;r._isSamePoint(N,q)&&(H._p2.add(A),H._p1=t),r._isSamePoint(B,q)&&(H._p3.add(A),H._p4=t)})},ml.prototype.moveCtrlDueToRealPointMovement=function(C,t){var G=this,H=G._curves,N=function(X){X.add(t),X.e&&t.e&&(X.e+=t.e)};H.forEach(function(F){var P=F._p1;F._p2,F._p3;var H=F._p4;G._isSamePoint(P,C)&&N(F._p2),G._isSamePoint(H,C)&&N(F._p3)})},ml.prototype.moveCtrlPoint=function(J,V,u){var Z=J[u];if(Z){Z.e!==Y&&(V.e=Z.e);var f=this,t=f._curves;V.clone().sub(Z),t.forEach(function(I){var m;"c2"===u?m="_p2":"c1"===u&&(m="_p3"),f._isSamePoint(I[m],Z)&&(I[m]=V)}),J[u]=V}},ml.prototype.deleteRealPoint=function(u,D){var i,$,B,z,K,W,f,h=this,V=h._curves,p={},o=[],g=Sm.Math.CubicBezier;for($=0,B=V.length;B>$;$++)i=V[$],z=i._p1,K=i._p2,W=i._p3,f=i._p4,(p[$]||!h._isSamePoint(z,u))&&(h._isSamePoint(f,u)?B>$+1&&h._isSamePoint(V[$+1]._p1,u)&&(D||o.push(new g(z,K,V[$+1]._p3,V[$+1]._p4))):o.push(i));h._curves=o},ml.prototype.findPairs=function(C,N){var I,O,L,i,w,T,A,p,W=this,a=W._curves,G={},F=[];for(O=0,L=a.length;L>O;O++)I=a[O],i=I._p1,w=I._p2,T=I._p3,A=I._p4,!G[O]&&W._isSamePoint(i,C)&&(N?F.push({point:i,r2:A}):F.push({point:i,c2:w})),W._isSamePoint(A,C)&&(p=N?{point:A,r1:i}:{point:A,c1:T},L>O+1&&W._isSamePoint(a[O+1]._p1,C)&&(N?p.r2=a[O+1]._p4:p.c2=a[O+1]._p2,G[O+1]=!0),F.push(p));return F},ml.prototype.toHtShape=function(){var w=this,k=w._curves,z=[],S=[],V={x:1/0,y:1/0};return k.forEach(function(n){var G=n._p1,a=n._p2,l=n._p3,m=n._p4;return w._isCloseEnough(G,V)||(z.push(1),S.push(G.clone())),V=m,w._isCloseEnough(G,a)&&w._isCloseEnough(l,m)?(z.push(2),S.push(m.clone()),void 0):(z.push(4),S.push(a.clone(),l.clone(),m.clone()),void 0)}),{segments:z,points:S}};var ep=Sm.Math.CubicBezier=function(O,i,o,f){var u=this;u._id=Sm.Math.CubicBezier._globalId++,u._p1=O,u._p2=i,u._p3=o,u._p4=f};ep._globalId=1,ep.prototype={},ep.prototype.constructor=ep,ep.prototype.toString=function(){return this._id},ep.prototype.intersectRect=function(h,m,N){var g=m/2,v=N/2,i=h.x,F=h.y,P=Sm.Math.Vector2,G=new P(-g+i,-v+F),W=new P(g+i,v+F),S=new P(W.x,G.y),U=new P(G.x,W.y),E=this,X=E.intersectLine(G,S),w=E.intersectLine(S,W),L=E.intersectLine(W,U),j=E.intersectLine(U,G),C=X.concat(w).concat(L).concat(j);return C},ep.prototype.intersectLine=function(S,E){var p,O,I,B,o,v,k,q,L,e,K,z,f,w=this,Q=S.clone().min(E),Z=S.clone().max(E);B=w._p1,o=w._p2,v=w._p3,k=w._p4,p=B.clone().multiplyScalar(-1),O=o.clone().multiplyScalar(3),I=v.clone().multiplyScalar(-3),K=p.add(O).add(I).add(k),p=B.clone().multiplyScalar(3),O=o.clone().multiplyScalar(-6),I=v.clone().multiplyScalar(3),e=p.add(O).add(I),p=B.clone().multiplyScalar(-3),O=o.clone().multiplyScalar(3),L=p.add(O),q=B.clone(),f=new Sm.Math.Vector2(S.y-E.y,E.x-S.x),z=S.x*E.y-E.x*S.y;for(var r=w.getRoots(f.dot(K),f.dot(e),f.dot(L),f.dot(q)+z),c=new Array,F=0,d=r.length;d>F;F++){var H=r[F];if(!(0>H||H>1)){var M=w.getPointAt(H);M.t=H,S.x==E.x?Q.y<=M.y&&M.y<=Z.y&&c.push(M):S.y==E.y?Q.x<=M.x&&M.x<=Z.x&&c.push(M):M.x>=Q.x&&M.y>=Q.y&&M.x<=Z.x&&M.y<=Z.y&&c.push(M)}}return c},ep.prototype.solveTForPoint=function(I){var V,J,m,v,s=this;V=s._p1.x-I.x,J=s._p2.x-I.x,m=s._p3.x-I.x,v=s._p4.x-I.x;for(var W=s.getRoots(v-3*m+3*J-V,3*m-6*J+3*V,3*J-3*V,V),K=Y,p=1/0,O=0,X=W.length;X>O;O++){var Q=W[O];if(!(0>Q||Q>1)){var n=s.getPointAt(Q);n.t=Q;var d=Math.abs(n.y-I.y);p>d&&(p=d,K=n)}}return K},ep.prototype.getPointAt=function(f){var j=this,$=j._p1,G=j._p2,c=j._p3,u=j._p4,o=$.clone().lerp(G,f),Z=G.clone().lerp(c,f),n=c.clone().lerp(u,f),v=o.lerp(Z,f),z=Z.lerp(n,f);return v.lerp(z,f)},ep.prototype.getPointByPercentage=function(R){var T=this.length*R,Q=this._cacheLength,d=Q.length;if(0===T)return Q[0].point;if(R>=1)return Q[d-1].point;for(var m=0;d>m;m++){var K=Q[m];if(!(K.len<T)){var I=Q[m-1];return K.point.clone().sub(I.point).setLength(T-I.len).add(I.point)}}},ep.prototype.getTByPercentage=function(q){var b=this.length*q,t=this._cacheLength,P=t.length;if(0===b||0>=q)return t[0].t;if(q>=1)return t[P-1].t;for(var F=0;P>F;F++){var A=t[F];if(!(A.len<b)){var B=t[F-1];return(b-B.len)/(A.len-B.len)*(A.t-B.t)+B.t}}},ep.prototype.getRoots=function(m,d,y,k){var o,r,n,c,i,R=new Array;if(Math.abs(m)<1e-6){var o=d,r=y/o,n=k/o,c=r*r-4*n;if(c>0){var i=Math.sqrt(c);R.push(.5*(-r+i)),R.push(.5*(-r-i))}else 0==c&&R.push(.5*-r)}d/=m,y/=m,k/=m,o=(3*y-d*d)/3,r=(2*d*d*d-9*y*d+27*k)/27;var P=d/3,s=r*r/4+o*o*o/27,H=r/2;if(Math.abs(s)<=1e-6&&(s=0),s>0){var x,T,i=Math.sqrt(s);x=-H+i,T=x>=0?Math.pow(x,1/3):-Math.pow(-x,1/3),x=-H-i,x>=0?T+=Math.pow(x,1/3):T-=Math.pow(-x,1/3),R.push(T-P)}else if(0>s){var C=Math.sqrt(-o/3),b=Math.atan2(Math.sqrt(-s),-H)/3,p=Math.cos(b),U=Math.sin(b),J=Math.sqrt(3);R.push(2*C*p-P),R.push(-C*(p+J*U)-P),R.push(-C*(p-J*U)-P)}else{var x;x=H>=0?-Math.pow(H,1/3):Math.pow(-H,1/3),R.push(2*x-P),R.push(-x-P)}return R},ep.prototype._70I=function(){var B=this;return B._p1.distanceToSquared(B._p2)<1e-10&&B._p3.distanceToSquared(B._p4)<1e-10},ep.prototype.insertKnot=function(s){var k=this,L=k._p1,x=k._p2,E=k._p3,c=k._p4,S=L.clone().lerp(x,s),O=x.clone().lerp(E,s),U=E.clone().lerp(c,s),M=S.clone().lerp(O,s),V=O.clone().lerp(U,s),R=M.clone().lerp(V,s);return k._70I()?(L.clone().lerp(c,s),[new Sm.Math.CubicBezier(L,L.clone(),R.clone(),R),new Sm.Math.CubicBezier(R,R.clone(),c.clone(),c)]):[new Sm.Math.CubicBezier(L,S,M,R),new Sm.Math.CubicBezier(R,V,U,c)]},S.defineProperties(ep.prototype,{length:{get:function(){var g=this._cacheLength;if(!g){g=this._cacheLength=[];for(var V=this._p1,v=0,e=0;1>=v;){var w=this.getPointAt(v+=.001);e+=w.clone().sub(V).length(),V=w,g.push({len:e,t:v,point:w.clone()})}}return g[g.length-1].len}},p1:{get:function(){return this._p1},set:function(e){this._p1=e,this._cacheLength=Y}},p2:{get:function(){return this._p2},set:function(A){this._p2=A,this._cacheLength=Y}},p3:{get:function(){return this._p3},set:function(Z){this._p3=Z,this._cacheLength=Y}},p4:{get:function(){return this._p4},set:function(C){this._p4=C,this._cacheLength=Y}}});var Or=R.Default.getInternal().ui().EdgeUI,fh={_47O:function(W){var C=this,X=fh.getBackups()._47O;Sm.inEdit(C.gv)||X.call(C,W)}};Sm.Inject.registAsModule(fh,Or);var mm=R.Default.getInternal().ui().NodeUI,Nn={_47O:function(K){var p=this,o=Nn.getBackups()._47O;Sm.inEdit(p.gv)||o.call(p,K)},getSelectWidth:function(){var _=this,h=_.gv,y=_._data;if(h.isEditable(y)&&Sm.inEdit(h))return 0;var z=Nn.getBackup("getSelectWidth");return z.call(_)}};Sm.Inject.registAsModule(Nn,mm);var Uj=R.graph.GraphView,Sh={_editPointSize:function(){var F=R.Default.isTouchable,h=Sm.getStyle("pointSize");return h[F?0:1]}(),isPointEditable:function(m){var v=this;if(Sm.inEdit(v))return v._pointEditableFunc?v._pointEditableFunc(m):!0;var B=Sh.getBackup("isPointEditable");B.call(v,m)},isEditable:function(_){var g,H=this,f=Sh.getBackup("isEditable");if(g=_ instanceof Sm.Group?!0:f.call(H,_),!Sm.inEdit(H))return g;if(!(_ instanceof R.Edge))return g;if(!_.s("2d.editable"))return!1;var J=H.getEditableFunc();return J?J(_):!0},_42:function(c,z){var Q=this,F=Sh.getBackups()._42;if(F.call(Q,c,z),Sm.inEdit(Q)){var w=Q.getEditInteractor();w.drawImpl()}}};Sm.Inject.registAsModule(Sh,Uj);var $c=R.Default.getInternal().ui().ShapeUI,pg={_47O:function(i){var L=this,q=pg.getBackups()._47O;Sm.inEdit(L.gv)||q.call(L,i)}};Sm.Inject.registAsModule(pg,$c);var wl=R.graph.DefaultInteractor,Pi={handle_mousewheel:function(O){var T=this,e=Pi.getBackup("handle_mousewheel");Sm.inEdit(T.gv)||e.call(T,O)}};Sm.Inject.registAsModule(Pi,wl);var Vr=R.graph.MoveInteractor,Pj={_calcShift:function(n,b){var e=this,Q=Pj.getBackup("_calcShift"),O=e.gv;if(!Sm.inEdit(O))return Q.call(e,n,b);var N=O.getEditInteractor(),l=N.getSubModule("Move").calcShift(n,b,e);return l||Q.call(e,n,b)},clear:function(i){var W=this,f=Pj.getBackup("clear");f.call(W,i);var b=W.gv;if(Sm.inEdit(b)){var O=b.getEditInteractor();O.getSubModule("Move").clear(i)}}};Sm.Inject.registAsModule(Pj,Vr);var up=Sm.Rect=function(b){this.catalog="Rect",this._interactor=b};up.prototype={},up.prototype.constructor=up,up.prototype.gatherInfo=function(J,T){var N=this;if(1===T.length){var t=T[0];return t instanceof R.Shape&&t._70I()?N.gatherLine(J,t):Xr(t,J)?!1:N.gatherSingleTarget(J,t)}return T.length>1?N.gatherMultiTargets(J,T):!1},up.prototype.gatherSingleTarget=function(U,q){if(q.getCorners){var n,g=this,Q=g.info;g.target=q,n=g.screenInfo={};var a=q.getCorners();Q.LT=new Sm.Math.Vector2(a[0]),Q.LB=new Sm.Math.Vector2(a[1]),Q.RB=new Sm.Math.Vector2(a[2]),Q.RT=new Sm.Math.Vector2(a[3]),Q.T=Q.LT.clone().add(Q.RT).divideScalar(2),Q.B=Q.LB.clone().add(Q.RB).divideScalar(2),Q.L=Q.LT.clone().add(Q.LB).divideScalar(2),Q.R=Q.RT.clone().add(Q.RB).divideScalar(2);for(var X in Q)n[X]=Sm.toScreenPosition(U,Q[X]);var B=g._interactor,J=B.getStyle("checkSize"),Z=function(t,$,m){var E=$.clone().sub(t).setLength(-J),e=m.clone().sub(t).setLength(-J),h=E.add(e).add(t);return h};return n.rotLT=Z(n.LT,n.RT,n.LB),n.rotLB=Z(n.LB,n.LT,n.RB),n.rotRB=Z(n.RB,n.LB,n.RT),n.rotRT=Z(n.RT,n.LT,n.RB),n.rotT=n.rotLT.clone().add(n.rotRT).divideScalar(2),n.rotB=n.rotLB.clone().add(n.rotRB).divideScalar(2),n.rotL=n.rotLT.clone().add(n.rotLB).divideScalar(2),n.rotR=n.rotRT.clone().add(n.rotRB).divideScalar(2),n.rotation=q.getRotation(),g.gatherConnectInfo(),!0
}},up.prototype.gatherConnectInfo=function(){var D=this,J=D.target,Z=D._interactor,$=D.screenInfo,B=Z.gv;if(B.isConnectActionVisible(J)&&Z.getStyle("connectGuideVisible")){var s;J.s&&(s=J.s("connectGuideShift")),s||(s=Z.getStyle("connectGuideShift"));var U=J.getAnchor(),C=J.getSize(),x=J.toGlobal({x:C.width*(s[0]-U.x),y:C.height*(s[1]-U.y)});x=Sm.toScreenPosition(B,x),$.P1?x.add($.P2.clone().sub($.P1).setLength(s[2])):(x.add($.RT.clone().sub($.LT).setLength(s[2])),x.add($.LB.clone().sub($.LT).setLength(s[3]))),$.connect=x}},up.prototype.gatherMultiTargets=function(E,h){var x=Sm.Group.findOrCreateGroup(h,this._interactor._uuid);if(!x)return!1;var K=this;return K.editing&&"rotate"!==K.editing.mode||x.calcInfo(),K.gatherSingleTarget(E,x)},up.prototype.gatherLine=function(M,s){this.target=s;var c=this.screenInfo={},k=s.getPoints(),H=Sm.getDataMatrix(s);return c.P1=Sm.toScreenPosition(M,H.apply(k.get(0))),c.P2=Sm.toScreenPosition(M,H.apply(k.get(1))),this.gatherConnectInfo(),!0},up.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],up.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],up.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],up.prototype.check=function(s,q,d){if(R.Default.isLeftButton(q)){var T=this;if(T.editing=null,T.tipInfo=null,T.screenInfo){var J=T.target,M=s.isEditable(J),v=T.screenInfo;if(M&&v.connect){var g=T._checkConnect(d);if(g)return g}if(v.P1)return T._checkLine(d);var P,o,G,Q=null,i=T._interactor,H=i.getStyle("checkSize");if(M&&s.isRectEditable(J))for(o=0;o<Sm.Rect.ResizeKeys.length;o++)if(G=Sm.Rect.ResizeKeys[o],Sm.checkHit(d,v[G],H)){Q=G,P="resize";break}if(!Q&&M&&s.isRotationEditable(J)&&!i.getStyle("rotateAsClock")){var m=i.getStyle("rotateCheckSize");for(o=0;o<Sm.Rect.RotateKeys.length;o++)if(G=Sm.Rect.RotateKeys[o],Sm.checkHit(d,v[G],m)){Q=G,P="rotate";break}}if(!Q)return i.setCursor("default"),void 0;if("rotate"===P){var K,E=s.lp(q);if(J instanceof Sm.Group){var k=i.getStyle("groupRotateModeKey");"string"==typeof k&&(k=[k]);for(var e=!1,N=0,B=k.length;B>N;N++)if(q[k[N]]){e=!0;break}var f=i.getStyle("groupRotateModeDefault");K=e?"batch"===f?"block":"batch":f}var p="batch"===K?J.getAnchor2():J.getPosition(),O=Math.atan2(E.y-p.y,E.x-p.x);i._setRotateCursor(O),T.editing={mode:P,key:Q,pos:p,flipY:J.getScale().y<0,rotation:J.getRotation(),hitRot:O},K&&(T.editing.groupRotateMode=K)}else{var C=Sm.Rect.ResizeKeys.indexOf(Q),Z=Sm.Rect.ResizeDirection[C],a=Math.cos(J.getRotation()),x=Math.sin(J.getRotation()),S=Z.x*Math.sign(J.getScale().x),n=Z.y*Math.sign(J.getScale().y),D=Math.atan2(-x*S-a*n,a*S-x*n),b=(Math.round(D/(Math.PI/4))+8)%8,u=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][b];this._interactor.setCursor(u);var h=J.getWidth(),U=J.getHeight(),F=J.getAnchor();T.editing={mode:P,key:Q,rect:{x:-h*F.x,y:-U*F.y,width:h,height:U},anchor:F,matrix:J.getMatrix()}}return Q}}},up.prototype._checkLine=function(H){var V=this;V.screenInfo;var d,s=V._interactor.getStyle("checkSize");if(Sm.checkHit(H,V.screenInfo.P1,s))d="P1";else{if(!Sm.checkHit(H,V.screenInfo.P2,s))return this._interactor.setCursor("default"),void 0;d="P2"}return V.editing={mode:"line",key:d},d},up.prototype._checkConnect=function(k){var s=this,F=s.screenInfo,q=s._interactor,e=q.getStyle("connectGuideIntersectSize"),G=F.connect,L=k.x,$=G.x;if($>L&&e>$-L&&Math.abs(G.y-k.y)<e||L>=$&&Sm.checkHit(k,G,e)){var _="connect",T=x.getConnectAction(q.gv);if(s.editing={mode:_},T&&T.delete)if(s.target instanceof Sm.Group){var m=!0;q.gv.sm().getSelection().each(function(f){T.delete.visible.call(null,q.gv,f)||(m=!1)}),s.editing.hasDeleteAction=m}else T.delete.visible.call(null,q.gv,s.target)&&(s.editing.hasDeleteAction=!0);return q.setCursor("default"),_}},up.prototype._fireEditEvent=function(x,m){var V=this._interactor,M=this.editing;if(M){var J=M.mode;J="rotate"===J?"Rotation":"connect"===J?"Connection":"resize"===J?"Rect":J[0].toUpperCase()+J.slice(1),V.fi({kind:x+"Edit"+J,event:m})}},up.prototype.startEdit=function(j,d){j.startDragging(d);var n=this;n._interactor.fi({kind:"prepareEdit",event:d});var g=n.editing,B=n.target;if(g){if(n._fireEditEvent("begin",d),g.started=!0,"rotate"===g.mode)return g.groupRotateMode&&B.beginRotate(g),j._42(),void 0;if("connect"!==g.mode)("line"===g.mode||B&&0===B.getRotation())&&(n._inSmartGuide=!0,n._interactor.rectGuide.gatherRects());else if(g.hasDeleteAction){var w=j.gv,q=n._interactor.getStyle("connectGuideGarbageShift");g.garbageInfo={x:w.getWidth()*q[0]+q[2],y:w.getHeight()*q[1]+q[3],size:n._interactor.getStyle("connectGuideGarbageIntersectsize")},j._42()}}},up.prototype._46O=function(p){var O,M,i=this,U=i.editing,B=i.target;if(U){if("connect"===U.mode&&!U.canceled&&!U.deleted)try{U.garbageInfo&&U.garbageInfo.hover?x.doDeleteConnectionAction(i._interactor.gv,B):x.doConnectAction(i._interactor.gv,B,U.target)}catch(S){console.error(S)}M=U.freezeFlag,O=i.editing.groupRotateMode,i._fireEditEvent("end",p),i.editing=null}i.tipInfo=null,i._inSmartGuide&&(i._interactor.rectGuide.clear(),i._inSmartGuide=!1),O&&B&&B.endRotate(),B instanceof R.Block&&(M===Y?delete B._freezeSyncFromChildren:B._freezeSyncFromChildren=M,B.updateFromChildren())},up.prototype.handleNormalStateDelete=function(){var C=this,a=C.editing;if(a&&"connect"===a.mode&&!a.canceled&&!a.deleted){if(a.garbageInfo){try{x.doDeleteConnectionAction(C._interactor.gv,C.target)}catch(A){console.error(A)}a.garbageInfo=null}return a.cursorPos=null,a.targetCorners=null,a.deleted=!0,C._interactor._42(),!0}},up.prototype.handleNormalStateKeyDown=function(m){var i=this,V=i.editing;return!V||"connect"!==V.mode||V.canceled||V.deleted?void 0:R.Default.isEsc(m)?(V.cursorPos=null,V.targetCorners=null,V.canceled=!0,i._interactor._42(),!0):void 0},up.prototype.handleEdit=function(S,E){var s=this,x=s.editing;if(x){var z,l,$,D,e,g=s.target,Y=x.key,w=x.mode,C=S.lp(E),L=s._interactor;if("connect"===w){if(x.canceled)return;if(x.deleted)return;x.cursorPos=L._getLogicalPoint(E);var u=x.garbageInfo;return u&&Sm.checkHit(x.cursorPos,u,u.size)?(u.hover=!0,x.target=null,x.targetCorners=null):(u&&(u.hover=!1),x.target=S.getDataAt(C,function(y){return S.isSelectable(y)?Im(y)?!0:!1:!1})||null,x.targetCorners=Sm.getTargetCornersOnScreen(S,x.target)),L._42(),void 0}if("rotate"===w){var Z,W,q=x.pos,O=Math.atan2(C.y-q.y,C.x-q.x);if(x.groupRotateMode?W=O-x.hitRot:(Z=O-x.hitRot,W=x.rotation+Z),W%=2*Math.PI,0>W&&(W+=2*Math.PI),!R.Default.isCtrlDown(E)){var G,p;eq(E)?(G=L.getStyle("shiftRotateRound"),p=G/2):(G=L.getStyle("rotateRound"),p=L.getStyle("rotateSensitivity")),W=Sm.roundTo(W,G,p)}x.groupRotateMode?(Z=W-(x.lastRotation||0),0!==Z&&(g.addRotation(Z,x.groupRotateMode,function(T){return S.isRotationEditable(T)}),x.lastRotation=W)):g.setRotation(W),L._setRotateCursor(O),W>Math.PI&&(W-=2*Math.PI);var T=180*(W/Math.PI);T=T.toFixed(2),z=""+T+"°"}else if("resize"===w){var k=x.rect;$=k.x,D=k.y;var X,H=k.width,F=k.height,Q=x.anchor,h=x.matrix,i=g.s&&g.s("keepAspectRatio")||L.getStyle("keepAspectRatio");eq(E)&&(i=!i);var d=s._unionPointMode1,N=s._unionPointMode2;if(s._inSmartGuide&&!R.Default.isCtrlDown(E)&&!i){var y;"L"===Y||"R"===Y?y="x":("T"===Y||"B"===Y)&&(y="y"),s._adsorbedToClosest(C,y),e=!0}X=h.tfi(C);var U;"LT"===Y?(k=d(X,{x:$+H,y:D+F},H,F,i),U=9):"T"===Y?(k=N({x:$,y:X.y},{x:$+H,y:D+F},H,F,i,"v"),U=1):"RT"===Y?(k=d(X,{x:$,y:D+F},H,F,i),U=33):"L"===Y?(k=N({x:X.x,y:D},{x:$+H,y:D+F},H,F,i,"h"),U=8):"R"===Y?(k=N({x:$,y:D},{x:X.x,y:D+F},H,F,i,"h"),U=32):"LB"===Y?(k=d(X,{x:$+H,y:D},H,F,i),U=12):"B"===Y?(k=N({x:$,y:D},{x:$+H,y:X.y},H,F,i,"v"),U=4):"RB"===Y&&(k=d(X,{x:$,y:D},H,F,i),U=36);var B=h.tf(k.x+k.width*Q.x,k.y+k.height*Q.y);g instanceof R.Block&&(x.hasOwnProperty("freezeFlag")||(x.freezeFlag=g._freezeSyncFromChildren,g._freezeSyncFromChildren=!0)),g.setPosition(B),g.setSize(k.width,k.height),e&&(l=g.getRect(),L.rectGuide.gatherLines({node:g,x:l.x,y:l.y,w:l.width,h:l.height},y,U)),z=""+Math.round(k.width)+" * "+Math.round(k.height)}else if("line"===w){if(eq(E)){var M=g.getPoints(),V="P1"===Y?M.get(1):M.get(0),n={x:C.x-V.x,y:C.y-V.y},K=L.getStyle("shiftLineRotateRound"),m=s._shiftDirList;if(!m||s._shiftRotateRound!==K){s._shiftRotateRound=K,s._shiftDirList=m=[];for(var I=0;I<Math.PI;I+=K)m.push({x:A(I),y:a(I)})}for(var _,r=0,o=0,J=m.length;J>o;o++){var c=m[o],j=c.x*n.x+c.y*n.y;Math.abs(j)>Math.abs(r)&&(r=j,_=c)}C={x:V.x+_.x*r,y:V.y+_.y*r},L.rectGuide.clear()}else s._inSmartGuide&&!R.Default.isCtrlDown(E)&&(s._adsorbedToClosest(C),e=!0);var t=Sm.getDataMatrix(g).applyInverse(C);g.setPoint("P1"===Y?0:1,t,!0);var P=g.getPoints(),f=P.get(0),b=P.get(1);$=f.x-b.x,D=f.y-b.y,z=" "+Math.round(Math.sqrt($*$+D*D))+" ",e&&(l=g.getRect(),L.rectGuide.gatherLines({node:g,x:l.x,y:l.y,w:l.width,h:l.height}))}if(z){var v=R.Default.getLogicalPoint(E,L._canvas);v.x+=Sm.Icons.TipShiftX,v.y+=Sm.Icons.TipShiftY,s.tipInfo={helperPos:v,text:z,size:z.length}}s._fireEditEvent("between",E)}},up.prototype._unionPointMode1=function(n,h,I,z,j){if(j&&I&&z){var M=n.x-h.x,Z=n.y-h.y;Math.abs(M*z)<Math.abs(Z*I)?(Z=Math.sign(Z)*Math.abs(M*z/I),n.y=h.y+Z):(M=Math.sign(M)*Math.abs(Z*I/z),n.x=h.x+M)}return R.Default.unionPoint(n,h)},up.prototype._unionPointMode2=function(k,q,K,W,Y,h){var o=R.Default.unionPoint(k,q);if(Y&&K&&W){var O;"v"===h?(O=o.x+o.width/2,o.width=K*o.height/W,o.x=O-o.width/2):(O=o.y+o.height/2,o.height=W*o.width/K,o.y=O-o.height/2)}return o},up.prototype._adsorbedToClosest=function(j,Z){var J=this,v=J._interactor,V=v.rectGuide.findClosest(j,Z),g=v.gridGuide.findClosest(j,Z),N=1/0,L=1/0;V&&(isFinite(V.x)&&(N=V.x),isFinite(V.y)&&(L=V.y)),g&&(isFinite(g.x)&&Math.abs(g.x)<Math.abs(N)&&(N=g.x),isFinite(g.y)&&Math.abs(g.y)<Math.abs(L)&&(L=g.y)),isFinite(N)&&(j.x+=N),isFinite(L)&&(j.y+=L)},up.prototype._42=function(C,r,t){var q=this;q.info={},q.screenInfo=null;var M=q._interactor;if(!M.editDetail&&q.gatherInfo(r,t)){var N=q.editing,L=N?N.groupRotateMode:null,G=q.screenInfo;if("block"!==L||!N||!N.started){if(G.P1?Sm.Icons.DrawIcon(M,C,Sm.Icons.Line,G):Sm.Icons.DrawIcon(M,C,Sm.Icons.Rect,G),G.connect&&(Sm.Icons.DrawIcon(M,C,Sm.Icons.ConnectGuide,{rotation:G.rotation,connect:G.connect,cursorPos:N?N.cursorPos:null}),N)){if(N.targetCorners){for(var l={x:1/0,y:1/0},B={x:-1/0,y:-1/0},$=0,c=N.targetCorners.length;c>$;$+=2)l.x=Math.min(l.x,N.targetCorners[$]),B.x=Math.max(B.x,N.targetCorners[$]),l.y=Math.min(l.y,N.targetCorners[$+1]),B.y=Math.max(B.y,N.targetCorners[$+1]);Sm.Icons.DrawIcon(M,C,Sm.Icons.HoverDataRect,{min:l,max:B,color:M.getStyle("hoverGuideColor")||M.getStyle("baseColor")})}N.garbageInfo&&Sm.Icons.DrawIcon(M,C,Sm.Icons.ConnectGuideGarbage,N.garbageInfo)}M.getStyle("rotateTipVisible")&&q.tipInfo&&Sm.Icons.DrawIcon(M,C,Sm.Icons.TipHelper,q.tipInfo)}q.target instanceof Sm.Group&&q.target._42(M,C,r)}};var Bl=Sm.Anchor=function(u){this.catalog="Anchor",this._interactor=u};Bl.prototype={},Bl.prototype.constructor=Bl,Bl.prototype.gatherInfo=function(Q,M){var W=this;if(1===M.length){var A=M[0];if(!A.getAnchor)return;if(A instanceof R.Shape&&A._70I())return;if(Xr(A,Q))return;return W.gatherSingleTarget(Q,M[0])}return M.length>1?W.gatherMultiTargets(Q,M):!1},Bl.prototype.gatherSingleTarget=function(X,_){var V=this;return V.info.POS=_.getPosition(),V.screenInfo.POS=Sm.toScreenPosition(X,V.info.POS),V.target=_,!0},Bl.prototype.gatherMultiTargets=function(Y,k){var p=this,e=Sm.Group.findOrCreateGroup(k,this._interactor._uuid);return e?(p.screenInfo.POS=Sm.toScreenPosition(Y,e.getAnchor2()),p.target=e,!0):!1},Bl.prototype.isVisible=function(){var z=this,P=z._interactor;if(P.getStyle("anchorVisible")===!1)return!1;var Z=z.target;if(Z){if(this.editing)return!0;var x=Z.getAnchor(),u=P.getStyle("anchorOutsideVisibleThreshold");if(x.x<-u||x.x>1+u||x.y<-u||x.y>1+u)return!0;var q=Z.getSize(),$=Z.getScale(),I=Math.min(Math.abs(q.width*$.x),Math.abs(q.height*$.y));if(I*P.gv._zoom<P.getStyle("anchorHideThreshold"))return!1}return!0},Bl.prototype.check=function(P,x,I){if(R.Default.isLeftButton(x)){var i=this,e=i._interactor;if(i.isVisible()&&e.getStyle("anchorMovable")!==!1){i.editing=null,i.tipInfo=null;var z=i.target;if(z&&P.isAnchorEditable(z)&&P.isEditable(z)){var a;if(i.screenInfo&&(a=i.screenInfo.POS)&&Sm.checkHit(I,new Sm.Math.Vector2(a),e.getStyle("checkSize"))){if(z instanceof Sm.Group)return i.editing={},!0;var c=z.getWidth(),W=z.getHeight(),q=z.getAnchor();return i.editing={rect:{x:-c*q.x,y:-W*q.y,width:c,height:W},anchor:q,matrix:z.getMatrix()},!0}}}}},Bl.prototype.startEdit=function(d,G){d.startDragging(G),d.fi({kind:"beginEditAnchor",event:G})},Bl.prototype._46O=function(Z){var O=this;O.editing&&(O.editing=null,O._interactor.fi({kind:"endEditAnchor",event:Z})),O.tipInfo=null},Bl.prototype.handleEdit=function(I,z){var N=this,a=N.target;if(a){var r=N.editing;if(r){var h=I.lp(z),E=N._interactor;if(a instanceof Sm.Group)return a.setAnchor2(h),E._42(),void 0;var e=r.matrix,O=e.tfi(h),u=r.rect,L=(O.x-u.x)/u.width,c=(O.y-u.y)/u.height;if(!R.Default.isCtrlDown(z)){var D=E.getStyle("anchorRound"),T=E.getStyle("anchorSensitivity");L=Sm.roundTo(L,D,T),c=Sm.roundTo(c,D,T)}a.setAnchor(L,c,!0);var F=R.Default.getLogicalPoint(z,E._canvas);F.x+=Sm.Icons.TipShiftX,F.y+=Sm.Icons.TipShiftY;var B=""+L.toFixed(2)+", "+c.toFixed(2);N.tipInfo={helperPos:F,text:B,size:B.length},E.fi({kind:"betweenEditAnchor",event:z})}}},Bl.prototype._42=function(g,N,d){var a=this;a.info={},a.screenInfo={};var S=a._interactor;S.editDetail||a.gatherInfo(N,d)&&a.isVisible()&&(Sm.Icons.DrawIcon(S,g,Sm.Icons.Anchor,a.screenInfo),a.tipInfo&&Sm.Icons.DrawIcon(S,g,Sm.Icons.TipHelper,a.tipInfo))};var Mq=Sm.MoveDummy=function(n){this.catalog="MoveDummy",this._interactor=n};Mq.prototype={},Mq.prototype.constructor=Mq,Mq.prototype.gatherInfo=function(){var Y=this,M=this._interactor.getSubModule("Rect");if(M){var I=M.screenInfo;if(I){var Z=Y._interactor,$=Y.getMovableTarget(M.target);if($){var z=Z.getStyle("moveDummyThreshold");if(z!==!1){var s=I.LT||I.P1,Q=I.RT||I.P2,B=I.LB||s;if(s){var e=I.P1,W=Math.min(s.distanceTo(B),s.distanceTo(Q));if(!(z!==!0&&W>z)){var p=Z.getStyle("moveDummyPosition"),x=Q.clone().sub(s),X=B.clone().sub(s),_=p[2],F=p[3];if(e){var A=Z.getStyle("moveDummyLineExtraShift");A&&(_+=A[0],F+=A[1])}var o=s.clone().add(x.clone().multiplyScalar(p[0])).add(x.setLength(_)).add(X.clone().multiplyScalar(p[1])).add(X.setLength(F));return Y.screenInfo.pos=o,Y.screenInfo.size=Z.getStyle("moveDummySensitivity"),!0}}}}}}},Mq.prototype.getMovableTarget=function(p){var r=this._interactor.gv;if(Im(p)){if(r.isMovable(p))return p}else if(p instanceof Sm.Group)for(var B=p._entities,b=B.length-1;b>=0;b--){var f=B[b];if(Im(f)&&r.isMovable(f))return f}return null},Mq.prototype.getMoveInteractor=function(){for(var I,C,N,J=this._interactor.gv,n=J.getInteractors(),I=0,C=n.length;C>I;I++)if(N=n.get(I),N instanceof Vr)return N},Mq.prototype.startEdit=function(z,Q){z.startDragging(Q);var c=this.getMoveInteractor();if(c){var L=this.selectedTarget,U=z.gv;U._moving=1,c._data=L,U.handleMouseDown&&U.handleMouseDown(Q,L)}},Mq.prototype._46O=function(D){var d=this,Y=d.getMoveInteractor();Y&&(Y.handleWindowMouseUp(D),d.selectedTarget=null)},Mq.prototype.handleEdit=function(X,E){var I=this.getMoveInteractor();I&&I.handleWindowMouseMove(E)},Mq.prototype.check=function(E,C,i){if(this.selectedTarget=null,R.Default.isLeftButton(C)&&!E._scrolling&&!an()){var f=this;if(f.screenInfo){var q=f.screenInfo.pos;if(q&&!(i.distanceTo(q)>f.screenInfo.size)){var T=f._interactor;return f.selectedTarget=f.getMovableTarget(T.getSubModule("Rect").target),T.setCursor("default"),!0}}}},Mq.prototype._42=function(n,a,I){var w=this;w.screenInfo={};var q=w._interactor;q.editDetail||w.gatherInfo(a,I)&&(!q.editing||w.selectedTarget)&&Sm.Icons.DrawIcon(q,n,Sm.Icons.MoveDummy,w.screenInfo)};var hg=Sm.RotateX=function(i){this.catalog="RotateX",this._interactor=i};hg.prototype={},hg.prototype.constructor=hg,hg.prototype.gatherInfo=function(A,c){var L=this;if(1===c.length){var J=c[0];return J instanceof R.Shape&&J._70I()||Xr(J,A)?!1:L.gatherSingleTarget(A,J)}return c.length>1?L.gatherMultiTargets(A,c):!1},hg.prototype.gatherSingleTarget=function(){var X=new R.Math.Vector2,A=new R.Math.Vector2,E=new R.Math.Vector2,T=new R.Math.Vector2,g=function(X,j){var J=X.x-j.x,Q=X.y-j.y;return J*J+Q*Q};return function(H,C){if(C.getCorners){var z=this,t=C.getCorners(),M=15,r=C.getPosition();X.copy(t[0]),E.copy(t[1]),T.copy(t[3]),A.copy(X).add(T).divideScalar(2).add(X.sub(E).setLength(M/H.getZoom()));var w=Math.max(g(r,t[0]),g(r,t[1]),g(r,t[2]),g(r,t[3]));return z.info.POS=A.clone(),z.screenInfo.POS=Sm.toScreenPosition(H,z.info.POS),z.screenInfo.LEN=Math.sqrt(w)*H.getZoom()+M,z.screenInfo.CENTER=Sm.toScreenPosition(H,r),z.target=C,!0}}}(),hg.prototype.gatherMultiTargets=function(M,C){var J=this,n=Sm.Group.findOrCreateGroup(C,this._interactor._uuid);if(!n)return!1;var J=this;return J.gatherSingleTarget(M,n)},hg.prototype.isVisible=function(){var V=this._interactor;if(!V.getStyle("rotateAsClock"))return!1;var t=this.target;if(!t)return!0;var b=V.gv;return b.isEditable(t)&&b.isRotationEditable(t)?!0:!1},hg.prototype.check=function(j,H,U){var Z=this,O=Z._checkImpl(j,H,U);return(O||Z._clockPainted)&&Z._interactor._42(),O},hg.prototype._checkImpl=function(F,v,B){if(R.Default.isLeftButton(v)){var r=this;r.editing=null,r.tipInfo=null;var k;if(r.screenInfo&&(k=r.screenInfo.POS)&&r.isVisible()){var t=r._interactor;if(Sm.checkHit(B,k,t.getStyle("checkSize"))){var X=r.target,q=F.lp(v),U=X.getPosition(),i=Math.atan2(q.y-U.y,q.x-U.x);return t._setRotateCursor(i),r.editing={pos:U,rotation:X.getRotation(),hitRot:i,groupRotateMode:"block",screenInfo:{CENTER:r.screenInfo.CENTER,LEN:r.screenInfo.LEN}},!0}}}},hg.prototype.startEdit=function(I,R){I.startDragging(R),I.fi({kind:"beginEditRotation",event:R}),this.target instanceof Sm.Group&&this.target.beginRotate(this.editing)},hg.prototype._46O=function(U){var K=this;K.editing&&(K.editing=null,K._interactor.fi({kind:"endEditRotation",event:U})),K.target instanceof Sm.Group&&K.target.endRotate(),K.tipInfo=null},hg.prototype.handleEdit=function(O,M){var i=this,k=i.editing;if(k){var r,g,s=i.target,S=O.lp(M),p=i._interactor,N=k.pos,B=Math.atan2(S.y-N.y,S.x-N.x),J=s instanceof Sm.Group;if(J?g=B-k.hitRot:(r=B-k.hitRot,g=k.rotation+r),g%=2*Math.PI,0>g&&(g+=2*Math.PI),!R.Default.isCtrlDown(M)){var H,f;eq(M)?(H=p.getStyle("shiftRotateRound"),f=H/2):(H=p.getStyle("rotateRound"),f=p.getStyle("rotateSensitivity")),g=Sm.roundTo(g,H,f)}J?(r=g-(k.lastRotation||0),0!==r&&(s.addRotation(r,k.groupRotateMode,function(U){return O.isRotationEditable(U)}),k.lastRotation=g)):s.setRotation(g),p._setRotateCursor(B),g>Math.PI&&(g-=2*Math.PI);var C=180*(g/Math.PI),E=""+C.toFixed(2)+"°",y=R.Default.getLogicalPoint(M,p._canvas);y.x+=Sm.Icons.TipShiftX,y.y+=Sm.Icons.TipShiftY,i.tipInfo={helperPos:y,text:E,size:E.length},p.fi({kind:"betweenEditRotation",event:M})}},hg.prototype._42=function(r,L,X){var w=this;w._clockPainted=!1,w.info={},w.screenInfo={};var K=w._interactor;K.editDetail||w.gatherInfo(L,X)&&w.isVisible()&&(Sm.Icons.DrawIcon(K,r,Sm.Icons.RoundPoint,w.screenInfo.POS),K.getStyle("rotateTipVisible")&&w.tipInfo&&Sm.Icons.DrawIcon(K,r,Sm.Icons.TipHelper,w.tipInfo),w.editing&&w.drawClock(r))},hg.prototype.drawClock=function(g){g.save();var Y=this;Y._clockPainted=!0;var W=Y.editing||{},h=W.screenInfo||Y.screenInfo,_=h.LEN,o=_+8,U=_+18;g.save(),g.translate(h.CENTER.x,h.CENTER.y),g.beginPath(),g.strokeStyle="rgb(150, 150, 150)";for(var v,j,I,R,t,d=0;360>d;d++)v=d*Math.PI/180,0===d%5&&(j=a(v)*_,I=A(v)*_,R=a(v)*o,t=A(v)*o,g.moveTo(j,I),g.lineTo(R,t)),0===d%45&&(j=a(v)*_,I=A(v)*_,R=a(v)*U,t=A(v)*U,g.moveTo(j,I),g.lineTo(R,t));g.stroke(),g.rotate(-Ie);var N=W.lastRotation||Y.target.getRotation();g.beginPath(),g.fillStyle="rgba(255, 0, 0, 0.1)",g.strokeStyle="rgb(157, 157, 157)",g.moveTo(0,0),g.arc(0,0,U,0,N,!1),g.fill(),g.beginPath(),g.moveTo(0+U,0),g.arc(0,0,U,0,N,!1),g.stroke(),g.restore()};var ml=Sm.Curve=function(U){this.catalog="Curve",this._interactor=U};ml.prototype={},ml.prototype.constructor=ml,S.defineProperties(ml.prototype,{activing:{get:function(){return this._activing},set:function(C){var $=this;if(C)$._activing=new Sm.CurveActiving(this,C),$._activing._firePointChange();else{var O=$._activing;O&&O.dispose(),$._activing=null}}}}),ml.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},ml.prototype.setUp=function(){var S=this,Q=S._interactor;Q&&Q.gv.mp(S._onGraphviewPropertyChanged,S)},ml.prototype._onGraphviewPropertyChanged=function(X){("zoom"===X.property||"translateX"===X.property||"translateY"===X.property)&&this._handleDataChanged()},ml.prototype.tearDown=function(){var $=this,D=$._interactor;D&&D.gv.ump($._onGraphviewPropertyChanged,$)},ml.prototype.canEnterEditDetailMode=function(){var M=Hk(this._interactor);return M?this.target=M:void 0},ml.prototype.canQuitEditDetailMode=function(O){var B=this,d=B._interactor._getLogicalPoint(O);return B._checkEditRealPoint(d)?void 0:B._interactor.gv.getDataAt(O)!==B.target?!0:void 0},ml.prototype.preHandleScroll=function(){var z=this.editing;return z&&z.inEdit?!0:void 0},ml.prototype.getCurrentSelectintStatus=function(){var G=this;if(G.activing&&!G.activing.selections){if(G.activing.status!=Y)return G.activing.status;var Q=function(Q){var S=G.activing.status;G.activing.status=Q,G._interactor.fp("shapePointStatus",S,Q)},C=Sm.Curve.PointType,W=G.activing.point,c=G.activing.pairs;if(!c||1!==c.length)return Q(C.Mirrored);var A=c[0],D=A.c1&&A.c1.isNearEnough(W),b=A.c2&&A.c2.isNearEnough(W);if(!A.c1||!A.c2)return D||b?Q(C.Straight):Q(C.Disconnected);if(D&&b)return Q(C.Straight);if(D||b)return Q(C.Asymmetric);var U=A.c1.clone().sub(W),L=A.c2.clone().sub(W);return Math.abs(U.x*L.y-U.y*L.x)>1e-5||U.x*L.x>0?Q(C.Disconnected):Math.abs(U.length()-L.length())>1e-5?Q(C.Asymmetric):Q(C.Mirrored)}},ml.prototype.handle_keydown=function(z){var b=this;if(b._interactor.editDetail){var h=Sm.Curve.PointType;"1"===z.key?b._setCurrentSelectionStatus(h.Straight):"2"===z.key?b._setCurrentSelectionStatus(h.Mirrored):"3"===z.key?b._setCurrentSelectionStatus(h.Disconnected):"4"===z.key&&b._setCurrentSelectionStatus(h.Asymmetric)}},ml.prototype.setCurrentSelectionStatus=function(y){var T=this,D=T._interactor;if(D){var _=D.gv;_.dm().beginTransaction(),this._setCurrentSelectionStatus(y),_.dm().endTransaction()}},ml.prototype._setCurrentSelectionStatus=function(F){var P=this,l=P.activing;if(l){var K=P.getCurrentSelectintStatus();if(null!==K&&K!==F){l.status=F;var x=P.activing.point,y=P.activing.pairs;if(y&&1===y.length){var n=y[0],O=P.screenInfo.curve,A=Sm.Curve.PointType,U=P._interactor,H=function(){P._writeToHt(),U.fp("shapePointStatus",K,F),P.check(U.gv,null,new Sm.Math.Vector2(U._lastLogicalPoint))};if(F===A.Straight)return O.moveCtrlPoint(n,x,"c1"),O.moveCtrlPoint(n,x,"c2"),H(),void 0;if(K===A.Straight){var r=O.findPairs(x,!0),X=r[0],L=X.r1||x,B=X.r2||x,w=B.clone().sub(L).multiplyScalar(.25);return O.moveCtrlPoint(n,x.clone().sub(w),"c1"),O.moveCtrlPoint(n,x.clone().add(w),"c2"),H(),void 0}var t=n.c1,V=n.c2;if(t&&V){if(F===A.Mirrored)return O.moveCtrlPoint(n,x.clone().multiplyScalar(2).sub(V),"c1"),H(),void 0;if(F===A.Asymmetric&&K===A.Disconnected){var k=t.clone().sub(x).length(),w=x.clone().sub(V).setLength(k).add(x);return O.moveCtrlPoint(n,w,"c1"),H(),void 0}}l._firePointChange(),U.fp("shapePointStatus",K,F),P.check(U.gv,null,new Sm.Math.Vector2(U._lastLogicalPoint))}}}},ml.prototype._handleDataChanged=function(){var F="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(G){var _=this;if(_.screenInfo&&_.target){if(G&&F.indexOf(G.property)<0)return;var E=_._interactor;_.gatherSingleTarget(E.gv,_.target,!0),_.check(E.gv,null,new Sm.Math.Vector2(E._lastLogicalPoint)),E._42()}}}(),ml.prototype.gatherSingleTarget=function(O,E,o){var B,P,$=this;$.screenInfo&&$.screenInfo.curve&&(P=$.screenInfo.curve._curves);var t=$.editing;B=t?$.screenInfo:$.screenInfo={};var f,U,N=E instanceof R.Edge;N?(f=E.s("edge.segments"),U=E.s("edge.points")||new R.List):(f=E._58O,U=E._59O),B.S=f;var m,g=B.P=[],W=Sm.getDataMatrix(E);if(E instanceof R.Polyline||E instanceof R.Edge&&$._interactor.getStyle("edgeElevationEditable"))m=E.getElevation&&E.getElevation()||0,B.E=[];else{var p=!1;U.each(function(P){P.e!==Y&&(p=!0)}),p&&(B.E=[])}if(U.each(function(L){B.E&&B.E.push(L.e!=Y?L.e:m),L=W.apply(L);var M=Sm.toScreenPosition(O,L);g.push(M.x,M.y)}),N){var T=g.length,e=Sm.toScreenPosition(O,E._lastSourcePoint||(T?{x:g[0],y:g[1]}:{x:0,y:0})),S=Sm.toScreenPosition(O,E._lastTargetPoint||(T?{x:g[T-2],y:g[T-1]}:{x:0,y:0}));if(g.splice(0,0,e.x,e.y),g.push(S.x,S.y),B.E){var F=E.getSourceAgent();F instanceof R.Edge?B.E.splice(0,0,E.s("edge.source.offset.elevation")):B.E.splice(0,0,((E.s("edge.source.anchor.elevation")||.5)-.5)*F.getTall()*F.getScaleTall()+F.getElevation()+E.s("edge.source.offset.elevation"));var Q=E.getTargetAgent();Q instanceof R.Edge?B.E.push(E.s("edge.target.offset.elevation")):B.E.push(((E.s("edge.target.anchor.elevation")||.5)-.5)*Q.getTall()*Q.getScaleTall()+Q.getElevation()+E.s("edge.target.offset.elevation"))}}if(!B.S||!B.S.size()){B.S=new R.List,B.S.add(1);for(var s=0;s<g.length/2-1;s++)B.S.add(2)}if((!t||o)&&$.convertToCubicBezier(P),$.activing&&(o||!$.editing||"realPoint"===$.editing.type)){var v=B.curve.findPairs($.activing.point);$.activing.pairs=v}},ml.prototype._convertToNewPoint=function(q,Z,v,i){var A,e,x;for(A=0,e=Z.length;e>A;A++){if(x=Z[A],x._p1.isNearEnough(q)&&(!i||i.indexOf(x._p1)<0))return x._p1;if(x._p4.isNearEnough(q)&&(!i||i.indexOf(x._p4)<0))return x._p4}if(v)for(A=0,e=Math.min(v.length,e);e>A;A++){if(x=v[A],x._p1===q&&(!i||i.indexOf(Z[A]._p1)<0))return Z[A]._p1;if(x._p4===q&&(!i||i.indexOf(Z[A]._p4)<0))return Z[A]._p4}},ml.prototype.convertToCubicBezier=function(o){var S,q,D=this,s=new Sm.Math.Curve,O=D.screenInfo;if(s.createFromHtShape(O.P,O.S,O.E),O.curve=s,D.activing){var h=s._curves;S=D.activing.point,q=D._convertToNewPoint(S,h,o);var N=[];if(q&&(D.activing.point=q,N.push(q)),D.activing.selections){var H=-1,K=D.activing.selections;K.forEach(function(P){H++,q=D._convertToNewPoint(P,h,o,N),q&&(K[H]=q,N.push(q))})}}},ml.prototype.check=function(N,K,_){if(!K||rf(K)||qn(K)){var s=this;if(s._interactor.setCursor("default"),s.editing=null,s.highlight=null,s.tipInfo=null,s.edgeEditResult=null,s.screenInfo){if(an()||K&&qn(K))return s._interactor._42(),!0;if(s._checkEditCtrlPoint(_))return s._interactor._42(),!0;if(s._checkEditRealPoint(_))return s._interactor._42(),!0;if(s._checkEditElevation(_))return s._interactor._42(),!0;var B=s.screenInfo.curve,p=B.checkPoint(_,s._interactor.getStyle("curveIntersectSize"));if(p){var L=s.highlight={};L.type="insertKnot",L.bezier=p.bezier,L.point=p.intersection}return s._interactor._42(),!0}}},ml.prototype.getAdjacentBeziers=function(U){var g=this.screenInfo;if(g){var D,X,o,n=g.curve._curves,r=[],s=Y;for(D=0,X=n.length;X>D;D++)if(o=n[D],s===Y){if(o._p4.isNearEnough(U)){r.push(o),s=D;continue}}else{if(o._p1.isNearEnough(U))return r.push(o),r;if(o._p4.isNearEnough(U)){r[0]=o,s=D;continue}}}},ml.prototype.roundCorner=function(N){if(this.activing&&this.screenInfo){var I=this.screenInfo.curve,Y=I._curves,H=this.getAdjacentBeziers(this.activing.point),V=H[1],Q=V._index;V=V.insertKnot(V.getTByPercentage(N/V.length))[1],Y[Q]=V;var T=V.p1,o=H[0],j=o._index;o=o.insertKnot(o.getTByPercentage(1-N/o.length))[0],Y[j]=o;var D=o.p4,P=this.activing.point,c=new Sm.Math.CubicBezier(D,P.clone().sub(D).multiplyScalar(2/3).add(D),P.clone().sub(T).multiplyScalar(2/3).add(T),T);Y.splice(Q,0,c),this._writeToHt(),this.activing=null,this._interactor._42()}},ml.prototype._checkEditRealPoint=function(R){var q,t,F,s,b,k,g=this,M=g.screenInfo.curve._curves,J=g._interactor.getStyle("curvePointIntersectSize"),H=1/0;for(J*=J,F=0,s=M.length;s>F;F++)q=M[F],b=q._p1,k=R.distanceToSquared(b),H>k&&(H=k,t=b),b=q._p4,k=R.distanceToSquared(b),H>k&&(H=k,t=b);if(H>J)return!1;var K=g.highlight={};return K.type="changeRealPoint",K.point=t,g.editing={type:"realPoint",point:t,shiftGuide:{point:t.clone(),dir:"x",limit:0}},g._interactor.setCursor("crosshair"),!0},ml.prototype._checkEditElevation=function(t){var w=this;if(!w._interactor.getStyle("curveElevationVisible"))return!1;var U=w.target;if(U instanceof R.Edge&&!w._interactor.getStyle("edgeElevationEditable"))return!1;var a=w.activing;if(!a)return!1;var e=a.getCurrentEditingPoint();if(!e)return!1;var I=w._interactor,f=I.getStyle("curveElevationGuideShift"),d=I.getStyle("curveElevationIntersectSize"),j=t.distanceToSquared({x:e.x+f[0],y:e.y+f[1]});if(!(j>d*d)){var u=w.highlight={};u.type="elevation";var M=new Sm.Math.Vector2(t.x,t.y,e.e);return w.editing={type:"elevation",startPoint:M},w._interactor.setCursor("crosshair"),!0}},ml.prototype._checkEditCtrlPoint=function(E){var m=this;if(m.activing&&!m.activing.selections){var Y=m.getCurrentSelectintStatus();if(Y!==Sm.Curve.PointType.Straight){var J=m.activing.pairs;if(J){var p=m._interactor.getStyle("curvePointIntersectSize");p*=p;var R,b,r,v,t,k,K,Q,i,c=1/0;for(K=0,i=J.length;i>K;K++)for(v=J[K],Q=0;2>Q;Q++)t=0===Q?"c1":"c2",v[t]&&(k=E.distanceToSquared(v[t]),c>k&&(c=k,R=v,b=K,r=t));if(c>p)return!1;m.activing.hlpair=R,m.activing.hltype=r;var z=m.highlight={};return z.type="changeCtrlPoint",z.point=R[r],m.editing={type:"ctrlPoint",pair:R,pairId:b,ctrlType:r,direction:R[r].clone().sub(m.activing.point).normalize()},m._interactor.setCursor("crosshair"),!0}}}},ml.prototype.startEdit=function(I,T){I.startDragging(T);var E=this;E.highlight&&"insertKnot"===E.highlight.type&&(E.insertKnot(),E.gatherSingleTarget(E._interactor.gv,E.target),E.activing=null,E._checkEditRealPoint(E._interactor._getLogicalPoint(T)));var Y=E._activing;if(Y){var c=E.editing?E.editing.type:null;"ctrlPoint"===c?Y.editingCtrl={pairId:E.editing.pairId,type:Y.hltype}:"realPoint"===c&&(Y.editingCtrl=!1)}var v=E.highlight,y=R.Default.isCtrlDown(T);if(!v||an()||qn(T)){var Q=E._interactor.gv;if(!Q.setFocus(T)||Q._scrolling)return;return y?E._multiSelect={startPoint:Q.lp(T)}:Q.isPannable()&&(rf(T)||qn(T))&&(E._pan={tx:Q.tx(),ty:Q.ty()},I.fi({kind:"beginPan",event:T})),void 0}if("changeRealPoint"===v.type){var L,r=E.activing?E.activing.point:null,f=E.activing?E.activing.selections:null;if(y&&E.activing)r===v.point?(f?(E.activing={point:f[0]},f.length>1&&(f.splice(0,1),E.activing.selections=f)):E.activing=null,E.editing=null):f&&(L=f.indexOf(v.point))>=0?(f.length>1?f.splice(L,1):delete E.activing.selections,E.editing=null):f?(f.push(r),E.activing={point:v.point,selections:f}):E.activing={point:v.point,selections:[r]};else if(f)r===v.point||((L=f.indexOf(v.point))>=0?(f.splice(L,1,r),E.activing={point:v.point,selections:f}):E.activing={point:v.point});else{var u;r===v.point&&(u=E.activing.status),E.activing={point:v.point},u&&(E.activing.status=u)}I.fi({kind:"beginEditPoint",event:T})}},ml.prototype.insertKnot=function(){var v=this,K=v.highlight,q=v.screenInfo.curve;q.insertKnot(K.bezier,K.point.t),v._writeToHt()},ml.prototype._writeToHt=function(){var H,b,e=this,i=e.screenInfo.curve,N=i.toHtShape(),Y=N.points,B=[],s=N.segments,h=e._interactor.gv;h.dm().beginTransaction();var d,o,Z=e.target,E=Z instanceof R.Edge,M=Sm.getDataMatrix(Z).invert();o=Z instanceof R.Polyline||E&&e._interactor.getStyle("edgeElevationEditable"),o&&(d=Z.getElevation&&Z.getElevation()||0);for(var g=0,V=Y.length;V>g;g++)H=Y[g],b=Sm.toWorldPosition(h,H),b=M.apply(b),isFinite(H.e)&&H.e!==d&&(b.e=H.e),B.push(b);if(Z._writing=!0,E){Z.s("edge.type","points"),Z.setStyle("edge.segments",s),Z.setStyle("edge.points",B.slice(1,B.length-1)),Z.setStyle("edge.source.offset.x",0),Z.setStyle("edge.source.offset.y",0),Z.setStyle("edge.target.offset.x",0),Z.setStyle("edge.target.offset.y",0);var r=e._nextChangeEdgeHost;delete e._nextChangeEdgeHost,r&&("source"===r.type?Z.setSource(r.host):Z.setTarget(r.host)),e._writeEdgeHostAnchor("source",B[0]),e._writeEdgeHostAnchor("target",B[B.length-1])}else B.length?(Z.setSegments(s),Z.setPoints(B,!0)):Z.removeFromDataModel();
h.dm().endTransaction(),delete Z._writing},ml.prototype._writeEdgeHostAnchor=function(R,T){var e=this,i=e.target,$=e._calcHostAnchor(i,R,T);$.index!==Y?(i.setStyle("edge."+R+".index",$.index),i.setStyle("edge."+R+".percent",Y),i.setStyle("edge."+R+".anchor.x",Y),i.setStyle("edge."+R+".anchor.y",Y),i.setStyle("edge."+R+".anchor.elevation",Y),i.setStyle("edge."+R+".offset.elevation",T.e)):$.percent!==Y?(i.setStyle("edge."+R+".percent",$.percent),i.setStyle("edge."+R+".index",Y),i.setStyle("edge."+R+".anchor.x",Y),i.setStyle("edge."+R+".anchor.y",Y),i.setStyle("edge."+R+".anchor.elevation",Y),i.setStyle("edge."+R+".offset.elevation",T.e)):(i.s("edge."+R+".anchor.x",$.x),i.s("edge."+R+".anchor.y",$.y),i.s("edge."+R+".anchor.elevation",$.e),$.offsetX||$.offsetY||$.offsetElevation?(i.s("edge."+R+".offset.x",$.offsetX),i.s("edge."+R+".offset.y",$.offsetY),i.s("edge."+R+".offset.elevation",$.offsetElevation)):(i.s("edge."+R+".offset.x",0),i.s("edge."+R+".offset.y",0),i.s("edge."+R+".offset.elevation",0)))},ml.prototype._calcHostAnchor=function(C,q,H,e){e||(e="source"===q?C.getSource():C.getTarget());var $=this._interactor.gv,h=$.calculateAttachPoint(e,H);if(h)return h.info;if(Ye(e)){var E=$.calculateEdgePosition(e,H);return E}var f=e.getRotation(),r=e.getAnchor();Xr(e,$)&&(f=0);var v=e.getElevation(),t=e.getTall()*e.getScaleTall();v=((H.e||0)-C.s("edge."+q+".offset.elevation")-v)/t+.5;var Y=e.getScale();if(f||Y.x<0||Y.y<0){var A=e.getMatrix(),m=A.tfi(H),P=e.getSize();return{x:m.x/P.width+r.x,y:m.y/P.height+r.y,e:v}}var a=Bf($,e),D={x:(H.x-a.x)/a.width,y:(H.y-a.y)/a.height,e:v};return D},ml.prototype._handlePanning=function(x){var W=this,Q=W._pan;if(Q){Q.started=!0;var A=W._interactor,Z=A.gv,I=A._lastClientPoint,B=sf(x),X=ap(Z,B,I);Z.setTranslate(Q.tx+X.x,Q.ty+X.y),W.gatherSingleTarget(A.gv,W.target),A._42(),A.fi({kind:"betweenPan",event:x})}},ml.prototype.handleEdit=function(v,b){var Z=this,Q=Z.editing;if(Z._pan)return Z._handlePanning(b),void 0;if(Z._multiSelect)return Z._multiSelect.endPoint=v.lp(b),Z._interactor.redraw(),void 0;if(Q){Q.inEdit=!0;var l,z,u,E=Z._interactor._getLogicalPoint(b),$=R.Default.isCtrlDown(b),c=R.Default.isShiftDown(b),D=Q.type,F=Z.activing;if(Z._guideInfo=null,"ctrlPoint"===D&&c){var G=Z.editing.direction.clone();l=F.point;var I=G.dot(E.clone().sub(l));E=G.setLength(I).add(l)}else if("ctrlPoint"===D||"realPoint"===D){var G;if("realPoint"===D&&c){var q=Z.editing.shiftGuide;z=q.point;var n=Math.abs(E.x-z.x),V=Math.abs(E.y-z.y);n>V&&n>q.limit&&"y"===q.dir&&(q.dir="x"),V>n&&V>q.limit&&"x"===q.dir&&(q.dir="y"),G=q.dir,"x"===G?(E.y=z.y,q.limit=Math.max(q.limit,n)):"y"===G&&(E.x=z.x,q.limit=Math.max(q.limit,V))}if(!$){var d,H=Z._isEditEdgeSourceTarget();H&&(d=E.clone());var C=Z._guidingToEdit(E,G),a="realPoint"===D?Z._interactor.gridGuide.findClosest(E,G,!0):null,W=1/0,j=1/0;a&&(a.x&&(W=a.x),a.y&&(j=a.y));var m=!1;if(C&&(C.xList&&(Math.abs(C.x)<=Math.abs(W)?(m=!0,W=C.x):delete C.xList),C.yList&&(Math.abs(C.y)<=Math.abs(j)?(m=!0,j=C.y):delete C.yList),m&&(Z._guideInfo=C)),isFinite(W)&&(E.x+=W),isFinite(j)&&(E.y+=j),m&&(C.v=E),H){var M=m?E.clone():null;E.copy(d);var S=Z._editEdgeSourceTarget(H,E,$,M);S&&(Z.edgeEditResult=S,u=S.tipText,S.isFixed&&(Z._guideInfo=null))}}}var h=Z.screenInfo.curve;if("realPoint"===Q.type){l=Q.point,l.e!==Y&&(E.e=l.e),h.moveRealPoint(l,E),Q.point=E,Z.highlight.point=E;var p=F.status,J=F.selections;if(Z.activing={point:E,status:p},J){var A=E.clone().sub(l),s=0;J.forEach(function(Z){var Y=Z.clone().add(A);h.moveRealPoint(Z,Y),J[s++]=Y}),Z.activing.selections=J}}else if("ctrlPoint"===Q.type){var O=F.pairs,X=O[Q.pairId];h.moveCtrlPoint(X,E,Q.ctrlType);var k=F.status,T=Sm.Curve.PointType;if((k===T.Mirrored||k===T.Asymmetric)&&X.c1&&X.c2){var l=new Sm.Math.Vector2(F.point),i="c1"===Q.ctrlType?"c2":"c1";if(k===Sm.Curve.PointType.Mirrored)h.moveCtrlPoint(X,l.clone().multiplyScalar(2).sub(E),i);else if(k===T.Asymmetric){var I=X[i].clone().sub(l).length(),P=l.clone().sub(X[Q.ctrlType]).setLength(I).add(l);isNaN(P.x)||h.moveCtrlPoint(X,P,i)}}F._firePointChange()}else if("elevation"===Q.type){z=Q.startPoint;var o=z.e+(z.y-E.y)/v._zoom;Z._setCurrentPointImpl("e",o),F._firePointChange(),u="E: "+Sm.toFixed(o)}var t=R.Default.getLogicalPoint(b,Z._interactor._canvas);if(t.x+=Sm.Icons.TipShiftX,t.y+=Sm.Icons.TipShiftY,!u){var L=Sm.toWorldPosition(v,E);u=""+Sm.toFixed(L.x)+", "+Sm.toFixed(L.y)}Z.tipInfo={helperPos:t,text:u,size:u.length},Z._writeToHt(),Z._interactor.fi({kind:"betweenEditPoint",event:b})}},ml.prototype._setCurrentPointImpl=function(k,V){var z=this,j=z._activing;if(!j)return!1;var n=z.target;if(!n)return!1;var l=j.getCurrentEditingPoint();if(!l)return!1;var M=j.editingCtrl;if(!M)var d=l.clone();if("e"===k)l.e=V;else{var X;if("x"===k||"y"===k){var w=j._lastFirePoint;X="x"===k?{x:V,y:w?w.y:0}:{x:w?w.x:0,y:V}}else"object"==typeof k?(X=k,k.e!==Y&&(l.e=k.e)):(X={x:arguments[0],y:arguments[1]},arguments[2]!==Y&&(l.e=arguments[2]));var $=Sm.getDataMatrix(n);X=Sm.toScreenPosition(z._interactor.gv,$.apply(X)),l.x=X.x,l.y=X.y}if(!M){var D=d.multiplyScalar(-1).add(l);bs(l.e)&&bs(d.e)&&(D.e=l.e-d.e);var e=z.screenInfo.curve;e.moveCtrlDueToRealPointMovement(l,D);var K=j.selections;if(K){var v=0;K.forEach(function(s){var W=s.clone().add(D);isFinite(D.e)&&(W.e=(isFinite(s.e)?s.e:n.getElevation()||0)+D.e),e.moveRealPoint(s,W),K[v++]=W}),j.selections=K}}return!0},ml.prototype.setCurrentPoint=function(l,i){return this._setCurrentPointImpl(l,i)?(this._writeToHt(),!0):!1},ml.prototype._isEditEdgeSourceTarget=function(){var P=this,A=P.target;if(!(A instanceof R.Edge))return!1;var L=P.editing.point,h=P.screenInfo.curve._curves;return L===h[0]._p1?"source":L===h[h.length-1]._p4?"target":!1},ml.prototype._editEdgeSourceTarget=function(P,O,J,n){var e,M=this,j=M.target;if(e="source"===P?j.getSource():j.getTarget()){var S,c=M._interactor.gv,C=Sm.toWorldPosition(c,O),b=M._calcHostAnchor(j,P,C,e);if(S=b.index!==Y||b.percent!==Y?b.distance*c.getZoom()>M._interactor.getStyle("edgeHostEdgeMaxDistance"):M._interactor.getStyle("edgeHostDetectPerFrame")?!0:b.x<0||b.x>1||b.y<0||b.y>1?!0:!1){var G=c.getDataAt(C,function(E){return c.isSelectable(E)?c.isSourceTargetEditable(j,E,P)?j.canSetSourceTarget(E,P)?!0:!1:!1:!1});if(G){var K=M._calcHostAnchor(j,P,C,G);e=G,M._nextChangeEdgeHost={type:P,host:G},b=K}}var w,F,q,u=!1;if(J||b.x===Y)(b.percent!==Y||b.index!==Y)&&(u=!0,F=b.point);else{var Z=M._interactor.getStyle("anchorRound"),A=M._interactor.getStyle("anchorSensitivity");w=c.calculateAttachPoint(e,C),w?(b=w.info,u=!0):(n&&(b=M._calcHostAnchor(j,P,Sm.toWorldPosition(c,n),e)),b.x=Sm.roundTo(b.x,Z,A),b.y=Sm.roundTo(b.y,Z,A)),F=lb(c,e,0,b.offsetX||0,b.offsetY||0,b.x,b.y)}F&&(q=Sm.toScreenPosition(c,F),O.x=q.x,O.y=q.y),M._edgeHostGuideInfo={corners:Sm.getTargetCornersOnScreen(c,e),attach:w?w.index:-1,host:e};var R;return b.percent!==Y?R="percent: "+b.percent.toFixed(2):b.index!==Y?R="index: "+b.index:(R=""+b.x.toFixed(2)+", "+b.y.toFixed(2),(b.offsetX||b.offsetY)&&(R+=" offset: "+b.offsetX.toFixed(2)+", "+b.offsetY.toFixed(2))),{host:e,anchor:b,tipText:R,isFixed:u}}},ml.prototype._guidingToEdit=function(Y,U){var o,q,E=this;if(o=E.screenInfo.curve){q=o._curves;var x,I,z,G,g,V,C,J,N=1/0,Q=1/0,h=[];for(E.editing&&"realPoint"===E.editing.type&&(J=E.editing.point),g=0,V=2*q.length;V>g;g++)C=q[Math.floor(g/2)][g%2?"_p4":"_p1"],h.indexOf(C)>=0||(h.push(C),J&&J===C||(z=C.x-Y.x,G=C.y-Y.y,Math.abs(z)<Math.abs(N)?(N=z,x=[C]):z===N&&x.push(C),Math.abs(G)<Math.abs(Q)?(Q=G,I=[C]):G===Q&&I.push(C)));var v=E._interactor.getStyle("smartGuideThreshold");if((Math.abs(N)>v||"y"===U)&&(x=null),(Math.abs(Q)>v||"x"===U)&&(I=null),x||I){var d=!1,b={};if(x&&(d=!0,b.xList=x,b.x=N),I&&(d=!0,b.yList=I,b.y=Q),d)return b}}},ml.prototype._46O=function($){var O=this;O.editing&&(O.editing=null,O._interactor.fi({kind:"endEditPoint",event:$})),O._guideInfo=null,O._edgeHostGuideInfo=null,O._pan&&(O._pan=null,O._interactor.fi({kind:"endPan",event:$})),O._multiSelect&&(O._handleMultiSelect(O._multiSelect,$),O._multiSelect=null),O.tipInfo=null,O.edgeEditResult=null},ml.prototype._handleMultiSelect=function(K,a){if(K.startPoint&&K.endPoint){var X,q,h,C,_,r,T=this,D=T._interactor,F=D.gv,g=Sm.toScreenPosition(F,K.startPoint),n=Sm.toScreenPosition(F,K.endPoint),P=R.Default.unionPoint(g,n),f=T.screenInfo.curve._curves,k=[],w=function(U){U.x>=P.x&&U.y>=P.y&&U.x<=P.x+P.width&&U.y<=P.y+P.height&&k.indexOf(U)<0&&k.push(U)};for(X=0,q=f.length;q>X;X++)_=f[X],w(_._p1),w(_._p4);if(k.length){var U=T.activing||{},H=U.selections||[];U.point&&H.push(U.point);var O=R.Default.isShiftDown(a),c=a.altKey;if(c&&!O)for(r=k,k=[],X=0,q=r.length;q>X;X++)h=r[X],C=H.indexOf(h),C>=0&&k.push(h);for(X=0,q=H.length;q>X;X++)h=H[X],C=k.indexOf(h),C>=0?(!O||O&&c)&&(k[C]=Y):k.push(h);for(r=k,k=[],X=0,q=r.length;q>X;X++)r[X]&&k.push(r[X]);q=k.length,0===q?T.activing=null:1===q?T.activing={point:k[0]}:(h=k[q-1],T.activing={point:h,selections:k.splice(0,q-1)}),D.redraw()}}},ml.prototype._canDeletePoint=function(x,w){var l=this.target;if(!(l instanceof R.Edge))return!0;var _=x._curves[0],i=x._curves[x._curves.length-1];return _._p1===w||i._p4===w?!1:!0},ml.prototype.handleDelete=function(){var e=this;if(e.activing&&e.screenInfo){var O=R.Default.isShiftDown(),C=e.screenInfo.curve;e._canDeletePoint(C,e.activing.point)&&C.deleteRealPoint(e.activing.point,O),e.activing.selections&&e.activing.selections.forEach(function(i){e._canDeletePoint(C,i)&&C.deleteRealPoint(i,O)}),e.activing=null,delete e.editing,delete e.tipInfo,delete e.edgeEditResult,delete e._pan,delete e._multiSelect,e._writeToHt(),e._interactor.fp("deleteShapePoint",!1,!0)}},ml.prototype.handleDoubleClick=function(x){var G=this,i=G._interactor._getLogicalPoint(x);if(G.screenInfo&&G._checkEditRealPoint(i)){var J=G.getCurrentSelectintStatus(),l=Sm.Curve.PointType;return J=J===l.Mirrored?l.Straight:l.Mirrored,G._setCurrentSelectionStatus(J),G._interactor._42(),!0}},ml.prototype._drawHighlight=function(I){var g=this,$=g.highlight;if($){var v=$.bezier,a=g._interactor;v&&Sm.Icons.DrawIcon(a,I,Sm.Icons.ShapeHighlightCurve,[v._p1.x,v._p1.y,v._p2.x,v._p2.y,v._p3.x,v._p3.y,v._p4.x,v._p4.y]);var c=$.point;c&&"insertKnot"===$.type&&Sm.Icons.DrawIcon(a,I,Sm.Icons.ShapeHighlighPoint,c)}},ml.prototype._drawGuide=function(u){var h=this,l=h._guideInfo;if(l){var y,b,P,v,V=l.v;for(y=0;2>y;y++)if(v=0===y?l.xList:l.yList)for(b=0,P=v.length;P>b;b++)Sm.Icons.DrawIcon(h._interactor,u,Sm.Icons.ShapeGuideLine,[V.x,V.y,v[b].x,v[b].y])}},ml.prototype._drawCurrentPoint=function(W){var O=this;if(O.activing){var q=O.activing,l=O.getCurrentSelectintStatus(),F=O._interactor;if(l!==Sm.Curve.PointType.Straight){var s=q.pairs;q.hlpair,q.hltype;var c=q.selections,x=q.editingCtrl;if(s&&!c){var h,Y,Q;for(Y=0,Q=s.length;Q>Y;Y++)h=s[Y],x&&Y===x.pairId&&h[x.type]?Sm.Icons.DrawIcon(F,W,Sm.Icons.ShapeActivingCtrl,{point:h.point,c1:h.c1,c2:h.c2,hl:x.type}):Sm.Icons.DrawIcon(F,W,Sm.Icons.ShapeActivingCtrl,h)}}Sm.Icons.DrawIcon(F,W,Sm.Icons.ShapeHighlighRealPoint,O.activing.point),c&&c.forEach(function(g){Sm.Icons.DrawIcon(F,W,Sm.Icons.ShapeHighlighRealPoint,g)})}},ml.prototype.clear=function(){var c=this;c.editing=null,c._guideInfo=null,c.activing=null,c.highlight=null},ml.prototype._42=function(S){var F=this;F.info={},F.editing||(F.screenInfo=null);var e=F._interactor;if(!e.editDetail)return F.clear(),void 0;var m=e.gv;if(!F.target||!m.isSelected(F.target)||!m.isVisible(F.target))return e.editDetail=!1,F.clear(),void 0;if(F.gatherSingleTarget(m,F.target),Sm.Icons.DrawIcon(e,S,Sm.Icons.ShapeBgCurve,F.screenInfo),F._interactor.getStyle("curveElevationVisible")&&(F.target instanceof R.Polyline||F.target instanceof R.Edge&&F._interactor.getStyle("edgeElevationEditable"))&&F.activing){var J=F.activing.getCurrentEditingPoint();J&&"string"!=typeof J.e&&Sm.Icons.DrawIcon(e,S,Sm.Icons.EdgeElevationGuide,J)}if(F._drawHighlight(S),F._drawCurrentPoint(S),F._getRealPoint().forEach(function(H){Sm.Icons.DrawIcon(e,S,Sm.Icons.ShapePoint,H)}),F._drawGuide(S),F.tipInfo&&F._interactor.getStyle("curveTipVisible")&&Sm.Icons.DrawIcon(e,S,Sm.Icons.TipHelper,F.tipInfo),F._edgeHostGuideInfo&&e._drawHostGuide(F._edgeHostGuideInfo),F.edgeEditResult&&F._drawEdgeHostHighlight(S,F.edgeEditResult.host,F.edgeEditResult.anchor),F._multiSelect&&F._multiSelect.endPoint){var M=R.Default.unionPoint(Sm.toScreenPosition(m,F._multiSelect.startPoint),Sm.toScreenPosition(m,F._multiSelect.endPoint));M.color=m.getRectSelectBorderColor(),S.save(),S.setTransform(1,0,0,1,0,0);var N=x.devicePixelRatio,P=M.borderWidth=Math.round(N);P/=2,M.x=Math.round(M.x*N)+P,M.y=Math.round(M.y*N)+P,M.width=Math.round(M.width*N),M.height=Math.round(M.height*N),Sm.Icons.DrawIcon(e,S,Sm.Icons.SimpleRect,M),S.restore()}},ml.prototype._drawEdgeHostHighlight=function(k,p,t){this.drawEdgeHostHighlight(k,p,t),this._interactor.redraw()},ml.prototype.drawEdgeHostHighlight=function(i,Z,p){if(Ye(Z)){var f,n,o,H,Q=this,t=Q._interactor,V=t.gv,B=V.getDataUI(Z),x=cj(B),R=[];for(o=0,H=x.points.length;H>o;o++)n=Sm.toScreenPosition(V,x.points.get(o)),R.push(n.x,n.y);x.segments&&(f=x.segments.toArray());var F=t.getStyle("edgeHostHighlighPeriod"),D=t.getStyle("edgeHostEdgeHighlighColor");Sm.Icons.DrawIcon(t,i,Sm.Icons.ShapeBgCurve,{P:R,S:f,color:D,dynamicVisible:p.index===Y,dynamicPeriod:F}),D=t.getStyle("edgeHostPointHighlighColor");var u=cp(B);for(o=0,H=u.length;H>o;o++){var L=u[o],k=Sm.toScreenPosition(V,L);Sm.Icons.DrawIcon(t,i,Sm.Icons.ShapePoint,{point:{x:k.x,y:k.y},color:D,size:12,dynamicVisible:o===p.index,dynamicPeriod:F})}}},ml.prototype._getRealPoint=function(){var y,g=this.screenInfo,J=g.P,P=g.S,A=-1,k=[],i=-1,D=P.length;return P.each(function(d){i++;var S=1;if(3===d)S=2;else if(4===d)S=3;else if(5===d)return;A+=S,y=i+1>=D?!0:1===P.get(i+1)?!0:!1,k.push({point:{x:J[2*A],y:J[2*A+1]},segmentIndex:i,pointIndex:A,isEnd:y})}),k},ml.prototype.getEditingPointsInfo=function(m){var A=this,v=A.activing;if(!v)return!1;var a=v.point;if(!a)return!1;var U=this._getRealPoint(),w=[{screen:a}];v.selections&&v.selections.forEach(function(G){w.push({screen:G})});var z,t,C=U.length;return w.forEach(function(m){for(z=0;C>z;z++)if(t=U[z],m.screen.isNearEnough(t.point)){m.segmentIndex=t.segmentIndex,m.pointIndex=t.pointIndex,m.point=A.target.getPoints().get(t.pointIndex);break}}),m&&w.sort(function(S,$){return S.segmentIndex-$.segmentIndex}),w};var Mi=Sm.MoveHelper=function(y){var F=this;F.catalog="Move",F._interactor=y};Mi.prototype={},Mi.prototype.constructor=Mi,Mi.prototype.calcShift=function(F,y,i){var U,z,m=this,K=m._interactor.gv,A=K.lp(y);if("beginMove"===F&&m._gatherGridInfo(i._lastLogicalPoint||A),U=m._target){var Y=U.downPosition;if(Y){var D=m._interactor.getStyle("moveSensitivity")/K._zoom;if(Y.distanceTo(A)<D)return{x:0,y:0};delete U.downPosition}var j;z=R.Default.isShiftDown(y),z&&(A=m._dealShiftDown(A),j=U.shiftGuide.dir);var X,x=U.rawPos={x:U.pos.x+A.x-U.lp.x,y:U.pos.y+A.y-U.lp.y};if(R.Default.isCtrlDown(y)){if(X=m._calcShiftByAddon(),m._target.node instanceof Sm.Group){var q=m._target.node;q._position.x+=X.x,q._position.y+=X.y}return X}var W=m._interactor.rectGuide;if(U.node instanceof R.Data&&U.node.s("2d.attachable")){var Q=m._calcAttachNodeShift(U.node,x);if(W.clear(),Q)return Q}for(var u,h=U.x+x.x,L=U.y+x.y,T={x:h,y:L},w={x:h+U.w/2,y:L+U.h/2},C={x:h+U.w,y:L+U.h},f=m._interactor.gridGuide,b=[W.findClosest(T,j),W.findClosest(w,j),W.findClosest(C,j),f.findClosest(T,j),f.findClosest(w,j),f.findClosest(C,j)],S=1/0,n=1/0,B=0,V=b.length;V>B;B++)u=b[B],u&&(h=u.x,L=u.y,isFinite(h)&&Math.abs(h)<Math.abs(S)&&(S=h),isFinite(L)&&Math.abs(L)<Math.abs(n)&&(n=L));if(isFinite(S)||(S=0),isFinite(n)||(n=0),X=m._calcShiftByAddon(S,n),m._target.node instanceof Sm.Group){var q=m._target.node;q._position.x+=X.x,q._position.y+=X.y}var $=U.node;if(!Xr($,K)){var e=x.x+S,P=x.y+n;m._interactor.rectGuide.gatherLines({node:$,x:U.x+e,y:U.y+P,w:U.w,h:U.h},j)}return X}},Mi.prototype._calcShiftByAddon=function(p,N){var l=this._target,O=l.rawPos,F=l.node.getPosition();return p=p||0,N=N||0,{x:O.x-F.x+p,y:O.y-F.y+N}},Mi.prototype._dealShiftDown=function(l){var $=this,Q=$._target.shiftGuide,N=$._target.lp,n=Math.abs(l.x-N.x),p=Math.abs(l.y-N.y);n>p&&n>Q.limit&&"y"===Q.dir&&(Q.dir="x"),p>n&&p>Q.limit&&"x"===Q.dir&&(Q.dir="y");var f=Q.dir;return"x"===f?(l.y=N.y,Q.limit=Math.max(Q.limit,n)):"y"===f&&(l.x=N.x,Q.limit=Math.max(Q.limit,p)),l},Mi.prototype._isAttachableLineShape=function(b){if(!b.getSegments)return!1;var O=b.getSegments();if(!O)return!0;O instanceof R.List&&(O=O.getArray());for(var g=1,n=O.length;n>g;g++)if(2!==O[g])return!1;return!0},Mi.prototype._calcAttachNodeShift=function(){var H=new $g,T=new $g,n=new $g,I=new $g;return function(d,U){var e=this._interactor.gv,f=d.getHost(),_=e.getDataAt(U,function(z){return z.s("2d.hostable")?!0:!1});if(_&&f!==_&&d.setHost(_),!_)return this._edgeHostGuideInfo=null,d.setHost(null);var r=this._edgeHostGuideInfo={corners:Sm.getTargetCornersOnScreen(e,_),host:_,attach:-1};if(this._isAttachableLineShape(_)){for(var u,R,O,g,B,k,C=_.getPoints(),S=C.size(),p=_.getPointsMatrix2d(),h=1/0,t=0;S>t&&(t!==S-1||_.isClosePath());t++)0!==t?T.copy(n):p.apply(C.get(t),T),p.apply(t===S-1?C.get(0):C.get(t+1),n),H.copy(U).sub(T),I.copy(n).sub(T),u=I.length(),I.divideScalar(u),R=H.dot(I),0>R?R=0:R>u&&(R=u),I.multiplyScalar(R).add(T),O=H.copy(U).sub(I).lengthSq(),h>O&&(h=O,k=t,g=R,B=u);return Math.sqrt(h)*e.getZoom()>this._interactor.getStyle("attachThreshold")?(d.s({"attach.index":-1}),d.setHost(null),void 0):(d.s("attach.offset.opposite")&&(g=B-g),d.s({"attach.index":k,"attach.offset":d.s("attach.offset.relative")?g/B:g}),{x:0,y:0})}var q=e.calculateAttachPoint(_,U);if(q){var F=q.point;return r.attach=q.index,this._calcShiftByAddon(F.x-U.x,F.y-U.y)}}}(),Mi.prototype._gatherGridInfo=function(Q){var F,O=this,p=O._interactor,b=p._getValidSelection();if(b.length){if(1===b.length){if(F=b[0],!F.getRect)return O._target=null,void 0}else if(F=Sm.Group.findOrCreateGroup(b,p._uuid),!F)return O._target=null,void 0}else{var b=p.gv.sm().getSelection();if(b.length&&(F=b.get(0),!F.getRect))return O._target=null,void 0}if(F){var q=F.getPosition(),$=F.getRect();O._target={node:F,x:$.x-q.x,y:$.y-q.y,w:$.width,h:$.height,lp:{x:Q.x,y:Q.y},pos:{x:q.x,y:q.y},shiftGuide:{dir:"x",limit:0},downPosition:new Sm.Math.Vector2(Q)},p.rectGuide.gatherRects()}},Mi.prototype.clear=function(){var C=this;C._edgeHostGuideInfo=null,C._interactor.rectGuide.clear(),C._interactor._42()},Mi.prototype._42=function(){var l=this._edgeHostGuideInfo;l&&this._interactor._drawHostGuide(l)};var qk=S.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047}),sp=function(){function m(r,N){var L=Y;return function(){return L||(L=r.getExtension(N)),L}}function T(W,X){X==Y&&(X={}),X.version=B&&(W instanceof WebGL2RenderingContext||S.prototype.toString.call(W)===$)?2:1,X.extensions=function(){for(var u={},v=W.getSupportedExtensions(),E=v.length;E--;)u[name]=m(W,v[E]);
return u}();for(var q=S.keys(M),Z=0,g=q.length;g>Z;++Z){var F=q[Z];X[F]=W.getParameter(M[F])}if(X.version>1){q=S.keys(l);for(var Z=0,g=q.length;g>Z;++Z){var F=q[Z];X[F]=W.getParameter(l[F])}}return X}var B="undefined"!=typeof WebGL2RenderingContext,$="[object WebGL2RenderingContext]",M={aliasedLineWidthRange:qk.ALIASED_LINE_WIDTH_RANGE,aliasedPointSizeRange:qk.ALIASED_POINT_SIZE_RANGE,maxCombinedTextureImageUnits:qk.MAX_COMBINED_TEXTURE_IMAGE_UNITS,maxCubeMapTextureSize:qk.MAX_CUBE_MAP_TEXTURE_SIZE,maxFragmentUniformVectors:qk.MAX_FRAGMENT_UNIFORM_VECTORS,maxRenderBufferSize:qk.MAX_RENDERBUFFER_SIZE,maxTextureImageUnits:qk.MAX_TEXTURE_IMAGE_UNITS,maxTextureSize:qk.MAX_TEXTURE_SIZE,maxVaryingVectors:qk.MAX_VARYING_VECTORS,maxVertexAttribs:qk.MAX_VERTEX_ATTRIBS,maxVertexTextureImageUnits:qk.MAX_VERTEX_TEXTURE_IMAGE_UNITS,maxVertexUniformVectors:qk.MAX_VERTEX_UNIFORM_VECTORS,maxViewportDIMs:qk.MAX_VIEWPORT_DIMS},l={max3DTextureSize:qk.MAX_3D_TEXTURE_SIZE,maxArrayTextureLayers:qk.MAX_ARRAY_TEXTURE_LAYERS,maxColorAttachments:qk.MAX_COLOR_ATTACHMENTS,maxCombinedFragmentUniformComponents:qk.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS,maxCombinedUniformBlocks:qk.MAX_COMBINED_UNIFORM_BLOCKS,maxCombinedVertexUniformComponents:qk.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS,maxDrawBuffers:qk.MAX_DRAW_BUFFERS,maxElementIndex:qk.MAX_ELEMENT_INDEX,maxElementsIndices:qk.MAX_ELEMENTS_INDICES,maxElementsVertices:qk.MAX_ELEMENTS_VERTICES,maxFragmentInpuComponents:qk.MAX_FRAGMENT_INPUT_COMPONENTS,maxFragmentUniformBlocks:qk.MAX_FRAGMENT_UNIFORM_BLOCKS,maxFragmentUniformComponents:qk.MAX_FRAGMENT_UNIFORM_COMPONENTS,maxProgramTexelOffset:qk.MAX_PROGRAM_TEXEL_OFFSET,maxSamples:qk.MAX_SAMPLES,maxTextureLODBias:qk.MAX_TEXTURE_LOD_BIAS,maxTransformFeedbackInterleavedComponents:qk.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS,maxTransformFeedbackSeparateAttribs:qk.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS,maxTransformFeedbackSeparateComponents:qk.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS,maxUniformBlockSize:qk.MAX_UNIFORM_BLOCK_SIZE,maxUniformBufferBindings:qk.MAX_UNIFORM_BUFFER_BINDINGS,maxVaryingComponents:qk.MAX_VARYING_COMPONENTS,maxVertexOutputComponents:qk.MAX_VERTEX_OUTPUT_COMPONENTS,maxVertexUniformBlocks:qk.MAX_VERTEX_UNIFORM_BLOCKS,maxVertexUniformComponents:qk.MAX_VERTEX_UNIFORM_COMPONENTS,minProgramTexelOffset:qk.MIN_PROGRAM_TEXEL_OFFSET};return{"for":function(I){var z=I._info;return z||(I._info=z=T(I,z)),z}}}(),Zo=function(){function M(S,l,r){return{def:S,getter:r?function(B){var v=sp.for(B);return v.version>1?B.getParameter(l):S}:function(f){return f.getParameter(l)},setter:r?function(k,f){var c=sp.for(k);c.version>1&&k.pixelStorei(l,f)}:function(x,q){x.pixelStorei(l,q)}}}function z(E){return"string"==typeof E?yl(E):E.r!==Y?(v[0]=E.r,v[1]=E.g,v[2]=E.b,v[3]=E.a,v):E.red!==Y?(v[0]=E.red,v[1]=E.green,v[2]=E.blue,v[3]=E.alpha,v):E}function k(h){return j(h)?Array.prototype.slice.call(h,0):h}function i(c,i,U){this.gl=i,this._record=U||{},this._branches={},this._leafSync={},this._struct=c;for(var h=c.children,X=h.length;X--;){var e=h[X],l=e.name;e.isLeaf?(this._leafSync[l]=!1,this._record[l]=k(e.desc.def)):this._record[l]={}}}function o(g){function r(J,j){i.call(this,g,J,j);for(var Z=t.length;Z--;){var e=t[Z];this._branches[e._name]=new e._type(J,this._record[e._name])}}function k(l,x){function W(R,i){for(var b=q,X=!1;b--;)R[b]!==i[b]&&(R[b]=i[b],X=!0);return X}var p=l.name,Q=j(l.desc.def),q=Q&&l.desc.def.length;if(l.isLeaf){var X=l.desc.setter,c=l.desc.parse;S.defineProperty(x,p,{configurable:!1,enumerable:!0,get:function(){return this._record[p]},set:Q?function(l){c&&(l=c(l)),(W(this._record[p],l)||!this._leafSync[p])&&(X(this.gl,this._record[p]),this._leafSync[p]=!0)}:function(t){this._record[p]===t&&this._leafSync[p]||(X(this.gl,t),this._record[p]=t,this._leafSync[p]=!0)}})}else t.push({_name:p,_type:o(l)}),S.defineProperty(x,p,{configurable:!1,enumerable:!0,get:function(){return this._branches[p]},set:function(L){this._branches[p].apply(L)}})}var t=[];return C(r,i),g.forEach(k,r.prototype),r}var v="undefined"!=typeof Float32Array&&new Float32Array(4),F={viewport:{def:[0,0,0/0,0/0],getter:function(I){return I.getParameter(I.VIEWPORT)},setter:function(t,r){var Y=r[2]!==r[2]?t.drawingBufferWidth-r[0]:r[2],H=r[3]!==r[3]?t.drawingBufferHeight-r[1]:r[3];t.viewport(r[0],r[1],Y,H)}},dither:{def:!1,getter:function(w){return w.isEnabled(w.DITHER)},setter:function(g,T){T?g.enable(g.DITHER):g.disable(g.DITHER)}},rasterizerDiscard:{def:!1,getter:function(e){var $=sp.for(e);return $.version>1&&e.isEnabled(e.RASTERIZER_DISCARD)},setter:function(W,l){var t=sp.for(W);1!==t.version&&(l?W.enable(W.RASTERIZER_DISCARD):W.disable(W.RASTERIZER_DISCARD))}},lineWidth:{def:1,getter:function(G){return G.lineWidth?G.getParameter(G.LINE_WIDTH):1},setter:function(e,w){e.lineWidth&&e.lineWidth(w)}},color:{clear:{def:[0,0,0,0],getter:function(c){return c.getParameter(c.COLOR_CLEAR_VALUE)},setter:function(w,Z){w.clearColor(Z[0],Z[1],Z[2],Z[3])},parse:z},mask:{def:[!0,!0,!0,!0],getter:function(z){return z.getParameter(z.COLOR_WRITEMASK)},setter:function(k,Q){k.colorMask(Q[0],Q[1],Q[2],Q[3])}}},blend:{enabled:{def:!1,getter:function(f){return f.isEnabled(f.BLEND)},setter:function(P,X){X?P.enable(P.BLEND):P.disable(P.BLEND)}},color:{def:[0,0,0,0],getter:function(j){return j.getParameter(j.BLEND_COLOR)},setter:function(C,q){C.blendColor(q[0],q[1],q[2],q[3])},parse:z},equation:{def:[qk.FUNC_ADD,qk.FUNC_ADD],getter:function(l){return[l.getParameter(l.BLEND_EQUATION_RGB),l.getParameter(l.BLEND_EQUATION_ALPHA)]},setter:function($,Q){$.blendEquationSeparate(Q[0],Q[1])},parse:function(t){var i=t.length;return i>1?t:1===i?(v[1]=v[0]=t[0],v):(v[1]=v[0]=t,v)}},func:{def:[qk.ONE,qk.ZERO,qk.ONE,qk.ZERO],getter:function(L){return[L.getParameter(L.BLEND_SRC_RGB),L.getParameter(L.BLEND_DST_RGB),L.getParameter(L.BLEND_SRC_ALPHA),L.getParameter(L.BLEND_DST_ALPHA)]},setter:function(U,C){U.blendFuncSeparate(C[0],C[1],C[2],C[3])},parse:function(b){var G=b.length;return G>3?b:(v[2]=v[0]=b[0],v[3]=v[1]=b[1],v)}}},cullFace:{enabled:{def:!1,getter:function(R){return R.isEnabled(R.CULL_FACE)},setter:function(f,c){c?f.enable(f.CULL_FACE):f.disable(f.CULL_FACE)}},mode:{def:qk.BACK,getter:function(s){return s.getParameter(s.CULL_FACE_MODE)},setter:function(X,J){X.cullFace(J)}},frontFace:{def:qk.CCW,getter:function(M){return M.getParameter(M.FRONT_FACE)},setter:function(n,g){n.frontFace(g)}}},scissor:{enabled:{def:!1,getter:function(T){return T.isEnabled(T.SCISSOR_TEST)},setter:function(X,r){r?X.enable(X.SCISSOR_TEST):X.disable(X.SCISSOR_TEST)}},box:{def:[0,0,0/0,0/0],getter:function(F){return F.getParameter(F.SCISSOR_BOX)},setter:function(C,c){var N=c[2]!==c[2]?C.drawingBufferWidth-c[0]:c[2],M=c[3]!==c[3]?C.drawingBufferHeight-c[1]:c[3];C.scissor(c[0],c[1],N,M)}}},depth:{enabled:{def:!1,getter:function(C){return C.isEnabled(C.DEPTH_TEST)},setter:function(d,u){u?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST)}},clear:{def:1,getter:function(i){return i.getParameter(i.DEPTH_CLEAR_VALUE)},setter:function(o,T){o.clearDepth(T)}},mask:{def:!0,getter:function($){return $.getParameter($.DEPTH_WRITEMASK)},setter:function(O,A){O.depthMask(A)}},range:{def:[-1,1],getter:function(t){return t.getParameter(t.DEPTH_RANGE)},setter:function(F,X){F.depthRange(X[0],X[1])}},func:{def:qk.LESS,getter:function(B){return B.getParameter(B.DEPTH_FUNC)},setter:function(o,T){o.depthFunc(T)}}},stencil:{enabled:{def:!1,getter:function(L){return L.isEnabled(L.STENCIL_TEST)},setter:function(P,v){v?P.enable(P.STENCIL_TEST):P.disable(P.STENCIL_TEST)}},clear:{def:0,getter:function(G){return G.getParameter(G.STENCIL_CLEAR_VALUE)},setter:function(S,R){S.clearStencil(R)}},frontMask:{def:255,getter:function(z){return z.getParameter(z.STENCIL_WRITEMASK)},setter:function(F,m){F.stencilMaskSeparate(F.FRONT,m)}},frontOp:{def:[qk.KEEP,qk.KEEP,qk.KEEP],getter:function(k){return[k.getParameter(k.STENCIL_FAIL),k.getParameter(k.STENCIL_PASS_DEPTH_FAIL),k.getParameter(k.STENCIL_PASS_DEPTH_PASS)]},setter:function(p,h){p.stencilOpSeparate(p.FRONT,h[0],h[1],h[2])}},frontFunc:{def:[qk.ALWAYS,0,255],getter:function(p){return[p.getParameter(p.STENCIL_FUNC),p.getParameter(p.STENCIL_REF),p.getParameter(p.STENCIL_VALUE_MASK)]},setter:function(k,K){k.stencilFuncSeparate(k.FRONT,K[0],K[1],K[2])}},backMask:{def:255,getter:function(f){return f.getParameter(f.STENCIL_BACK_WRITEMASK)},setter:function(u,I){u.stencilMaskSeparate(u.BACK,I)}},backOp:{def:[qk.KEEP,qk.KEEP,qk.KEEP],getter:function(r){return[r.getParameter(r.STENCIL_BACK_FAIL),r.getParameter(r.STENCIL_BACK_PASS_DEPTH_FAIL),r.getParameter(r.STENCIL_BACK_PASS_DEPTH_PASS)]},setter:function(v,m){v.stencilOpSeparate(v.BACK,m[0],m[1],m[2])}},backFunc:{def:[qk.ALWAYS,0,255],getter:function(d){return[d.getParameter(d.STENCIL_BACK_FUNC),d.getParameter(d.STENCIL_BACK_REF),d.getParameter(d.STENCIL_BACK_VALUE_MASK)]},setter:function(F,$){F.stencilFuncSeparate(F.BACK,$[0],$[1],$[2])}}},hint:{generateMipmap:{def:qk.DONT_CARE,getter:function(e){return e.getParameter(e.GENERATE_MIPMAP_HINT)},setter:function(_,Y){_.hint(_.GENERATE_MIPMAP_HINT,Y)}},fragmentShaderDerivative:{def:qk.DONT_CARE,getter:function(_){var f=sp.for(_);return 1!==f.version||f.extensions.OES_standard_derivatives?_.getParameter(qk.FRAGMENT_SHADER_DERIVATIVE_HINT):qk.DONT_CARE},setter:function(x,s){var t=sp.for(x);return t.version>1||t.extensions.OES_standard_derivatives?(x.hint(qk.FRAGMENT_SHADER_DERIVATIVE_HINT,s),void 0):void 0}}},pixelStore:{packAlignment:M(4,qk.PACK_ALIGNMENT,!1),unpackAlignment:M(4,qk.UNPACK_ALIGNMENT,!1),unpackFlipY:M(!1,qk.UNPACK_FLIP_Y_WEBGL,!1),unpackPremultiplyAlpha:M(!1,qk.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),unpackColorspaceConversion:M(qk.BROWSER_DEFAULT_WEBGL,qk.UNPACK_COLORSPACE_CONVERSION_WEBGL,!1),packRowLength:M(0,qk.PACK_ROW_LENGTH,!0),packSkipPixels:M(0,qk.PACK_SKIP_PIXELS,!0),packSkipRows:M(0,qk.PACK_SKIP_ROWS,!0),unpackRowLength:M(0,qk.UNPACK_ROW_LENGTH,!0),unpackImageHeight:M(0,qk.UNPACK_IMAGE_HEIGHT,!0),unpackSkipPixels:M(0,qk.UNPACK_SKIP_PIXELS,!0),unpackSkipRows:M(0,qk.UNPACK_SKIP_ROWS,!0),unpackSkipImages:M(0,qk.UNPACK_SKIP_IMAGES,!0)},polygonOffset:{enabled:{def:!1,getter:function(O){return O.isEnabled(O.POLYGON_OFFSET_FILL)},setter:function(b,D){D?b.enable(b.POLYGON_OFFSET_FILL):b.disable(b.POLYGON_OFFSET_FILL)}},value:{def:[0,0],getter:function(Y){return[Y.getParameter(Y.POLYGON_OFFSET_FACTOR),Y.getParameter(Y.POLYGON_OFFSET_UNITS)]},setter:function(U,c){U.polygonOffset(c[0],c[1])}}},sampleCoverage:{enabled:{def:!1,getter:function(x){return x.isEnabled(x.SAMPLE_COVERAGE)},setter:function(I,M){M?I.enable(I.SAMPLE_COVERAGE):I.disable(I.SAMPLE_COVERAGE)}},alpha:{def:!1,getter:function(I){return I.isEnabled(I.SAMPLE_ALPHA_TO_COVERAGE)},setter:function(F,R){R?F.enable(F.SAMPLE_ALPHA_TO_COVERAGE):F.disable(F.SAMPLE_ALPHA_TO_COVERAGE)}},value:{def:[1,!1],getter:function(F){return[F.getParameter(F.SAMPLE_COVERAGE_VALUE),F.getParameter(F.SAMPLE_COVERAGE_INVERT)]},setter:function(d,u){d.sampleCoverage(u[0],u[1])}}}},t=Sc.create(F,function(q){return"def"in q});i.prototype.reset=function(){for(var w=this._struct.children,z=w.length;z--;){var k=w[z],r=k.name;k.isLeaf?this[r]=k.desc.def:this._branches[r].reset()}},i.prototype.save=function(K){K==Y&&(K={});for(var q=this._struct.children,H=q.length;H--;){var p=q[H],L=p.name;if(p.isLeaf)K[L]=k(this._record[L]);else{var O=K[L];O==Y&&(K[L]=O={}),this._branches[L].save(O)}}return K},i.prototype.sync=function(d,a){for(var k=this._struct.children,r=k.length;r--;){var Z=k[r],R=Z.name;Z.isLeaf?(a||!this._leafSync[R])&&(d?(this._record[R]=Z.desc.getter(this.gl),this._leafSync[R]=!0):(Z.desc.setter(this.gl,this._record[R]),this._leafSync[R]=!0)):this._branches[R].sync(d,a)}},i.prototype.syncLoss=function(){for(var o=this._struct.children,i=o.length;i--;){var L=o[i];L.isLeaf?this._leafSync[L.name]=!1:this._branches[L.name].syncLoss()}},i.prototype.apply=function(e){for(var q=this._struct.children,j=q.length;j--;){var S=q[j],P=S.name;P in e&&(S.isLeaf?this[P]=e[P]:this._branches[P].apply(e[P]))}},i.prototype.append=function(w){var q=this._struct.childMap;for(var n in w){var f=q[n];f&&(f.isLeaf?this[n]=w[n]:this._branches[n].append(w[n]))}};var l=o(t);return function(q){var N=q._state;return N||(q._state=N=new l(q)),N}}(),yn=function(){function T(J,q,t,f){if(J){var V=J.length;if(V!=Y)for(var K=0;f>K;++K)q[t+K]=J[K];else J.toArray&&J.toArray(q,t)}else for(var K=0;f>K;++K)q[t+K]=0}function Q(R,w,P){var o=R[0];if(0>=o||o>0)return R;var V=w*P,v=a[V];if(v==Y&&(a[V]=v=new Float32Array(V)),0!==w){T(o,v,0,P);for(var $=1,F=0;$!==w;++$)F+=P,T(R[$],v,F,P)}return v}function M(u,h){u.uniform1f(this.addr,h)}function $(q,H){q.uniform1fv(this.addr,H)}function k(H,m){if(m.x!=Y)H.uniform2f(this.addr,m.x,m.y);else{var B=a[2];B.set(m,0),H.uniform2fv(this.addr,B)}}function H(N,b){N.uniform2fv(this.addr,Q(b,this.size,2))}function D(t,S){if(S.x!=Y)t.uniform3f(this.addr,S.x,S.y,S.z);else if(S.r!=Y)t.uniform3f(this.addr,S.r,S.g,S.b);else if(S.red!=Y)t.uniform3f(this.addr,S.red,S.green,S.blue);else{var i=a[3];i.set(S,0),t.uniform3fv(this.addr,i)}}function I(l,$){l.uniform3fv(this.addr,Q($,this.size,3))}function z(k,T){if("string"==typeof T&&(T=yl(T)),T.x!=Y)k.uniform4f(this.addr,T.x,T.y,T.z,T.w);else if(T.r!=Y)k.uniform4f(this.addr,T.r,T.g,T.b,T.a);else if(T.red!=Y)k.uniform4f(this.addr,T.red,T.green,T.blue,T.alpha);else{var n=a[4];n.set(T,0),k.uniform4fv(this.addr,n)}}function P(P,l){P.uniform4fv(this.addr,Q(l,this.size,4))}function f(p,g){p.uniform1i(this.addr,g)}function v(r,X){r.uniform1iv(this.addr,X)}function i(c,S){c.uniform2iv(this.addr,S)}function Z(T,h){T.uniform3iv(this.addr,h)}function s(J,n){J.uniform4iv(this.addr,n)}function b(v,V){v.uniform1i(this.addr,O[V?1:0])}function p(T,b){var d=a[4];d.set(b,0),T.uniformMatrix2fv(this.addr,!1,d)}function y(k,O){k.uniformMatrix2fv(this.addr,!1,Q(O,this.size,4))}function e(O,t){var p=a[9];p.set(t,0),O.uniformMatrix3fv(this.addr,!1,p)}function N(f,w){f.uniformMatrix3fv(this.addr,!1,Q(w,this.size,9))}function V(b,o){var S=a[16];S.set(o,0),b.uniformMatrix4fv(this.addr,!1,S)}function d(f,y){f.uniformMatrix4fv(this.addr,!1,Q(y,this.size,16))}function R(z,r){z.uniform1i(this.addr,this.slots[0]),z.activeTexture(z.TEXTURE0+this.slots[0]),z.bindTexture(z.TEXTURE_2D,r||z._emptyTexture)}function o(L,H){L.uniform1iv(this.addr,this.slots);for(var e=this.slots.length;e--;)L.activeTexture(L.TEXTURE0+this.slots[e]),L.bindTexture(L.TEXTURE_2D,H[e]||L._emptyTexture)}function L(H,L){H.uniform1i(this.addr,this.slots[0]),H.activeTexture(H.TEXTURE0+this.slots[0]),H.bindTexture(H.TEXTURE_CUBE_MAP,L||H._emptyCubeTexture)}function q(U,y){U.uniform1iv(this.addr,this.slots);for(var X=this.slots.length;X--;)U.activeTexture(U.TEXTURE0+this.slots[X]),U.bindTexture(U.TEXTURE_CUBE_MAP,y[X]||U._emptyCubeTexture)}function K(b,_,Q){J[b]=[_,Q]}function U(S,K,e){switch(S.type){case 35678:case 35680:if("uSampler"===e)return[0];if("uBlendSampler"===e)return[1];for(var X=S.size,f=new Int32Array(X),b=0;X>b;++b)f[b]=K.usedTextureSlot++;return f}return Y}function x(c,a,j,i,M){this.name=c,this.addr=a,this.size=i?j.size:0,this.activeInfo=j,this.setter=J[j.type][i?1:0],this.slots=U(j,M,c),cq(this)}function F(H,i,m,l){var o=H.name,X=o.length;for(W.lastIndex=0;;){var w=W.exec(o),D=W.lastIndex,M=w[1],P="]"===w[2],$=w[3];if(P&&(M=0|M),$===Y||"["===$&&D+2===X){m[M]=new x(M,i,H,$!==Y,l);break}var C=m[M];C==Y&&(m[M]=C={}),m=C}}function j(B,f,r){this.gl=f,this._program=r,this._leaves={},this._branches={},this._struct=B}function w(b){function X($,I){j.call(this,b,$,I);for(var o=N.length;o--;){var i=N[o];this._branches[i._name]=new i._type($,I)}this.uuid=ze.generateUUID()}function x(B,Z){var u=B.name;if(B.isLeaf){var l=h("d.setter(this.gl, v);",["v"],["d"],[B.desc]);S.defineProperty(Z,u,{configurable:!1,enumerable:!0,get:function(){return l},set:l})}else N.push({_name:u,_type:w(B)}),S.defineProperty(Z,u,{configurable:!1,enumerable:!0,get:function(){return this._branches[u]},set:function(Y){this._branches[u].apply(Y)}})}var N=[];return C(X,j),b.forEach(x,X.prototype),X}function n(T,s){for(var E=T.getProgramParameter(s,T.ACTIVE_UNIFORMS),$={},I={usedTextureSlot:2};E--;){var U=T.getActiveUniform(s,E),l=U.name,x=T.getUniformLocation(s,l);F(U,x,$,I)}var Q=Sc.create($,function(O){return"addr"in O}),i=w(Q);return S.defineProperty(i.prototype,"textureCount",{configurable:!1,enumerable:!1,writable:!1,value:I.usedTextureSlot}),new i(T,s)}var a=[];if("function"==typeof Float32Array)for(var t=1;17>t;++t)a[t]=new Float32Array(t);var O=[0,1],J=[];K(qk.FLOAT,M,$),K(qk.FLOAT_VEC2,k,H),K(qk.FLOAT_VEC3,D,I),K(qk.FLOAT_VEC4,z,P),K(qk.INT,f,v),K(qk.INT_VEC2,i,i),K(qk.INT_VEC3,Z,Z),K(qk.INT_VEC4,s,s),K(qk.BOOL,b,v),K(qk.BOOL_VEC2,i,i),K(qk.BOOL_VEC3,Z,Z),K(qk.BOOL_VEC4,s,s),K(qk.FLOAT_MAT2,p,y),K(qk.FLOAT_MAT3,e,N),K(qk.FLOAT_MAT4,V,d),K(qk.SAMPLER_2D,R,o),K(qk.SAMPLER_CUBE,L,q);var W=/([\w\d_]+)(\])?(\[|\.)?/g;return j.prototype.apply=function(P){for(var e=this._struct.children,N=e.length;N--;){var E=e[N],R=E.name;R in P&&(E.isLeaf?this[R]=P[R]:this._branches[R].apply(P[R]))}},j.prototype.append=function(i){var r=this._struct.childMap;for(var G in i){var S=r[G];S&&(S.isLeaf?this[G]=i[G]:this._branches[G].append(i[G]))}},function($,T){var s=T._uniforms;return s||(T._uniforms=s=n($,T)),s}}(),Zf=function(){function r(e,q,T){q.vertexAttrib1f(e.addr,T)}function V(d,T,D){if(D.x!=Y)T.vertexAttrib2f(d.addr,D.x,D.y);else{var m=F[2];m.set(D,0),T.vertexAttrib2fv(d.addr,m)}}function O(M,m,h){if(h.x!=Y)m.vertexAttrib3f(M.addr,h.x,h.y,h.z);else if(h.r!=Y)m.vertexAttrib3f(M.addr,h.r,h.g,h.b);else if(h.red!=Y)m.vertexAttrib3f(M.addr,h.red,h.green,h.blue);else{var P=F[3];P.set(h,0),m.vertexAttrib3fv(M.addr,P)}}function R(z,G,D){if("string"==typeof D&&(D=yl(D)),D.x!=Y)G.vertexAttrib4f(z.addr,D.x,D.y,D.z,D.w);else if(D.r!=Y)G.vertexAttrib4f(z.addr,D.r,D.g,D.b,D.a);else if(D.red!=Y)G.vertexAttrib4f(z.addr,D.red,D.green,D.blue,D.alpha);else{var M=F[4];M.set(D,0),G.vertexAttrib4fv(z.addr,M)}}function w(j,M,C){C=C.el||C;for(var Z=0,F=0;2>Z;++Z)M.vertexAttrib2f(j.addr,C[F++],C[F++])}function T(c,S,C){C=C.el||C;for(var K=0,z=0;3>K;++K)S.vertexAttrib3f(c.addr,C[z++],C[z++],C[z++])}function x(F,J,P){P=P.el||P;for(var m=0,l=0;4>m;++m)J.vertexAttrib4f(F.addr,P[l++],P[l++],P[l++],P[l++])}function Q(w,s,V,Y,B,K,m){s.bindBuffer(s.ARRAY_BUFFER,V),s.vertexAttribPointer(w.addr,1,Y||s.FLOAT,!!B,K||0,m||0),s.bindBuffer(s.ARRAY_BUFFER,null)}function z(P,t,c,G,x,O,b){t.bindBuffer(t.ARRAY_BUFFER,c),t.vertexAttribPointer(P.addr,2,G||t.FLOAT,!!x,O||0,b||0),t.bindBuffer(t.ARRAY_BUFFER,null)}function I(N,n,H,Z,P,F,z){n.bindBuffer(n.ARRAY_BUFFER,H),n.vertexAttribPointer(N.addr,3,Z||n.FLOAT,!!P,F||0,z||0),n.bindBuffer(n.ARRAY_BUFFER,null)}function H(A,d,n,h,t,q,E){d.bindBuffer(d.ARRAY_BUFFER,n),d.vertexAttribPointer(A.addr,4,h||d.FLOAT,!!t,q||0,E||0),d.bindBuffer(d.ARRAY_BUFFER,null)}function M(P,L,n,E,O,A,w){var A=A||4,w=w||0;L.bindBuffer(L.ARRAY_BUFFER,n),L.vertexAttribPointer(P.addr,2,E||L.FLOAT,!!O,A,w),L.vertexAttribPointer(P.addr+1,2,E||L.FLOAT,!!O,A,w+2),L.bindBuffer(L.ARRAY_BUFFER,null)}function q(C,R,Y,X,T,i,I){var i=i||9,I=I||0;R.bindBuffer(R.ARRAY_BUFFER,Y),R.vertexAttribPointer(C.addr,3,X||R.FLOAT,!!T,i,I),R.vertexAttribPointer(C.addr+1,3,X||R.FLOAT,!!T,i,I+3),R.vertexAttribPointer(C.addr+2,3,X||R.FLOAT,!!T,i,I+6),R.bindBuffer(R.ARRAY_BUFFER,null)}function c(h,Y,P,L,f,t,z){var t=t||16,z=z||0;Y.bindBuffer(Y.ARRAY_BUFFER,P),Y.vertexAttribPointer(h.addr,4,L||Y.FLOAT,!!f,t,z),Y.vertexAttribPointer(h.addr+1,4,L||Y.FLOAT,!!f,t,z+4),Y.vertexAttribPointer(h.addr+2,4,L||Y.FLOAT,!!f,t,z+8),Y.vertexAttribPointer(h.addr+3,4,L||Y.FLOAT,!!f,t,z+12),Y.bindBuffer(Y.ARRAY_BUFFER,null)}function g(D,L,r){X[D]=function(q,E,D,_,H,u){this.addr==Y||this.addr<0||(E==Y||E===!1?q.disableVertexAttribArray(this.addr):vq(E)===v?(q.enableVertexAttribArray(this.addr),r(this,q,E,D,_,H,u)):(q.disableVertexAttribArray(this.addr),L(this,q,E)))}}function d(r,n,t){this.name=r,this.addr=n,this.activeInfo=t,this.setter=X[t.type],cq(this)}function u(L,U,b){this.gl=U,this.program=b,this._branches={},this._struct=L}function p(T){function I(L,y){u.call(this,T,L,y);for(var S=K.length;S--;){var U=K[S];this._branches[U._name]=new U._type(L,y)}}function w(a,R){var D=a.name;if(a.isLeaf){var n=h("d.setter(this.gl, v);",["v"],["d"],[a.desc]);S.defineProperty(R,D,{configurable:!1,enumerable:!0,get:function(){return n},set:n})}else K.push({_name:D,_type:p(a)}),S.defineProperty(R,D,{configurable:!1,enumerable:!0,get:function(){return this._branches[D]},set:function(S){this._branches[D].apply(S)}})}var K=[];return C(I,u),T.forEach(w,I.prototype),I}function L(v,P){for(var t=v.getProgramParameter(P,v.ACTIVE_ATTRIBUTES),k={};t--;){var W=v.getActiveAttrib(P,t),S=W.name,C=v.getAttribLocation(P,S);k[S]=new d(S,C,W)}var e=Sc.create(k,function(D){return"addr"in D}),f=p(e);return new f(v,P)}for(var F=[],D=1;17>D;++D)F[D]=new Oh(D);var X=[],v="undefined"!=typeof WebGLBuffer&&WebGLBuffer.prototype;return g(qk.FLOAT,r,Q),g(qk.FLOAT_VEC2,V,z),g(qk.FLOAT_VEC3,O,I),g(qk.FLOAT_VEC4,R,H),g(qk.FLOAT_MAT2,w,M),g(qk.FLOAT_MAT3,T,q),g(qk.FLOAT_MAT4,x,c),u.prototype.disable=function(){for(var a=this._struct.children,g=a.length;g--;){var T=a[g],n=T.name;T.isLeaf?this.gl.disableVertexAttribArray(T.desc.addr):this._branches[n].disable()}},u.prototype.apply=function(l){for(var t=this._struct.children,p=t.length;p--;){var L=t[p],j=L.name;j in l&&(L.isLeaf?this[j]=l[j]:this._branches[j].apply(l[j]))}},u.prototype.append=function(i){var T=this._struct.childMap;for(var F in i){var l=T[F];l&&(l.isLeaf?this[F]=i[F]:this._branches[F].append(i[F]))}},function(n,i){var k=i._attribs;return k||(i._attribs=k=L(n,i)),k}}(),mq=function(z){var X=this;S.defineProperties(this,{gl:{configurable:!1,enumerable:!1,value:z,writable:!1},glState:{configurable:!1,enumerable:!1,value:Zo(z),writable:!1}}),X._currProgram=Y,X._currUniforms=Y,X._currAttribs=Y,X._sync=!0};S.defineProperties(mq.prototype,{program:{configurable:!1,enumerable:!1,get:function(){return this._currProgram},set:function(k){var i=this;i._sync&&k===i._currProgram||(i.gl.useProgram(k),i._currProgram=k,i._currUniforms=yn(i.gl,k),i._currAttribs=Zf(i.gl,k),i._sync=!0)}},uniforms:{configurable:!1,enumerable:!1,get:function(){var J=this;return J._currProgram&&!J._sync&&(J.gl.useProgram(J._currProgram),J._sync=!0),J._currUniforms},set:function(m){var E=this;E._currUniforms&&(E._currProgram&&!E._sync&&(E.gl.useProgram(E._currProgram),this._sync=!0),E._currUniforms.apply(m))}},attribs:{configurable:!1,enumerable:!1,get:function(){var x=this;return x._currProgram&&!x._sync&&(x.gl.useProgram(x._currProgram),x._sync=!0),x._currAttribs},set:function(O){var b=this;b._currUniforms&&(b._currProgram&&!b._sync&&(b.gl.useProgram(b._currProgram),this._sync=!0),b._currAttribs.apply(O))}}}),mq.prototype.useProgram=function(n){var T=this;T._sync&&n===T._currProgram||(T.gl.useProgram(n),T._currProgram=n,T._currUniforms=yn(T.gl,n),T._currAttribs=Zf(T.gl,n),T._sync=!0)},mq.prototype.directState=function(){return this.glState},mq.prototype.directUniforms=function(){return this._currUniforms},mq.prototype.directAttribs=function(){return this._currAttribs},mq.prototype.syncLoss=function(){this._sync=!1,this.glState.syncLoss()},mq.for=function(_){var m=_._renderState;return m||(_._renderState=m=new mq(_)),m};var Bb="directional",tn="point",re="spot",hd="light.color",fb=4294967295,nj=0,Uh={},vi=[],hp=0,Lo=function(m,b){Fn(b)&&oj.test(b)?mi(m,b):gr(b)&&b.modelType?xf(m,b):b===Y?delete Ze[m]:Ze[m]=b},Mh=function(S){return S},Kh=function(L){L=x.convertShape3dModelName(L);var i;if(gr(L)){if(L.modelType){if(L.uuid){if(i=Ze[L.uuid])return i}else L.uuid=R.Math.generateUUID();return i===Y&&(Ll&&Ll[L.uuid]||xf(L.uuid,L)),Y}return L}return i=Ze[L],L&&i===Y&&oj.test(L)&&(Ll&&Ll[L]||mi(L,L)),i},Wh=function(P,q){P.frameStack?P.frameStack.push(q):P.frameStack=[q],P.bindFramebuffer(P.FRAMEBUFFER,q)},gi=function(M){var q=M.frameStack;if(q){if(q.pop(),q.length)return M.bindFramebuffer(M.FRAMEBUFFER,q[q.length-1]),void 0;M.frameStack=null}M.bindFramebuffer(M.FRAMEBUFFER,null)};je(x,{graph3dViewAttributes:F,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:d/60,graph3dViewSortable:!1,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:tq,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewRotateMaxPhi:d,graph3dViewRotateMinPhi:0,graph3dViewShadowQuality:"high",graph3dViewShadowIntensity:.3,graph3dViewShadowBias:-.005,graph3dViewShadowRadius:.1,graph3dViewShadowType:"hard",graph3dViewShadowDegreeX:30,graph3dViewShadowDegreeZ:-10,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewSyncEyeWithOrthoWidth:!1,graph3dViewFovy:d/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewDataNumWarningLine:1e4,graph3dViewHeadlightRange:0,graph3dViewHeadlightGroup:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogMode:"linear",graph3dViewFogDensity:5e-4,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dViewEnvmapType:"legacy",graph3dMaxVectorCacheTime:50,graph3dEnvmapCapabilityRequire:8,setShape3dModel:Lo,getShape3dModel:Kh,convertShape3dModelName:Mh,getShape3dModelMap:function(){return Ze},getCachedShape3dModelMap:function(){return Ae},createMatrix:function(V,Y){Ub(V)||(V=[V]);for(var z=V.length-1;z>=0;z--){var c=V[z];Y=Be(c.mat,c.s3,c.r3,c.rotationMode,c.t3,Y)}return Y},transformVec:function(K,R){return Lp(K,R)},glBindFrame:Wh,glUnbindFrame:gi,createBoxModel:function(){return{vs:rn,ns:im,uv:qg,is:_c}},createRoundRectModel:function(R,e){return Bc.roundRect(R,e)},createStarModel:function(H,R){return Bc.star(H,R)},createRectModel:function(H,Z){return Bc.rect(H,Z)},createTriangleModel:function(f,O){return Bc.triangle(f,O)},createRightTriangleModel:function(q,F){return Bc.rightTriangle(q,F)},createParallelogramModel:function(a,$){return Bc.parallelogram(a,$)},createTrapezoidModel:function(J,T){return Bc.trapezoid(J,T)},createSmoothSphereModel:function(t,l,w,n,$,X,R){return Qp(new ac(t,l,w,n,$,X,R))},createSphereModel:function(p,A,W,U,T,$,e){return p?qe(p,A,W,U,T,$,e):x.createSmoothSphereModel()},createSmoothConeModel:function(R,C,p,b,w){return dd(R,C,p,b,w)},createConeModel:function(s,y,v,V,D,t,m,Z){return s?jk(s,y,v,V,D,t,m,Z):dd(t)},createSmoothCylinderModel:function(u,H,s,N,E,R,M,T){return Qp(new si(u,H,s,N,E,R,M,T))},createCylinderModel:function(u,B,w,b,v,g,z,T){return u?xl(u,B,w,b,v,g,z,T):sh(g,z)},createSmoothTorusModel:function(t,N,F,S,P,M){return Qp(new Nq(t,N,F,S,P,M))},createTorusModel:function(V,S,x,Z,r,o,n,K){return V?qp(V,S,x,Z,r,o,n,K):uq(o,n)},createExtrusionModel:function(j,E,A,Y,D,l,F,k){return $k(j,E,A,Y,D,l,F,k)},createSmoothRingModel:function(t,i,j,B,o,$){for(var E=[],H=0;H<t.length-1;H+=2)E.push({x:t[H],y:t[H+1]});for(t=fq(E,i,j)[0],E=[],H=0;H<t.length;H++){var b=t[H];E.push(new Sr(b.x,0,b.y))}return Qp(new Eg(E,$,B,o))},createTextGeometry:function(N,F){return Qp(new fd(N,F))},loadFontFace:function(H,r){x.xhrLoad(H,function(s){if(!s)return r();var H;try{H=JSON.parse(s)}catch(f){H=JSON.parse(s.substring(65,s.length-2))}Ih.loadFace(H),r&&r(H.familyName.toLowerCase())},r?null:{sync:!0})},getShaderErrorLog:function(){return vi.join("\n")},createRingModel:function(r,I,d,e,h,W,Q,b,X,Z){for(var c=[],s=0;s<r.length-1;s+=2)c.push({x:r[s],y:r[s+1]});W=W||x.shapeSide,Q=Q||0,b=b||W;var o,C,B,p,N,V,i,g,J,j,s,u,z,P,l,L,t,H,k=[],q=[],f=X?[]:F,U=X?[]:F,m=Z?[]:F,Y=Z?[]:F,M=e?[]:F,D=e?[]:F,R=h?[]:F,K=h?[]:F,r=fq(c,I,d),O=fp(r),$=0,E=2*Math.PI/W;return r.forEach(function(d){if(B=d.length,B>1){if(p=d[0],e)for(V=p.x,g=p.y,s=Q;b>s;s++)u=s+1,z=s*E,P=u*E,l=a(z),L=A(z),t=a(P),H=A(P),M.push(l*V,g,-L*V,t*V,g,-H*V,0,g,0),D.push(.5-.5*l,.5-.5*L,.5-.5*t,.5-.5*H,.5,.5);for(j=0;B>j;j++){for(N=d[j],V=p.x,i=N.x,g=p.y,J=N.y,o=$/O,$+=Gd(p,N),C=$/O,s=Q;b>s;s++)u=s+1,z=s*E,P=u*E,l=a(z),L=A(z),t=a(P),H=A(P),k.push(l*i,J,-L*i,t*i,J,-H*i,l*V,g,-L*V,t*i,J,-H*i,t*V,g,-H*V,l*V,g,-L*V),q.push(s/W,C,u/W,C,s/W,o,u/W,C,u/W,o,s/W,o),X&&s===Q&&(f.push(0,g,0,0,J,0,l*i,J,-L*i,l*i,J,-L*i,l*V,g,-L*V,0,g,0),U.push(0,.5-g,0,.5-J,2*i,.5-J,2*i,.5-J,2*V,.5-g,0,.5-g)),Z&&u===b&&(m.push(0,g,0,t*i,J,-H*i,0,J,0,t*i,J,-H*i,0,g,0,t*V,g,-H*V),Y.push(1,.5-g,1-2*i,.5-J,1,.5-J,1-2*i,.5-J,1,.5-g,1-2*V,.5-g));p=N}if(h)for(V=p.x,g=p.y,s=Q;b>s;s++)u=s+1,z=s*E,P=u*E,l=a(z),L=A(z),t=a(P),H=A(P),R.push(t*V,g,-H*V,l*V,g,-L*V,0,g,0),K.push(.5-.5*t,.5+.5*H,.5-.5*l,.5+.5*L,.5,.5)}}),{vs:k,uv:q,bottom_vs:R,bottom_uv:K,top_vs:M,top_uv:D,from_vs:f,from_uv:U,to_vs:m,to_uv:Y}}},!0),je(Q,{"3d.move.mode":Y,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"3d.reflectable":!0,"shape.border.gradient.color":Y,"edge.gradient.color":Y,"edge.source.t3":Y,"edge.target.t3":Y,"light.type":tn,"light.group":0,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":d/4,"light.range":0,"light.exponent":1,"light.intensity":1,"light.mask":fb,"headlight.ambientIntensity":Y,"wf.visible":!1,"wf.width":1,"wf.color":Vb,"wf.short":!1,"wf.mat":Y,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:Y,"transparent.mask":!1,brightness:Y,"select.brightness":.7,"repeat.uv.length":Y,"shadow.cast":!0,"shadow.receive":!0,"3d.clipbox":Y,"3d.clipbox.mask":fb,"3d.clipbox.group":0,"effect.flow":!1,"effect.flow.gradient":"spread.horizontal","effect.flow.uvshape":"rect","effect.flow.size":512,"effect.flow.group":0,"effect.flow.intensity":1,"effect.flow.blend":Y,"effect.flow.mask":fb,bloom:!1,envmap:0,"envmap.probe":0,roughness:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,"texture.cache":!1,"hide.overlapping.group":Y,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.type":"hard","highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","highlight.glow":.8,"highlight.strength":2,"color.empty":[0,0,0,0],"label.face":Cn,"label.t3":Y,"label.r3":Y,"label.texture.scale":2,"label.rotationMode":bp,"label.light":!1,"label.blend":Y,"label.reverse.flip":!1,"label.reverse.color":ik,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Cn,"label2.t3":Y,"label2.r3":Y,"label2.texture.scale":2,"label2.rotationMode":bp,"label2.light":!1,"label2.blend":Y,"label2.reverse.flip":!1,"label2.reverse.color":ik,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Cn,"note.t3":Y,"note.r3":Y,"note.texture.scale":2,"note.rotationMode":bp,"note.light":!1,"note.blend":Y,"note.reverse.flip":!1,"note.reverse.color":ik,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Cn,"note2.t3":Y,"note2.r3":Y,"note2.texture.scale":2,"note2.rotationMode":bp,"note2.light":!1,"note2.blend":Y,"note2.reverse.flip":!1,"note2.reverse.color":ik,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:Y,"shape3d.color":xg,"shape3d.top.color":Y,"shape3d.bottom.color":Y,"shape3d.from.color":Y,"shape3d.to.color":Y,"shape3d.image":Y,"shape3d.image.projection":Y,"shape3d.top.image":Y,"shape3d.bottom.image":Y,"shape3d.from.image":Y,"shape3d.to.image":Y,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":Y,"shape3d.side.to":Y,"shape3d.smooth":Y,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":Y,"shape3d.opacity":Y,"shape3d.reverse.flip":!1,"shape3d.reverse.color":ik,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":Y,"shape3d.uv.scale":Y,"shape3d.uv.rotation":Y,"shape3d.top.uv.offset":Y,"shape3d.top.uv.scale":Y,"shape3d.top.uv.rotation":Y,"shape3d.bottom.uv.offset":Y,"shape3d.bottom.uv.scale":Y,"shape3d.bottom.uv.rotation":Y,"shape3d.from.uv.offset":Y,"shape3d.from.uv.scale":Y,"shape3d.from.uv.rotation":Y,"shape3d.to.uv.offset":Y,"shape3d.to.uv.scale":Y,"shape3d.to.uv.rotation":Y,"shape3d.top.cap":Y,"shape3d.bottom.cap":Y,"shape3d.start.angle":0,"shape3d.sweep.angle":o,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.blur":0,"shape3d.reflector.blur.iterations":1,"shape3d.reflector.background":null,"shape3d.reflector.clip":.003,"shape3d.reflector.shadow":"scene","camera.type":"perspective","camera.aspect":1,"camera.fovy":Y,"camera.ortho.width":Y,"camera.near":Y,"camera.far":Y,"camera.background":0,"camera.renderSky":!0,"camera.renderAxis":!1,"camera.renderGrid":!1,"camera.renderEdit":!1,"camera.onlySky":!1,"texture.mipmap.max":Y,"texture.filter":Y,"texture.filter.min":Y,"texture.filter.mag":Y,"texture.wrap":Y,"points.image":"rect","points.color":"white","points.transparent":!1,"points.size":20,"points.opacity":1,"points.uv.scale":[1,1],"points.uv.offset":[0,0],"points.discard.selectable":!1,"all.light":!0,"all.visible":!0,"all.color":xg,"all.image":Y,"all.blend":Y,"all.opacity":Y,"all.reverse.flip":!1,"all.reverse.color":ik,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":Y,"all.uv.offset":Y,"all.uv.scale":Y,"all.uv.rotation":Y,"all.discard.selectable":!0,mat:Y,"left.mat":Y,"right.mat":Y,"top.mat":Y,"bottom.mat":Y,"front.mat":Y,"back.mat":Y,"edge.source.anchor.elevation":Y,"edge.target.anchor.elevation":Y,"edge.source.offset.elevation":0,"edge.target.offset.elevation":0},!0);
var gd,Hj=!1,Xk=[0,0,0,0],Gn=function(s){return s instanceof qr},fr=function(t){return[t.x,t.e||0,t.y]},$m=function(C,x,f){for(var x=yl(x||0),Q=x[0],L=x[1],O=x[2];f--;)C.push(Q,L,O)},ug=function(F,K,b){for(var K=yl(K||0),a=K[0],v=K[1],M=K[2],x=K[3];b--;)F.push(a,v,M,x)},Xg=function(A,D,K){if(D)for(var N,J,s,S=D[0],G=D[1],q=D[2],$=D[4],r=D[5],F=D[6],i=D[8],O=D[9],y=D[10],T=D[12],t=D[13],l=D[14],z=K.length,U=0,U=0;z>U;U+=3)N=K[U],J=K[U+1],s=K[U+2],A.push(S*N+$*J+i*s+T,G*N+r*J+O*s+t,q*N+F*J+y*s+l);else eh(A,K)},Op=function(L,b,v){var l=b.s("light.intensity"),d=yl(b.s(hd)),I=d[0],G=d[1],s=d[2];1!==l&&(I*=l,G*=l,s*=l);var B=b.s("light.disabled");L.push(I,G,s,B?1:0),v.c.push(I,G,s),v.g.push(B?-1:b.s("light.group")),v.e.push(B?1:0)},Yd=function(v,$){var V=mq.for($),k=V.directUniforms(),K=v._lastLightUploadInfo={c:[],g:[],e:[]};k.uHeadlightRange=v._headlightRange;var r=k.uHeadlightAmbientIntensity=v._headlightAmbientIntensity,H=v._headlightIntensity,c=yl(v._headlightColor);1!==H&&(c=[c[0]*H,c[1]*H,c[2]*H]);var E;k.uHeadlightColor=[c[0],c[1],c[2],(E=v._headlightDisabled)?1:0],K.c.push(c[0],c[1],c[2]),K.g.push(E?-1:v._headlightGroup),K.e.push(E?1:0);var B=v._59O,l=v._spots,W=v._dirs;if(B.length){var h=[],Q=[],P=[];B.forEach(function(s){Op(h,s,K),eh(Q,v._transformPointToViewSpace(s.p3())),P.push(s.s("light.range"))}),k.uPointColor=h,k.uPointRange=P,k.uPointPosition=Q}if(l.length){var T=[],Z=[],D=[],Y=[],x=[],y=[];l.forEach(function(t){Op(T,t,K),eh(Z,v._transformPointToViewSpace(t.p3())),eh(x,v._transformDirectionToViewSpace(t.p3(),t.s("light.center"))),D.push(t.s("light.range")),Y.push(a(t.s("light.angle")/2)),y.push(t.s("light.exponent"))}),k.uSpotColor=T,k.uSpotRange=D,k.uSpotAngle=Y,k.uSpotExponent=y,k.uSpotPosition=Z,k.uSpotDirection=x}if(W.length){var o=[],n=[];W.forEach(function(e){Op(o,e,K),eh(n,v._transformDirectionToViewSpace(e.p3()))}),k.uDirColor=o,k.uDirDirection=n}v._lastLightMask=fb,v._lastHeadlightAmbientIntensity=r},sj=function(V,y,C,M){if(M===Y&&(M=V._headlightAmbientIntensity),M!==V._lastHeadlightAmbientIntensity&&(y.uHeadlightAmbientIntensity=V._lastHeadlightAmbientIntensity=M),C!==V._lastLightMask){V._lastLightMask=C;var t=V._lastLightUploadInfo;if(t){var m,s,T,g=t.g,c=t.e,O=g.length,p=new Array(O),X=!1;for(s=0;O>s;s++)m=g[s],T=0>m||m>=32?1:C&1<<m?0:1,p[s]=T,T!==c[s]&&(X=!0);if(X){t.e=c=p;var z=t.c;y.uHeadlightColor=[z[0],z[1],z[2],c[0]];var _,q=V._59O,w=V._spots,v=V._dirs,S=3,I=1;if(O=q.length){for(s=0,_=[];O>s;s++)_.push(z[S++],z[S++],z[S++],c[I++]);y.uPointColor=_}if(O=w.length){for(s=0,_=[];O>s;s++)_.push(z[S++],z[S++],z[S++],c[I++]);y.uSpotColor=_}if(O=v.length){for(s=0,_=[];O>s;s++)_.push(z[S++],z[S++],z[S++],c[I++]);y.uDirColor=_}}}}},Xq=function(b,X){return Math.max(b.getRotateMinPhi()+mn,Math.min(b.getRotateMaxPhi()-mn,X))},Gm=function(){return.05+me()/2},Zk=function(k,p,F,c){var $,V=k.getEye();return k.isOrtho()?($=Ok(k.getCenter(),V),$[0]+=c[0],$[1]+=c[1],$[2]+=c[2]):$=V,Hd(p,F,c,$)},Hd=function(K,G,t,U){var W=Oe(K,G),v=Ok(U,t,!0),S=Oe(v,G);if(P(S)<mn)return F;var $=(W-Oe(t,G))/S;return[t[0]+v[0]*$,t[1]+v[1]*$,t[2]+v[2]*$]},se=function(W,n){return{x:2*W.x-n.x,y:2*W.y-n.y}},Jb=function(P,H,l,N){var E,L;if(!P)return E=jm(H.y-l.y,l.x-H.x),{x:H.x+N*A(E),y:H.y+N*a(E)};if(!l)return E=jm(P.y-H.y,H.x-P.x),{x:H.x+N*A(E),y:H.y+N*a(E)};var n=Ok([P.x,P.y,0],[H.x,H.y,0],!0),g=Ok([l.x,l.y,0],[H.x,H.y,0],!0),K=-(n[0]+g[0])/2,D=-(n[1]+g[1])/2,T=z(K*K+D*D);if(mn>T)return E=jm(P.y-H.y,H.x-P.x),{x:H.x+N*A(E),y:H.y+N*a(E)};var B=P.x-H.x,V=P.y-H.y,x=l.x-H.x,G=l.y-H.y,p=z(B*B+V*V),k=z(x*x+G*G);E=J(Oe(n,g))/2,L=n[1]*g[0]-n[0]*g[1]>0?-1:1,K/=T,D/=T;var h=N/A(E),c=O(p,k)/a(E);T=Math.min(h,c);var C={x:H.x+L*T*K,y:H.y+L*T*D};return l.b&&h>k/a(E)&&(C.adjust=!0),C},cl=function(w){var $=w[1],n=w[2],L=w[3],O=w[6],f=w[7],Y=w[11];w[1]=w[4],w[2]=w[8],w[3]=w[12],w[4]=$,w[6]=w[9],w[7]=w[13],w[8]=n,w[9]=O,w[11]=w[14],w[12]=L,w[13]=f,w[14]=Y},Pe=function(s){var f=s[0],H=s[1],l=s[2],z=s[3],V=s[4],j=s[5],t=s[6],g=s[7],k=s[8],I=s[9],A=s[10],E=s[11],B=s[12],W=s[13],r=s[14],u=s[15],n=f*j-H*V,m=f*t-l*V,J=f*g-z*V,p=H*t-l*j,a=H*g-z*j,Z=l*g-z*t,O=k*W-I*B,N=k*r-A*B,R=k*u-E*B,M=I*r-A*W,o=I*u-E*W,L=A*u-E*r,Q=n*L-m*o+J*M+p*R-a*N+Z*O;return Q?(Q=1/Q,s[0]=(j*L-t*o+g*M)*Q,s[1]=(l*o-H*L-z*M)*Q,s[2]=(W*Z-r*a+u*p)*Q,s[3]=(A*a-I*Z-E*p)*Q,s[4]=(t*R-V*L-g*N)*Q,s[5]=(f*L-l*R+z*N)*Q,s[6]=(r*J-B*Z-u*m)*Q,s[7]=(k*Z-A*J+E*m)*Q,s[8]=(V*o-j*R+g*O)*Q,s[9]=(H*R-f*o-z*O)*Q,s[10]=(B*a-W*J+u*n)*Q,s[11]=(I*J-k*a-E*n)*Q,s[12]=(j*N-V*M-t*O)*Q,s[13]=(f*M-H*N+l*O)*Q,s[14]=(W*m-B*p-r*n)*Q,s[15]=(k*p-I*m+A*n)*Q,void 0):F},gk=function(Z,z){if(z){var L=z[0],K=z[1],S=z[2];Z[12]=Z[0]*L+Z[4]*K+Z[8]*S+Z[12],Z[13]=Z[1]*L+Z[5]*K+Z[9]*S+Z[13],Z[14]=Z[2]*L+Z[6]*K+Z[10]*S+Z[14],Z[15]=Z[3]*L+Z[7]*K+Z[11]*S+Z[15]}},Ec=function(w,A){if(A){var u=A[0],r=A[1],h=A[2];w[0]=w[0]*u,w[1]=w[1]*u,w[2]=w[2]*u,w[3]=w[3]*u,w[4]=w[4]*r,w[5]=w[5]*r,w[6]=w[6]*r,w[7]=w[7]*r,w[8]=w[8]*h,w[9]=w[9]*h,w[10]=w[10]*h,w[11]=w[11]*h}},_i=function(U,f,W){var t=f[0],c=f[1],y=f[2],x=f[3],i=f[4],E=f[5],N=f[6],L=f[7],G=f[8],w=f[9],F=f[10],q=f[11],k=f[12],Q=f[13],T=f[14],s=f[15],O=W[0],B=W[1],e=W[2],d=W[3];return U[0]=O*t+B*i+e*G+d*k,U[1]=O*c+B*E+e*w+d*Q,U[2]=O*y+B*N+e*F+d*T,U[3]=O*x+B*L+e*q+d*s,O=W[4],B=W[5],e=W[6],d=W[7],U[4]=O*t+B*i+e*G+d*k,U[5]=O*c+B*E+e*w+d*Q,U[6]=O*y+B*N+e*F+d*T,U[7]=O*x+B*L+e*q+d*s,O=W[8],B=W[9],e=W[10],d=W[11],U[8]=O*t+B*i+e*G+d*k,U[9]=O*c+B*E+e*w+d*Q,U[10]=O*y+B*N+e*F+d*T,U[11]=O*x+B*L+e*q+d*s,O=W[12],B=W[13],e=W[14],d=W[15],U[12]=O*t+B*i+e*G+d*k,U[13]=O*c+B*E+e*w+d*Q,U[14]=O*y+B*N+e*F+d*T,U[15]=O*x+B*L+e*q+d*s,U},nb=function(m,A,U,V){var s,N,T,k,i,l,L,X,H,w,Y=A[0],Q=A[1],v=A[2],D=V[0],E=V[1],S=V[2],F=U[0],u=U[1],b=U[2];return P(Y-F)<mn&&P(Q-u)<mn&&P(v-b)<mn?io(m):(L=Y-F,X=Q-u,H=v-b,w=1/z(L*L+X*X+H*H),L*=w,X*=w,H*=w,s=E*H-S*X,N=S*L-D*H,T=D*X-E*L,w=z(s*s+N*N+T*T),w?(w=1/w,s*=w,N*=w,T*=w):(s=0,N=0,T=0),k=X*T-H*N,i=H*s-L*T,l=L*N-X*s,w=z(k*k+i*i+l*l),w?(w=1/w,k*=w,i*=w,l*=w):(k=0,i=0,l=0),m[0]=s,m[1]=k,m[2]=L,m[3]=0,m[4]=N,m[5]=i,m[6]=X,m[7]=0,m[8]=T,m[9]=l,m[10]=H,m[11]=0,m[12]=-(s*Y+N*Q+T*v),m[13]=-(k*Y+i*Q+l*v),m[14]=-(L*Y+X*Q+H*v),m[15]=1,m)},Rd=function(o,y,f,v,b){var m=1/ld(y/2),W=1/(v-b);return o[0]=m/f,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=m,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=(b+v)*W,o[11]=-1,o[12]=0,o[13]=0,o[14]=2*b*v*W,o[15]=0,o},Ee=function(o,g,k,C,p,N,X){var G=1/(g-k),z=1/(C-p),n=1/(N-X);return o[0]=-2*G,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*z,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*n,o[11]=0,o[12]=(g+k)*G,o[13]=(p+C)*z,o[14]=(X+N)*n,o[15]=1,o},bm=function(V,A){var h=A[0],P=A[1],z=A[2],C=A[3],b=h*h+P*P+z*z+C*C,y=b?1/b:0;return V[0]=-h*y,V[1]=-P*y,V[2]=-z*y,V[3]=C*y,V},hh=function(a,I){var t=I[0]+I[5]+I[10],k=0;return t>0?(k=2*Math.sqrt(t+1),a[3]=.25*k,a[0]=(I[6]-I[9])/k,a[1]=(I[8]-I[2])/k,a[2]=(I[1]-I[4])/k):I[0]>I[5]&I[0]>I[10]?(k=2*Math.sqrt(1+I[0]-I[5]-I[10]),a[3]=(I[6]-I[9])/k,a[0]=.25*k,a[1]=(I[1]+I[4])/k,a[2]=(I[8]+I[2])/k):I[5]>I[10]?(k=2*Math.sqrt(1+I[5]-I[0]-I[10]),a[3]=(I[8]-I[2])/k,a[0]=(I[1]+I[4])/k,a[1]=.25*k,a[2]=(I[6]+I[9])/k):(k=2*Math.sqrt(1+I[10]-I[0]-I[5]),a[3]=(I[1]-I[4])/k,a[0]=(I[8]+I[2])/k,a[1]=(I[6]+I[9])/k,a[2]=.25*k),a},Bq=function(G,k,p){var y=k[0],V=k[1],J=k[2],v=k[3],r=y+y,L=V+V,A=J+J,u=y*r,F=y*L,Y=y*A,m=V*L,M=V*A,s=J*A,S=v*r,h=v*L,C=v*A;return G[0]=1-(m+s),G[1]=F+C,G[2]=Y-h,G[3]=0,G[4]=F-C,G[5]=1-(u+s),G[6]=M+S,G[7]=0,G[8]=Y+h,G[9]=M-S,G[10]=1-(u+m),G[11]=0,G[12]=p[0],G[13]=p[1],G[14]=p[2],G[15]=1,G},rm=function(H,s){if(H.isVREnabled()){var m=H.vr.getViewMatrix(s);if(m)return m}return H._camera?H._camera.getViewMatrix(s):nb(s?s:vc(),H._eye,H._center,H._up)},Vk=function(L,M){if(L.isVREnabled()){var v=L.vr.getProjectMatrix();if(v)return v}if(L._camera)return L._camera.getProjectMatrix();if(!M&&L._computedProjectMatrix)return pn(L._computedProjectMatrix);var T=L.getAspect(),x=L._near,D=L._far,n=vc();if(L._ortho){var Z=L._orthoWidth/2,i=Z/T;Ee(n,-Z,Z,-i,i,x,D)}else Rd(n,L._fovy,T,x,D);return n},Jd=function(J,D){if(!J)return F;var r=0,t=1,x=2,p=[],d=0,$=J.length,b=$/3;if(D){for(;$>d;d++)p[d]=0;for(d=0;d<D.length;d+=3){var y=[],g=[],I=[];y[r]=J[3*D[d+1]+r]-J[3*D[d]+r],y[t]=J[3*D[d+1]+t]-J[3*D[d]+t],y[x]=J[3*D[d+1]+x]-J[3*D[d]+x],g[r]=J[3*D[d+2]+r]-J[3*D[d+1]+r],g[t]=J[3*D[d+2]+t]-J[3*D[d+1]+t],g[x]=J[3*D[d+2]+x]-J[3*D[d+1]+x],I[r]=y[t]*g[x]-y[x]*g[t],I[t]=y[x]*g[r]-y[r]*g[x],I[x]=y[r]*g[t]-y[t]*g[r];for(var M=0;3>M;M++)p[3*D[d+M]+r]+=I[r],p[3*D[d+M]+t]+=I[t],p[3*D[d+M]+x]+=I[x]}}else for(d=0;b>d;d+=3){var y=[],g=[],I=[];y[r]=J[3*(d+1)+r]-J[3*d+r],y[t]=J[3*(d+1)+t]-J[3*d+t],y[x]=J[3*(d+1)+x]-J[3*d+x],g[r]=J[3*(d+2)+r]-J[3*(d+1)+r],g[t]=J[3*(d+2)+t]-J[3*(d+1)+t],g[x]=J[3*(d+2)+x]-J[3*(d+1)+x],I[r]=y[t]*g[x]-y[x]*g[t],I[t]=y[x]*g[r]-y[r]*g[x],I[x]=y[r]*g[t]-y[t]*g[r];for(var M=0;3>M;M++)p[3*(d+M)+r]=I[r],p[3*(d+M)+t]=I[t],p[3*(d+M)+x]=I[x]}for(d=0;$>d;d+=3){var B=[];B[r]=p[d+r],B[t]=p[d+t],B[x]=p[d+x];var H=z(B[r]*B[r]+B[t]*B[t]+B[x]*B[x]);0===H&&(H=mn),B[r]=B[r]/H,B[t]=B[t]/H,B[x]=B[x]/H,p[d+r]=B[r],p[d+t]=B[t],p[d+x]=B[x]}return new Oh(p)},Tb=function(u,n,q,l){if(q||(q=u.createTexture()),n){var Z=u.TEXTURE_2D,I=u.REPEAT,E=u.CLAMP_TO_EDGE,t=u.TEXTURE_MIN_FILTER;l=l||Qj;var W=l.minFilter||l.filter||u.LINEAR,T=l.magFilter||l.filter||u.LINEAR;u.activeTexture(u.TEXTURE0),Tj(u,q),u.texImage2D(Z,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,n),Wb(u,u.TEXTURE_MAG_FILTER,T);var i=n.naturalWidth||n.width,y=n.naturalHeight||n.height;ze.isPOT(i)&&ze.isPOT(y)&&!l.clampToEdge&&!n.clampToEdge?(Wb(u,u.TEXTURE_WRAP_S,I),Wb(u,u.TEXTURE_WRAP_T,I),Wb(u,t,W===u.NEAREST?u.NEAREST_MIPMAP_NEAREST:u.LINEAR_MIPMAP_LINEAR),l.mipmapMaxLevel!==Y&&Wb(u,u.TEXTURE_MAX_LEVEL,l.mipmapMaxLevel),u.generateMipmap(Z)):(Wb(u,u.TEXTURE_WRAP_S,E),Wb(u,u.TEXTURE_WRAP_T,E),Wb(u,t,W)),Tj(u,F)}return q},Uf=function(r,S,J){var u=new Uint8Array(J||4);return S=S||r.createTexture(),r.activeTexture(r.TEXTURE0),Tj(r,S),Wb(r,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,u),S},Vj=function(F,g,Z){var s=new Uint8Array(Z||4);return g=g||F.createTexture(),F.activeTexture(F.TEXTURE0),F.bindTexture(F.TEXTURE_CUBE_MAP,g),F.texParameteri(F.TEXTURE_CUBE_MAP,F.TEXTURE_MAG_FILTER,F.LINEAR),F.texParameteri(F.TEXTURE_CUBE_MAP,F.TEXTURE_MIN_FILTER,F.LINEAR),F.texImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,F.RGBA,1,1,0,F.RGBA,F.UNSIGNED_BYTE,s),F.texImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,F.RGBA,1,1,0,F.RGBA,F.UNSIGNED_BYTE,s),F.texImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,F.RGBA,1,1,0,F.RGBA,F.UNSIGNED_BYTE,s),F.texImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,F.RGBA,1,1,0,F.RGBA,F.UNSIGNED_BYTE,s),F.texImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,F.RGBA,1,1,0,F.RGBA,F.UNSIGNED_BYTE,s),F.texImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,F.RGBA,1,1,0,F.RGBA,F.UNSIGNED_BYTE,s),g},Zl=function(z){z._26I&&z._prg&&(z._26I.deleteProgram(z._prg),z._prg=F)},Lj=function(){function c(a){if(a.match($))return Ld(a);var g=r[a];if(g)return g;var i=new RegExp("#define\\s+"+a+"\\s+(\\d+)"),F=D.match(i);return r[a]=F?Ld(F[1]):0}function N(q){r={},D=q;var R=q.replace(O,k).replace(U,T);return D=null,r=null,R}function k(F,G,D){D=c(D);for(var v="",y=0;D>y;y++)v+=G+y+";";return v}function T(n,R,H,E){for(var K="",u=c(R);u<c(H);u++)K+=E.replace(/\[\s*i\s*\]/g,"["+u+"]").replace(/\[\s*I\s*\]/g,u);return K}var r,D,O=/(uniform\s+sampler2D\s+\w+)\[([\S\d]+)\];/g,U=/#UNROLL_LOOP_START\s+for\s*\(\s*int\s+i\s*=\s*([\S\d]+)\s*;\s*i\s*<\s*([\S\d]+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#UNROLL_LOOP_END/g,$=/^\d+$/;return function(i){return N(i)}}(),_h=function(R,P,G,Z){var Q=R.createShader(G);return R.shaderSource(Q,Lj(Z)),R.compileShader(Q),R.attachShader(P,Q),Q},Sd=function(n){return n.createBuffer()},Tj=function(z,B){z.bindTexture(z.TEXTURE_2D,B||z._emptyTexture)},Wb=function(r,F,j){r.texParameteri(r.TEXTURE_2D,F,j)},dj=function(O,K){var R=mq.for(O).directState();R.polygonOffset.enabled=!0,R.polygonOffset.value=K},mj=function(T){var S=mq.for(T).directState();S.polygonOffset.enabled=!1},oh=function(L,c){if(c){var W=mq.for(L).directState();W.color.clear=yl(c)}},Dh=function(R,s,P){if(P!==s._lastClipboxEnabled){var d=R._boxClipperGroups,w=d?d.length:0,X=new Array(w);if(P)for(var Z=0;w>Z;Z++)P&1<<d[Z]&&(X[Z]=!0);s._lastClipboxEnabled=P,s.uEnableBoxClip=X}},rj=Dh,Ln=function(F){var m=mq.for(F),B=m.directUniforms(),W=m.directAttribs();B.uFix=!0,W.aNormal=!1},Vf=function(t){var y=mq.for(t),d=y.directUniforms();y.directAttribs(),d.uFix=!1},Yh=function(X,e,s,c,O,H,R,S){var B=mq.for(X),W=B.directState(),l=B.directUniforms();X._picking||(s?(l.uBlend=!0,l.uBlendColor=s):l.uBlend=!1,l.uLight=c==F?!0:c,bs(O)&&1!==O&&(l.uPartOpacity=O),l.uReverseFlip=H==F?!1:H,l.uFixPickReverseColor=R||ik),W.cullFace.enabled=S?!0:!1},nq=function(f){if(!f._picking){var y=mq.for(f),Z=y.directUniforms();Z.uPartOpacity=1}},Yf=function(){var H=new R.Math.Matrix2d,o=[1,0,0,0,1,0,0,0,0];return function(c,w,z,u,M,_,l,T,x,U){var e=mq.for(c),d=e.directUniforms(),W=e.directAttribs();return z?(d.uTexture=!0,d.uDiscardSelectable=Um(u)?u:!0,W.aUv=dg(c,M,_,F,2),U?(d.uBlendTexture=!0,d.uBlendSampler=U):(d.uBlendTexture=!1,d.uBlendSampler=c._emptyBlendTexture),d.uSampler=z,d.uUvMatrix=l||T||x?pc(x,l,T,H).toArray9():o,void 0):(d.uSampler=c._emptyTexture,d.uBlendSampler=c._emptyBlendTexture,void 0)}}(),Dl=function(N,f,j){var s=mq.for(N),q=s.directUniforms(),J=s.directAttribs();N.activeTexture(N.TEXTURE0),Tj(N,F),N.activeTexture(N.TEXTURE1),Tj(N,F),j&&(J.aUv=!1,q.uTexture=!1,q.uSampler=N._emptyTexture,q.uBlendTexture=!1,q.uBlendSampler=N._emptyBlendTexture)},tk=function(k,o,G,K,u,c){var q=mq.for(k),S=q.directUniforms(),Y=q.directAttribs();!G||_r||km||k.lineWidth(G),K&&!k._picking&&(S.uFixPickReverseColor=K),u&&(Y.aPosition=dg(k,u,c,F))},Rf=function(H,E,D,Z){gd&&(Z=H[gd]),H.drawArrays(Z==F?H.TRIANGLES:Z,E,D);var M=H._renderInfo;M&&(M.calls++,M.vertices+=D,(Z==F||Z===H.TRIANGLES)&&(M.faces+=D/3),Z===H.LINES&&(M.lines+=D/2),Z===H.POINTS&&(M.points+=D))},Eb=function(L,r,w,z,b){gd&&(z=L[gd]),L.drawElements(z==F?L.TRIANGLES:z,w,b==F?L.UNSIGNED_SHORT:b,r==F?0:2*r);var Y=L._renderInfo;Y&&(Y.calls++,Y.vertices+=w,(z==F||z===L.TRIANGLES)&&(Y.faces+=w/3),z===L.LINES&&(Y.lines+=w/2),z===L.POINTS&&(Y.points+=w))},No=function(N,J,L){var S=N.ARRAY_BUFFER;return N.bindBuffer(S,J),L&&N.bufferData(S,L,N.STATIC_DRAW),J},dg=function(z,B,m,e,Y){return m?gm(z,z.ARRAY_BUFFER,B,m):No(z,B,m,e,Y)},yf=function(A,v,V){var l=A.ELEMENT_ARRAY_BUFFER;A.bindBuffer(l,v),V&&A.bufferData(l,V,A.STATIC_DRAW)},lo=function(i,o,p){gm(i,i.ELEMENT_ARRAY_BUFFER,o,p)},gm=function(V,i,y,c){var r=c._bufId;r||(r=c._bufId=R.Math.generateIncreasingID());var y,_=V._bufPool;return(y=_[r])&&y._buf?V.bindBuffer(i,y._buf):(y=_[r]={_buf:Sd(V)},V.bindBuffer(i,y._buf),V.bufferData(i,c,V.STATIC_DRAW)),y._fid=V._renderInfo.frame,y._buf},Un=function(A,g){g!=F&&g>=0&&A.enableVertexAttribArray(g)},Lr=function(e,V){V!=F&&V>=0&&e.disableVertexAttribArray(V)},Ah=function(e,z){var b=e.getGL(),f=mq.for(b),j=f.directUniforms();e._7O=e._8O.pop(),z&&(j.uMVMatrix=e._7O,e._6O=z,j.uNMatrix=z)},Vc=function(X,P){return P||(P=vc()),$d(P,X),Pe(P),cl(P),P},vo=function(r,V){var L=r.getGL(),h=r._7O,q=mq.for(L),k=q.directUniforms();V?(r._8O.push(pn(h)),k.uMMatrix=V,_i(h,h,V),r._7O=h):k.uMMatrix=yd,k.uMVMatrix=h,k.uNMatrix=Vc(h,r._6O)},vr={body:0,label:1,label2:2,note:3,note2:4,symbol:5},As=10,Np=function(G,T,n,b,d,z){var V;if(n){var p=b._pickId;p||(p=b._pickId=T._pickIdUsed,T._pickIdUsed+=As);var H,f=vr[d];if(null!=f)H=p+f;else{var o=b._pickExtraPartMap;o||(o=b._pickExtraPartMap={}),(H=o[d])||(H=o[d]=T._pickIdUsed++)}T[H]||(T[H]={data:b.data,part:d}),V=Gs(H)}else V=Xk;if(!z){var R=mq.for(G),C=R.directUniforms();C.uFixPickReverseColor=V}return V},ar=Np,wk=function(o,m,W){"target"!==W&&(W="source");var q="target"===W?m.getTargetAgent():m.getSourceAgent(),U="edge."+W+".";if(Im(q)){var E=m.s(U+"anchor.x"),j=m.s(U+"anchor.elevation"),e=m.s(U+"anchor.y"),O=_j(q,o.getMat(q)),b=q.getAnchor3d(),z=Lp([(E===Y?.5:E)-b.x,(j===Y?.5:j)-b.y,(e===Y?.5:e)-b.z],O);return z[1]+=m.s(U+"offset.elevation"),z}var P=m.s(U+"index"),p=o.getData3dUI(q);if(!p.info||!p.info.list)return!1;if(P>=0){var B,u,g,G,F,Z=p.info._lastPointsSegments,S=Z.points,w=Z.segments,$=-1,K=-1;for(g=0,G=w?w.length:S.length;G>g;g++){if(u=w?w.get(g):1,3===u)F=2;else if(4===u)F=3;else{if(5===u)continue;F=1}if($+=F,K++,K===P){B=S.get($);break}}return B||(B=S.get(S.length-1)),[B.x,(B.e||0)+m.s(U+"offset.elevation"),B.y]}var r=m.s(U+"percent")||.5;if(r=Math.max(0,Math.min(r,1)),!p||!p.getCache)return!1;var i=p.getCache(),G=i[i.length-1].length,Z=o.getLineOffset(q,r*G),z=Z.point;return[z.x,z.y+m.s(U+"offset.elevation"),z.z]},Jr=function(){var B={center:function(B,H,m,N,w){var U=-H[1]/2,u={x:-H[0]/2,y:U,width:H[0],height:H[1]},W=Am(B,u,m);return[W.x+N,-W.y-w,x.getPosition3dGap()]},front:function(M,z,j,o,a){var U=-z[1]/2,C={x:-z[0]/2,y:U,width:z[0],height:z[1]},S=Am(M,C,j);return[S.x+o,-S.y-a,z[2]/2+x.getPosition3dGap()]},back:function(i,k,L,w,z){var U=-k[0]/2,d=-k[1]/2,n={x:U,y:d,width:k[0],height:k[1]},K=Am(i,n,L);return[-K.x-w,-K.y-z,-k[2]/2-x.getPosition3dGap()]},left:function(V,O,r,$,D){var L=-O[1]/2,W={x:-O[2]/2,y:L,width:O[2],height:O[1]},l=Am(V,W,r);return[-O[0]/2-x.getPosition3dGap(),-l.y-D,l.x+$]},right:function(Q,M,D,P,k){var H=-M[2]/2,f=-M[1]/2,y={x:H,y:f,width:M[2],height:M[1]},n=Am(Q,y,D);return[M[0]/2+x.getPosition3dGap(),-n.y-k,-n.x-P]},top:function(k,g,Q,A,O){var Z={x:-g[0]/2,y:-g[2]/2,width:g[0],height:g[2]},i=Am(k,Z,Q);return[i.x+A,g[1]/2+x.getPosition3dGap(),i.y+O]},bottom:function(G,z,Q,r,a){var v=-z[2]/2,K={x:-z[0]/2,y:v,width:z[0],height:z[2]},X=Am(G,K,Q);return[X.x+r,-z[1]/2-x.getPosition3dGap(),-X.y-a]}};return function(p,o,G,_,f,$){return B[_](p,o,G,f||0,$||0)}}(),Iq=function(G,N,v,Z,P,c,J,K,m,H){if(P&&(N[0]+=P[0],N[1]+=P[1],N[2]+=P[2]),gk(G,v),K){var j=vc();if(ih(j,m,H),Lp(N,j),gk(G,N),G.auto=K,G.pos=Lp([0,0,0],G),c){var n=G.mat2=vc();ih(n,c,J)}}else ih(G,m,H),gk(G,N),Z===Qi?pp(G,-Ie):Z===Me?pp(G,Ie):Z===En?ms(G,-Ie):Z===Mr?ms(G,Ie):Z===Cb&&pp(G,d),ih(G,c,J);return G},Ke=function(b,V){var e=V.auto,N=V.mat2,h=b.gv;if(e){var P,J=vc(),n=[0,0,0,0];P="string"==typeof e?[e.indexOf("x")<0?h._eye[0]:h._center[0],e.indexOf("y")<0?h._eye[1]:h._center[1],e.indexOf("z")<0?h._eye[2]:h._center[2]]:h._eye,hh(n,nb(vc(),P,h._center,h._up)),Bq(J,bm(n,n),V.pos),N&&_i(J,J,N),vo(h,J)}else vo(h,V)},xi=function(E,A,w,q,z){var P=E.s,Q=E.gv,s=Q.getGL(),I=Q._prg,j=Q._buffer,y=Q._1O,x=mq.for(s),G=x.directAttribs();Tb(s,Bg,y),Ke(E,w),Yh(s,I,P(A+".blend"),P(A+".light"),P(A+".opacity"),P(A+".reverse.flip"),P(A+".reverse.color"),P(A+".reverse.cull")),Yf(s,I,y,z,j.uv,Rl),G.aPosition=dg(s,j.vs,q,F),G.aNormal=dg(s,j.ns,Em,F),lo(s,j.is,uf),Eb(s,0,uf.length),Dl(s,I,y),nq(s,I),Ah(Q)},we=function(J,P,M){var X=J.gv,j=J.data,C=J[P]={blend:X.getBodyColor(j)||X.getFaceBlend(j,P),light:X.getFaceLight(j,P),color:X.getFaceColor(j,P),opacity:X.getFaceOpacity(j,P),transparent:X.getFaceTransparent(j,P),reverseFlip:X.getFaceReverseFlip(j,P),reverseColor:X.getFaceReverseColor(j,P),reverseCull:X.getFaceReverseCull(j,P),texture:X.getFaceImage(j,P),blendTexture:X.getFaceBlendImage(j,P),discardSelectable:X.getFaceDiscardSelectable(j,P)};if("csg"!==P){C.uv=X.getFaceUv(j,P)||M&&M[P+"Uv"],C.uvScale=X.getFaceUvScale(j,P)||M&&M[P+"UvScale"],C.uvOffset=X.getFaceUvOffset(j,P)||M&&M[P+"UvOffset"],C.uvRotation=X.getFaceUvRotation(j,P)||M&&M[P+"uvRotation"];var o=X.getFaceMat(j,P);if(o){var S=_j(j,o);j.appendAnchorMatrix3d(S),C.mat=S}}return C},Zc=function(E,C,H,L,b){var h=E[L];if(h){if(!b(h.transparent))return;var q=E.data,i=E.gv,p=i._buffer,v=i.getTexture(h.texture,q,L),j=i.getTexture(h.blendTexture,q),N=mq.for(C),t=N.directUniforms(),D=N.directAttribs();Yf(C,H,v,h.discardSelectable,p.uv,h.tuv,h.uvOffset,h.uvScale,h.uvRotation,j),Yh(C,H,h.blend,h.light,h.opacity,h.reverseFlip,h.reverseColor,h.reverseCull),h.cs&&!i._batchColorDisabled?(t.uBatchColor=!0,D.aBatchColor=dg(C,p.batchColor,h.cs,H.aBatchColor,4)):t.uDiffuse=h.color||Q["color.empty"],D.aPosition=dg(C,p.vs,h.vs,F),D.aNormal=dg(C,p.ns,h.ns,F),Rf(C,0,h.vs.length/3),h.cs&&!i._batchColorDisabled&&(t.uBatchColor=!1,Lr(C,H.aBatchColor)),nq(C,H),Dl(C,H,v)}},Ed=function(C,r,J){Ub(C)?C.forEach(function(R){Ed(R,r,J)}):Fn(C)?Ed(qc(r,C),r,J):gr(C)?C.shape3d?Ed(C.shape3d,r,J):J.push(C):J.push(C)},Yj=function(){for(var s=50,i=arguments.length,z=[],D=0;i>D;D++)z[D]=arguments[D];vi[hp]="Time : "+(new Date).toLocaleString()+", Info :"+z.join(", "),hp=(hp+1)%s,console.error("Failed to create shader.")},pc=function(){var F=new ze.Matrix2d;return function(X,L,T,z){z||(z=F);var n,P,x,k;return L?(n=L[0],P=L[1]):n=P=0,T?(x=T[0],k=T[1]):x=k=1,z.setFromTransform(X||0,n,P,x,k)}}(),Fq=function(n,J,A,W,$,I){var R,V,L,q,p,h,X,c,a,Y,e,f=[W-J,$-A],G=n?n.length:0;for(L=0;G>L;L++){for(q=2,R=n[L],p=R[0],h=R[1];q+1<R.length;){if(X=R[q],c=R[q+1],V=Si(J,A,W,$,p,h,X,c,!0)){a=[X-p,c-h],Y=Gd(a),a[0]/=Y,a[1]/=Y,Y=Oe(f,a),Y=Y>0?I:-I,e=[a[0]*Y,a[1]*Y];break}p=X,h=c,q+=2}if(e)break}if(e)for(W=J+e[0],$=A+e[1],L=0;G>L;L++)for(q=2,R=n[L],p=R[0],h=R[1];q+1<R.length;){if(X=R[q],c=R[q+1],V=Si(J,A,W,$,p,h,X,c,!0))return[0,0];p=X,h=c,q+=2}return e?e:[W-J,$-A]},Jh=function(A){return"nearest"===A?qk.NEAREST:"linear"===A?qk.LINEAR:A},Km=R.graph3d={WebGLConstants:qk},_p=function(H,P,$){tr(q+".graph3d."+H,P,$)},Eh="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<6/1!,!*{/mbdpMwVxpmg!,!z/mbdpMwVxpmg!-y/mbdpMwVxpmg)3dfw!>!^j]wVxpmg<{zy/**1/2!-opjujtpQb)5dfw!+!yjsubNNv!+!^j]yjsubNxpmg)!>!mbdpMwVxpmg|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1>j!uoj)spg<mbdpMwVxpmg!4dfw1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!<*1/2!-opjujtpQb)5dfw!+!yjsubNNv!+!yjsubNxpebit!>!esppDxpebit!QBNXPEBIT`FTV!gfegj$!!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw!>!wVw|*fsvuyfUv)gj<*opjujtpQb)4dfw!>!opjujtpQw!gjeof$!~!1!>>!SFQQJMD`YPC`YBN!gj$!<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!gjeof$!|*ldjQva!%%!yjGva)gj!1!>>!SFQQJMD`YPC`YBN!gj$!<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw<^UDFKCP`XPMG`YBN]yjsubNxpmg!5ubn!nspgjov1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!<esppDxpebit!5dfw!hojzsbw<yjsubNxpebit!5ubn!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<yjsubNwVv!4ubn!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",bi="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVw!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ!gjeof$!<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg!ftmf$!<*iuqfe!+!iuqfe!+!zujtofEhpGv!+!zujtofEhpGv!.)qyf!.!1/2!>!spudbGhpg!ubpmg!3QYF`HPG!gfegj$!<{/yfusfWw.!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!!EOF`QPPM`MMPSOV$!~<chs/*^j]wVxpmg!-^J]fsvuyfUxpmg)E3fsvuyfu!!>,!chs/eJ!****1/1)3dfw!-^j]wVxpmg)obiUsfubfsh)mmb!%%!***1/2)3dfw!-^j]wVxpmg)obiUttfm)mmb!%%!^j]efmcboFxpmg)!gj|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1>j!uoj)!spg!USBUT`QPPM`MMPSOV$!!1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ!gjeof$!<*spmpDwof)sbfojMpUmfyfUqbNwof!>!spmpDwof<**{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv)fcvDfsvuyfu!>!spmpDwof!5dfw!ftmf$!<**ttfoihvps!-*{z/dfWudfmgfs!-y/dfWudfmgfs.)4dfw!-qbNwoFv)WVfcvDfsvuyfu)CHStpUsbfojM!>!spmpDwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!<*mbnspOemspx!-yfusfWpUbsfnbd)udfmgfs!>!dfWudfmgfs!4dfw<*yjsubNxfjWv!-O)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*opjujtpQbsfnbDv!.!emspXw)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ!gjeof$!~<fvmbWxpebit!+!zujtofuoJxpebit!.!1/2!>+!nsfUusfcnbm!~!!<osvufs!<esbdtje!!|!*1/1!>>!fvmbWxpebit!%%!mmvDxpebit)!gj<*esppDxpebit!-tvjebSxpebit!-tbjCxpebit!-f{jTxpebit!-qbNxpebit)xpebiTufh!.!1/2!>!fvmbWxpebit!ubpmg|!*fwjfdfSxpebit)!gj!QBNXPEBIT`FTV!gfegj$!~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*fdobutjEitbEv!?!*fdobutjEqbHitbEv!-fdobutjEfojMw)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~!<osvufs!<*1/2!-1/1!-1/1!-1/1)5dfw!>!spmpDhbsG`mh!|!*uvpldbmc)!gj!gjeof$!~~!<osvufs!<esbdtje!|!****ojNqjmd!-mbdpMw)obiUsfubfsh)mmb!%%!**ybNqjmd!-mbdpMw)obiUttfm)mmb)!>a!^j]sfooJqjmDsfqqjmDv!%%!^j]qjmDypCfmcboFv)!gj<**1/2!-emspXw)5dfw!+!^j]yjsubNsfqqjmDv)4dfw!>!mbdpMw|!*,,j!<SFQQJMD`YPC`YBN!=!j!<1>j!uoj)spg<mbdpMw!4dfw!1!?!SFQQJMD`YPC`YBN!gj$!~~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw|!*1!?!opjudfsjEqjmDv)!gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw<uvpldbmc!mppc!nspgjov!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw<^UDFKCP`XPMG`YBN]efmcboFxpmg!mppc!nspgjov<^UDFKCP`XPMG`YBN]fsvuyfUxpmg!E3sfmqnbt!nspgjov!1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!!gjeof$!!~~<*1/2!-*Gqjn!-2spmpd!-1spmpd)yjn)5dfw!osvufs<*1/2!,!uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!2spmpd!4dfw|!ftmf!~<*1/2!-1spmpd)5dfw!osvufs|!*1/1!>>!Gqjn)!gj<*uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!1spmpd!4dfw<*qjn)sppmg!>!uoJqjn!ubpmg<*qjn)udbsg!>!Gqjn!ubpmg<*mfwfMqjNybn`WVfcvd!-1n!-*ttfoihvps)qjNpUttfoihvps)qnbmd!>!qjn!ubpmg|!*ttfoihvps!ubpmg!-sjEfmqnbt!4dfw!-qbNwof!E3sfmqnbt)WVfcvDfsvuyfu!5dfw!~<qjn!osvufs~<*ttfoihvps!+!72/2)3hpm!+!1/3!.!>!qjn|!ftmf!~<6n!,!*7s!.!6s)!0!*6n!.!7n)!+!*ttfoihvps!.!6s)!>!qjn|!*7s!>?!ttfoihvps)!gj!ftmf!~<5n!,!*6s!.!5s)!0!*5n!.!6n)!+!*ttfoihvps!.!5s)!>!qjn|!*6s!>?!ttfoihvps)!gj!ftmf!~<2n!,!*5s!.!2s)!0!*2n!.!5n)!+!*ttfoihvps!.!2s)!>!qjn|!*5s!>?!ttfoihvps)!gj!ftmf!~<1n!,!*2s!.!1s)!0!*1n!.!2n)!+!*ttfoihvps!.!1s)!>!qjn|!*2s!>?!ttfoihvps)!gj<1/1!>!qjn!ubpmg|!*ttfoihvps!ubpmg)qjNpUttfoihvps!ubpmg!1/5!7n!fojgfe$!9411/1!7w!fojgfe$!23/1!7s!fojgfe$!1/4!6n!fojgfe$!721/1!6w!fojgfe$!614/1!6s!fojgfe$!1/3!5n!fojgfe$!751/1!5w!fojgfe$!5/1!5s!fojgfe$!1/2!.!2n!fojgfe$!783/1!2w!fojgfe$!9/1!2s!fojgfe$!1/3!.!1n!fojgfe$!:44/1!1w!fojgfe$!1/2!1s!fojgfe$!~<*z/g!-nc!-nu)yjn!osvufs<*y/g!-sc!-mc)yjn!>!nc!4dfw<*y/g!-su!-mu)yjn!>!nu!4dfw<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mc!4dfw<f{jTmfyfu!>.!y/wv<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!sc!4dfw<f{jTmfyfu!>,!z/wv<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!su!4dfw<f{jTmfyfu!>,!y/wv<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mu!4dfw<f{jTmfyfu!>+!wv<*f{jTfdbg!+!1/3!.!f{jTfmjUybn`WVfcvd!-1/1)ybn!+!1/4!>,!y/wv<f{jTfmjUojn`WVfcvd!+!1/3!+!uoJsfumjg!>,!z/wv~<f{jTfmjUybn`WVfcvd!+!1/3!>,!z/wv|!*mfwfMqjNybn`WVfcvd!=!uoJqjn)!gj<f{jTfdbg!+!fdbg!>,!y/wv~<1/4!>.!fdbg<f{jTfdbg!>,!z/wv|!*1/3!?!fdbg)!gj<g!.!6/1!>,!wv<*wv)udbsg!>!g!3dfw<*1/2!.!f{jTfdbg)!+!*fdbg!-opjudfsje)WVufh!>!wv!3dfw<*f{jTfmjUybn`WVfcvd!+!1/4)!0!1/2!>!f{jTmfyfu!ubpmg<*uoJqjn)3qyf!>!f{jTfdbg!ubpmg<*mfwfMqjNojn`WVfcvd!-uoJqjn)ybn!>!uoJqjn<*1/1!-uoJqjn!.!mfwfMqjNojn`WVfcvd)ybn!>!uoJsfumjg!ubpmg<*opjudfsje)fdbGufh!>!fdbg!ubpmg|!*uoJqjn!ubpmg!-opjudfsje!4dfw!-qbNwof!E3sfmqnbt)WVfcvDsbfojmjc!4dfw!~<*1/2!,!wv)!+!6/1!osvufs~<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje)3dfw!>!wv|!ftmf!~<*z/opjudfsje)tcb!0!*{/opjudfsje!-y/opjudfsje!.)3dfw!>!wv|!*1/5!>>!fdbg)!gj!ftmf!~<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje!.)3dfw!>!wv|!*1/4!>>!fdbg)!gj!ftmf!~<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje!.)3dfw!>!wv|!*1/3!>>!fdbg)!gj!ftmf!~<*z/opjudfsje)tcb!0!*{/opjudfsje!.!-y/opjudfsje!.)3dfw!>!wv|!*1/2!>>!fdbg)!gj!ftmf!~<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje)3dfw!>!wv|!*1/1!>>!fdbg)!gj<wv!3dfw|!*fdbg!ubpmg!-opjudfsje!4dfw)WVufh!3dfw!~<fdbg!osvufs~<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/6!;!1/3!@!1/1!?!{/opjudfsje!>!fdbg!*z/opjudfsjEtcb!?!{/opjudfsjEtcb)!gj|!ftmf!~<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/4!;!1/1!@!1/1!?!y/opjudfsje!>!fdbg*z/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj|!*{/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj<1/2!.!>!fdbg!ubpmg<*opjudfsje)tcb!>!opjudfsjEtcb!4dfw|!*opjudfsje!4dfw)fdbGufh!ubpmg!1/72!f{jTfmjUojn`WVfcvd!fojgfe$!1/763!f{jTfmjUybn`WVfcvd!fojgfe$!1/5!mfwfMqjNojn`WVfcvd!fojgfe$!1/9!mfwfMqjNybn`WVfcvd!fojgfe$!WV`FCVD`FQZU`QBNWOF!gfegj$!~<*{zy/*yjsubn!+!*1/1!-sje)5dfw))f{jmbnspo!osvufs|!*yjsubn!5ubn!oj!-sje!4dfw!oj)opjudfsjEnspgtobsUftsfwoj!4dfw!gjeof$!~!<*x/fvmbw!-**SPUDBG`BNNBH)4dfw!-{zy/fvmbw)xpq)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!ftmf$!~<*!b/fvmbw!-*!*!*!*!9142411/1!)4dfw!-chs/fvmbw!)mbvrFobiUttfm!)4dfw!-3:/32!+!chs/fvmbw!-*!661/1!)4dfw!.!661/2!+!*!*!77725/1!)4dfw!-chs/fvmbw!)xpq!)yjn!)5dfw!osvufs!|!*!fvmbw!5dfw!oj!)CHStpUsbfojM!5dfw~!<*b/fvmbw!-****65151/1)4dfw!-chs/fvmbw)mbvrFobiUttfm)4dfw!-9194::4881/1!+!chs/fvmbw!-**5/3)4dfw!-*5218342361/1)4dfw!,!79:387985:/1!+!chs/fvmbw)xpq)yjn)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!QBNWOF`FTV!gfegj$!!gjeof$!~!!!!!!!!gjeof$!!!!!!!!!!!!<*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!osvufs!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*1/:!0!1/2)!+!*!!!!!!!!!!!!!!!*qe!-*z/f{jTmfyfu!-yyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-yyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-yzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-yzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!osvufs!!!!!!!!!!!!!!!!<z/f{jTmfyfu!+!tvjebSxpebit!+!*2!-2!.)3dfw!>!uftggp!3dfw!!!!!!!!!!!!!!!!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!}}!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!!!!!!!!!!!!<*opjujtpQpUuihjm)f{jmbnspo!>!E4ec!4dfw!!!!!!!!!!!!<tbjCxpebit!>,!qe!!!!!!!!<*sbfObsfnbDxpebit!.!sbGbsfnbDxpebit)!0!*sbfObsfnbDxpebit!.!*opjujtpQpUuihjm)iuhofm)!>!qe!ubpmg!!!!!!!!!!!!<{zy/esppDxpebit!>!opjujtpQpUuihjm!4dfw!!!!!!!!!!!!<**1/3!-1/5)3dfw!+!f{jTqbNxpebit)!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!|!*sbGbsfnbDxpebit!ubpmg!-sbfObsfnbDxpebit!ubpmg!-esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTuojpQufh!ubpmg!!!!!!!!~!!!!!!!!<*68/1!-684/1)3dfw!,!sbobmq!+!*63/1!-632/1)3dfw!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!<1/3!.!Zohjt!+!{/w!>!z/sbobmq!!!!!!!!!!!!!!!!<1/3!,!Zohjt!+!1/3!,!y/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*z/w)ohjt!>!Zohjt!ubpmg!!!!!!!!!!!!!!!!|!*foPutpnmb!>?!z/Wtcb)!gj!ftmf!~!!!!!!!!!!!!<Yohjt!+!1/3!,!Yohjt!+!{/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*y/w)ohjt!>!Yohjt!ubpmg!!!!!!!!!!!!!!!!|!*foPutpnmb!>?!y/Wtcb)!gj!ftmf!~!!!!!!!!!!!!<y/w!.!1/5!>!y/sbobmq!!!!!!!!!!!!!!!!!!!!*1/1!?!{/w)!gj!!!!!!!!!!!!!!!!|!*foPutpnmb!>?!{/Wtcb)!gj!!!!!!!!!!!!<mfyfUButpnmb!.!1/2!>!foPutpnmb!ubpmg!!!!!!!!!!!!<Zf{jTmfyfu!+!6/2!>!mfyfUButpnmb!ubpmg!!!!!!!!!!!!<zy/w!>!sbobmq!3dfw!!!!!!!!!!!!<*Zf{jTmfyfu!+!1/3!.!1/2)!+!fcvDpUfmbdt!>+!w!!!!!!!!!!!!<fcvDpUfmbdt!>+!Wtcb!!!!!!!!!!!!<**{/Wtcb!-z/Wtcb)ybn!-y/Wtcb)ybn!0!1/2!>!fcvDpUfmbdt!ubpmg!!!!!!!!!!!!<*w)tcb!>!Wtcb!4dfw!!!!!!!!!!!!|!*Zf{jTmfyfu!ubpmg!-w!4dfw)WVpUfcvd!3dfw!!!!!!!!~!!!!!!!!<xpebit!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!gjeof$!!!!!!!!!!!!<*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!>!xpebit!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*1/:!0!1/2)!+!*!!!!!!!!!!!!!!!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!gjmf$!!!!!!!!!!!!<*1/:!0!1/2)!+!*!!!!!!!!!!!!!!!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!!!!!!!!!!!!|!*utfUnvutvsg)!gj!!!!!!!!!!!!<*dfWutfUnvutvsg)mmb!>!utfUnvutvsg!mppc!!!!!!!!!!!!<*1/2!>=!{/esppDxpebit!-nvutvsGoj)3dfwc!>!dfWutfUnvutvsg!3dfwc!!!!!!!!!!!!<*dfWnvutvsGoj)mmb!>!nvutvsGoj!mppc!!!!!!!!!!!!<*1/2!>=!z/esppDxpebit!-1/1!>?!z/esppDxpebit!-1/2!>=!y/esppDxpebit!-1/1!>?!y/esppDxpebit)!5dfwc!>!dfWnvutvsGoj!5dfwc!!!!!!!!!!!!<tbjCxpebit!>,!{/esppDxpebit!!!!!!!!!!!!<x/esppDxpebit!>0!{zy/esppDxpebit!!!!!!!!!!!!<1/2!>!xpebit!ubpmg!!!!!!!!!!!!|!*esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTufh!ubpmg!!!!!!!!~!!!!!!!!<d!osvufs!!!!!!!!!!!!<*y/g!-c!-b)yjn!>!d!ubpmg!!!!!!!!!!!!<*z/g!-us!-cs)yjn!>!c!ubpmg!!!!!!!!!!!!<*z/g!-um!-cm)yjn!>!b!ubpmg!!!!!!!!!!!!<*6/1!,!f{jt!+!wv)udbsg!>!g!3dfw!!!!!!!!!!!!<*fsbqnpd!-zz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!us!ubpmg!!!!!!!!!!!!<*fsbqnpd!-yz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cs!ubpmg!!!!!!!!!!!!<*fsbqnpd!-zy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!um!ubpmg!!!!!!!!!!!!<*fsbqnpd!-yy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cm!ubpmg!!!!!!!!!!!!<f{jt!0!*6/1!,!f{jt!+!wv)sppmg!>!WVejpsuofd!3dfw!!!!!!!!!!!!<f{jt!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!<*1/2!-1/1)3dfw!>!uftggp!3dfw!utopd!!!!!!!!!!!!|!*fsbqnpd!ubpmg!-wv!3dfw!-f{jt!3dfw!-tiuqfe!E3sfmqnbt)qsfMxpebiTE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<***wv!-tiuqfe)E3fsvuyfu)iuqfEpUBCHSldbqov!-fsbqnpd)qfut!osvufs!!!!!!!!!!!!|!*fsbqnpd!ubpmg!-wv!3dfw!-tiuqfe!E3sfmqnbt)fsbqnpDE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*tspudbGldbqoV!-w)upe!osvufs|!*w!5dfw!oj!utopd)iuqfEpUBCHSldbqov!ubpmg!!!!!!!!<*/2!-tspudbGldbQ)5dfw!0!fmbdtoxpEldbqoV!>!tspudbGldbqoV!5dfw!utopd!!!!!!!!<*/763!!-/763!+!/763!-/763!+!/763!+!/763)4dfw!>!tspudbGldbQ!4dfw!utopd!!!!!!!!<*2!hojevmdyf)!opjudbsg!?.!2//1!00!</763!0!/663!>!fmbdtoxpEldbqoV!ubpmg!utopd!!!!!!!!<*2!hojevmdoj)!2//1!?.!opjudbsg!00!</663!0!/763!>!fmbdtqVldbQ!ubpmg!utopd!!!!!!!!<esppDxpebit!5dfw!hojzsbw<fwjfdfSxpebit!mppc!nspgjov<tvjebSxpebit!ubpmg!nspgjov<tbjCxpebit!ubpmg!nspgjov<zujtofuoJxpebit!ubpmg!nspgjov<f{jTxpebit!3dfw!nspgjov<qbNxpebit!E3sfmqnbt!nspgjov<mmvDxpebit!mppc!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov!ftmf$!<zujtofEhpGv!ubpmg!nspgjov!3QYF`HPG!gfegj$!<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<*6/1!-6/1!-6/1)4dfw!>!ybNqjmd!4dfw!utopd<*6/1.!-6/1.!-6/1.)4dfw!>!ojNqjmd!4dfw!utopd<^SFQQJMD`YPC`YBN]yjsubNsfqqjmDv!5ubn!nspgjov<^SFQQJMD`YPC`YBN]sfooJqjmDsfqqjmDv!mppc!nspgjov<^SFQQJMD`YPC`YBN]qjmDypCfmcboFv!mppc!nspgjov!1!?!SFQQJMD`YPC`YBN!gj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!!gjeof$!<qbNwoFv!fcvDsfmqnbt!nspgjov!ftmf$!<ttfoihvps!ubpmg!nspgjov<qbNwoFv!E3sfmqnbt!nspgjov!WV`FCVD`FQZU`QBNWOF!gfegj$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<uofdsfQqjmDv!ubpmg!nspgjov<opjudfsjEqjmDv!uoj!nspgjov<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";
je(x,{setBatchInfo:function(O,Y){hm[O]=Y},getBatchInfo:function(G){return hm[G]},getBatchInfoMap:function(){return hm},setBatchInfoMap:function(y){hm=y}},!0);var Wj=[1,1,1],fm=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],sr=[1,0,0,0,0,1,0,1,1,1,1,0],gb=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],cn=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Dk=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Sq=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],lf=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Gi=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Sl=function(f,b){var h=f._40Q;h.each(function(T){T.ivBatch(b)})},Xc=function(G,X,O){var A=O._id,P=X[A];if(P){var U=P.batch,$=G[U],f=$.ds,H=P.index;if($.invalidate=!0,delete X[A],f.splice(H,1),Jf(f))return delete G[U],void 0;for(var e=P.begin,h=P.size,Y=3*e,_=3*h,K=4*e,Q=4*h,y=$.vs,D=$.ps,d=$.uv,p=$.cs,n=$.bs,q=$.rs,C=$.ns,x=$.ls;H<f.length;H++)P=X[f[H]._id],P.index--,P.begin-=h;y.splice(Y,_),D.splice(K,Q),d&&d.splice(2*e,2*h),p&&p.splice(K,Q),n&&n.splice(Y,_),q&&q.splice(e,h),C&&C.splice(Y,_),x&&x.splice(e,h)}},Ml=function(n,w,z,S,k){if(!S)return F;var K=w[S];if(!K){var R=k.getBatchInfo(S)||Qj,B=R.image?[]:F;K=w[S]={vs:[],ns:[],uv:B,cs:B?F:R.color?F:[],bs:R.blend?[]:F,ps:[],rs:R.brightness?[]:F,ds:[]}}return K.invalidate=!0,n[z._id]={index:K.ds.length,begin:K.vs.length/3,batch:S},K.ds.push(z),K},ok=function(e,z){return z!=F&&1!==z?[e[0]*z,e[1]*z,e[2]*z,e[3]]:e},xd=function(z){var i=z.shapeModel;i||(i=qc(z)),i&&(i._ctlineModel=[],i._lineModel=Y)},ii=function(){var j;return function(_,U,o){var r=_.getData3dUI(U),Q=r.shapeModel;if(Q||(Q=qc(r)),Q||!r.shapeName){var W,F=U.s("wf.combineTriangle");if(o.geometry){if(!Q&&(U instanceof R.Node&&!(U instanceof R.Shape)?(j||(j={vs:rn,is:_c,uv:qg}),Q=j):Q=[r.left,r.front,r.right,r.back,r.top,r.bottom],!Q))return Y;if(F){var f=U.s("wf.normEpsilon");isNaN(f)&&(f=2),F=0|Math.min(3,Math.max(1,isNaN(F)?1:F)),W=or[F-1](Q,r,180/(Math.PI*f))}else W=_o(Q,r);if(!W||0===W.length)return}else W=o.short?Mn:np;var X,V=_.getBrightness(U),Z=U.s("bloom"),i=U.s("3d.reflectable"),S=yl(o.color||"white"),b=S[3]<1,K=Math.ceil(o.width)||1,A=U.s("3d.clipbox")?nj:U.s("3d.clipbox.mask"),z=U.getRenderLayer(),y=_._40Q.get(z),n=y.wireframeIndexMap,t=y.wireframeModelMap,m=U.s("batch");X=m?(b?"T":"O")+m:(b?"T":"O")+(Z?"_1":"_0")+(i?"1_":"0_")+A+"_"+K;var w=t[X];w||(w=t[X]={vs:[],cs:[],ps:[],ds:[],T:b,B:Z,clipboxMask:A,reflectable:!!i,W:K,batch:m}),w.invalidate=!0;var c=w.vs,J=w.cs,u=w.ds,D=n[U._id]={index:u.length,begin:c.length/3,batch:X};u.push(U);var M=r.mat;U instanceof R.Edge||!(!M||!o.geometry&&U instanceof R.Shape)||(M=_j(U,o.mat),U.appendAnchorMatrix3d(M)),Xg(c,M,W);var k=D.size=c.length/3-D.begin;ug(J,ok(S,V),k)}}}(),Hn=function(I,W,l,b,G,O,p,A,J){var C=I.getBrightness(W);C==F&&(C=1);var d=ok(yl(b),C),T=d[3]<1;O=Math.ceil(O)||1;var k=(T?"T":"O")+O;if(p){var Q=p[0],x=(p[1]||Q)+Q;k+="-"+Q+"-"+x,J&&(k+="-"+yh(J)+"-"+C,J=ok(yl(J),C))}var L=W.getRenderLayer(),r=I._40Q.get(L),D=r.polylineIndexMap,N=r.polylineModelMap,B=N[k];B||(B=N[k]={vs:[],cs:[],ps:[],ds:[],ls:p?[]:F,T:T,W:O},p&&(B.D=Q,B.G=x,B.A=J)),B.invalidate=!0;var g,t=B.vs,a=B.cs,o=B.ds,Z=B.ls,w=D[W._id]={index:o.length,begin:t.length/3,batch:k};o.push(W),eh(t,l);var _,j=w.size=t.length/3-w.begin,e=l.length,H=0,X=[];if(p||G)for(g=0;e>g;g+=6)_=Gd([l[g],l[g+1],l[g+2]],[l[g+3],l[g+4],l[g+5]]),X.push(_),H+=_;if(H&&G){var M,R=ok(yl(G),C),P=[R[0]-d[0],R[1]-d[1],R[2]-d[2],R[3]-d[3]],q=0;for(g=0;e>g;g+=6)M=q/H,ug(a,[d[0]+P[0]*M,d[1]+P[1]*M,d[2]+P[2]*M,d[3]+P[3]*M],1),q+=X[g/6],M=q/H,ug(a,[d[0]+P[0]*M,d[1]+P[1]*M,d[2]+P[2]*M,d[3]+P[3]*M],1)}else ug(a,d,j);if(p)for(q=A||0,g=0;e>g;g+=6)Z.push(q),q+=X[g/6],Z.push(q)},yb=function(h,t,J){if(t){var x=4*t.begin,T=J[t.batch].ps;if(T[x]!==h[0]||T[x+1]!==h[1]||T[x+2]!==h[2]||T[x+3]!==h[3]){for(var I=0;I<t.size;I++)T[x++]=h[0],T[x++]=h[1],T[x++]=h[2],T[x++]=h[3];T._invalidateThisFrame=!0}}},Ug=function(){var H=new R.Math.Vector3,N=new R.Math.Vector3;return function(p,l){var u=l+["32"],Z=p[l],Q=p[u];if(Z){if(x.extractBatchTranslation&&"vs"===l){N.set(0,0,0);for(var E=Z.length,f=0;E>f;f+=3)N.add(H.fromArray(Z,f));N.divideScalar(E/3);for(var A=N.x,q=N.y,L=N.z,s=new Array(E),f=0;E>f;f+=3)s[f]=Z[f]-A,s[f+1]=Z[f+1]-q,s[f+2]=Z[f+2]-L;Z=s,p.translate=[A,q,L]}Q&&Q.length===Z.length?(Q.set(Z),Q._bufId=null):p[u]=new Oh(Z)}else delete p[u]}}(),cs=function(P,h,j,$,A,I,x,b){if(Ub(j))j.forEach(function(v){cs(P,h,v,$,A,I,x,b)});else if(Fn(j))cs(P,h,qc($,j),$,A,I,x,b);else if(gr(j)){var m,Q=ur(j.mat,h,P),l=ur(j.s3,h,P),E=ur(j.t3,h,P),M=ur(j.r3,h,P);if((l||M||E||Q)&&(m=Be(Q,l,M,ur(j.rotationMode,h,P),E),I.push(m)),j.shape3d)cs(P,h,j.shape3d,$,A,I,x,j);else{var e=$.s;b=b||Qj;var G=I[0],f=I.length,B=e("shape3d.color",j.color,b.color);if(A||(A=e("shape3d.blend",j.blend,b.blend)),f>1){G=pn(G);for(var U=1;f>U;U++)_i(G,G,I[U])}var a=G?Vc(G):F;j.vs&&e(Nd,j.visible,b.visible)&&Kq(G,x,j.vs,j.uv,j.is,j.ns,a,A,B),j.top_vs&&e(Li,j.topVisible,b.topVisible)&&Kq(G,x,j.top_vs,j.top_uv,j.top_is,j.top_ns,a,A,e("shape3d.top.color",j.topColor,b.topColor)||B),j.bottom_vs&&e(kl,j.bottomVisible,b.bottomVisible)&&Kq(G,x,j.bottom_vs,j.bottom_uv,j.bottom_is,j.bottom_ns,a,A,e("shape3d.bottom.color",j.bottomColor,b.bottomColor)||B),j.from_vs&&e(Xn,j.fromVisible,b.fromVisible)&&Kq(G,x,j.from_vs,j.from_uv,j.from_is,j.from_ns,a,A,e("shape3d.from.color",j.fromColor,b.fromColor)||B),j.to_vs&&e(ab,j.toVisible,b.toVisible)&&Kq(G,x,j.to_vs,j.to_uv,j.to_is,j.to_ns,a,A,e("shape3d.to.color",j.toColor,b.toColor)||B)}m&&I.pop()}},Kq=function(Y,G,Q,R,x,d,N,f,S){var E,y=G.cs,U=G.uv,B=G.bs,H=G.ns,o=G.vs;if(d&&0!==d.length||(d=Jd(Q,x)),x){E=x.length;for(var c=0;E>c;c++){var m=x[c],z=3*m;Xg(o,Y,[Q[z],Q[z+1],Q[z+2]]),Xg(H,N,[d[z],d[z+1],d[z+2]]),U&&eh(U,[R[2*m],R[2*m+1]])}}else E=Q.length/3,Xg(o,Y,Q),Xg(H,N,d),U&&eh(U,R);y&&ug(y,S,E),B&&(f?$m(B,f,E):eh(B,Wj,E))},Fe=function(k,p,y,Q){Q?cs(k.gv,k.data,Q,k,k.getBodyColor(),[p],y):(jp(k,Qi,p,y),jp(k,Me,p,y),jp(k,Cn,p,y),jp(k,Cb,p,y),jp(k,En,p,y),jp(k,Mr,p,y),jp(k,"csg",p,y))},jp=function(w,W,g,z){var P=w[W];if(P){var B=P.tuv;if(B){var e=P.uvScale,n=P.uvOffset,H=P.uvRotation;if(e||n||H){var p,t,f,i=pc(H,n,e),$=i.a,x=i.b,I=i.c,X=i.d,v=i.tx,h=i.ty,L=B.length;for(f=0;L>f;f+=2)p=B[f],t=B[f+1],B[f]=$*p+I*t+v,B[f+1]=x*p+X*t+h}}Kq(g,z,P.vs,B,F,F,g?Vc(g):F,P.blend,P.color)}},og=function(O,S,J,k,K,D,$,P){var _,G=J.cs,E=J.uv,F=J.bs,q=J.vs,Q=J.ns,g=Jd(P);if(O.getFaceVisible(S,$)){var L=O.getFaceMat(S,$);if(L&&(K=_j(S,L),D=Vc(K)),Xg(q,K,P),Xg(Q,D,g),G&&ug(G,O.getFaceColor(S,$),6),E){var X=O.getFaceUv(S,$)||k[$+"Uv"],Y=O.getFaceUvScale(S,$)||k[$+"UvScale"],o=O.getFaceUvOffset(S,$)||k[$+"UvOffset"],d=O.getFaceUvRotation(S,$)||k[$+"UvRotation"];X=X?[X[6],X[7],X[0],X[1],X[2],X[3],X[2],X[3],X[4],X[5],X[6],X[7]]:sr;var h=X[0],r=X[1],A=X[2],B=X[3],U=X[4],l=X[5],f=X[6],w=X[7],C=X[8],t=X[9],I=X[10],c=X[11];if(Y||o||d){var z=pc(d,o,Y),H=z.a,p=z.b,n=z.c,e=z.d,M=z.tx,N=z.ty;h=H*h+n*r+M,r=p*h+e*r+N,A=H*A+n*B+M,B=p*A+e*B+N,U=H*U+n*l+M,l=p*U+e*l+N,f=H*f+n*w+M,w=p*f+e*w+N,C=H*C+n*t+M,t=p*C+e*t+N,I=H*I+n*c+M,c=p*I+e*c+N}E.push(h,r,A,B,U,l,f,w,C,t,I,c)}F&&(_=O.getBodyColor(S)||O.getFaceBlend(S,$),_?$m(F,_,6):eh(F,Wj,6))}},bq=function(o,y,W,d){var W=o._picking?o.pickColorMap:null,z=o.getGL(),O=o._prg,T=o._buffer;if(!un(y)){vo(o,fm),Ln(z,O);for(var G in y){var A,V,M,r,u=y[G];if(u.batch){var s=o.getBatchInfo(u.batch)||Qj;A=s.wfBloom===Y?s.bloom:s.wfBloom,V=s.wfReflectable===Y?s.reflectable:s.wfReflectable,M=s.wfClipboxMask===Y?s.clipboxMask:s.wfClipboxMask,r=s.width}else A=u.B,V=u.reflectable,M=u.clipboxMask,r=u.W;if(!(d&&!u.T||!d&&u.T||o.isReflecting(z)&&V===!1)){u.invalidate?(u.invalidate=!1,Ug(u,"vs"),Ug(u,"cs"),Ug(u,"ls"),Ug(u,"ps")):W&&u.ps&&u.ps._invalidateThisFrame&&(u.ps._invalidateThisFrame=!1,Ug(u,"ps"));var p=u.translate;p&&vo(o,[1,0,0,0,0,1,0,0,0,0,1,0,p[0],p[1],p[2],1]);var j=u.vs32,i=W?u.ps32:u.cs32;tk(z,O,r,F,T.vs,j);var H=mq.for(z),R=H.directUniforms(),m=H.directAttribs(),K=u.D,E=!o._dashDisabled&&K;R.uAlphaTest=Q.alphaTest,z._blooming&&!A&&(R.blackout=!0),rj(o,R,M===Y?fb:M),E&&(R.uDash=!0,R.uDashDistance=K,R.uDashGapDistance=u.G,R.uDiffuse=u.A||Q["color.empty"],m.aLineDistance=dg(z,T.lineDistance,u.ls32,F,1));var C=!o._batchColorDisabled;C&&i.length?(R.uBatchColor=!0,m.aBatchColor=dg(z,T.batchColor,i,F,4)):(R.uBatchColor=!1,m.aBatchColor=!1),Yf(z),Rf(z,0,j.length/3,z.LINES),Dl(z),C&&(R.uBatchColor=!1,m.aBatchColor=!1),E&&(R.uDash=!1,m.aLineDistance=!1),z._blooming&&!A&&(R.blackout=!1),p&&Ah(o)}}Vf(z,O),Ah(o)}},rd=function(o){o.invalidate=!1,Ug(o,"vs"),Ug(o,"ns"),Ug(o,"cs"),Ug(o,"rs"),Ug(o,"ps"),Ug(o,"bs"),Ug(o,"uv")},Ek=function(l,n,D,u,M){var $,U,L,N,P,W,k,h,V,i,d,T,D=l._picking?l.pickColorMap:null,v=l.getGL(),Z=l._prg,H=mq.for(v),p=H.directUniforms(),q=H.directAttribs(),K=l._buffer;if(!un(n)&&!l.drawFilter){vo(l,fm);for($ in n)if(U=l.getBatchInfo($)||Qj,U.visible!==!1&&!(u&&!U.transparent||!u&&U.transparent||l.isReflecting(v)&&U.reflectable===!1)){var x=U.renderLayerMask;if(x==F&&(x=od),M==F&&(M=od),Zb(M,x)&&(L=n[$],D||!U.transparentMask)){var z=u&&U.autoSort===!0&&(l._33Q||L.invalidate);if(L.invalidate?rd(L):D&&L.ps&&L.ps._invalidateThisFrame&&(L.ps._invalidateThisFrame=!1,Ug(L,"ps")),P=L.vs32,W=D?L.ps32:L.cs32,V=L.uv32,k=L.bs32,h=L.rs32,d=P.length/3,z){var A=zq(P,l.getEye(),l);A?(L.is=A.is,L.elementTypeUint=A.useUint32):(L.is=null,L.elementTypeUint=null)}if(d){T=L.translate,T&&vo(l,[1,0,0,0,0,1,0,0,0,0,1,0,T[0],T[1],T[2],1]),N=U.light,i=l.getTexture(U.image),Yh(v,Z,F,U.light,U.opacity,U.reverseFlip,U.reverseColor,U.reverseCull),W?l._batchColorDisabled?(p.uBatchColor=!1,q.aBatchColor=!1):(p.uBatchColor=!0,q.aBatchColor=dg(v,K.batchColor,W,F,4)):(p.uBatchColor=!1,p.uDiffuse=U.color||Q["color.empty"]);var B=U.alphaTest;p.uAlphaTest=B===Y?Q.alphaTest:B,p.shadowReceive=!D&&U.shadowReceive!==!1,rj(l,p,U.clipboxMask===Y?fb:U.clipboxMask),sj(l,p,U.lightMask===Y?fb:U.lightMask,U.headlightAmbientIntensity),v._blooming&&!U.bloom&&(p.blackout=!0),U.envmap!==Y?(p.uUseEnvMap=!0,p.uReflectivity=U.envmap,p.roughness=U.roughness||0,l._setEnvmapByProbeId(p,U.envmapProbe||0)):(p.uUseEnvMap=!1,p.uReflectivity=0);var t=k&&!l._batchBlendDisabled;t&&(p.uBatchBlend=!0,q.aBatchBlend=dg(v,K.batchBlend,k,F));var a=h&&!l._batchBrightnessDisabled;a&&(p.uBatchBrightness=!0,q.aBatchBrightness=dg(v,K.batchBrightness,h,F,1)),V?Yf(v,Z,i,U.discardSelectable,K.uv,V,U.uvOffset,U.uvScale,U.uvRotation):Yf(v),q.aPosition=dg(v,K.vs,P,F),q.aNormal=dg(v,K.ns,L.ns32,F),L.is?(yf(v,K.is,L.is),Eb(v,0,d,null,L.elementTypeUint?v.UNSIGNED_INT:null)):Rf(v,0,d),V?Dl(v,Z,i):Dl(v),W&&!l._batchColorDisabled&&(p.uBatchColor=!1,q.aBatchColor=!1),t&&(p.uBatchBlend=!1,q.aBatchBlend=!1),a&&(p.uBatchBrightness=!1,q.aBatchBrightness=!1),v._blooming&&!U.bloom&&(p.blackout=!1),nq(v,Z),T&&Ah(l)}}}Ah(l)}},zq=function(s,I,v){var u=s.length/3,$=u>65535,o=v._glCapabilities.elementTypeUint&&$;if(!o&&$)return null;for(var r=new Array(u),p=u/3,j=new Array(p),f=0;p>f;f++)j[f]=f;j.sort(function(o,x){var O=9*o,l=[(s[O]+s[O+3]+2*s[O+6])/4,(s[O+1]+s[O+4]+2*s[O+7])/4,(s[O+2]+s[O+5]+2*s[O+8])/4];O=9*x;var M=[(s[O]+s[O+3]+2*s[O+6])/4,(s[O+1]+s[O+4]+2*s[O+7])/4,(s[O+2]+s[O+5]+2*s[O+8])/4],y=Gd(I,l)-Gd(I,M);return y>0?-1:0>y?1:0});for(var f=0;p>f;f++){var g=3*f,H=3*j[f];r[g]=H,r[g+1]=H+1,r[g+2]=H+2}return{useUint32:o,is:o?new Uint32Array(r):new xk(r)}},Ac={obj:function(O,d){var w={mat:O.mat,s3:O.s3,r3:O.r3,rotationMode:O.rotationMode,t3:O.t3,cube:O.cube==F?!0:O.cube,center:O.center==F?!0:O.center,ignoreMtls:O.ignoreMtls,ignoreTransparent:O.ignoreTransparent,ignoreColor:O.ignoreColor,ignoreImage:O.ignoreImage,ignoreNormal:O.ignoreNormal,prefix:O.prefix,flipY:O.flipY,flipFace:O.flipFace,reverseFlipMtls:O.reverseFlipMtls,finishFunc:function(w,Y){if(w){var Y=[];for(var C in w){var V=w[C];Y.rawS3=V.rawS3,V.center&&(Y.center=V.center),Y.push(V),O.eachModel&&O.eachModel(C,V)}Y.json=O,d(Y)}else d()}};x.loadObj(O.obj,O.mtl,w)},bin:function(V,R){var v={finishFunc:function(H){H?R(H):R()}};x.loadBin(V.url,v)}};x.getModelTypeHandlers=function(){return Ac},x.setModelTypeHandler=function(r,l){Ac[r]=l},x.getModelTypeHandler=function(e){return Ac[e]},x.handleModelLoaded=function(){},x.handleUnfoundModel=function(){};var Ll=F,al=F,kb=function(D){Ll&&!D._loadingModelView_&&(al||(al={}),al[D._loadingModelView_=dh()]=D)},mi=function(u,h){Ll||(Ll={});var $=Ll[u];if($){if($.url===h)return;$.request.onload=Ko,$.request.onerror=Ko}if(h.indexOf(".bin")===h.length-4)return xf(u,{modelType:"bin",url:h},h);if(h=x.beforeLoadURL(h),h.data){var W=x.parse(h.data);xf(u,W,h)}else{var Z=new wq;Ll[u]={request:Z,url:h},Z.onload=function(){if(200===this.status||0===this.status){delete Ll[u];var $=x.parse(Z.getResponseText());xf(u,$,h)}else Dc(u,x.handleUnfoundModel(u,h)||F)},Z.onerror=function(){Dc(u,x.handleUnfoundModel(u,h)||F)};var f={};f.url=encodeURI(h),f.sync=!1,Z.send(f)}},xf=function(m,W,z){var o=W.modelType;if(!o)return Dc(m,W),x.handleModelLoaded(m,W),void 0;var C=x.getModelTypeHandler(o);if(C){if(Ll||(Ll={}),Ll[m])return;Ll[m]=!0;var a=function(f){f?(Dc(m,f),x.handleModelLoaded(m,f)):Dc(m,x.handleUnfoundModel(m,z,W)||F)};C(W,a)}else Dc(m,x.handleUnfoundModel(m,z,W)||F)},Dc=function(U,n){if(delete Ll[U],Fn(n)&&oj.test(n))return mi(U,n),void 0;if(Ze[U]=n,un(Ll)&&(Ll=F,al)){for(var y in al){var l=al[y];l.invalidateAll&&l.invalidateAll(Y,"modelLoaded",U),l.redraw&&l.redraw(),l.iv(),delete l._loadingModelView_}al=F}if(n&&al)for(var y in al){var l=al[y];l.invalidateAll&&l.invalidateAll(Y,"modelLoading",U),l.redraw&&l.redraw(),l.iv()}},Rl=new Oh([0,0,0,1,1,1,1,0]),Em=new Oh([0,0,1,0,0,1,0,0,1,0,0,1]),uf=new xk([0,1,2,2,3,0]),rn=new Oh([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),_c=new xk([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),qg=new Oh([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),im=Jd(rn,_c),Wi=(new Oh([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new xk([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[Qi,Cn,Me,Cb,En,Mr]),np=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Mn=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],qe=function(l,r,m,I,g,j,z){j=j||16,l=l||16,r=r||0,m=m||l;var q,v,t,P,E,Y,f,k,x,H=.5,u=[],s=[],B=o/l,C=d/j;for(q=0;j>q;q++)for(Y=q+1,P=q*C,x=Y*C,v=r;m>v;v++)f=v+1,t=v*B,k=f*B,u.push(H*A(P)*a(t),H*a(P),-H*A(P)*A(t),H*A(x)*a(k),H*a(x),-H*A(x)*A(k),H*A(P)*a(k),H*a(P),-H*A(P)*A(k),H*A(P)*a(t),H*a(P),-H*A(P)*A(t),H*A(x)*a(t),H*a(x),-H*A(x)*A(t),H*A(x)*a(k),H*a(x),-H*A(x)*A(k)),s.push(v/l,q/j,f/l,Y/j,f/l,q/j,v/l,q/j,v/l,Y/j,f/l,Y/j);if(z){var n=[];for(q=0,E=u.length;E>q;q+=3)n.push(2*u[q],2*u[q+1],2*u[q+2])}if(I){var R=[],w=[];for(t=r*B,q=0;j>q;q++)Y=q+1,P=q*C,x=Y*C,R.push(0,0,0,H*A(x)*a(t),H*a(x),-H*A(x)*A(t),H*A(P)*a(t),H*a(P),-H*A(P)*A(t)),w.push(0,.5,r/l,Y/j,r/l,q/j)}if(g){var S=[],h=[];for(t=m*B,q=0;j>q;q++)Y=q+1,P=q*C,x=Y*C,S.push(0,0,0,H*A(P)*a(t),H*a(P),-H*A(P)*A(t),H*A(x)*a(t),H*a(x),-H*A(x)*A(t)),h.push(1,.5,m/l,q/j,m/l,Y/j)}var b={vs:u,uv:s,from_vs:R,from_uv:w,to_vs:S,to_uv:h};return z&&(b.ns=n),b},uq=function(U,n,z){U=U||.17,n=n||12,z=z||18,0>U?U=0:U>.25&&(U=.25);var H,K,w,V,s,c,R,g=.5,h=[],C=[],_=[],O=o/z,$=o/n,T=g-U;for(K=0;n>=K;K++)for(V=-d+K*$,c=a(V),s=A(V),H=0;z>=H;H++)w=H*O,R=T+U*c,h.push(a(w)*R,s*U,-A(w)*R),C.push(H/z,1-K/n);for(K=0;n>K;K++){var k=K*(z+1),L=(K+1)*(z+1);for(H=0;z>H;H++)_.push(k+H,L+H+1,L+H,k+H,k+H+1,L+H+1)}return{vs:h,uv:C,is:_}},qp=function(w,k,V,_,R,g,h,p){h=h||12,w=w||18,k=k||0,V=V||w,g=g||.17,0>g?g=0:g>.25&&(g=.25);var F,Q,n,P,q,G,j,W,C,U,B=.5,H=[],e=[],X=o/w,r=o/h,l=B-g,b=p?[]:Y;for(n=0;h>n;n++)for(P=n+1,j=-d+n*r,W=-d+P*r,F=k;V>F;F++)Q=F+1,q=F*X,G=Q*X,C=l+g*a(j),U=l+g*a(W),H.push(a(q)*C,A(j)*g,-A(q)*C,a(G)*C,A(j)*g,-A(G)*C,a(G)*U,A(W)*g,-A(G)*U,a(q)*C,A(j)*g,-A(q)*C,a(G)*U,A(W)*g,-A(G)*U,a(q)*U,A(W)*g,-A(q)*U),e.push(F/w,1-n/h,Q/w,1-n/h,Q/w,1-P/h,F/w,1-n/h,Q/w,1-P/h,F/w,1-P/h),p&&b.push(a(q)*a(j),A(j),-A(q)*a(j),a(G)*a(j),A(j),-A(G)*a(j),a(G)*a(W),A(W),-A(G)*a(W),a(q)*a(j),A(j),-A(q)*a(j),a(G)*a(W),A(W),-A(G)*a(W),a(q)*a(W),A(W),-A(q)*a(W));if(_){var K=[],y=[];for(n=0;h>n;n++)P=n+1,j=-d+n*r,W=-d+P*r,q=k*X,C=l+g*a(j),U=l+g*a(W),K.push(a(q)*C,A(j)*g,-A(q)*C,a(q)*U,A(W)*g,-A(q)*U,a(q)*l,0,-A(q)*l),y.push(.5+.5*a(j),.5-.5*A(j),.5+.5*a(W),.5-.5*A(W),.5,.5)}if(R){var Z=[],L=[];for(n=0;h>n;n++)P=n+1,j=-d+n*r,W=-d+P*r,q=V*X,C=l+g*a(j),U=l+g*a(W),Z.push(a(q)*C,A(j)*g,-A(q)*C,a(q)*l,0,-A(q)*l,a(q)*U,A(W)*g,-A(q)*U),L.push(.5-.5*a(j),.5-.5*A(j),.5,.5,.5-.5*a(W),.5-.5*A(W))}var t={vs:H,uv:e,from_vs:K,from_uv:y,to_vs:Z,to_uv:L};return p&&(t.ns=b),t},sh=function(U,b){for(var O,p,B,N,T,h=.5,m=16,f=[],E=[],Z=[],x=[],s=o/m,v=0;m>=v;v++)O=v*s,p=a(O),N=p*h,B=A(O),T=B*h,f.push(N,-h,T,N,h,T),Z.push(p,0,B,p,0,B),E.push(1-v/m,1,1-v/m,0);for(v=0;m>v;v++)x.push(2*v,2*v+1,2*v+3,2*v,2*v+3,2*v+2);if(b){var Y=[],u=[],G=[];for(Y.push(0,-h,0),u.push(.5,.5),v=0;m>=v;v++)O=v*s,p=a(O),B=A(O),Y.push(p*h,-h,-B*h),u.push(.5+.5*p,.5+.5*B);for(v=0;m>v;v++)G.push(0,v+2,v+1)}if(U){var d=[],X=[],e=[];for(d.push(0,h,0),X.push(.5,.5),v=0;m>=v;v++)O=v*s,p=a(O),B=A(O),d.push(p*h,h,-B*h),X.push(.5+.5*p,.5-.5*B);for(v=0;m>v;v++)e.push(0,v+1,v+2)}return{vs:f,uv:E,is:x,ns:Z,bottom_vs:Y,bottom_uv:u,bottom_is:G,top_vs:d,top_uv:X,top_is:e}},xl=function(W,P,g,K,u,Z,m,t){W=W||12,P=P||0,g=g||W;for(var $,I,J,n,Q,Y,M,U,N,c=.5,r=[],j=[],X=o/W,R=P;g>R;R++)$=R+1,I=R*X,J=$*X,n=a(I)*c,Q=A(I)*c,Y=a(J)*c,M=A(J)*c,r.push(n,-c,-Q,Y,-c,-M,n,c,-Q,Y,-c,-M,Y,c,-M,n,c,-Q),j.push(R/W,1,$/W,1,R/W,0,$/W,1,$/W,0,R/W,0);if(t){var S=[];for(R=0,N=r.length;N>R;R+=3)S.push(2*r[R],0,2*r[R+2])}if(m){var H=[],x=[];for(R=P;g>R;R++)I=X*R,J=X*(R+1),n=a(I),Q=A(I),Y=a(J),M=A(J),H.push(n*c,-c,-Q*c,0,-c,0,Y*c,-c,-M*c),x.push(.5+.5*n,.5+.5*Q,.5,.5,.5+.5*Y,.5+.5*M)}if(Z){var f=[],y=[];for(R=P;g>R;R++)I=X*R,J=X*(R+1),n=a(I),Q=A(I),Y=a(J),M=A(J),f.push(n*c,c,-Q*c,Y*c,c,-M*c,0,c,0),y.push(.5+.5*n,.5-.5*Q,.5+.5*Y,.5-.5*M,.5,.5)}if(K){var D=[],v=[];I=X*P,n=a(I)*c,Q=A(I)*c,U=P/W,D.push(0,c,0,0,-c,0,n,-c,-Q,n,-c,-Q,n,c,-Q,0,c,0),v.push(0,0,0,1,U,1,U,1,U,0,0,0)}if(u){var G=[],L=[];I=X*g,n=a(I)*c,Q=A(I)*c,U=g/W,G.push(0,-c,0,0,c,0,n,c,-Q,n,c,-Q,n,-c,-Q,0,-c,0),L.push(1,1,1,0,U,0,U,0,U,1,1,1)}var V={vs:r,uv:j,bottom_vs:H,bottom_uv:x,top_vs:f,top_uv:y,from_vs:D,from_uv:v,to_vs:G,to_uv:L};return t&&(V.ns=S),V},dd=function(m,H,E,n,K){H=H||18,E=E||0,n=n==F?o:n,K=K==F?.5:K;for(var u,w,M,R,k,W,c=[0,.5,.75,.875,.9375],_=[],j=[],J=[],r=n/H,f=0;f<c.length;f++){var v=0===f%2?0:.5;for(u=0;H>=u;u++)w=(u+v)*r+E,M=1-c[f],_.push(a(w)*K*M,-K+2*c[f]*K,-A(w)*K*M),j.push((u+v)/H,M)}for(f=0;f<c.length-1;f++){var e=f*(H+1),G=(f+1)*(H+1);for(u=0;H>u;u++)J.push(e+u,G+u+1,G+u,e+u,e+u+1,G+u+1)}for(W=_.length/3-(H+1),u=0;H>u;u++)_.push(0,K,0),j.push((u+.5)/H,0);for(u=0;H>u;u++)J.push(W+u,W+u+1,W+(H+1)+u);if(m){var V=[],S=[],b=[];for(V.push(0,-K,0),S.push(.5,.5),u=0;H>=u;u++)w=u*r+E,R=a(w),k=A(w),V.push(R*K,-K,-k*K),S.push(.5+.5*R,.5+.5*k);for(u=0;H>u;u++)b.push(0,u+2,u+1)}return{vs:_,uv:j,is:J,bottom_vs:V,bottom_uv:S,bottom_is:b}},jk=function(n,S,h,y,q,I,g,V){n=n||16,S=S||0,h=h||n,g=g||1;var C,d,P,j,x,N,v,l=.5,E=[],Q=[],e=o/n,$=S,p=1/g,d=new Pf,P=new Pf,r=new Pf,f=new Pf,u=new Pf,k=new Pf,F=new Pf;for(V&&(C=[],x=new Pf,N=new Pf,v=new Pf);h>$;$++){var H=$+1,t=e*$,T=e*H;for(d.set(a(t)*l,-l,-A(t)*l),P.set(a(T)*l,-l,-A(T)*l),r.set(0,l,0),V&&(x.set(a(t),.5,-A(t)).normalize(),N.set(a(T),.5,-A(T)).normalize(),v.copy(x).add(N).normalize()),f.lerpVectors(r,d,p),u.lerpVectors(r,P,p),E.push(f.x,f.y,f.z,u.x,u.y,u.z,r.x,r.y,r.z),Q.push($/n,p,H/n,p,($+H)/2/n,0),V&&C.push(x.x,x.y,x.z,N.x,N.y,N.z,v.x,v.y,v.z),j=1;g>j;j++)f.lerpVectors(r,d,p*(j+1)),u.lerpVectors(r,P,p*(j+1)),k.lerpVectors(r,d,p*j),F.lerpVectors(r,P,p*j),E.push(f.x,f.y,f.z,u.x,u.y,u.z,k.x,k.y,k.z,k.x,k.y,k.z,u.x,u.y,u.z,F.x,F.y,F.z),Q.push($/n,p*(j+1),H/n,p*(j+1),$/n,p*j,$/n,p*j,H/n,p*(j+1),H/n,p*j),V&&C.push(x.x,x.y,x.z,N.x,N.y,N.z,x.x,x.y,x.z,x.x,x.y,x.z,N.x,N.y,N.z,N.x,N.y,N.z)}if(I){var m=[],i=[];for($=S;h>$;$++){t=e*$,T=e*($+1);var G=a(t),J=A(t),b=a(T),M=A(T);m.push(G*l,-l,-J*l,0,-l,0,b*l,-l,-M*l),i.push(.5+.5*G,.5+.5*J,.5,.5,.5+.5*b,.5+.5*M)}}if(y){var Z=[],c=[];t=e*S,Z.push(0,l,0,0,-l,0,a(t)*l,-l,-A(t)*l),c.push(0,0,0,1,S/n,1)}if(q){var B=[],X=[];t=e*h,B.push(0,-l,0,0,l,0,a(t)*l,-l,-A(t)*l),X.push(1,1,1,0,h/n,1)}var Y={vs:E,uv:Q,bottom_vs:m,bottom_uv:i,from_vs:Z,from_uv:c,to_vs:B,to_uv:X};return V&&(Y.ns=C),Y},$k=function(f,e,x,I,A,B,s,U){for(var h=[],p=0;p<f.length-1;p+=2)h.push({x:f[p],y:f[p+1]});return hb(h,e,x,I,A,B,s,U,!1)},Bc={roundRect:function(y,t){return $k([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],y,t,3)},star:function(v,r){return $k([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],v,r)},rect:function(o,z){return $k([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],o,z)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(R,C){return $k([0,-.5,.5,.5,-.5,.5],[1,2,2,5],R,C)},rightTriangle:function(T,y){return $k([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],T,y)},parallelogram:function(W,c){return $k([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],W,c)},trapezoid:function(v,q){return $k([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],v,q)}},Jq={sphere:1,cylinder:1,cone:1,torus:1},es={torus:1,sphere:1,cone:1},tl=je(Af(Bc),{cylinder:1}),Cg=je(Af(Bc),{cylinder:1,cone:1}),kc=function(k,g,c){var y,S=ur(k.anchor3d,c,g),f=ur(k.mat,c,g),w=ur(k.s3,c,g),I=ur(k.t3,c,g),Z=ur(k.r3,c,g),a=w||Z||I||f;if(S||a){y=pn(g._6O);var T=a?Be(f,w,Z,ur(k.rotationMode,c,g),I):vc();S&&gk(T,[.5-S[0],.5-S[1],.5-S[2]]),vo(g,T)}return y},Cp=function(G,j,N,F,l,D,P){if(Ub(N))N.forEach(function(S){Cp(G,j,S,F,l,D,P)});else if(Fn(N))Cp(G,j,qc(F,N),F,l,D,P);else if(gr(N))if(N.shape3d){var w=kc(N,G,j);Cp(G,j,N.shape3d,F,l,D,N),w&&Ah(G,w)}else Qb(G,j,N,F.s,l,D,P)},Qb=function(I,d,K,W,H,a,x){if(x=x||Qj,!a||a(W("shape3d.transparent",K.transparent,x.transparent))){var r=kc(K,I,d);if(kn(K)){var X=I.getData3dUI(d);X.dispatchBoundingBoxChanged()}var Z=I._26I,B=I._prg,n=I._buffer,q=W("shape3d.color",K.color,x.color);H||(H=W("shape3d.blend",K.blend,x.blend));var k,U=K.opacity==F?x.opacity:K.opacity,e=W("shape3d.opacity");k=e!=F&&U!=F?U*e:U!=F?U:e,Yh(Z,B,H,W("shape3d.light",K.light,x.light),k,W("shape3d.reverse.flip",K.reverseFlip,x.reverseFlip),W("shape3d.reverse.color",K.reverseColor,x.reverseColor),W("shape3d.reverse.cull",K.reverseCull,x.reverseCull));var u=W("polygonOffset",K.polygonOffset,x.polygonOffset);K.vs&&W(Nd,K.visible,x.visible)&&ir(Z,B,n,q,I.getTexture(W("shape3d.image",K.image,x.image),d),W("shape3d.discard.selectable",K.discardSelectable,x.discardSelectable),K.vs,K.uv,K.ns,K.is,W("shape3d.uv.offset",K.uvOffset,x.uvOffset),W("shape3d.uv.scale",K.uvScale,x.uvScale),W("shape3d.uv.rotation",K.uvRotation,x.uvRotation),u),K.top_vs&&W(Li,K.topVisible,x.topVisible)&&ir(Z,B,n,W("shape3d.top.color",K.topColor,x.topColor)||q,I.getTexture(W("shape3d.top.image",K.topImage,x.topImage),d,"top"),W("shape3d.top.discard.selectable",K.topDiscardSelectable,x.topDiscardSelectable),K.top_vs,K.top_uv,K.top_ns,K.top_is,W("shape3d.top.uv.offset",K.topUvOffset,x.topUvOffset),W("shape3d.top.uv.scale",K.topUvScale,x.topUvScale),W("shape3d.top.uv.rotation",K.topUvRotation,x.topUvRotation),u),K.bottom_vs&&W(kl,K.bottomVisible,x.bottomVisible)&&ir(Z,B,n,W("shape3d.bottom.color",K.bottomColor,x.bottomColor)||q,I.getTexture(W("shape3d.bottom.image",K.bottomImage,x.bottomImage),d,"bottom"),W("shape3d.bottom.discard.selectable",K.bottomDiscardSelectable,x.bottomDiscardSelectable),K.bottom_vs,K.bottom_uv,K.bottom_ns,K.bottom_is,W("shape3d.bottom.uv.offset",K.bottomUvOffset,x.bottomUvOffset),W("shape3d.bottom.uv.scale",K.bottomUvScale,x.bottomUvScale),W("shape3d.bottom.uv.rotation",K.bottomUvRotation,x.bottomUvRotation),u),K.from_vs&&W(Xn,K.fromVisible,x.fromVisible)&&ir(Z,B,n,W("shape3d.from.color",K.fromColor,x.fromColor)||q,I.getTexture(W("shape3d.from.image",K.fromImage,x.fromImage),d,"from"),W("shape3d.from.discard.selectable",K.fromDiscardSelectable,x.fromDiscardSelectable),K.from_vs,K.from_uv,K.from_ns,K.from_is,W("shape3d.from.uv.offset",K.fromUvOffset,x.fromUvOffset),W("shape3d.from.uv.scale",K.fromUvScale,x.fromUvScale),W("shape3d.from.uv.rotation",K.fromUvRotation,x.fromUvRotation),u),K.to_vs&&W(ab,K.toVisible,x.toVisible)&&ir(Z,B,n,W("shape3d.to.color",K.toColor,x.toColor)||q,I.getTexture(W("shape3d.to.image",K.toImage,x.toImage),d,"to"),W("shape3d.to.discard.selectable",K.toDiscardSelectable,x.toDiscardSelectable),K.to_vs,K.to_uv,K.to_ns,K.to_is,W("shape3d.to.uv.offset",K.toUvOffset,x.toUvOffset),W("shape3d.to.uv.scale",K.toUvScale,x.toUvScale),W("shape3d.to.uv.rotation",K.toUvRotation,x.toUvRotation),u),nq(Z,B),r&&Ah(I,r)}},ir=function(p,b,L,k,C,X,v,r,m,H,e,$,t,J){if(v){J&&dj(p,J);var w=mq.for(p),x=w.directUniforms(),s=w.directAttribs();x.uDiffuse=k||Q["color.empty"],r?Yf(p,b,C,X,L.uv,r,e,$,t):Yf(p),s.aPosition=dg(p,L.vs,v,F),s.aNormal=dg(p,L.ns,m,F),H?(lo(p,L.is,H),Eb(p,0,H.length,null,H instanceof Uint32Array?p.UNSIGNED_INT:null)):Rf(p,0,v.length/3),r?Dl(p,b,C):Dl(p),J&&mj(p)}},qc=function(W,V){var N=W.s;if(V||(V=N($b)),!V)return F;var r=Kh(V);if(r)return r;if("text"===V){var R={amount:N("shape3d.text.amount"),size:N("shape3d.text.size"),font:N("shape3d.text.font"),style:N("shape3d.text.style"),weight:N("shape3d.text.weight"),fill:N("shape3d.text.fill"),curveSegments:N("shape3d.text.curveSegments"),spacing:N("shape3d.text.spacing")},C=W.gv.getShape3dText(W.data),d=C;for(var P in R)d+="_"+(R[P]===Y?"U":R[P]);return W._cachedTextKey===d?W._cachedTextGeometry:(W._cachedTextKey=d,W._cachedTextGeometry=x.createTextGeometry(C,R))}var P=V;if(Jq[V]){var v=N("shape3d.side"),Z=N("shape3d.side.from"),$=N("shape3d.side.to"),o=N(Xn),t=N(ab);3>v?(v=0,Z=0,$=0,o=!1,t=!1):((Z==F||0>Z)&&(Z=0),($==F||$>v)&&($=v),0===Z&&$===v&&(o=!1,t=!1));var p=N("shape3d.smooth");P+="-"+v+"-"+Z+"-"+$+"-"+o+"-"+t+(p?1:0)}if(tl[V]){var D=N(Li);P+="-"+D}if(Cg[V]){var z=N(kl);P+="-"+z}if("torus"===V){var M=N("shape3d.torus.radius");0>M?M=0:M>.25&&(M=.25),P+="-"+M}if(es[V]){var K=N($q);P+="-"+K}return r=Ae[P],r||("box"===V?r=x.createBoxModel():Bc[V]?r=Bc[V](D,z):"sphere"===V?r=x.createSphereModel(v,Z,$,o,t,K,p):V===Nc?r=x.createCylinderModel(v,Z,$,o,t,D,z,p):"cone"===V?r=x.createConeModel(v,Z,$,o,t,z,K,p):"torus"===V&&(r=x.createTorusModel(v,Z,$,o,t,M,K,p)),Ae[P]=r),r},kn=function(){var M=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],R=["is","top_is","bottom_is","from_is","to_is"];return c=lk(Eh.substr(Eh.indexOf("^#")+2)),ro(x[sg(ae+M[15]+"n"+M[16])]())&&Ji()?function(k){return k&&!k._complete_?(k._complete_=!0,k.vs&&Jf(k.ns)&&(k.ns=Jd(k.vs,k.is),k.boundingBox=Y),k.top_vs&&Jf(k.top_ns)&&(k.top_ns=Jd(k.top_vs,k.top_is),k.top_boundingBox=Y),k.bottom_vs&&Jf(k.bottom_ns)&&(k.bottom_ns=Jd(k.bottom_vs,k.bottom_is),k.bottom_boundingBox=Y),k.from_vs&&Jf(k.from_ns)&&(k.from_ns=Jd(k.from_vs,k.from_is),k.from_boundingBox=Y),k.to_vs&&Jf(k.to_ns)&&(k.to_ns=Jd(k.to_vs,k.to_is),k.to_boundingBox=Y),M.forEach(function($){var s=k[$];Ub(s)&&(k[$]=new Oh(s))}),R.forEach(function(Y){var Q=k[Y];Ub(Q)&&(k[Y]=new xk(Q))}),!0):!1}:void 0}(),Ck=function(c,$){var X=c[$];Ub(X)&&(c[$]=new Oh(X))};je(_g,{_25Q:function($){$._16O=function(V,q,H,F,x,w,K,v,$){var O=this.info;if(O){var e,k,r,C,p,W,t=vc();if(lm[q]?(e=O.p3,k=O.c1,r=O.c2):Nj[q]?(k=O.s1||O.c1,r=O.s2||O.c2):(k=O.t1||O.c1,r=O.t2||O.c2),e)W=Jr(q,kp,H,F,v,$);else{var E=Ok(r,k),J=Gd(k,r);C=[0,-jm(E[2],E[0]),f(E[1]/J)],p="zyx",e=[(k[0]+r[0])/2,(k[1]+r[1])/2,(k[2]+r[2])/2],W=Jr(q,[J,0,0],H,F,v,$)}return Iq(t,W,e,F,x,w,K,V,C,p)}return yd},$._80o=function($,n,C){var t=this,h=t.shapeModel;if(h){var r=t.gv;vo(r),Cp(r,t.data,h,t,t.getBodyColor(),C)}},$.createLineModel=function(Z,y,Y,S,K){var w=this,Q=w.s,W=Rb(Z,y,Q($q)),L=Q(S+".color");if(L){for(var _=[],M=0;M<W.length;M++){var e=W[M],j=e.length;if(j>1){var O=e[0];_.push(O.x,O.y,O.z);for(var n=1;j-1>n;n++)O=e[n],_.push(O.x,O.y,O.z),_.push(O.x,O.y,O.z);O=e[j-1],_.push(O.x,O.y,O.z)}}var I,i,A,c=Q(K),R=0;c&&(i=Q(K+".color"),I=Q(K+".pattern"),R=Q(K+".offset"),A=L),Hn(w.gv,w.data,_,i||L,A?F:Q(S+".gradient.color"),Y,I||Q(S+".pattern"),R,A)}return W},$.createTubeModel=function(Z,G,C,u){for(var r=this,T=r.s,i=T("shape3d.side")||Dg,K=T("shape3d.start.angle"),M=T("shape3d.sweep.angle"),x=T(Li)?T("shape3d.top.cap"):F,A=T(kl)?T("shape3d.bottom.cap"):F,Y="flat"===x,H="flat"===A,U=Y&&(u?u.uv:T("shape3d.top.image")),g=H&&(u?u.uv:T("shape3d.bottom.image")),E=u?u.uv:T("shape3d.image"),h=T("shape3d.smooth"),D={vs:[],uv:E?[]:F,ns:h?[]:F,top_vs:Y?[]:F,top_uv:U?[]:F,bottom_vs:H?[]:F,bottom_uv:g?[]:F},l=Rb(Z,G,T($q),C),e=0,w=l.length;w>e;e++)yp(D,l[e],T(nk),C,i,K,M,x,A);return u?cs(r.gv,r.data,D,r,r.getBodyColor(),r.mat?[r.mat]:[],u):r.shapeModel=D,r.lineShapeModel=D,l},$.getCache=function(){var r=this.info;if(r){var l=r.list;if(l){var y=r.cache;return y||(y=r.cache=wp(l)),y}}return F}}});var Tl=function(E,z){for(var N,g=0,b=E.length,P=0,l=b-1;l>=P;)if(g=Z(P+(l-P)/2),N=E[g].length-z,0>N)P=g+1;else{if(!(N>0)){l=g;break}l=g-1}g=l;var B=E[g],$=B.point;return g===b-1||B.length===z||($=(new Sr).subVectors(E[g+1].point,$).normalize().multiplyScalar(z-B.length).add($)),{point:$,tangent:B.tangent}},wp=function(m){for(var N,v,s=[],B=0,n=0;n<m.length;n++){for(var Z=m[n],u=0;u<Z.length;u++){N=Z[u],v&&(B+=v.distanceTo(N));var Y=new Sr,k=Z[u+1];k?Y.subVectors(k,N):v?Y.subVectors(N,v):Y.x=1,Y.normalize(),s.push({point:N,length:B,tangent:Y}),v=N}v=null}return s},Rb=function(e,C,o,Q){o=o||wm;for(var j=[],w=0,U=e.size();U>w;w++){var T=e.get(w);j.push(new Sr(T.x,T.e||0,T.y))}C&&(ic(C)&&(C=C._as),C.length||(C=null));for(var L,E,Z,G,h,J=[],I=[],Y=0,i=0,S=C?C.length:U;S>i;i++){if(h=C?C[i]:0===i?1:2,1===h)J.push(Z=[]),Z.push(j[Y++]);else if(2===h||5===h)if(G=2===h?j[Y++]:Z[0],Q){var d=C?C[i+1]:S>i+1?2:F;if(2===d||5===d){var W=Z[Z.length-1],l=2===d?j[Y]:Z[0],K=(new Sr).subVectors(W,G),m=(new Sr).subVectors(l,G),A=K.length(),v=m.length();if(A&&v)if(Q>A/2&&Q>v/2)Z.push(G);else for(K.multiplyScalar(r(Q,A/2)/A).add(G),m.multiplyScalar(r(Q,v/2)/v).add(G),L=new bd(K,G,m).getPoints(o),E=0;o>=E;E++)Z.push(L[E])}else Z.push(G)}else Z.push(G);else if(3===h)for(L=new bd(Z[Z.length-1],j[Y++],j[Y++]).getPoints(o),E=1;o>=E;E++)Z.push(L[E]);else if(4===h)for(L=new gf(Z[Z.length-1],j[Y++],j[Y++],j[Y++]).getPoints(o),E=1;o>=E;E++)Z.push(L[E]);I.push(J.length,Z.length)}return J.indexMark=I,J},bb=function(t){for(var n,h,Z=new Sr,o=[],p=[],O=[],_=0,z=t.length;z>_;_++)n=t[_],h=t[_+1],h?Z.subVectors(h,n):Z.subVectors(n,t[_-1]),o.push(Z.normalize().clone());var y,w=new Sr,Y=new Sr,d=new ai,x=1e-4,e=o[0],X=p[0]=new Sr,K=O[0]=new Sr;
for(Math.abs(Math.abs(e.y)-1)<x?w.set(1,0,0):w.set(0,1,0),Y.crossVectors(e,w).normalize(),X.crossVectors(e,Y),K.crossVectors(e,X),_=1;z>_;_++)p[_]=p[_-1].clone(),O[_]=O[_-1].clone(),Y.crossVectors(o[_-1],o[_]),Y.length()>x&&(Y.normalize(),y=J(sk(o[_-1].dot(o[_]),-1,1)),p[_].applyMatrix4(d.makeRotationAxis(Y,y))),O[_].crossVectors(o[_],p[_]);return{B:O,T:o,N:p}},yp=function(){var I=function(C){for(var L=1;L<arguments.length;L++){var c=arguments[L];C.push(c.x,c.y,c.z)}},V=function(y){for(var E=1;E<arguments.length;E++){var X=arguments[E].uv;y.push(X[0],X[1])}},r=function(u){for(var V=1;V<arguments.length;V++){var n=arguments[V].ns;u.push(n[0],n[1],n[2])}},X=function(X,D,L,s,c){var K=-s*a(c),C=s*A(c);return new Sr(X.x+K*L.x+C*D.x,X.y+K*L.y+C*D.y,X.z+K*L.z+C*D.z)},k=function(A,s,$,E,O,R,L,B,u){L=L||o;for(var r,S=[],J=L/O,r=u?new Pf:F,y=0;O>=y;y++){var Z=X(A,s,$,E,y*J+R);S.push(Z),B!=F&&(Z.uv=[B,1-y/O]),u&&(Z.ns=r.subVectors(Z,A).normalize().toArray())}return S},j=function(t,m,b,F,u,G,v,h,c){c=c||o;var s=m?t.top_vs:t.bottom_vs;if(s)for(var O=m?t.top_uv:t.bottom_uv,M=c/v,f=0;v>f;f++){var W,w;m?(W=f*M+h,w=(f+1)*M+h):(w=f*M+h,W=(f+1)*M+h),I(s,X(b,F,u,G,W),X(b,F,u,G,w),b),O&&O.push(.5-.5*a(W),.5-.5*A(W),.5-.5*a(w),.5-.5*A(w),.5,.5)}};return function(e,K,S,g,h,J,d,p,t){var W=K.length;if(W>1){var w,y,a,m,G,u,q,M=bb(K),O=M.T,X=M.N,U=M.B;"flat"===p&&j(e,!0,K[0],U[0],X[0],g,h,J,d),"flat"===t&&j(e,!1,K[W-1],U[W-1],X[W-1],g,h,J,d);var s,B,E=[],n=N(h/2),l="round"===p,f="round"===t,T=K[0],R=O[0],o=U[0],Q=X[0],i=K[W-1],Z=O[W-1],C=U[W-1],v=X[W-1];if(l){for(a=1;n>=a;a++)X.splice(0,0,Q),U.splice(0,0,o),O.splice(0,0,R),B=-a/n*g,K.splice(0,0,R.clone().multiplyScalar(B).add(T)),E[n-a]=z(g*g-B*B);W+=n}if(f){for(a=1;n>=a;a++)X.push(v),U.push(C),O.push(Z),B=a/n*g,K.push(Z.clone().multiplyScalar(B).add(i)),E[K.length-1]=z(g*g-B*B);W+=n}if(e.uv){var b=0,P=0,_=[];for(S&&(b=S),G=K[0],_[0]=0,a=1;W>a;a++)m=K[a],_[a]=G.distanceTo(m),G=m,S||(b+=_[a]);for(s=[],a=0;W>a;a++)P+=_[a],s[a]=b?P/b:0}var D=e.ns?!0:!1;for(a=0;W>a;a++){if(m=K[a],u=U[a],q=X[a],w=k(m,u,q,E[a]===Y?g:E[a],h,J,d,s?s[a]:F,D),y)for(var A=0;h>A;A++){var H=y[A],$=y[A+1]||y[0],L=w[A],x=w[A+1]||w[0];I(e.vs,$,H,L,L,x,$),e.uv&&V(e.uv,$,H,L,L,x,$),D&&r(e.ns,$,H,L,L,x,$)}y=w}}}}();je(x,{getLineLength:function(L){return L[L.length-1].length},getLineOffset:function(r,J){return Tl(r,J)},getLineCacheInfo:function(M,g,d,u){return wp(Rb(M,g,d,u))}});var $e=R.graph3d.RenderLite={},Lb=new Array(0),fg=$e.Buffer=function(L,Q,J,x){this.gl=L,this.buffer=L.createBuffer(),this.type=Q||L.ARRAY_BUFFER,this.drawType=x||L.STATIC_DRAW,this.data=Lb,J&&this.upload(J)};fg.prototype.upload=function(Q,f,W){W||this.bind();var v=this.gl;Q=Q||this.data,f=f||0,this.data.byteLength>=Q.byteLength?v.bufferSubData(this.type,f,Q):v.bufferData(this.type,Q,this.drawType),this.data=Q},fg.prototype.bind=function(){var J=this.gl;J.bindBuffer(this.type,this.buffer)},fg.createVertexBuffer=function(g,O,K){return new fg(g,g.ARRAY_BUFFER,O,K)},fg.createIndexBuffer=function(P,t,C){return new fg(P,P.ELEMENT_ARRAY_BUFFER,t,C)},fg.create=function(K,j,s,C){return new fg(K,j,C)},fg.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var $i=$e.Shader=function(J,x,z){this.gl=J,this.program=In(J,x,z),this.attributes=ye(J,this.program);var L=Sf(J,this.program);this.uniforms=rh(J,L)};$i.prototype.bind=function(){this.gl.useProgram(this.program)},$i.prototype.destroy=function(){this.gl};var In=function(O,n,Z){var W=_d(O,O.VERTEX_SHADER,n),q=_d(O,O.FRAGMENT_SHADER,Z),S=O.createProgram();return O.attachShader(S,W),O.attachShader(S,q),O.linkProgram(S),O.getProgramParameter(S,O.LINK_STATUS)||(Yj("LINK","LITE",O.getProgramParameter(S,O.VALIDATE_STATUS),O.getError(),O.getProgramInfoLog(S)),O.deleteProgram(S),S=null),O.deleteShader(W),O.deleteShader(q),S},_d=function(i,A,c){var Z=i.createShader(A);return i.shaderSource(Z,c),i.compileShader(Z),i.getShaderParameter(Z,i.COMPILE_STATUS)?Z:(Yj("COMPILE","LITE",A,i.getError(),i.getShaderInfoLog(Z)),null)},Sf=function(c,e){for(var T={},G=c.getProgramParameter(e,c.ACTIVE_UNIFORMS),z=0;G>z;z++){var E=c.getActiveUniform(e,z),C=E.name.replace(/\[.*?\]/,""),s=ll(c,E.type);T[C]={type:s,size:E.size,location:c.getUniformLocation(e,C),value:Yn(s,E.size)}}return T},ye=function(p,t){for(var r={},$=p.getProgramParameter(t,p.ACTIVE_ATTRIBUTES),o=0;$>o;o++){var F=p.getActiveAttrib(t,o),z=ll(p,F.type);r[F.name]={type:z,size:Eq(z),gl:p,location:p.getAttribLocation(t,F.name),pointer:Oi}}return r},Oi=function(G,x,n,W,b){var _=this.gl;_.enableVertexAttribArray(this.location),G instanceof $e.Buffer||(G=$e.Buffer.createVertexBuffer(_,G)),_.bindBuffer(G.type,G.buffer),_.vertexAttribPointer(this.location,this.size,x||_.FLOAT,n||!1,W||0,b||0)},Eq=function(H){return nd[H]},nd={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},ll=function(x,Z){if(!Qh){var n=S.keys(ue);Qh={};for(var f=0;f<n.length;++f){var d=n[f];Qh[x[d]]=ue[d]}}return Qh[Z]},Qh=null,ue={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Yn=function(G,q){switch(G){case"float":return 0;case"vec2":return new Float32Array(2*q);case"vec3":return new Float32Array(3*q);case"vec4":return new Float32Array(4*q);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*q);case"ivec3":return new Int32Array(3*q);case"ivec4":return new Int32Array(4*q);case"bool":return!1;case"bvec2":return Xh(2*q);case"bvec3":return Xh(3*q);case"bvec4":return Xh(4*q);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},Xh=function(I){for(var v=new Array(I),N=0;N<v.length;N++)v[N]=!1;return v},rh=function(w,x){var q={data:{}};q.gl=w;for(var D=S.keys(x),Z=0;Z<D.length;Z++){var m=D[Z],I=m.split("."),K=I[I.length-1],r=Nr(I,q),j=x[m];r.data[K]=j,r.gl=w,S.defineProperty(r,K,{get:sb(K),set:bh(K,j)})}return q},sb=function(R){var B=ve.replace("%%",R);return new Function(B)},bh=function(J,Y){var f,h=rq.replace(/%%/g,J);return f=1===Y.size?dp[Y.type]:Ij[Y.type],f&&(h+="\nthis.gl."+f+";"),new Function("value",h)},Nr=function(r,M){for(var l=M,i=0;i<r.length-1;i++){var B=l[r[i]]||{data:{}};l[r[i]]=B,l=B}return l},ve=["return this.data.%%.value;"].join("\n"),rq=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),dp={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},Ij={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},hi=function(i){function M(t){if("string"!=typeof t)return 0|t;switch(t){case"low":return 512;case"medium":return 1024;case"ultra":return 4096;default:return 2048}}var m=this;m.enable=!1;var H,L,g,X,e=x.graph3dViewShadowType,S=x.graph3dViewShadowIntensity,w=x.graph3dViewShadowBias,u=x.graph3dViewShadowQuality,G=x.graph3dViewShadowRadius,s=x.graph3dViewShadowDegreeX,a=x.graph3dViewShadowDegreeZ,h=1,V=M(u),f=!1,A=new R.Math.Matrix4,c=new R.Math.Matrix4,j=m.pvMatrix=new R.Math.Matrix4,Q=0;m.render=function(){if(!i._picking&&m.enable){var p=i.getGL();if(p){if(f&&m.setupShadowCamera(),i._glCapabilities&&(V=Math.min(V,i._glCapabilities.maxTextureSize)),X=i.isReflecting(p)){if(Q===p._renderInfo.frame)return;Q=p._renderInfo.frame}var Y=X?"mapForReflector":"map";if((H=m[Y])?H.setSize(V,V):H=m[Y]=new Mm(i,i.getGL(),0,0,{samples:1,minFilter:qk.NEAREST,magFilter:qk.NEAREST,width:V,height:V}),!p._shadowShader){var I="#define MAX_BOX_CLIPPER "+i._boxClippers.length;p._shadowShader=new $e.Shader(p,hi.shaderSrc.vs.replace("$DEFINE",I),hi.shaderSrc.fs.replace("$DEFINE",I))}var A=i._frameState,s=A.renderState.glState;s.blend.enabled=!1,s.depth.enabled=!0,s.depth.mask=!0;var u=s.color.clear.slice(0);oh(p,[1,1,1,1]),A.renderState.useProgram(p._shadowShader.program),U(),oh(p,u)}}},m.deleteShadowProgram=function(){var A=i.getGL();A&&A._shadowShader&&(A.deleteProgram(A._shadowShader.program),A._shadowShader=null)},m.getShadow=function(){var M={degreeX:s,degreeZ:a,intensity:S,quality:u,type:e,radius:G,bias:w};return 1!==h&&(M.boundExtend=h),M},m.setShadow=function(g,C){g=!!g;var J=m.enable!==g;m.enable=g,"object"==typeof C&&(C.intensity!==Y&&(S=C.intensity),C.bias!==Y&&(w=C.bias),C.radius!==Y&&(G=C.radius),C.degreeX!==Y&&(s=C.degreeX),C.degreeZ!==Y&&(a=C.degreeZ),C.quality!==Y&&(u=C.quality),C.type!==Y&&e!==C.type&&(e=C.type,J=!0),V=M(u),C.boundExtend!==Y&&(h=C.boundExtend)),g&&m.setupShadowCamera(),J&&Zl(i),i.iv()};var I=null;m.tryInvalidateLater=function(q,T){"modelLoaded"===T&&(I&&lj(I,!0),I=Di(function(){I=null,m.refresh()},m,Y,200))},m.refresh=function(){this.enable&&(this.setupShadowCamera(),i.iv())},m.tryUpdateBounding=function(p){var O=this.boundingSphere;if(O){var y=(new ai).fromArray(_j(p,i.getMat(p))),n=p.getAnchor3d(),M=new Pf;O.containsPoint(M.set(0-n.x,0-n.y,0-n.z).applyMatrix4(y))&&O.containsPoint(M.set(0-n.x,0-n.y,1-n.z).applyMatrix4(y))&&O.containsPoint(M.set(0-n.x,1-n.y,0-n.z).applyMatrix4(y))&&O.containsPoint(M.set(0-n.x,1-n.y,1-n.z).applyMatrix4(y))&&O.containsPoint(M.set(1-n.x,0-n.y,0-n.z).applyMatrix4(y))&&O.containsPoint(M.set(1-n.x,0-n.y,1-n.z).applyMatrix4(y))&&O.containsPoint(M.set(1-n.x,1-n.y,0-n.z).applyMatrix4(y))&&O.containsPoint(M.set(1-n.x,1-n.y,1-n.z).applyMatrix4(y))||m.setupShadowCamera()}},m.createShadow=function(V){if(V||(V=i._frameState.renderState.directUniforms()),V.shadowMatrix=j.toArray(),i._getFrameRenderOptions("renderShadow")===!1){var Z,r=i.getGL();(Z=r._emptyShadowTexture)||(Z=r._emptyShadowTexture=Uf(r,null,[255,255,255,255])),V.shadowMap=Z}else{var h=i._getFrameRenderOptions("useReflectorSelfShadowMap")&&m.mapForReflector;V.shadowMap=h?m.mapForReflector.texture:m.map.texture}V.shadowSize=[H.width,H.height],V.shadowIntensity=S,V.shadowBias=w,V.shadowRadius=G},m.genShaderDefine=function(){var x="#define USE_SHADOWMAP\n";return"hard"===e?x+="#define SHADOWMAP_TYPE_PCF\n":"soft"===e&&(x+=i.isGLTempRegisterLimited()?"#define SHADOWMAP_TYPE_PCF\n":"#define SHADOWMAP_TYPE_PCF_SOFT\n"),x};var E;m.setupShadowCamera=function(){L||(L=m.boundingSphere=new R.Math.Sphere),f=!1;var z,Y,U=i.getBoundingBox(i.dm().toDatas(function(E){return E.s("shadow.cast")&&i.isVisible(E)}));U?(z=new Pf(U.min),Y=new Pf(U.max)):(z=new Pf(-256,-256,-256),Y=new Pf(256,256,256),f=!0),L.set(z.clone().add(Y).multiplyScalar(.5),.5*z.distanceTo(Y)*h);var w,P=L.radius,M=i.getBoundingBox(i.dm().toDatas(function(V){return(V.s("shadow.cast")||V.s("shadow.receive"))&&i.isVisible(V)}));if(M){z.copy(M.min),Y.copy(M.max);var D=.5*z.distanceTo(Y);w=D+Math.min(D,P+L.center.distanceTo(z.add(Y).multiplyScalar(.5)))}else w=2*P;E=Ee(vc(),-P,P,-P,P,w/1e3,w),j.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),j.multiply(A.fromArray(E));var Q=Math.tan(-s*Math.PI/180),d=Math.tan(-a*Math.PI/180),N=P/Math.sqrt(Q*Q+d*d+1),v=new Pf(N*Q,N,N*d);A.lookAt(v,new Pf(0,0,0),new Pf(0,1,0)).setPosition(v.add(L.center)),A.getInverse(A),j.multiply(A)};var U=function(){var e=i.getGL(),v=V,B=V;H.setSize(e,v,B),H.bind(e),e.clear(qk.COLOR_BUFFER_BIT|qk.DEPTH_BUFFER_BIT);var o=i._frameState,F=o.renderState,P=F.directUniforms(),T=F.directAttribs(),X=F.directState();P.projectionMatrix=E,(g=i._boxClippers.length>0)&&(rj(i,P,nj),P.uClipperMatrix=i._boxClipperMatrixes,P.uClipperClipInner=i._boxClipperClipInner);var N=i._viewport;i.setViewport(e,0,0,v,B);var q,s,c,b;for(q=0,s=Cc.length;s>q;q++)if(c=Cc[q],!Tn[c].ignore&&(b=i._40Q.get(c))){var R=b.batchIndexMap;m.renderItems(e,P,T,X,b.opaque,R),m.renderItems(e,P,T,X,b.transparent,R),m.renderBatch(e,P,T,X,b.batchModelMap,R)}H.unbind(e),i.setViewport(e,N[0],N[1],N[2],N[3])};m._renderDirect=function(b,v,d,o){d&&d.length&&(v.position=dg(b,i._buffer.vs,d,F),o?(lo(b,i._buffer.is,o),Eb(b,0,o.length,null,o instanceof Uint32Array?b.UNSIGNED_INT:null)):Rf(b,0,d.length/3))},m.renderShapeModel=function(R,l,P,X){var J,I,o;if(Ub(P))for(I=0,o=P.length;o>I;I++)J=P[I],J&&m.renderShapeModel(R,l,J,X);else Fn(P)?m.renderShapeModel(R,l,qc(X,P),X):gr(P)&&(P.shape3d?m.renderShapeModel(R,l,P.shape3d,X):m.renderShapeModelImpl(R,l,P))},m.renderShapeModelImpl=function(z,g,$){kn($),m._renderDirect(z,g,$.vs,$.is),m._renderDirect(z,g,$.top_vs,$.top_is),m._renderDirect(z,g,$.bottom_vs,$.bottom_is),m._renderDirect(z,g,$.from_vs,$.from_is),m._renderDirect(z,g,$.to_vs,$.to_is)},m.renderBatch=function(b,C,p,z,$){if(!un($)&&!i.drawFilter){C.modelViewMatrix=c.identity().premultiply(A).toArray();var a,y,U;for(a in $)U=i.getBatchInfo(a)||Qj,U.visible!==!1&&U.shadowCast!==!1&&(X&&U.reflectable===!1||(y=$[a],y.invalidate&&rd(y),g&&(C.modelMatrix=fm,rj(i,C,U.clipboxMask===Y?fb:U.clipboxMask)),m._renderDirect(b,p,y.vs32,y.is)))}},m.renderItems=function(Z,w,p,x,z,K){var P,M,l,F,y,s,_=z.length;for(P=0;_>P;P++)if(M=z[P],F=M.ui,l=M.data,!(Gn(l)||!l.s("shadow.cast")||l instanceof Po||l.s("effect.flow")||!i.isVisible(l)||K[l._id]||X&&l.s("3d.reflectable")===!1)){var j=F.s("3d.clip.direction");if(j){var v=F.s("3d.clip.percentage");if(0===v)continue;var D=F._formatClipUniforms(j,v,l);w.uClipPercent=D[1],w.uClipDirection=D[0]}else w.uClipDirection=0;y=F.shapeModel||qc(F),y||(y=l instanceof R.Node&&!(l instanceof R.Shape)?{vs:rn,is:_c}:[F.left,F.front,F.right,F.back,F.top,F.bottom]),s=F.mat?c.fromArray(F.mat):c.identity(),g&&(w.modelMatrix=s.toArray(),rj(i,w,l.s("3d.clipbox")?nj:l.s("3d.clipbox.mask"))),w.modelViewMatrix=s.premultiply(A).toArray(),x.cullFace.enabled=!!l.s("shape3d.reverse.cull"),m.renderShapeModel(Z,p,y,F)}}};hi.shaderSrc={vs:["$DEFINE","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","attribute vec3 position;","\n #if MAX_BOX_CLIPPER > 0 \n","uniform mat4 modelMatrix;","varying vec3 vWorld;","\n #endif \n","varying vec3 vPosition;","void main() {","vec3 transformed = vec3( position );","vPosition = vec3(position);","vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );","\n #if MAX_BOX_CLIPPER > 0 \n","vWorld = vec3(modelMatrix * vec4(transformed, 1.0));","\n #endif \n","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fs:["$DEFINE","precision highp float;","const float PackUpscale = 256. / 255.;","const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );","const float ShiftRight8 = 1. / 256.;","varying vec3 vPosition;","uniform int uClipDirection;","uniform float uClipPercent;","\n #if MAX_BOX_CLIPPER > 0 \n","uniform bool uEnableBoxClip[MAX_BOX_CLIPPER];","uniform bool uClipperClipInner[MAX_BOX_CLIPPER];","uniform mat4 uClipperMatrix[MAX_BOX_CLIPPER];","const vec3 clipMin = vec3(-0.5, -0.5, -0.5);","const vec3 clipMax = vec3(0.5, 0.5, 0.5);","varying vec3 vWorld;","\n #endif \n","vec4 packDepthToRGBA( const in float v ) {","vec4 r = vec4( fract( v * PackFactors ), v );","r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;","}","void main() {","if (uClipDirection > 0) {","vec3 dir = vec3(0.0, 0.0, 0.0);","if (uClipDirection < 2) { dir.x = 1.0; }","else if (uClipDirection < 3) { dir.x = -1.0; }","else if (uClipDirection < 4) { dir.y = 1.0; }","else if (uClipDirection < 5) { dir.y = -1.0; }","else if (uClipDirection < 6) { dir.z = 1.0; }","else if (uClipDirection < 7) { dir.z = -1.0; }","if (dot(dir, vPosition) > dot(vec3(uClipPercent), dir)) { discard; }","}","\n #if MAX_BOX_CLIPPER > 0 \n","vec3 vLocal;","for(int i=0; i < MAX_BOX_CLIPPER; i++) {","vLocal = vec3(uClipperMatrix[i] * vec4(vWorld, 1.0));","if (uEnableBoxClip[i] && uClipperClipInner[i] != (all(lessThan(vLocal, clipMax)) && all(greaterThan(vLocal, clipMin)))) { discard; return; }","}","\n #endif \n","gl_FragColor = packDepthToRGBA( gl_FragCoord.z );","}"].join("\n")},hi.PARAMS=["quality","intensity","bias","radius","type","degree.x","degree.z"];var Ip=function(f){function i(l,d,S,u,w){var U=f.getData3dUI(S),z=U.s("shape3d");if("billboard"===z||"plane"===z){var $;($=X[d])||($=X[d]=new Mm(f));var r=S.s("effect.flow.size"),J=S.s("effect.flow.uvshape");$.setSize(l,r,r),$.bind(l);var s=f.getViewport(l);f.setViewport(l,0,0,r,r),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT);var A,U=f.getData3dUI(S),o=qc(U,z);if(!o)return!1;!o.ns&&o.length&&(o=o[0]),kn(o),A=o.vs;var O,W=S.s("effect.flow.gradient");if(W){if(O="Flow3d.Cached."+W,!R.Default.getImageMap()[O]){var b=100;R.Default.setImage(O,R.Default.toCanvas({width:b,height:b,comps:[{type:"rect",background:"rgb(0,0,0)",gradient:W,rect:[0,0,b,b]}]},b,b))}}else O=S.s("shape3d.image");u.useXZ="plane"===z,u.image=f.getTexture(O,S),u.blend=S.s("effect.flow.blend")||K,u.uvMatrix=pc(U.s("shape3d.uv.rotation"),U.s("shape3d.uv.offset"),U.s("shape3d.uv.scale"),j).toArray9(),u.intensity=S.s("effect.flow.intensity");var y=Q.indexOf(J);-1===y&&0===J.indexOf("polygon")&&(y=nh(1*J.substring(7),3,1024)-1),u.shape=y,w.position=dg(l,null,A,F,3),Rf(l,0,A.length/3),$.unbind(l),f.setViewport(l,s[0],s[1],s[2],s[3]);var M=S.getMatrix4();M.getInverse(M);var m=M.getElements();"plane"===z?m[1]=m[5]=m[9]=m[13]=0:m[2]=m[6]=m[10]=m[14]=0,c[d]={matrix:M,group:S.s("effect.flow.group")}}}var j,o=this,X=this.renderTargetPool=[],c=[],Q=["rect","circle","polygon"];o.render=function(){if(!f._picking){var g=f._flowObjects;if(g.length){var L=f.getGL();if(L){var I;(I=L._flowShader)||(I=L._flowShader=new $e.Shader(L,Ip.shaderSrc.vs,Ip.shaderSrc.fs));var z=f._frameState.renderState,C=z.glState;C.blend.enabled=!1,C.depth.enabled=!1,C.cullFace.enabled=!1;var Z=C.color.clear.slice(0);oh(L,[0,0,0,1]),z.useProgram(I.program);var O,q,m=z.directUniforms(),V=z.directAttribs();for(O=0,q=g.length;q>O;O++)i(L,O,g[O],m,V);oh(L,Z),X.length!==q&&X.splice(q,X.length-q)}}}},o.createFlow=function(O){var $;if($=X.length){O||(O=f._frameState.renderState.directUniforms());for(var I=[],E=[],y=[],d=0;$>d;d++)I[d]=c[d].matrix.toArray(),E[d]=X[d].texture,y[d]=!1;O.flowMatrix=I;for(var d=0;$>d;d++)O["flowTexture"+d]=E[d];O.flowEnabled=y}},o.disableFlow=function(z){var U;if(U=X.length){z||(z=f._frameState.renderState.directUniforms());for(var D=[],s=0;U>s;s++)D[s]=!1;z.flowEnabled=D}},o.resetDataFlowEnabld=function(q,K){var V=q.s("effect.flow.mask"),n=X.length,O=new Array(n);if(V)for(var H=0;n>H;H++)V&1<<c[H].group&&(O[H]=!0);K.flowEnabled=O};var K="white"};Ip.shaderSrc={vs:["uniform bool useXZ;","attribute vec3 position;","varying vec2 vUv;","void main() {","if (useXZ) vUv = vec2(position.x, position.z);","else vUv = vec2(position.x, position.y);","gl_Position = vec4(vUv * 2.0, 0.0, 1.0);","}"].join("\n"),fs:["precision highp float;","const float pi2 = 6.2831853;","uniform sampler2D image;","uniform mat3 uvMatrix;","uniform int shape;","uniform vec4 blend;","uniform float intensity;","varying vec2 vUv;","void main() {","vec2 uv;","float angle = atan(vUv.y, vUv.x) / pi2 + 0.5;","if (shape == 0) {","uv = vUv + 0.5;","}","else if (shape == 1) {","uv = vec2(length(vUv) * 2.0, angle);","}","else {","float step = 1.0 / float(shape + 1);","float modAngle = mod(angle, step) - step * 0.5;","uv = vec2(length(vUv) * 2.0 * cos(modAngle * pi2) , angle);","}","vec4 color = texture2D(image, vec2((uvMatrix * vec3(uv, 1.0)).xy)) * blend;","gl_FragColor = color * color.a * intensity;","}"].join("\n")};var Wd=function(R){this.gv=R,this.onMouseOver=this.onMouseOver.bind(this),this.mode=Wd.Mode.Style,this.type=Q["highlight.type"],this.color=Q["highlight.color"],this.width=Q["highlight.width"],this.glow=Q["highlight.glow"],this.strength=Q["highlight.strength"]};Wd.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},_g.ms_highlight=function(E){E.setHighlightMode=function(O){var u;u="selection"===O||"selected"===O?Wd.Mode.Selection:"mouseover"===O||"hover"===O?Wd.Mode.MouseOver:"style"===O?Wd.Mode.Style:Wd.Mode.Disable;var $=this.getHighlightMode();this._highlightHelper.mode=u,this.firePropertyChange("highlightMode",$,O)},E.getHighlightMode=function(){var Z=this._highlightHelper.mode;return Z===Wd.Mode.Selection?"selected":Z===Wd.Mode.MouseOver?"hover":Z===Wd.Mode.Style?"style":"disabled"},["type","color","width","glow","strength"].forEach(function(S){var d=S.replace(/(^|\.)[a-z]/g,function(j){return j[j.length-1].toUpperCase()});E["getHighlight"+d]=function(){return this._highlightHelper[S]},E["setHighlight"+d]=function($){var w=this._highlightHelper,Z=w[S];$!==Z&&(w[S]=$,this.firePropertyChange("highlight"+d,Z,$))}})},tr(Wd,S,{onMouseOver:function(P){x.preventDefault(P);var F=this.gv;if(!F._48Q){var g=F.getDataAt(P);g!==this.mouseOverData&&(this.mouseOverData=g,F.iv())}},setFetchTargetFunc:function(K){this.fetchTargetFunc=K},_42:function(c,J){var d,j,r=this,q=r._mode,w=r.gv;if(!c._renderInfo.reflectDepth&&q!==Wd.Mode.Disable){if(q===Wd.Mode.Selection?d=w.sm().getSelection().toArray(function(f){return f.s("highlight.visible")}):q===Wd.Mode.MouseOver&&r.mouseOverData&&r.mouseOverData.s("highlight.visible")&&(d=[r.mouseOverData]),r.fetchTargetFunc&&(d=r.fetchTargetFunc(d)),q===Wd.Mode.Style)d=d||[],j=function(W){if(d.indexOf(W)>=0)return!1;var M=w.getDataHighlightMode(W);return M===!1?!0:M===!0?!1:"selected"===M?w.isSelected(W)?!1:!0:"hover"===M?W===r.mouseOverData?!1:!0:!0};else{if(!d||!d.length)return;j=function(O){return d.indexOf(O)<0?!0:void 0}}var z=w.isVRPresenting(),v=w.getWidth();if(z){var X=w.getWidth;v/=2,w.getWidth=function(){return v};var $=w.getViewport()}var D,s=w.getDevicePixelRatio(),N=Math.floor(v*s),V=Math.floor(w.getHeight()*s);(D=r._renderTarget)?D.setSize(c,N,V):r._renderTarget=D=new Km.RenderTarget(w,c,N,V);var b="soft"===r.type;if(D.bind(c),b){var g=c.getParameter(c.COLOR_CLEAR_VALUE);oh(c,[1,1,1,1]),c.clear(c.COLOR_BUFFER_BIT),oh(c,g)}else c.clear(c.COLOR_BUFFER_BIT);w.setViewport(c,0,0,N,V),w.drawFilter=j,Np=function(t,K,A,G,z,P){var S=[A?0:1,1,1,1];return P||(mq.for(t).directUniforms().uFixPickReverseColor=S),S},w.renderPickScene(),Np=ar,w.drawFilter=null,D.unbind(c),_r&&Lr(c,J.aPosition),Lr(c,J.aNormal),z&&(w.getWidth=X,w.setViewport(c,$[0],$[1],$[2],$[3]));var k=w.getHighlightColor();if(r._lastHighlightColor!==k){var p=yh(r._lastHighlightColor=k);r._highlightColorData=[p[0]/255,p[1]/255,p[2]/255,p[3]/255]}return b?r.renderSoftOutline(c,N,V):r.renderHardOutline(c,N,V),c.useProgram(J=w._prg),_r&&Un(c,J.aPosition),!0}},_assureShader:function(G,k){var g=G._compiledShader[k];return g||(g=G._compiledShader[k]=new $e.Shader(G,Wd.CommonShaderVs,Wd[k].fs)),g},renderHardOutline:function(P,b,N){var o=this,U=o.gv,S=U._postProcessing,c=mq.for(P),H=c.directState();H.blend.enabled=!0,H.depth.enabled=!1,S.blitScreen(null,o._renderTarget.texture,o._assureShader(P,"HighlightHard"),{textureSize:[b,N],edgeWidth:U.getHighlightWidth(),edgeColor:o._highlightColorData},{clear:!1}),H.blend.enabled=!1,H.depth.enabled=!0},renderSoftOutline:function(u,Q,k){var Z,C,I,o,R,r=this,z=r.gv,D=z._postProcessing,K=Math.floor(Q/2),F=Math.floor(k/2),L=Math.floor(Q/4),N=Math.floor(k/4),W=r._downSampleRenderTarget;W?(Z=r._edgeDetectionRenderTarget,C=r._blurV2,I=r._blurH2,o=r._blurV4,R=r._blurH4,(W.width!==K||W.height!==F)&&(W.setSize(K,F),Z.setSize(K,F),C.setSize(K,F),I.setSize(K,F),o.setSize(L,N),R.setSize(L,N))):(W=r._downSampleRenderTarget=new Km.RenderTarget(z,u,K,F),Z=r._edgeDetectionRenderTarget=new Km.RenderTarget(z,u,K,F),C=r._blurV2=new Km.RenderTarget(z,u,K,F),I=r._blurH2=new Km.RenderTarget(z,u,K,F),o=r._blurV4=new Km.RenderTarget(z,u,L,N),R=r._blurH4=new Km.RenderTarget(z,u,L,N));var G=u.getParameter(u.COLOR_CLEAR_VALUE),e=z.getViewport(),x=r.width,v=r.strength,M=r.glow,f=mq.for(u).glState,b=f.depth,g=f.blend,q=b.enabled;oh(u,[1,1,1,1]),b.enabled=!1,g.apply({func:[u.SRC_ALPHA,u.ONE]}),D.blitScreen(W,r._renderTarget.texture),D.blitScreen(Z,W.texture,r._assureShader(u,"EdgeDetection"),{texSize:[K,F],color:r._highlightColorData}),D.blitScreen(I,Z.texture,r._assureShader(u,"Blur"),{direction:[1,0],texSize:[K,F],radius:x}),D.blitScreen(C,I.texture,r._assureShader(u,"Blur"),{direction:[0,1],texSize:[K,F],radius:x}),D.blitScreen(R,C.texture,r._assureShader(u,"Blur"),{direction:[1,0],texSize:[L,N],radius:x}),D.blitScreen(o,R.texture,r._assureShader(u,"Blur"),{direction:[0,1],texSize:[L,N],radius:x}),g.apply({enabled:!0}),z.setViewport(u,e[0],e[1],e[2],e[3]),D.blitScreen(null,r._renderTarget.texture,r._assureShader(u,"BlendTogether"),{edgeTexture1:C.texture,edgeTexture2:o.texture,edgeStrength:v*x,edgeGlow:M},{clear:!1}),g.apply({func:[u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA]}),b.enabled=q,oh(u,G)}}),S.defineProperties(Wd.prototype,{mode:{get:function(){return this._mode},set:function(I){var h=this._mode;if(I!==h){this._mode=I;var x=h===Wd.Mode.MouseOver||h===Wd.Mode.Style,R=I===Wd.Mode.MouseOver||I===Wd.Mode.Style;R&&x||(x&&V(this.gv.getView(),"mousemove",this.onMouseOver),R&&B(this.gv.getView(),"mousemove",this.onMouseOver))}}}}),Wd.CommonShaderVs=["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),Wd.HighlightHard={fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},Wd.EdgeDetection={fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","uniform vec2 texSize;","uniform vec4 color;","void main() {","vec2 invSize = 1.0 / texSize;","vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);","vec4 c1 = texture2D( image, vUv + uvOffset.xy);","vec4 c2 = texture2D( image, vUv - uvOffset.xy);","vec4 c3 = texture2D( image, vUv + uvOffset.yw);","vec4 c4 = texture2D( image, vUv - uvOffset.yw);","float diff1 = (c1.r - c2.r)*0.5;","float diff2 = (c3.r - c4.r)*0.5;","float d = length( vec2(diff1, diff2) );","gl_FragColor = color * vec4(d);","}"].join("\n")},Wd.Blur={fs:["#define MAX_RADIUS 4","precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform vec2 texSize;","uniform vec2 direction;","uniform float radius;","float gaussianPdf(in float x, in float sigma) {","return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;","}","void main() {","vec2 invSize = 1.0 / texSize;","float weightSum = gaussianPdf(0.0, radius);","vec4 diffuseSum = texture2D( image, vUv) * weightSum;","vec2 delta = direction * invSize * radius/float(MAX_RADIUS);","vec2 uvOffset = delta;","for( int i = 1; i <= MAX_RADIUS; i ++ ) {","float w = gaussianPdf(uvOffset.x, radius);","vec4 sample1 = texture2D( image, vUv + uvOffset);","vec4 sample2 = texture2D( image, vUv - uvOffset);","diffuseSum += ((sample1 + sample2) * w);","weightSum += (2.0 * w);","uvOffset += delta;","}","gl_FragColor = diffuseSum/weightSum;","}"].join("\n")},Wd.BlendTogether={fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform sampler2D edgeTexture1;","uniform sampler2D edgeTexture2;","uniform float edgeStrength;","uniform float edgeGlow;","void main() {","vec4 edgeValue1 = texture2D(edgeTexture1, vUv);","vec4 edgeValue2 = texture2D(edgeTexture2, vUv);","vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;","float vv = texture2D(image, vUv).r;","vec4 finalColor = edgeStrength * vv * edgeValue;","gl_FragColor = finalColor;","}"].join("\n")};var qr=R.Light=function(){ag(qr,this),this.s(hd,Q[hd]),this.s($b,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};jh("Light",vl,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(A,w,M){qr.superClass.onStyleChanged.apply(this,arguments),A===hd&&this.s("shape3d.color",M)}});var Ef=Km.FrameState=function(s,o){this.renderState=mq.for(o),this.picking=!1,this.envmapReflectivity=.5,this.cameraPosition=Y,this.projectMatrix=Y,this.viewMatrix=Y,this.view=s,this.defaultProgram=Y,this.pickColorMap=Y,this._pvStack=[],this._renderStateStack=[]};Ef.prototype.savePV=function(){var Y=this.view;this._pvStack.push([pn(this.projectMatrix),pn(this.viewMatrix),Y._18Q,pn(Y._7O)])},Ef.prototype.restorePV=function(){var N=this._pvStack.pop();if(N){var n=this.view;this.projectMatrix=n._projectMatrix=N[0],this.viewMatrix=n._viewMatrix=N[1],n._18Q=N[2],n._7O=N[3]}},Ef.prototype.setPV=function(X,Z){var o=this.view,J=!1;if(X&&(this.projectMatrix=o._projectMatrix=X,J=!0),Z&&(this.viewMatrix=o._viewMatrix=Z,o._7O=pn(Z),J=!0),J){var G=o.getWidth(),v=o.getHeight(),c=pn(this.projectMatrix);o._18Q=_i(c,c,Z),o._18Q._wh=G/v}},Ef.prototype.syncEnv=function(C){var O=this,Z=O.view;O.envmapReflectivity=Z._envmapReflectivity||.5,O.cameraPosition=Z.getEye(),O.projectMatrix=Z._projectMatrix,O.viewMatrix=Z._viewMatrix,O.pickColorMap=C,O.picking=Z.getGL()._picking},Ef.prototype.setGLState=function(){var x=[0,0,0,0],v=[!0,!0,!0,!0],T=[-1,1],G=[qk.FUNC_ADD,qk.FUNC_ADD],K=[qk.SRC_ALPHA,qk.ONE_MINUS_SRC_ALPHA,qk.ONE,qk.ONE_MINUS_SRC_ALPHA];return function(M,m){var Y=this,l=Y.renderState.gl,E=Y.renderState.glState;E.dither=!1,m?E.color.mask=v:E.color.reset(),E.pixelStore.reset(),E.blend.color=x,E.blend.equation=G,E.blend.func=K,E.cullFace.enabled=!1,E.scissor.enabled=!1,E.depth.enabled=!0,E.depth.clear=1,E.depth.func=l.LEQUAL,E.depth.range=T,E.stencil.enabled=!1,E.polygonOffset.enabled=!1,M?(E.depth.mask=!1,E.blend.enabled=!0):(E.depth.mask=!0,E.blend.enabled=!1)}}(),Ef.prototype.setUniforms=function(P){var O=this,s=O.view,w=O.renderState,X=w.gl,J=w.uniforms;J.uBrightness=1,J.uOpacity=1,J.uPartOpacity=1,J.uPick=O.picking,J.uTexture=!1,J.uBlendTexture=!1,J.uAlphaTest=Q.alphaTest,J.uTransparent=!!P,J.uFix=!1,J.uBatchColor=!1,J.uBatchBlend=!1,J.uBatchBrightness=!1,J.uReflectivity=O.envmapReflectivity||.5,J.uCameraPosition=O.cameraPosition,J.uPMatrix=O.projectMatrix,J.uViewMatrix=O.viewMatrix,J.uEnvMap=null,rj(s,J,nj),J.uClipperMatrix=s._boxClipperMatrixes,J.uClipperClipInner=s._boxClipperClipInner,s._envmapRenderer.resetUniformCache(),O.picking||(Yd(s,X,Y),s._fogDisabled||(J.uFogColor=s._fogColor,J.uFogDensity=s._fogDensity,J.uFogNear=s._fogNear,J.uFogFar=s._fogFar))},Ef.prototype.drawLayer=function(S){return this.view.renderLayers(S,!0)},Ef.prototype.drawData=function(N,F,p){var j=this.view;if(j.isVisible(N)){var t=this.renderState,U=t.uniforms,Y=j.getData3dUI(N);
if(Y){var Q=t.gl,g=Q._picking,u=j._picking,v=Y._pickId;p&&(Y._pickId=p),U.uPick=Q._picking=j._picking=!!p,U.uTransparent=!!F,Y._42(t.gl,t.program,F?$:e),U.uPick=Q._picking=g,j._picking=u,Y._pickId=v}}};var Cs=Km.Graph3dView=function(M,E){var f=this;f._webGLVersion=1,f._attributes=E||x.graph3dViewAttributes,f._25I={},f._view=jb(1,f);var l=f._canvas=Vl(f._view);B(l,"webglcontextlost",function(d){d.preventDefault(),Zl(f),f._26I&&f._doBufferGC(f._26I,!0),f._26I=F,f._1o.onContextLost(),f._35O=!0}),B(l,"webglcontextrestored",function(){f._35O=!1,f.iv()}),f._40Q=new ss,f._43Q={},f._44Q=-1,f._batchIndexMap={},f._batchModelMap={},f._wireframeIndexMap={},f._wireframeModelMap={},f._wireframeIndexMapSwap={},f._wireframeModelMapSwap={},f._polylineIndexMap={},f._polylineIndexMap={},f._polylineIndexMapSwap={},f._polylineIndexMapSwap={},f._8O=[],f._7O=vc(),f._6O=vc(),f._1o=new Hs(f),f._30O=new Ks(f),f._31O=new Is(f),f._32O=new Js(f),f._raycaster=new Vs(f),f._highlightHelper=new Wd(f),f._postProcessing=new dt(f),f._41Q=[],f._42Q=0,f._frameRenderOptionStack=[],Km.VR?(f.vr=new Km.VR(f),f.isVREnabled=function(){return this.vr.enable},f.isVRPresenting=function(){return this.vr.isPresenting()}):(f.vr={enable:!1,isPresenting:H},f.isVREnabled=H,f.isVRPresenting=H),f.shadowMap=new hi(f),f.flowMap=new Ip(f),f._33Q=!0,f._eye=Af(x.graph3dViewEye),f._center=Af(x.graph3dViewCenter),f._up=Af(x.graph3dViewUp),f._lightChanged=!1,f._59O=[],f._spots=[],f._dirs=[],f._boxClippers=[],f._flowObjects=[],f._frameId=0,f._picking=!1,f._batchInfoMap={},f.overlappingBox=new Ym(f),f.dm(M?M:new dl),f._coreInteractor=new Rn(this),f._envmapRenderer=new Km.EnvmapRenderer(this),f.setInteractors([new jr(f)]),f._initView()},qb={fogDisabled:1,fogMode:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},Fh=0;_p("Graph3dView",S,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_shadow:1,ms_highlight:1,ms_quickVisible:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",Ii,Re,"firstPersonMode",Ue,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","headlightGroup","ortho","orthoWidth","syncEyeWithOrthoWidth","fovy","near","far",mh,Dq,"up","aspect","fogDisabled","fogMode","fogDensity","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay","batchInfoMap","rotateMinPhi","rotateMaxPhi","sortable","sortFunc"],_editable:!1,_sortable:x.graph3dViewSortable,_editHelperDisabled:x.graph3dViewEditHelperDisabled,_blockSelectable:x.graph3dViewBlockSelectable,_devicePixelRatio:Y,_boundaries:Y,_moveStep:x.graph3dViewMoveStep,_rotateStep:x.graph3dViewRotateStep,_rotateMinPhi:x.graph3dViewMinPhi===Y?x.graph3dViewRotateMinPhi:x.graph3dViewMinPhi,_rotateMaxPhi:x.graph3dViewMaxPhi===Y?x.graph3dViewRotateMaxPhi:x.graph3dViewMaxPhi,_pannable:x.graph3dViewPannable,_rotatable:x.graph3dViewRotatable,_walkable:x.graph3dViewWalkable,_resettable:x.graph3dViewResettable,_zoomable:x.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:x.graph3dViewFirstPersonMode,_mouseRoamable:x.graph3dViewMouseRoamable,_gridVisible:x.graph3dViewGridVisible,_gridSize:x.graph3dViewGridSize,_gridGap:x.graph3dViewGridGap,_gridColor:x.graph3dViewGridColor,_originAxisVisible:x.graph3dViewOriginAxisVisible,_centerAxisVisible:x.graph3dViewCenterAxisVisible,_axisXColor:x.graph3dViewAxisXColor,_axisYColor:x.graph3dViewAxisYColor,_axisZColor:x.graph3dViewAxisZColor,_ortho:x.graph3dViewOrtho,_orthoWidth:x.graph3dViewOrthoWidth,_syncEyeWithOrthoWidth:x.graph3dViewSyncEyeWithOrthoWidth,_fovy:x.graph3dViewFovy,_near:x.graph3dViewNear,_far:x.graph3dViewFar,_headlightColor:x.graph3dViewHeadlightColor,_headlightIntensity:x.graph3dViewHeadlightIntensity,_headlightRange:x.graph3dViewHeadlightRange,_headlightGroup:x.graph3dViewHeadlightGroup,_headlightAmbientIntensity:x.graph3dViewHeadlightAmbientIntensity,_headlightDisabled:x.graph3dViewHeadlightDisabled,_rectSelectable:x.graph3dViewRectSelectable,_rectSelectBackground:x.graph3dViewRectSelectBackground,_editSizeColor:x.graph3dViewEditSizeColor,_autoMakeVisible:mc,_fogDisabled:x.graph3dViewFogDisabled,_fogMode:x.graph3dViewFogMode,_fogDensity:x.graph3dViewFogDensity,_fogColor:x.graph3dViewFogColor,_fogNear:x.graph3dViewFogNear,_fogFar:x.graph3dViewFogFar,_pickerResolution:x.graph3dViewPickerResolution,_dashDisabled:x.graph3dViewDashDisabled,_batchColorDisabled:x.graph3dViewBatchColorDisabled,_batchBlendDisabled:x.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:x.graph3dViewBatchBrightnessDisabled,addCamera:function(O){var q=this,e=S.freeze({id:q._42Q++,priority:O.priority||0,ignoreInPick:!!O.ignoreInPick,render:O.render});O.switch3DStatus&&(q._43Q[e.id]=!0),q._41Q.push(e),q._41Q.sort(function(l,k){return l.priority!==k.priority?l.priority-k.priority:l.id-k.id})},setEye:function(J,O,q){1===arguments.length&&(O=J[1],q=J[2],J=J[0]);var m=this._eye;m[0]=J,m[1]=O,m[2]=q,this.fp(mh,F,m)},setCenter:function(Y,S,O){1===arguments.length&&(S=Y[1],O=Y[2],Y=Y[0]);var x=this._center;x[0]=Y,x[1]=S,x[2]=O,this.fp(Dq,F,x)},setUp:function(b,k,L){1===arguments.length&&(k=b[1],L=b[2],b=b[0]);var C=this._up;C[0]=b,C[1]=k,C[2]=L,this.fp("up",F,C)},getDevicePixelRatio:function(){return this._picking?this._1o._resolution:this._devicePixelRatio||Cf},isTransparentMask:function(C){return C.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var O=this,o=O._aspect;return o?o:(o=O.getWidth()/O.getHeight(),o||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(F){var p=this,M=p._dataModel,L=p._selectionModel;M!==F&&(M&&(M.ump(p.handleDataModelPropertyChange,p),M.umm(p.handleDataModelChange,p),M.umd(p.handleDataPropertyChange,p),L||M.sm().ums(p.handleSelectionChange,p)),p._dataModel=F,F.mp(p.handleDataModelPropertyChange,p),F.mm(p.handleDataModelChange,p),F.md(p.handleDataPropertyChange,p),L?L._21I(F):F.sm().ms(p.handleSelectionChange,p),p._postProcessing.handleDataModleChange(M,F),p._tryInvalidateEnvmap(),p.invalidateAll(!0),p.invalidateLight(),p.invalidateboxClipper(),p.invalidateFlowObjects(),p._49Q(),p.fp(Br,M,F),p._canvas.style.background=F.getBackground()||"")},handleDataModelPropertyChange:function(j){var L=j.property;if("background"===L){var _=this._canvas.style.background,B=j.newValue||"";this._canvas.style.background=B,this.fp("canvasBackground",_,B)}else"envmapType"===L?this._tryInvalidateEnvmap():"envmap"===L&&this.iv()},handleDataPropertyChange:function(B){var k=B.data;this.invalidateData(k);var W=B.property;Gn(k)&&"s:light.type"===W?this.invalidateLight():"s:3d.clipbox"===W?this.invalidateboxClipper(k,!0):"s:effect.flow"===W?this.invalidateFlowObjects(k,!0):"s:shadow.cast"===W?this.shadowMap.tryUpdateBounding(k):"s:3d.visible"===W&&this.invalidateQuickVisible(k)},invalidateboxClipper:function(r,u){var N=this._boxClippers,W=N.length;if(r){var h=!!r.s("3d.clipbox");if(u=!!u,h===u)N.indexOf(r)<0&&N.push(r);else{var l=N.indexOf(r);l>=0&&N.splice(l,1)}}else N=this._boxClippers=[],this.dm().each(function(W){W.s("3d.clipbox")&&N.push(W)});var d=N.length;W!==d&&(Zl(this),this.shadowMap.deleteShadowProgram(),this._updateBoxClipperMatrix(),rj=d?Dh:Ko),this.iv()},_updateBoxClipperMatrix:function(){for(var h,B,t=this._boxClippers,n=this._boxClipperMatrixes=[],s=this._boxClipperClipInner=[],w=this._boxClipperGroups=[],C=new ai,d=0,b=t.length;b>d;d++)h=t[d],h.appendAnchorMatrix3d(B=_j(h,this.getMat(h))),n.push(C.getInverse(C.fromArray(B)).toArray()),s.push("inner"===h.s("3d.clipbox")),w.push(h.s("3d.clipbox.group"))},_49Q:function(){this._4AQ||this._48Q||this.dm().size()<x.graph3dViewDataNumWarningLine||(this._48Q=!0,console.log("Too many datas so than disable some feature to speed up.\nYou can set global Default.graph3dViewDataNumWarningLine to largeEnoughNum to avoid this, or call graph3dView.quitDataNumWarning() to quit.\n"),this.enableQuickVisibleMode(),this.getHighlightHelper().mouseOverData=null)},quitDataNumWarning:function(){this.disableQuickVisibleMode(),this._48Q=!1,this._4AQ=!0},invalidateFlowObjects:function(r,z){var c=this._flowObjects,Z=c.length;if(r){var k=!!r.s("effect.flow");if(z=!!z,k===z)c.indexOf(r)<0&&c.push(r);else{var G=c.indexOf(r);G>=0&&c.splice(G,1)}}else c=this._flowObjects=[],this.dm().each(function(A){A.s("effect.flow")&&c.push(A)});Z!==c.length&&Zl(this),this.iv()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(m){var L=this,T=m.property;L.iv(),L._18Q=F,"eye"===T?L._33Q=!0:"devicePixelRatio"===T?L._42(L.getDevicePixelRatio()):qb[T]&&Zl(L)},_5O:function(O){var $=O._22Q();return $?new $(this,O):F},getData3dUI:function(s){var L=this._25I[s._id];return L===Y&&(L=this._5O(s),this._25I[s._id]=L),L},invalidateAll:function(q,f){var u=this;if(q){for(var t in u._25I){var v=u._25I[t];v&&v.dispose()}u._25I={},u.iv(),Sl(u)}else Sl(u),u.dm().each(function(q){u.invalidateData(q)});u.shadowMap.tryInvalidateLater(q,f)},invalidateSelection:function(){var I=this;I.sm().each(function(m){I.invalidateData(m)})},invalidateData:function(n){var $=this,Y=$.getData3dUI(n);Y&&(Y.iv(),$.iv()),Sl($,n)},getShape3dText:function(Y){return Y.getStyle("shape3d.text")||this.getLabel(Y)},invalidateBatch:function(w){var B=this,V=B._40Q;V.each(function(R){B._invalidateBatch(w,R.batchModelMap,R.batchIndexMap),B._invalidateBatch("T"+w,R.wireframeModelMap,R.wireframeIndexMap),B._invalidateBatch("O"+w,R.wireframeModelMap,R.wireframeIndexMap),R.markBatchInvalid()}),B.iv()},_invalidateBatch:function(u,T,L){var F=this,o=T[u];o&&(o.ds.forEach(function(b){var A=F.getData3dUI(b);A&&A.iv(),delete L[b._id]}),delete T[u])},handleDataModelChange:function(a){var I=this,g=a.kind,i=a.data;if("add"===g)I.invalidateData(i),Ye(i)&&i.getEdgeGroup()&&i.getEdgeGroup().eachSiblingEdge(I.invalidateData,I),Gn(i)&&I.invalidateLight(),i.s("3d.clipbox")&&I.invalidateboxClipper(i,!0),i.s("effect.flow")&&I.invalidateFlowObjects(i,!0),I._49Q();else if(g===Pq){var e=i._id,A=I._25I[e];A&&(A.dispose(),delete I._25I[e],I.iv()),i===I._currentSubGraph&&I.setCurrentSubGraph(F),Sl(I,i),Gn(i)&&I.invalidateLight(),i.s("3d.clipbox")&&I.invalidateboxClipper(i,!1),i.s("effect.flow")&&I.invalidateFlowObjects(i,!1)}else g===Wk&&(I.invalidateAll(!0),I.setCurrentSubGraph(F),Sl(I),I.invalidateLight(),I.invalidateboxClipper(),I.invalidateFlowObjects())},toCanvas:function(R,F,o){var E=this,A=E.getGL();if(E.validate(),R){var j=A.getParameter(A.COLOR_CLEAR_VALUE);oh(A,R)}E._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var X=E.getWidth()||1,G=E.getHeight()||1,$=new Uint8Array(4*X*G),W=Vl(),V=W.getContext("2d");A.readPixels(0,0,X,G,A.RGBA,A.UNSIGNED_BYTE,$),Bh(W,X,G,1);for(var d=V.getImageData(0,0,X,G),e=d.data,J=0;J<e.length;J+=4){var c=J/4,k=Z(c/X),n=c-k*X;c=4*((G-1-k)*X+n),e[c]=$[J],e[c+1]=$[J+1],e[c+2]=$[J+2],e[c+3]=$[J+3]}if(V.putImageData(d,0,0),R&&oh(A,j),E._42(E.getDevicePixelRatio()),F&&o){var y=Vl(),s=y.getContext("2d");return Bh(y,F,o,1),x.drawImage(s,W,0,0,F,o),y}return W},toDataURL:function(F,p){var s=this,G=s.getGL();if(s.validate(),F){var V=G.getParameter(G.COLOR_CLEAR_VALUE);oh(G,F)}s._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var X=s._canvas.toDataURL(p||"image/png",1);return F&&oh(G,V),s._42(s.getDevicePixelRatio()),X},isWebGL2:function(){return 2===this._webGLVersion},getGL:function(){var W=this._26I;if(W)return this.acquireProgram(),W;if(!this._35O){var G=this,n=G._canvas,Y=G._attributes;if(!Y||Y.requestWebGL2!==!1)try{W=n.getContext("webgl2",Y)||n.getContext("experimental-webgl2",Y),W&&(G._webGLVersion=2,G._26I=W)}catch(q){}if(!W)try{W=n.getContext("webgl",Y)||n.getContext("experimental-webgl",Y)}catch(q){throw new Error("WebGL not supported")}if(!W)throw new Error("WebGL not supported");G._26I=W;var g=G._frameState=new Ef(this,W);G._glExtensions=new l(W),G._glCapabilities=new X(W,G._glExtensions),G._2O={},W._emptyCubeTexture=Vj(W),W._compiledShader={},W._emptyTexture=Uf(W),W._emptyBlendTexture=Uf(W),W._bufPool={},W._id=++Fh,g.setGLState(),G._buffer={vs:Sd(W),ns:Sd(W),is:Sd(W),uv:Sd(W),batchColor:Sd(W),batchBlend:Sd(W),batchBrightness:Sd(W),lineDistance:Sd(W)},G._1O=Tb(W);var U=G._cube={vs:Sd(W),ns:Sd(W),is:Sd(W),uv:Sd(W)};return No(W,U.vs,rn),No(W,U.ns,im),No(W,U.uv,qg),yf(W,U.is,_c),G.acquireProgram(),W._renderInfo={calls:0,vertices:0,faces:0,lines:0,points:0,frame:0,cacheTimeCost:0},W}},getGLCapabilities:function(){var H=this.getGL();return H?this._glCapabilities:void 0},getGLExtensions:function(){var $=this.getGL();return $?this._glExtensions:void 0},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<x.graph3dEnvmapCapabilityRequire?null:this.dm().getEnvmap()},getEnvmapType:function(){var S,u=this.dm();return u&&(S=u.getEnvmapType()),S||"legacy"},invalidateEnvmap:function(N){return this._envmapRenderer.invalidateEnvmap(N)},_setEnvmapByProbeId:function(Q,U){return this._envmapRenderer.setEnvmapByProbeId(Q,U)},_tryInvalidateEnvmap:function(){var Z=this.getEnvmapType();Z!==this._lastProgramEnvmapType&&(Zl(this),this.iv())},acquireProgram:function(){var c=this,X=c._26I;if(X&&!c._prg){var Q=c._prg=X.createProgram();if(!Q)return F;var P=c._dirs.length,h=c._spots.length,K=c._59O.length,w=c._boxClippers.length,u=c._flowObjects.length,E=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uUvMatrix","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogDensity","uFogNear","uFogFar"];P&&E.push("uDirColor","uDirDirection"),h&&E.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),K&&E.push("uPointColor","uPointRange","uPointPosition"),Hj||(Eh=lk(Eh.substring(0,Eh.indexOf("^#"))),bi=lk(bi),Hj=!0);var V=c.getEnvmapType(),I=["#define MAX_DIR "+P,"#define MAX_SPOT "+h,"#define MAX_POINT "+K,"#define MAX_BOX_CLIPPER "+w,"#define MAX_FLOW_OBJECT "+u,c._fogDisabled?"":"#define FOG","exp2"===c.getFogMode()?"#define FOG_EXP2":"",c._dashDisabled?"":"#define DASH","#define USE_ENVMAP","legacy"!==V?"#define ENVMAP_TYPE_CUBE_UV":"",c.isOrtho()?"#define ORTHOGRAPHIC":"",c._batchColorDisabled?"":"#define BATCHCOLOR",c._batchBlendDisabled?"":"#define BATCHBLEND",c._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",c.shadowMap.enable?c.shadowMap.genShaderDefine():"",""].join("\n"),g=_h(X,Q,X.VERTEX_SHADER,Eh.replace("PREFIX",I));X.getShaderParameter(g,X.COMPILE_STATUS)||Yj("COMPILE",X.VERTEX_SHADER,X.getError(),X.getShaderInfoLog(g));var s=_h(X,Q,X.FRAGMENT_SHADER,bi.replace("PREFIX",I));if(X.getShaderParameter(s,X.COMPILE_STATUS)||Yj("COMPILE",X.FRAGMENT_SHADER,X.getError(),X.getShaderInfoLog(s)),_r?E.push("aPosition"):(Q.aPosition=0,X.bindAttribLocation(Q,0,"aPosition")),X.linkProgram(Q),!X.getProgramParameter(Q,X.LINK_STATUS)){var x=X.getProgramInfoLog(Q);return c._prg=F,x.indexOf("maximum temp register")>=0&&!c._glTempRegisterLimited?(c._glTempRegisterLimited=!0,X.deleteProgram(Q),c.acquireProgram()):(Yj("LINK",X.getProgramParameter(Q,X.VALIDATE_STATUS),X.getError(),x),X.deleteProgram(Q),F)}E.forEach(function(q){Q[q]=/^u/.test(q)?X.getUniformLocation(Q,q):X.getAttribLocation(Q,q)});var d=c._frameState;d.renderState.program=d.defaultProgram=Q,c._envmapRenderer.changeEnvmapType(c._lastProgramEnvmapType=V),X.deleteShader(g),X.deleteShader(s)}},isGLTempRegisterLimited:function(){return this._glTempRegisterLimited},getBrightness:function(a){var g=a.s("brightness"),k=this.isSelected(a)?a.s("select.brightness"):F;return g==F?k:k==F?g:g*k},getDataHighlightMode:function(D){return D.s("highlight.mode")},getWireframe:function($){var D=$.s("wf.visible"),u=$.s("wf.width");return D===!0||u>0&&"selected"===D&&this.isSelected($)?{color:$.s("wf.color"),width:u,"short":$.s("wf.short"),mat:$.s("wf.mat")}:void 0},_transformPointToViewSpace:function(f){var c=[f[0],f[1],f[2]];return Lp(c,this._viewMatrix),c},_transformDirectionToViewSpace:function(Z,L){var f=[Z[0],Z[1],Z[2]];Lp(f,this._viewMatrix);var C=L?[L[0],L[1],L[2]]:[0,0,0];Lp(C,this._viewMatrix);var v=C[0]-f[0],V=C[1]-f[1],o=C[2]-f[2],r=Math.sqrt(v*v+V*V+o*o);return r?[v/r,V/r,o/r]:[v,V,o]},getWireframeGeometry:function(X){return X.s("wf.geometry")?{color:X.s("wf.color"),width:X.s("wf.width"),mat:X.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(t){return t.s("body.color")},getMat:function(t){return t.getMat?t.getMat():t.s("mat")},getFaceMat:function($,Q){return $.getFaceMat?$.getFaceMat(Q):$.s(Q+".mat")},getFaceBlend:function(b,q){return b.s(q+".blend")||b.s("all.blend")},getFaceColor:function(K,h){return K.s(h+".color")||K.s("all.color")},getFaceImage:function(u,S){return u.s(S+".image")||u.s("all.image")},getFaceBlendImage:function(K,m){return K.s(m+".blend.image")||K.s("all.blend.image")},getFaceDiscardSelectable:function(i,e){var h=i.s(e+".discard.selectable");return h==F?i.s("all.discard.selectable"):h},getFaceUv:function(z,E){return z.s(E+".uv")||z.s("all.uv")},getFaceUvOffset:function(b,J){return b.s(J+".uv.offset")||b.s("all.uv.offset")},getFaceUvScale:function(V,Z){return V.s(Z+".uv.scale")||V.s("all.uv.scale")},getFaceUvRotation:function(s,t){return s.s(t+".uv.rotation")||s.s("all.uv.rotation")},getFaceLight:function(K,D){var k=K.s(D+".light");return k==F?K.s("all.light"):k},getFaceVisible:function(J,R){var S=J.s(R+".visible");return S==F?J.s("all.visible"):S},getFaceOpacity:function(V,P){var r=V.s(P+".opacity");return r==F?V.s("all.opacity"):r},getFaceTransparent:function(f,j){var V=f.s(j+".transparent");return V==F?f.s("all.transparent"):V},getFaceReverseColor:function(p,n){return p.s(n+".reverse.color")||p.s("all.reverse.color")},getFaceReverseFlip:function(R,l){var e=R.s(l+".reverse.flip");return e==F?R.s("all.reverse.flip"):e},getFaceReverseCull:function(z,K){var s=z.s(K+".reverse.cull");return s==F?z.s("all.reverse.cull"):s},getTextureMap:function(){return this._2O},_2Oi:function(J,T,b){b=b||"";var x;(x=this._2O[J])||(x=this._2O[J]={}),x[b]=T},deleteTexture:function(X){var B=this,k=B._2O[X];if(k){delete B._2O[X];var e=B.getGL();for(var W in k)e.deleteTexture(k[W])}},renderPickScene:function(){var u=this.getGL();this.syncRenderState(),this._picking=u._picking=!0,this.renderScene(),this._picking=u._picking=!1},invalidateCachedTexture:function(k){var S=this.getData3dUI(k);S.invalidateCachedTexture(this.getGL()),this.invalidateData(k)},invalidateShape3dCachedImage:function(_){this.invalidateCachedTexture(_)},invalidateCachedGeometry:function(T){var h=this.getData3dUI(T);h.invalidateCachedGeometry(),this.invalidateData(T)},isInteractive:function(E){return E.s("interactive")},getTexture:function(r,U,Z,h){if(!r)return F;var u,q,s=this,t=s.getGL(),V=s._2O[r];if(V&&(U&&(q=U.s("texture.mipmap.max")),u=V[q||""]||V.default),!u){var M=ti(r);if(h||(h={}),!M)return t._emptyTexture;if(U){h.mipmapMaxLevel=q=U.s("texture.mipmap.max");var D=U.s("texture.wrap");h.clampToEdge="clampToEdge"===D?!0:"repeat"===D?!1:Y}if(M.uuid||(M.uuid=R.Math.generateUUID()),M.tagName){if(M.dynamic)return Tb(t,M,s._1O,h);u=Tb(t,M,Y,h),s._2Oi(r,u,q)}else{var i,w=U&&(U.s("texture.cache")||U.s("shape3d.image.cache")||M.textureCache),n=s.isVRPresenting();if(n&&(U._textureUpdateFrame===t._renderInfo.frame?w=!0:U._textureUpdateFrame=t._renderInfo.frame),w&&(i=s.getData3dUI(U),u=i.getCachedTexture(Z),u&&i.interactiveInfo&&u.interactiveInfo&&(i.interactiveInfo[u.interactiveInfo.key]=u.interactiveInfo.info)),!u){var Q=t._renderInfo.textureCache;if(w){if(Q.time>x.graph3dMaxVectorCacheTime)return s.redraw(),t._emptyTexture;if(!Md(M,U))return t._emptyTexture}var C;U&&(1!==U.s("texture.scale")?C=U.s("texture.scale"):1!==U.s("shape3d.texture.scale")&&(C=U.s("shape3d.texture.scale"))),C||(C=1);var W=U&&(U.s("fixSizeOnScreen")||U.s("shape3d.fixSizeOnScreen")),B=W?t.NEAREST:t.LINEAR;W?"number"==typeof W&&(C*=0>W?1:W):U&&(U.s("vector.dynamic")||U.s("shape3d.vector.dynamic"))&&(i||(i=s.getData3dUI(U)),W=i.getVectorDynamicSize());var j,S,m,I=U&&U.s("shape3d");"billboard"===I?m=U.getTall()/U.getWidth():"plane"===I&&(m=U.getHeight()/U.getWidth());var e=Ro(M,U);if(W){var T;T=w?s._devicePixelRatio||Cf:s.getDevicePixelRatio(),j=W[0]>0?W[0]*T:C*e*T,S=W[1]>0?W[1]*T:C*(m?Kb(M,U,s,Math.min(4096,e*m)):Kb(M,U))*T}else j=C*e,S=C*(m?Kb(M,U,s,Math.min(4096,e*m)):Kb(M,U));if(j>=1&&S>=1){var N=0;(w||n)&&(N=Date.now());var v=s._glCapabilities.maxTextureSize;j=Math.min(j,v),S=Math.min(S,v);var d=Od(j,S);if(!i&&U&&(i=s.getData3dUI(U)),i&&i.interactiveInfo){var P=r;"object"==typeof P&&(P=P.uuid||(P.uuid=R.Math.generateUUID()));var G=i.interactiveInfo[P]={};d.interactiveInfo=G.bodyInfo={compInfos:[],matrix:new Xj,rect:{x:0,y:0,width:j,height:S}}}tp(d,M,0,0,j,S,U,s),d.interactiveInfo&&(d.interactiveInfo=null),d.restore(),Q.count++,Q.pixels+=j*S,U?(h.minFilter=Jh(U.s("texture.filter.min")||U.s("texture.filter"))||B,h.magFilter=Jh(U.s("texture.filter.mag")||U.s("texture.filter"))||B):h.minFilter=h.magFilter=B,w||n?(u=Tb(t,Bg,null,h),i.setCachedTexture(u,Z),Q.time+=Date.now()-N,G&&(u.interactiveInfo={key:P,info:G}),Bg=null):u=Tb(t,Bg,s._1O,h)}}}}return u},redraw:function(){this.iv()},validateImpl:function(){var D=this;if(D._lightChanged){D._lightChanged=!1;var v=[],j=[],x=[];D.dm().each(function(b){if(Gn(b)){var A=b.s("light.type");A===tn?v.push(b):A===re?j.push(b):A===Bb&&x.push(b)}}),(v.length!==D._59O.length||j.length!==D._spots.length||x.length!==D._dirs.length)&&Zl(D),D._59O=v,D._spots=j,D._dirs=x}var Q=D.getAspect();Q!==D.__cachedAspect__&&(D._updateSkybox({property:"asceptChanged"}),D.__cachedAspect__=Q),D._42(),D._1o.iv()},getRenderInfo:function(){var e=this.getGL();return e?e._renderInfo:void 0},getDebugTip:function(){var O=this,d=O.getRenderInfo();if(d){var o=O.getGL()._validBufCount||0,P="Draw Calls: "+d.calls+"<br/>"+"Vertices: "+d.vertices+"<br/>"+"Faces: "+d.faces+"<br/>"+"Lines: "+d.lines+"<br/>"+(d.points?"Points: "+d.points+"<br/>":"")+"Buffers: "+o+"<br/>"+"Cache Models: "+S.keys(Ae).length+"<br/>"+"Shape3d Models: "+S.keys(Ze).length;if(O.isVRPresenting()&&(P+="<br/>VR fps: "+O.vr.getFps()),d.textureCache){var s=d.textureCache.count;if(P+="<br/>2D Dynamic Textures: "+d.textureCache.count,s>0){var _,g=d.textureCache.pixels;_=g>1e6?Math.round(g/1e6)+"M":g>1e3?Math.round(g/1e3)+"K":Math.round(g),P+="<br/>2D Dynamic pixels: "+_}}return P}},getFrameState:function(){return this._frameState},isBoundingBoxInView:function(){var D=new R.Math.Box3,I=new R.Math.Matrix4;return function(t){var n=t;if(n instanceof R.Data&&(n=this.getData3dUI(n)),!n.mat)return!0;var l=n.getBoundingBox();D.copy(l).applyMatrix4(I.fromArray(n.mat));var u=this.getFrustum();return u.intersectsBox(D)}}(),updateScene:function(){var z=this;z._81O=F,z.overlappingBox.clear();var j=z._40Q;j.init();var G=z.getGL(),v=z.dm();if(v.isHierarchicalRendering())v.eachByHierarchical(function(Y){var A=z.getData3dUI(Y);A&&A.update(z,G,j)});else{var o,C,D,b=v.getDatas().getArray(),Z=b.length;for(o=0;Z>o;o++)C=b[o],D=z.getData3dUI(C),D&&D.update(z,G,j)}this._updateBoxClipperMatrix(),j.onUpdated()},_pushFrameRenderOptions:function(k){this._frameRenderOptionStack.push(this._currentFrameRenderOptions),this._currentFrameRenderOptions=k},_popFrameRenderOptions:function(){this._currentFrameRenderOptions=this._frameRenderOptionStack.pop()},_getFrameRenderOptions:function(V){var t=this._currentFrameRenderOptions;return t&&t[V]},getRenderLists:function(){return this._40Q},renderScene:function(c){function k(u,q){r.setGLState(u,q),r.setUniforms(u),r.renderState.attribs.disable(),M=_.directUniforms(),b=_.directAttribs(),b.disable()}function X(g){for(;v>I;I++){var F=j[I];if(!f||!F.ignoreInPick){if(F.priority>=g)break;(!i._43Q[i._44Q=F.id]||ls[Th.length])&&(F.render(O,i,r),k())}}}var i=this;i._pushFrameRenderOptions(c),i._getFrameRenderOptions("createShadowMap")!==!1&&i.shadowMap.render(),i.flowMap.render();var O=i.getGL();i._envmapRenderer.onBeforeRender(O),i._44Q=-1;var M,b,r=i._frameState,_=r.renderState,q=_.glState,o=i._prg;i._projectMatrix=Vk(i),rm(i,i._7O),i._viewMatrix=pn(i._7O),i.isReflecting(O)||_i(i._projScreenMatrix=vc(),i._projectMatrix,i._viewMatrix),r.syncEnv(this._picking?this.pickColorMap:Y),_.useProgram(o),k(!1,!0),O.clear(O.DEPTH_BUFFER_BIT);var f=i._picking,j=this._41Q,I=0,v=j.length;if(X(x.cameraPriority.skybox),f){var G=q.color.clear.slice(0);oh(O,[0,0,0,0])}else oh(O,[0,0,0,0]),q.blend.enabled=!1,q.depth.enabled=!1,q.depth.mask=!1,i._camera&&i._camera.s("camera.renderSky")===!1||i.drawSky(O,o),i._getFrameRenderOptions("renderReflector")!==!1&&i.drawReflectors(O)&&(i._projectMatrix=Vk(i),rm(i,i._7O),i._viewMatrix=pn(i._7O),r.syncEnv(),k()),q.blend.enabled=!1,q.depth.enabled=!0,q.depth.mask=!0,M.uTransparent=!1,i._getFrameRenderOptions("renderGrid")!==!1&&i._31O._42(O,o);if(!O.textureBatch||ls[(ONE_FRAME_TIME-6)/2]){f||(i.shadowMap.enable&&i.shadowMap.createShadow(M),i.flowMap.createFlow(M));for(var H=0,B=Cc.length;B>H;H++){var w=Cc[H],$=Tn[w];if(!(!i._camera&&$.ignore||i._camera&&!i._camera.isLayerVisible(w))){var m=$.priority;X(m),this.renderLayer(w)}}X(x.cameraPriority.infinity),f||i.flowMap.disableFlow(M),sj(i,M,0,x.graph3dViewHeadlightAmbientIntensity),M.uHeadlightColor=[1,1,1,0],M.uUseEnvMap=!1,q.depth.enabled=!1,M.uTransparent=!1,M.shadowReceive=!1,rj(i,M,nj),f?i.drawFilter||i._30O._42(O,o):(i._highlightHelper._42(O,o),this._renderAxisAndEditHelper(i._getFrameRenderOptions("renderAxis")!==!1,i._getFrameRenderOptions("renderEdit")!==!1),q.blend.enabled=!1,q.depth.mask=!0),q.depth.enabled=!0,f&&oh(O,G),No(O,F),yf(O,F),i._44Q=-1,i._popFrameRenderOptions(null)}},_renderAxisAndEditHelper:function(Y,i){if(Y||i){var Q=this,L=Q.getGL(),u=Q._prg,c=Q._frameState,a=c.renderState,V=a.glState,P=a.directUniforms();c.renderState.attribs.disable(),V.depth.enabled=!1,P.uTransparent=!1,P.shadowReceive=!1,V.blend.enabled=!1,V.depth.mask=!0,P.uPick=Q._picking,Y&&Q._32O._42(L,u),i&&Q._30O._42(L,u),No(L,F),yf(L,F)}},renderLayers:function(e,L){L&&(e=Jg(e));for(var c=0,C=e.length;C>c;c++)this.renderLayer(e[c])},renderSky:function(){var T=this,X=T._frameState,o=X.renderState,g=o.glState,t=T.getGL(),y=T._prg;T._projectMatrix=Vk(T),rm(T,T._7O),T._viewMatrix=pn(T._7O),_i(T._projScreenMatrix=vc(),T._projectMatrix,T._viewMatrix),X.syncEnv(),o.useProgram(y),X.setGLState(!1,!0),X.setUniforms(!1),X.renderState.attribs.disable(),t.clear(t.DEPTH_BUFFER_BIT),oh(t,[0,0,0,0]),g.blend.enabled=!1,g.depth.enabled=!1,g.depth.mask=!1,T.drawSky(t,y),g.depth.mask=!0,g.depth.enabled=!0,No(t,F),yf(t,F)},addRenderLayerListener:function(E,H,L){var V=this;V._renderLayerNotifier||(V._renderLayerNotifier=new Fr),V._renderLayerNotifier.add(E,H,L)},removeRenderLayerListener:function(E,l){this._renderLayerNotifier&&this._renderLayerNotifier.remove(E,l)},fireRenderLayerEvent:function(V,p){var E=this._renderLayerNotifier;E&&E.fire({layer:V,phase:p})},renderLayer:function(x){var E=this,C=E._picking,V=E._40Q.get(x);if(V){E.fireRenderLayerEvent(x,"prepare");var S=E.getGL(),t=Tn[x],Z=E._frameState,A=Z.renderState,u=A.glState,X=A.directUniforms();!C&&E.isSortable()&&V.sort(E._sortFunc,E._projScreenMatrix);var a,p,v,L=V.opaque,O=V.transparent,g=V.batchModelMap,Y=V.polylineModelMap,W=V.wireframeModelMap,S=E.getGL(),N=E._prg;C||(u.blend.enabled=!1,u.depth.enabled=!0,u.depth.mask=!0),X.uTransparent=!1,t.clearDepth!==!1&&S.clear(S.DEPTH_BUFFER_BIT);var G=this.drawFilter;if(G)for(v=L,a=0,p=v.length;p>a;a++)G(v[a].data)!==!0&&v[a].ui._42(S,N,e);else{for(v=L,a=0,p=v.length;p>a;a++)v[a].ui._42(S,N,e);if(C)for(v=O,a=0,p=v.length;p>a;a++)v[a].ui._46Q(S);Ek(E,g),bq(E,Y),bq(E,W)}if(C||(u.blend.enabled=!0,u.depth.mask=!1),E._45Q=X.uTransparent=!0,G)for(v=O,a=0,p=v.length;p>a;a++)G(v[a].data)!==!0&&v[a].ui._42(S,N,$);else{for(v=O,a=0,p=v.length;p>a;a++)v[a].ui._42(S,N,$);Ek(E,g,null,!0),bq(E,Y,null,!0),bq(E,W,null,!0)}E._45Q=null,E.fireRenderLayerEvent(x,"post")}},_42:function(n,G){var l=this;if(!l._35O&&(!rs||ls(rs))){var F=l.getWidth(),$=l.getHeight();if(F&&$){var Q=l.getGL();if(Q){var b,c=l._canvas;if(n?b=!0:n=l.getDevicePixelRatio(),!l._picking&&(b||F!==c.clientWidth||$!==c.clientHeight)){Bh(c,F,$,n);var C=n;F&&Math.abs(Q.drawingBufferWidth-F*n)>1&&(C=Math.min(C,Q.drawingBufferWidth/F)),$&&Math.abs(Q.drawingBufferHeight-$*n)>1&&(C=Math.min(C,Q.drawingBufferHeight/$)),C!==n&&(l.setDevicePixelRatio(n=C),Bh(c,F,$,n)),l._18Q=null}Q.clear(Q.COLOR_BUFFER_BIT);var _=Q._renderInfo;_.calls=0,_.vertices=0,_.faces=0,_.lines=0,_.points=0,_.textureCache={time:0,count:0,pixels:0},_.frame=++l._frameId,_.cacheTimeCost=0,_.reflectDepth=0,F*=n,$*=n,this.syncRenderState();do{if(l.isVREnabled()&&l.vr.render(Q,F,$,G))break;if(l.updateScene(),l._postProcessing.render(Q,F,$,G))break;l.setViewport(Q,0,0,F,$),l.renderScene(G)}while(!1);l._33Q=!1,l.countFrame(),l._doBufferGC(Q)}}}},syncRenderState:function(){var v,b;(v=this._frameState)&&(b=v.renderState)&&b.syncLoss()},drawReflectors:function(R){R._renderInfo.reflectDepth++;var l,z,B,s=this,q=s._dataModel.getReflectors(),P=!1;for(l in q)z=q[l],s.isVisible(z)&&(B=s.getData3dUI(z),B&&B.drawReflector(R)&&(P=!0));return R._renderInfo.reflectDepth--,P},isReflecting:function(y){return y._renderInfo.reflectDepth},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(g,l){return this._postProcessing.enableModule(g,l)},getPostProcessingModule:function(j){return this._postProcessing.getModule(j)},getPostProcessingValue:function(I,J){var L=this._postProcessing.getModule(I);return L?L[J]:Y},setPostProcessingValue:function(R,i,b){var Z=this.getPostProcessingValue(R,i),$=this._postProcessing.getModule(R);$&&Z!==b&&("enable"===i?this.enablePostProcessing(R,b):$[i]=b,this.firePropertyChange("postProcessing."+R+"."+i,Z,b))},setDofImageFromGraphView:function(B,U,W){return this._postProcessing.getModule("Dof").setImageFromGraphView(B,U,W)},setViewport:function(Q,E,i,L,Y){this._viewport=[E,i,L,Y],mq.for(Q).directState().viewport=this._viewport},getRenderState:function(){return mq.for(this._26I)},getViewport:function(){return this._viewport},setBufferGCInterval:function(F){this._bufferGCInterval=F},_doBufferGC:function(H,O){var S,e,Z=H._bufPool,$=0,E=0,p=H._renderInfo.frame,k=this._bufferGCInterval||10;for(S in Z)$++,e=Z[S],e&&(O||p-e._fid>k?(H.deleteBuffer(e._buf),e._buf=null,Z[S]=null):E++);if($/2>E&&$>128){var i={};for(S in Z)Z[S]&&(i[S]=Z[S]);H._bufPool=i}H._validBufCount=E},_swapLineMap:function(){var H=this;vk=H._polylineModelMap,H._polylineModelMap=H._polylineModelMapSwap,H._polylineModelMapSwap=vk,vk=H._wireframeModelMap,H._wireframeModelMap=H._wireframeModelMapSwap,H._wireframeModelMapSwap=vk,vk=H._polylineIndexMap,H._polylineIndexMap=H._polylineIndexMapSwap,H._polylineIndexMapSwap=vk,vk=H._wireframeIndexMap,H._wireframeIndexMap=H._wireframeIndexMapSwap,H._wireframeIndexMapSwap=vk},_updateSkybox:function(Q){if(this._skybox&&Q){var A=Q.property,m=!1,H=this._skybox;if("eye"===A||"forceUpdate"===A){var X=this._eye;H.p3(X[0],X[1],X[2]),m=!0}if("near"===A||"far"===A||"forceUpdate"===A||"asceptChanged"===A){var q=H.__cachedS3__;q||(q=H.__cachedS3__=H.getFinalScale3d());var E=Math.sqrt(3),u=1/0,o=-1/0;
q.forEach(function(D){D/=2,u=r(D,u),o=O(D,o)}),o*=E;var j=this._near,W=this._far,p=Math.tan(this.getFovy()/2)*j,M=this.getAspect()*p,s=1.1*Math.sqrt(M*M+p*p+j*j),e=1;if(s>u)e=s/u;else if(o>=W){var N=W*W/(j+W);e=N/o}if(1!==e){H.__updatingSkybox__=!0;var K=q.map(function(E){return e*E});H.s3(K),H.setScale3d(1,1,1),m=!0,delete H.__updatingSkybox__}}m&&this.invalidateData(H)}},getSkyBox:function(){return this.getSkybox()},setSkyBox:function(d){return this.setSkybox(d)},getSkybox:function(){return this._skybox},setSkybox:function(Q){var w=this._skybox;if(w===Q)return Q&&this._updateSkybox({property:"forceUpdate"}),void 0;if(w&&(this._skyboxStyleMap&&w.setStyleMap(this._skyboxStyleMap),this._skyboxStyleMap=null,this._skyboxAnchor3d&&w.setAnchor3d(this._skyboxAnchor3d),this._skyboxAnchor3d=null,this._skyboxP3&&w.p3(this._skyboxP3),this._skyboxP3=null,this.handleDataModelChange({kind:Pq,data:w})),this._skybox=Q,this.ump(this._updateSkybox,this),Q){Q.dm()&&Q.dm().remove(Q),this._skyboxStyleMap=R.Default.clone(Q.getStyleMap()),this._skyboxAnchor3d=Q.getAnchor3d(),Q.setAnchor3d(.5,.5,.5),this._skyboxP3=Q.p3().slice(0),Q.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1});var x=Q.onPropertyChanged;Q.onPropertyChanged=function($){x.call(Q,$),!Q.__updatingSkybox__&&["width","height","tall","scale","scaleTall"].indexOf($.property)>=0&&(Q.__cachedS3__=Y)},this.mp(this._updateSkybox,this),this._updateSkybox({property:"forceUpdate"})}this.fp("skybox",w,Q)},drawSky:function(S,a){var U=this,o=U._skybox;if(o){var D=mq.for(S).directUniforms(),t=U._headlightIntensity,x=yl(U._headlightColor),a=U._prg;1!==t&&(x=[x[0]*t,x[1]*t,x[2]*t]),D.uHeadlightColor=[x[0],x[1],x[2],1];var M=U.getData3dUI(o);if(M){var R=U.isOrtho(),X=R||this._computedProjectMatrix;if(X){var r=U._projectMatrix;R&&(U._ortho=!1),D.uPMatrix=U._projectMatrix=Vk(U,!0)}var h=o.p3(),w=this.getEye();(h[0]!==w[0]||h[1]!==w[1]||h[2]!==w[2])&&(o._position.x=w[0],o._54O=w[1],o._position.y=w[2]),M.validate(),M._42(S,a,u),X&&(R&&(U._ortho=!0),D.uPMatrix=U._projectMatrix=r)}S.clear(S.DEPTH_BUFFER_BIT),D.uHeadlightColor=[x[0],x[1],x[2],U._headlightDisabled?1:0]}},getLogicalPoint:function(O){return Oj(O,this._canvas)},isRectOverlapping:function(Z){var r=this.getData3dUI(Z);return r._rectOverlapping},getHitFaceInfo:function(d){d.target&&(d=this.lp(d));var c=this.getDataInfoAt(d);if(c){var L=this.intersectObject(d,c.data);if(L)return{data:c.data,face:L.part}}return F},unproject:function(d,X){var k=this,G=k.getWidth(),A=k.getHeight(),B=d.target?k.lp(d):d,p=B.x-G/2,_=B.y-A/2,Z=2*(p/G),W=2*(-1*_/A);X=X||0;var g=vc(),v=Vk(k),z=rm(k);_i(g,v,z),Pe(g);var K=xc([Z,W,X,1],g);return[K[0]/K[3],K[1]/K[3],K[2]/K[3]]},getDataAt:function(D){var e=this.getDataInfoAt(D);return e?e.data:F},getDataInfoAt:function(e,x,A){return e.target&&(e=this.lp(e)),this._1o.get(_e(e.x,e.y,x),!0,A)},getDatasInRect:function(K,g){return this._1o.get(K,!1,g)},setEditable:function(Z){var A=this,k=A._editable;A._editable=Z,this.fp(Te,k,Z)},isEditable:function(K){var n=this;return K?n._editable?Im(K)?K.s("3d.editable")?n._editableFunc?n._editableFunc(K):!0:!1:!1:!1:n._editable},isSelectable:function(i){return i.s("3d.selectable")&&this.sm().isSelectable(i)},isMovable:function(i){var F=this;return Ye(i)&&i.getStyle(Lf)!==Kn?!1:i.s("3d.movable")?F._movableFunc?F._movableFunc(i):!0:!1},isSizeEditable:function(F){return Im(F)?this._sizeEditableFunc?this._sizeEditableFunc(F):!0:!1},isRotationEditable:function(z){return Im(z)&&z.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(z):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(R){this.setZoom(aj,R)},zoomOut:function(E){this.setZoom(1/aj,E)},setZoom:function(){var J=new Pf,D=new Pf,j=new Pf,U=new Pf;return function(b,F){if(1!==b){var d=this;d._14o&&d._14o.stop(!0);var W,L=1/b;J.copy(d.getCenter()),D.copy(d.getEye());var I=d._ortho;if(I){if(W=d._orthoWidth,W<d._moveStep&&b>1)return}else if(J.distanceTo(D)<d._moveStep&&1>L)return;var V=!1;return d._zoomToCenter===!1&&d._lastZoomLP&&(j.copy(D).sub(J).normalize(),d._81O=null,U.copy(d.getHitPosition(d._lastZoomLP,J.toArray(),j.toArray())),V=!0,d._lastZoomHit=U),(F=Pg(F))?(F.action=function(A){d.fi({kind:d._zooming?"betweenZoom":"beginZoom"}),d._zooming=1;var G=(L-1)*A+1;I&&d.setOrthoWidth(W*G),V?(d.setEye(j.lerpVectors(U,D,G).toArray()),d.setCenter(j.lerpVectors(U,J,G).toArray())):I||d.setEye(j.lerpVectors(J,D,G).toArray())},F._37o=function(){delete d._14o,delete d._zooming,d.fi({kind:"endZoom"}),d.onZoomEnded()},d._14o=Rg(F)):(I&&d.setOrthoWidth(W*L),V?(d.setEye(j.lerpVectors(U,D,L).toArray()),d.setCenter(j.lerpVectors(U,J,L).toArray())):I||d.setEye(j.lerpVectors(J,D,L).toArray()),void 0)}}}(),setOrthoZoom:function(N,u){return this.setZoom(N,u)},getPositionInfo:function(K){var I=this,j=I._eye,E=I._center,p=I.getAspect(),L=K?Oe(Ok(E,j,!0),Ok(K,j)):Gd(j,E);if(I._ortho){var O=I._orthoWidth;return{length:L,height:O/p,width:O}}var V=2*ld(I._fovy/2)*L;return{length:L,height:V,width:V*p}},getCenterInfo:function(){var r=this;return r._81O||(r._81O=r.getPositionInfo()),Af(r._81O)},rotate:function(t,g,u,C){var e=this;if(t||g){C==F&&(C=e._firstPersonMode),e._88O&&e._88O.stop(!0);var q=e._center,r=e._eye,i=e.getCenterInfo().length,O=C?q:r,l=C?r:q,E=Ok(O,l),V=jm(E[0],E[2]),X=jm(z(E[0]*E[0]+E[2]*E[2]),E[1]),N=C?Dq:mh;return C&&(g=-g),(u=Pg(u))?(u.action=function(L){e.fi({kind:e._rotating?"betweenRotate":"beginRotate"}),e._rotating=1;var h=V+t*L,M=X+g*L;M=C?d-Xq(e,d-M):Xq(e,M),E[0]=i*A(M)*A(h),E[1]=i*a(M),E[2]=i*A(M)*a(h),O[0]=l[0]+E[0],O[1]=l[1]+E[1],O[2]=l[2]+E[2],e.fp(N,F,O)},u._37o=function(){delete e._88O,delete e._rotating,e.fi({kind:"endRotate"}),e.onRotateEnded()},e._88O=Rg(u)):(V+=t,X+=g,X=C?d-Xq(e,d-X):Xq(e,X),E[0]=i*A(X)*A(V),E[1]=i*a(X),E[2]=i*A(X)*a(V),O[0]=l[0]+E[0],O[1]=l[1]+E[1],O[2]=l[2]+E[2],e.fp(N,F,O),void 0)}},pan:function(B,A,O,G){if(B||A){var o=this;G==F&&(G=o._firstPersonMode),o._89O&&o._89O.stop(!0);var V=rm(o),L=[V[0]*B,V[4]*B,V[8]*B],u=[V[1]*A,V[5]*A,V[9]*A],g=L[0]+u[0],Q=L[1]+u[1],b=L[2]+u[2],E=o._center,H=o._eye;if(G){var J=Fq(o.getBoundaries(),H[0],H[2],H[0]+g,H[2]+b,z(g*g+b*b));g=J[0],b=J[1]}if(O=Pg(O)){var q=Af(H),v=Af(E);return O.action=function(c){o.fi({kind:o._panning?"betweenPan":"beginPan"}),o._panning=1,E[0]=v[0]+g*c,E[1]=v[1]+Q*c,E[2]=v[2]+b*c,H[0]=q[0]+g*c,H[1]=q[1]+Q*c,H[2]=q[2]+b*c,o.fp(mh,F,H),o.fp(Dq,F,E)},O._37o=function(){delete o._89O,delete o._panning,o.fi({kind:"endPan"}),o.onPanEnded()},o._89O=Rg(O)}E[0]+=g,E[1]+=Q,E[2]+=b,H[0]+=g,H[1]+=Q,H[2]+=b,o.fp(mh,F,H),o.fp(Dq,F,E)}},walk:function(l,R,p){if(l){var b=this;p==F&&(p=b._firstPersonMode),b._90O&&b._90O.stop(!0);var Z=b._center,f=b._eye,D=Ok(Z,f,!0);if(p){var h=Fq(b.getBoundaries(),f[0],f[2],f[0]+D[0]*l,f[2]+D[2]*l,P(l));if(l=Gd(h),!l)return;D=[h[0]/l,0,h[1]/l]}if(R=Pg(R)){var u=Af(f),z=Af(Z);return R.action=function(U){b.fi({kind:b._walking?"betweenWalk":"beginWalk"}),b._walking=1;var r=l*U;f[0]=u[0]+D[0]*r,f[1]=u[1]+D[1]*r,f[2]=u[2]+D[2]*r,Z[0]=z[0]+D[0]*r,Z[1]=z[1]+D[1]*r,Z[2]=z[2]+D[2]*r,b.fp(mh,F,f),b.fp(Dq,F,Z)},R._37o=function(){delete b._90O,delete b._walking,b.fi({kind:"endWalk"}),b.onWalkEnded()},b._90O=Rg(R)}f[0]+=D[0]*l,f[1]+=D[1]*l,f[2]+=D[2]*l,Z[0]+=D[0]*l,Z[1]+=D[1]*l,Z[2]+=D[2]*l,b.fp(mh,F,f),b.fp(Dq,F,Z)}},handleScroll:function(U,m){cc(U);var w=this,a=w._moveStep,v=w.getDataInfoAt(U);if(v){var P=v.data;if(P&&w.isInteractive(P)){var l=w.intersectObject(U,P);if(l){var K=l.part,c=ti(P.s(K+".image")||P.s("shape3d."+K+".image")||P.s("all.image")||P.s("shape3d.image"));if(c&&ur(c.scrollable,P,w))return}}}return w.isFirstPersonMode()?(w.isPannable()&&w.pan(0,m>0?a:-a),void 0):(w.isZoomable()&&(w._lastZoomLP=w.lp(U),w.setZoom(0>m?1/eg:eg),w._lastZoomLP=w._lastZoomHit=null),void 0)},handlePinch:function(b,t){if(this.isZoomable()){if(Math.abs(b-t)<x.pinchZoomThreshold)return;this.setZoom(t>b?1/cf:cf)}},reset:function(N){this.setUp(x.graph3dViewUp),this.moveCamera(x.graph3dViewEye,x.graph3dViewCenter,N)},moveSelection:function(c,B,R){var p=this;p.dm().beginTransaction(),Vm(this.sm().toSelection(this.isMovable,this),c,B,R),p.dm().endTransaction()},getMoveMode:function(u,R){var F=R.s("3d.move.mode");if(F)return F;var o="88",J="89",q="90";return eq(u)||Qm[o]&&Qm[J]&&Qm[q]?"xyz":Qm[o]&&Qm[J]?"xy":Qm[o]&&Qm[q]?"xz":Qm[J]&&Qm[q]?"yz":Qm[o]?"x":Qm[J]?"y":Qm[q]?"z":"xz"},handleTick:function(){var l=this,x=!1,A=l._moveStep,D=A,v=!1,Q=!0,S=l._rotateStep*(Q?-1:1);if(l.isWalkable()||(D=0),l.isPannable()||(A=0),l.isRotatable()||(S=0),l._32Q){var m=(wi()-l._32Q)/50;D*=m,A*=m,S*=m}l._31Q&&(lj(l._31Q),delete l._31Q,delete l._32Q),Gp()&&(x=!0,l.pan(-A,0,v,Q)),bc()&&(x=!0,l.pan(A,0,v,Q)),Nh()&&(x=!0,eq()?l.pan(0,A,v,Q):l.walk(D,v,Q)),jc()&&(x=!0,eq()?l.pan(0,-A,v,Q):l.walk(-D,v,Q)),pm()&&(x=!0,l.rotate(-S,0,v,Q)),hj()&&(x=!0,l.rotate(S,0,v,Q)),ce()&&(x=!0,l.rotate(0,-S/2,v,Q)),Hr()&&(x=!0,l.rotate(0,S/2,v,Q)),x&&(l._32Q=wi(),l._31Q=Di(l.handleTick,l))},handleKeyDown:function(K){var R=this;!qh(K)&&Yg[K.keyCode]?R.handleTick():fe(K)?R.selectAll():Nb(K)?R.handleDelete(K):an(K)&&this.isResettable()&&R.reset()},checkDoubleClickOnNote:function(f,L,Q){var $=this;if(Q===Jk){if(L.s("note.toggleable"))return L.s(ol,!L.s(ol)),$.fi({kind:"toggleNote",event:f,data:L,part:Q}),!0}else if(Q===vs&&L.s("note2.toggleable"))return L.s(Gb,!L.s(Gb)),$.fi({kind:"toggleNote2",event:f,data:L,part:Q}),!0;return!1},checkDoubleClickOnRotation:function(R,Y,N){return N===Os?(Y.setRotationX(0),!0):N===Ps?(Y.setRotationY(0),!0):N===Qs?(Y.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(P){var d=this;if(d.isOrtho())return d.getWidth()/d.getOrthoWidth();var S=d.getCenter(),$=d.getHeight(),x=d.getEye(),A=[S[0]-x[0],S[1]-x[1],S[2]-x[2]],Q=[P[0]-x[0],P[1]-x[1],P[2]-x[2]],U=Math.sqrt(A[0]*A[0]+A[1]*A[1]+A[2]*A[2]),C=1/Math.tan(d.getFovy()/2);return $*U*C/(Q[0]*A[0]+Q[1]*A[1]+Q[2]*A[2])},inViewSpace:function(R){var r,D=this,p=D._transformPointToViewSpace(R),L=D.getAspect(),W=D.getNear(),S=D.getFar();return-p[2]<W||-p[2]>S?!1:D.isOrtho()?(r=D.getOrthoWidth()/2,Math.abs(p[0])<=r&&Math.abs(p[1]*L)<=r):(r=Math.sqrt(p[0]*p[0]+p[1]*p[1]+p[2]*p[2])*Math.tan(D.getFovy()/2),Math.abs(p[1]<=r)&&Math.abs(p[0])<=r*L)},getPVMatrix:function(){var H,o=this;return(H=o._18Q)||(H=Vk(o),o._18Q=_i(H,H,rm(o)),o._18Q._wh=o.getWidth()/2/o.getHeight()),H},getFrustum:function(){var L=new ai,q=new qd,Q=new Array(16);return function(){for(var m=this.getPVMatrix(),w=!1,A=0;16>A;A++)m[A]!==Q[A]&&(w=!0,Q[A]=m[A]);return w&&q.setFromMatrix(L.fromArray(m)),q}}(),toViewPosition:function(e){var v=this,J=v.getWidth()/2,E=v.getHeight()/2,i=v.getPVMatrix();return e=xc([e[0],e[1],e[2],1],i),{x:J+J*e[0]/e[3],y:E-E*e[1]/e[3],z:e[2]/e[3]}},getHitPosition:function(J,B,b){var Y=this,F=Y.getWidth(),c=Y.getHeight(),$=J.target?Y.lp(J):J,M=$.x-F/2,r=$.y-c/2,E=Y.getCenterInfo(),V=rm(Y);B=B?B:[0,0,0],b=b?b:[0,1,0],M=M/F*E.width,r=-1*r/c*E.height;var e=[V[0]*M,V[4]*M,V[8]*M],R=[V[1]*r,V[5]*r,V[9]*r],u=[e[0]+R[0],e[1]+R[1],e[2]+R[2]],s=Y.getCenter(),z=Zk(Y,B,b,[u[0]+s[0],u[1]+s[1],u[2]+s[2]]);return z?z:[0,0,0]},intersectObject:function(s,i){return this._raycaster.intersectObject(s,i)},intersectObjects:function(K,N,h){return this._raycaster.intersectObjects(K,N,h)},getLineLength:function(N){this.validate();var Z=this.getData3dUI(N);if(Z&&Z.getCache){var R=Z.getCache();if(R)return R[R.length-1].length}return 0},getLineOffset:function(T,q){var x=this.getData3dUI(T);if(x&&x.getCache){var n=x.getCache();if(n){var V=Tl(n,q);if(!T.r3)return V;var Q=T.r3();if(0===Q[0]&&0===Q[1]&&0===Q[2])return V;var S=new Pf(T.p3()),$=new Pf(V.point).sub(S),a=new Pf(V.tangent).add($),z=(new Hl).setFromEuler(new le(Q,T.getRotationMode(),!0));return $.applyQuaternion(z),a.applyQuaternion(z),{point:$.add(S),tangent:a.sub($).normalize()}}}return F},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(G,n,p){var P=this,h=P.getEye();h=[h[0],h[1],h[2]];var z=P.getCenter();if(z=[z[0],z[1],z[2]],G||(G=h),n||(n=z),P._flyAnim&&P._flyAnim.stop(!0),p=Pg(p),!p)return P.setEye(G[0],G[1],G[2]),P.setCenter(n[0],n[1],n[2]),delete P._flyAnim,!0;var K=[G[0]-h[0],G[1]-h[1],G[2]-h[2]],j=[n[0]-z[0],n[1]-z[1],n[2]-z[2]];return p.action=function(J){P.setCenter(z[0]+j[0]*J,z[1]+j[1]*J,z[2]+j[2]*J),P.setEye(h[0]+K[0]*J,h[1]+K[1]*J,h[2]+K[2]*J)},p._37o=function(){delete P._flyAnim},P._flyAnim=Rg(p)},flyTo:function(){function M(j,Q,I){if(I instanceof R.Node){_.fromArray(_j(I,Q.getMat(I)));var S=I.getAnchor3d();j.push((new Pf).set(0-S.x,0-S.y,0-S.z).applyMatrix4(_)),j.push((new Pf).set(0-S.x,0-S.y,1-S.z).applyMatrix4(_)),j.push((new Pf).set(0-S.x,1-S.y,0-S.z).applyMatrix4(_)),j.push((new Pf).set(0-S.x,1-S.y,1-S.z).applyMatrix4(_)),j.push((new Pf).set(1-S.x,0-S.y,0-S.z).applyMatrix4(_)),j.push((new Pf).set(1-S.x,0-S.y,1-S.z).applyMatrix4(_)),j.push((new Pf).set(1-S.x,1-S.y,0-S.z).applyMatrix4(_)),j.push((new Pf).set(1-S.x,1-S.y,1-S.z).applyMatrix4(_))}}var Q=new Pf,z=new Pf,f=new Pf,L=new Pf,E=new Pf,_=new ai,C=new R.Math.Quaternion,g=new le,G=new xb;return function(i,D,d){var F=this;"boolean"==typeof D&&(D={animation:D}),D=D||{};var q=D.center,p=D.distance,k=D.direction,P=D.worldDirection,O=d||D.ratio||.8,Z=D.xRatio||O,A=D.yRatio||O;(d!==Y||D.duration||D.frames)&&(D={animation:D});var W,T,r=[],n=p===Y;if(q&&f.fromArray(q),!q||n)if(i||(i=F.dm().getDatas()),1===i.length&&(i=ic(i)?i.get(0):i[0]),i instanceof R.Node)q||f.fromArray(i.p3()),n&&(M(r,F,i),W=r.length);else{if(!i.length)return;if((n||!q)&&(r=[],i.forEach(function(W){M(r,F,W)}),W=r.length,!W))return;q||(G.setFromPoints(r),f.copy(G.min).add(G.max).multiplyScalar(.5))}if(F._flyAnim&&F._flyAnim.stop(!0),Q.fromArray(F.getEye()),z.fromArray(F.getCenter()),F.setCenter(f.x,f.y,f.z),L.subVectors(Q,z),k||P){!P&&i instanceof R.Node?C.setFromEuler(g.set(i.r3(),i.getRotationMode(),!0)):C.set(0,0,0,1);var o=L.length();L.fromArray(P||k).applyQuaternion(C).setLength(o)}var t=new Pf(F.getUp()),w=ze.fequal(t.x,0,1e-5)&&ze.fequal(t.z,0,1e-5);if(w&&0===L.x&&0===L.z){var h=.001,s=L.y;L.y=s*(1-h),L.z=Math.sign(s)*h}var v=0;if(n){var N,J,B,V=Z,S=A;if(E.copy(L),F.isOrtho()){var j=-1/0;for(F._eye[0]=L.x+f.x,F._eye[1]=L.y+f.y,F._eye[2]=L.z+f.z,N=Vk(F),_i(N,N,rm(F)),T=0;W>T;T++)B=r[T],J=xc([B.x,B.y,B.z,1],N),j=Math.max(j,Math.max(Math.abs(J[0])/V,Math.abs(J[1])/S));v=F.getOrthoWidth()*j}else{for(var X,b,K=F.getNear(),c=10;c--;){for(F._eye[0]=L.x+f.x,F._eye[1]=L.y+f.y,F._eye[2]=L.z+f.z,N=Vk(F),_i(N,N,rm(F)),X=!0,b=-1/0,T=0;W>T;T++){if(B=r[T],J=xc([B.x,B.y,B.z,1],N),J[3]<K&&c){L.multiplyScalar(2),X=!1;break}b=Math.max(b,Math.max(Math.abs(J[0])/V,Math.abs(J[1])/S)-J[3])}if(X)break}L.setLength(b+L.length())}L.manhattanLength()<1e-6&&L.copy(E)}else L.setLength(p);var l=L.add(f),a=Pg(D.animation);if(a){F.setEye(Q.x,Q.y,Q.z),F.setCenter(z.x,z.y,z.z);var m=l.clone().sub(f),$=m.length();$&&m.multiplyScalar(1/$);var _=Q.clone().sub(z),y=_.length();y&&_.multiplyScalar(1/y);var I=(new ai).lookAtDirection(_,t),H=(new ai).lookAtDirection(m,t),e=(new Hl).setFromRotationMatrix(I),U=(new Hl).setFromRotationMatrix(H),u=(new Pf).subVectors(f,z);if(v)var en=F.getOrthoWidth();var uj=new Pf,An=new Pf,Mp=new Pf,Yk=a.action,Hc=a._37o,hm=z.clone();return a.action=function(W,k){An.copy(hm).addScaledVector(u,W);var o=e.clone().slerp(U,W);uj.set(0,0,1).applyQuaternion(o).setLength(y+($-y)*W).add(An),Mp.set(0,1,0).applyQuaternion(o),F.setCenter(An.x,An.y,An.z),F.setEye(uj.x,uj.y,uj.z),F.setUp(Mp.x,Mp.y,Mp.z),v&&F.setOrthoWidth((v-en)*W+en),Yk&&Yk(W,k)},a._37o=function(){delete F._flyAnim;var v=F.getUp(),$=w?x.graph3dViewUp:t.toArray();(v[0]!==$[0]||v[1]!==$[1]||v[2]!==$[2])&&F.setUp($),Hc&&Hc()},{lastEye:Q,lastCenter:z,eye:l,center:f,orthoWidth:v,animation:F._flyAnim=Rg(a)}}return F.setEye(l.x,l.y,l.z),F.setCenter(f.x,f.y,f.z),v&&F.setOrthoWidth(v),delete F._flyAnim,{lastEye:Q,lastCenter:z,eye:l,center:f,orthoWidth:v}}}(),getBoundingBox:function(){function C(W,Z,T){j.fromArray(_j(T,Z.getMat(T)));var v=T.getAnchor3d();W.push((new Pf).set(0-v.x,0-v.y,0-v.z).applyMatrix4(j)),W.push((new Pf).set(0-v.x,0-v.y,1-v.z).applyMatrix4(j)),W.push((new Pf).set(0-v.x,1-v.y,0-v.z).applyMatrix4(j)),W.push((new Pf).set(0-v.x,1-v.y,1-v.z).applyMatrix4(j)),W.push((new Pf).set(1-v.x,0-v.y,0-v.z).applyMatrix4(j)),W.push((new Pf).set(1-v.x,0-v.y,1-v.z).applyMatrix4(j)),W.push((new Pf).set(1-v.x,1-v.y,0-v.z).applyMatrix4(j)),W.push((new Pf).set(1-v.x,1-v.y,1-v.z).applyMatrix4(j))}var j=new ai;return function(Y){if(Y=Y||this.sm().getSelection(),Y instanceof R.Node&&(Y=[Y]),0===Y.length)return F;var i=[];Y.forEach(function(A){Im(A)&&C(i,this,A)},this);var v=[1/0,1/0,1/0],x=[-1/0,-1/0,-1/0];return i.forEach(function(N){v[0]=Math.min(N.x,v[0]),v[1]=Math.min(N.y,v[1]),v[2]=Math.min(N.z,v[2]),x[0]=Math.max(N.x,x[0]),x[1]=Math.max(N.y,x[1]),x[2]=Math.max(N.z,x[2])}),{min:v,max:x}}}(),setBatchInfo:function(e,o){var N=this._batchInfoMap[e];this._batchInfoMap[e]=o,this.fp("batchInfo",N,o)},getBatchInfo:function(U){return this._batchInfoMap[U]||hm[U]},setOrthoWidth:function(L){var k=this._orthoWidth;if(this._orthoWidth=L,this._syncEyeWithOrthoWidth){var G=L/this.getAspect(),r=G/2/ld(this.getFovy()/2),d=(new Pf).fromArray(this.getEye()),S=(new Pf).fromArray(this.getCenter());d.sub(S).setLength(r).add(S),this.setEye(d.toArray())}this.fp("orthoWidth",k,L)},getCamera:function(U){var d=this;U||(U=d._mainCamera,U||(U=d._mainCamera=new R.Camera)),U.s({"camera.type":d.isOrtho()?"ortho":"perspective","camera.aspect":d.getAspect(),"camera.fovy":d.getFovy(),"camera.ortho.width":d.getOrthoWidth(),"camera.near":d.getNear(),"camera.far":d.getFar()});var $=d.getEye();return U.p3($.slice()),U.lookAt(d.getCenter(),d.getUp()),U}}),function(){function r(u,P,g){var U=u[P];U&&U.releaseTexture(),u[P]=g}function J(){return["\n #ifdef ENVMAP_TYPE_CUBE_UV \n","#define cubeUV_maxMipLevel 8.0 \n","#define cubeUV_minMipLevel 4.0 \n","#define cubeUV_maxTileSize 256.0 \n","#define cubeUV_minTileSize 16.0 \n","float getFace(vec3 direction) {","vec3 absDirection = abs(direction);","float face = - 1.0;","if (absDirection.x > absDirection.z) {","if (absDirection.x > absDirection.y)","face = direction.x > 0.0 ? 0.0 : 3.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","} else {","if (absDirection.z > absDirection.y) ","face = direction.z > 0.0 ? 2.0 : 5.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","}","return face;","} ","vec2 getUV(vec3 direction, float face) {","vec2 uv;","if (face == 0.0) {","uv = vec2(direction.z, direction.y) / abs(direction.x);","} else if (face == 1.0) {","uv = vec2(- direction.x, - direction.z) / abs(direction.y);","} else if (face == 2.0) {","uv = vec2(- direction.x, direction.y) / abs(direction.z);","} else if (face == 3.0) {","uv = vec2(- direction.z, direction.y) / abs(direction.x);","} else if (face == 4.0) {","uv = vec2(- direction.x, direction.z) / abs(direction.y);","} else {","uv = vec2(direction.x, direction.y) / abs(direction.z);","}","return 0.5 * (uv + 1.0);","} ","vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {","float face = getFace(direction);","float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);","mipInt = max(mipInt, cubeUV_minMipLevel);","float faceSize = exp2(mipInt);","float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);","vec2 uv = getUV(direction, face) * (faceSize - 1.0);","vec2 f = fract(uv);","uv += 0.5 - f;","if (face > 2.0) {","uv.y += faceSize;","face -= 3.0;","}","uv.x += face * faceSize;","if (mipInt < cubeUV_maxMipLevel) {","uv.y += 2.0 * cubeUV_maxTileSize;","}","uv.y += filterInt * 2.0 * cubeUV_minTileSize;","uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);","uv *= texelSize;","vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x += texelSize;","vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.y += texelSize;","vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x -= texelSize;","vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","vec3 tm = mix(tl, tr, f.x);","vec3 bm = mix(bl, br, f.x);","return mix(tm, bm, f.y);","}","\n #define r0 1.0 \n","#define v0 0.339 \n","#define m0 - 2.0 \n","#define r1 0.8 \n","#define v1 0.276 \n","#define m1 - 1.0 \n","#define r4 0.4 \n","#define v4 0.046 \n","#define m4 2.0 \n","#define r5 0.305 \n","#define v5 0.016 \n","#define m5 3.0 \n","#define r6 0.21 \n","#define v6 0.0038 \n","#define m6 4.0 \n","float roughnessToMip(float roughness) {","float mip = 0.0;","if (roughness >= r1) {","mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;","} else if (roughness >= r4) {","mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;","} else if (roughness >= r5) {","mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;","} else if (roughness >= r6) {","mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;","} else {","mip = - 2.0 * log2(1.16 * roughness);","}","return mip;","} ","vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {","float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);","float mipF = fract(mip);","float mipInt = floor(mip);","vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);","if (mipF == 0.0) {","return vec4(color0, 1.0);","} else {","vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);","return vec4(mix(color0, color1, mipF), 1.0);","}","} ","\n #endif \n"].join("")}function W(){return["vec4 sRGBToLinear( in vec4 value ) {","return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );","}","vec4 LinearTosRGB( in vec4 value ) {","return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );","}","vec4 inputTexelToLinear( vec4 value ) { return sRGBToLinear( value ); }","vec4 linearToOutputTexel( vec4 value ) { return LinearTosRGB( value ); }","vec4 envMapTexelToLinear( vec4 color ) { return inputTexelToLinear( color ); }"].join("")}function o(){return["precision mediump float;\n","precision mediump int;\n","attribute vec3 position;","attribute vec2 uv;","attribute float faceIndex;","varying vec3 vOutputDirection;","vec3 getDirection( vec2 uv, float face ) {","uv = 2.0 * uv - 1.0;","vec3 direction = vec3( uv, 1.0 );","if ( face == 0.0 ) { direction = direction.zyx; } ","else if ( face == 1.0 ) { direction = direction.xzy; direction.xz *= -1.0; } ","else if ( face == 2.0 ) { direction.x *= -1.0; }","else if ( face == 3.0 ) { direction = direction.zyx; direction.xz *= -1.0; } ","else if ( face == 4.0 ) { direction = direction.xzy; direction.xy *= -1.0; } ","else if ( face == 5.0 ) { direction.z *= -1.0; }","return direction;","}","void main() {","vOutputDirection = getDirection( uv, faceIndex );","gl_Position = vec4( position, 1.0 );","}"].join("")}function _(){return{vs:o(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform samplerCube envMap;\n",W(),"\n void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3(- vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function b(){return{vs:o(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform vec2 texelSize;\n",W(),"\n #define RECIPROCAL_PI 0.3183098861837907 \n","\n #define RECIPROCAL_PI2 0.15915494309189535 \n","vec2 equirectUv( in vec3 dir ) {","float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;","float v = 0.5 - asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI;","return vec2( u, v );","}","void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","vec3 outputDirection = normalize( vOutputDirection );","vec2 uv = equirectUv( outputDirection );","vec2 f = fract( uv / texelSize - 0.5 );","uv -= f * texelSize;","vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x += texelSize.x;","vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.y += texelSize.y;","vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x -= texelSize.x;","vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","vec3 tm = mix( tl, tr, f.x );","vec3 bm = mix( bl, br, f.x );","gl_FragColor.rgb = mix( tm, bm, f.y );","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function H(w){return{vs:o(),fs:["precision mediump float;\n","precision mediump int;\n","#define n "+w+"\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform int samples;","uniform float weights[ n ];","uniform bool latitudinal;","uniform float dTheta;","uniform float mipInt;","uniform vec3 poleAxis; \n",W(),"\n #define ENVMAP_TYPE_CUBE_UV \n",J(),"\n vec3 getSample( float theta, vec3 axis ) {","float cosTheta = cos( theta );","vec3 sampleDirection = vOutputDirection * cosTheta + cross(axis, vOutputDirection) * sin(theta) + axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);","return bilinearCubeUV( envMap, sampleDirection, mipInt );","}","void main() {","vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );","if ( all( equal( axis, vec3( 0.0 ) ) ) ) {","axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );","}","axis = normalize( axis );","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );","for ( int i = 1; i < n; i++ ) {","if ( i >= samples ) { break; }","float theta = dTheta * float( i );","gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );","gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );","}","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}var G=Km.EnvmapRenderer=function(u){this.gv=u,this._envmaps={},this._envmapHash={},this._probeCaptureTime={},this._pingPongRenderTarget=null,this._equirectShader=null,this._cubemapShader=null,this._blurMaterial=null,this._lastCaptureFrame=0};G.prototype={},G.prototype.constructor=G,G.prototype.changeEnvmapType=function(P){"legacy"===P?(this.setEnvmapByProbeId=this.setEnvmapLegacy,this.onBeforeRender=this.onBeforeRenderLegacy):(this.setEnvmapByProbeId=this.setEnvmap,this.onBeforeRender=this.onBeforeRenderNew)},G.prototype.invalidateEnvmap=function(Y){var s=this.gv;if("legacy"!==s.getEnvmapType()){var C=s.getGL();C&&(Y?(delete this._envmapHash[Y],delete this._probeCaptureTime[Y]):(this._envmapHash={},this._probeCaptureTime={}),s.iv())}},G.prototype.onBeforeRenderLegacy=function(W){this.assureTextureLegacy(W)},G.prototype.assureTextureLegacy=function(s){var W=this,g=W.gv,N=g.getEnvmap();if(N!==W._lastLegacyImage){if(W._envmapLegacy&&(s.deleteTexture(W._envmapLegacy),W._envmapLegacy=null),!N)return W._lastLegacyImage=N,void 0;var u=x.getImage(N);if(u&&u.tagName){u=x.resizeImagePOT(u,!0);var z=W._envmapLegacy=s.createTexture();s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_CUBE_MAP,z),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,u),s.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,u),s.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,u),s.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,u),s.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,u),s.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,u),s.bindTexture(s.TEXTURE_CUBE_MAP,s._emptyCubeTexture),W._lastLegacyImage=N}}},G.prototype.setEnvmapLegacy=function(v){v.uEnvMap=this._envmapLegacy},G.prototype.onBeforeRenderNew=function(P){this.assureTextureNew(P),this.resetUniformCache()},G.prototype.assureTextureNew=function(f){var P=this,E=P.gv,n=E.getEnvmap(),D=P._envmapHash,X=P._envmaps,N=f._renderInfo.frame;if(!(this._lastCaptureFrame>=N||E._picking))for(var y in n){var A,U=n[y],S=U.type;switch(S){case"sphere":A=U.image,A!==D[y]&&(Ng=x.getImage(A),Ng&&(D[y]=A,r(X,y,P.fromEquirectangular(A))));break;case"cube":var q=U.images;if(q&&6===q.length&&(A=q.join(","),A!==D[y])){for(var B=!0,I=0;6>I;I++)if(!x.getImage(q[I])){B=!1;break}B&&(D[y]=A,r(X,y,P.fromCubemap(q)))}break;case"skybox":var t=E.getSkybox();if(t){var J=t.s("shape3d");if(A="sphere"===J?t._id+"_"+t.s("shape3d.image"):t._id+"_"+t.s("front.image"),A!==D[y]){var B;if("sphere"===J)B=x.getImage(t.s("shape3d.image"));else{B=!0;for(var L=["front","back","left","right","top","bottom"],I=0;6>I;I++)if(!x.getImage(t.s(L[I]+".image"))){B=!1;break}}B&&(D[y]=A,r(X,y,P.fromSkybox()))}}break;case"probe":var F=U.pos,j=U.size;if(A=F[0]+"_"+F[1]+"_"+F[2]+"_"+j,A!==D[y]){var i=this._probeCaptureTime[A],b=Date.now();i||(this._probeCaptureTime[A]=i=b),b-i>x.envmapProbeMinWaitTime&&!ym&&!Ll||b-i>x.envmapProbeMaxWaitTime?(delete this._probeCaptureTime[A],D[y]=A,r(X,y,P.fromSceneProbe(F,j,U.filter))):E.iv()}}}},G.prototype.resetUniformCache=function(){this._frameUniformCache={}},G.prototype.setEnvmap=function(z,I){var K=z.uuid,q=this._frameUniformCache,e=this._envmaps[I];e&&(e=e.texture),q[K]!==e&&(q[K]=e,z.uEnvMap=e)},G.prototype.fromEquirectangular=function(c){var g=R.Default.getImage(c);return this.rectSize=[1/g.width,1/g.height],c=this.gv.getTexture(c),this.fromTexture(c)},G.prototype.fromCubemap=function(y){var h=this.gv.getGL(),q=h.createTexture();h.activeTexture(h.TEXTURE0),h.bindTexture(h.TEXTURE_CUBE_MAP,q),h.texParameteri(h.TEXTURE_CUBE_MAP,h.TEXTURE_MAG_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_CUBE_MAP,h.TEXTURE_MIN_FILTER,h.LINEAR);for(var F=[],N=D/3,o=0;6>o;o++)F[o]=x.resizeImage(R.Default.getImage(y[o]),N);return h.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,F[0]),h.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,F[1]),h.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,F[2]),h.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,F[3]),h.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,F[4]),h.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,F[5]),h.bindTexture(h.TEXTURE_CUBE_MAP,h._emptyCubeTexture),this.fromTexture(q,!0)},G.prototype.fromTexture=function(D,p){var v=this._allocateTargets();this._pingPongRenderTarget||(this._pingPongRenderTarget=this._allocateTargets());var O=this.gv,i=O.getGL(),K=mq.for(i).directState(),E=K.depth.enabled;K.scissor.enabled=!0,K.depth.enabled=!1;var z=O.getViewport(i);return this._textureToCubeUV(D,v,p),this._applyPMREM(v),v.unbind(i),O.setViewport(i,z[0],z[1],z[2],z[3]),K.depth.enabled=E,K.scissor.enabled=!1,v},G.prototype.fromSkybox=function(){return this._fromCamera(function(G){G.s({"camera.onlySky":!0})})},G.prototype.fromScene=function(W){return this._fromCamera(function(r){r.s({"camera.onlySky":!1}),W&&W(r)})},G.prototype.fromNode=function(_){var J=this.gv.getData3dUI(_),y=J._42;J._42=Ko;var l=this.gv.getSkybox(),n=_.p3();if(l){var g=l.p3();l.p3(n)}var U=this.fromScene(function(r){r.p3(n)});return J._42=y,l&&l.p3(g),U},G.prototype.fromSceneProbe=function(g,b,l){var X=this.gv,Q=X.getSkybox();if(Q){var J=Q.p3();Q.p3(g)}if(l){var O=X.isVisible;X.isVisible=function(k){var b=l(k);return b!==Y?b:O.call(X,k)}}var R=this.fromScene(function(q){q.p3(g),q.s("camera.near",b)});return l&&(X.isVisible=O),Q&&Q.p3(J),R},G.prototype._fromCamera=function(f){var U=this.gv,m=U.getCamera();f&&f(m);var Q=new Mm(U,D,D,{cube:!0}),e=U.getGL(),j=U.getViewport(e),n=this.setEnvmapByProbeId,J=this.onBeforeRender;this.setEnvmapByProbeId=function(h){h.envMap=e._emptyTexture
},this.onBeforeRender=Ko,m.attachRenderTarget(Q),m.render(U),m.detachRenderTarget(),this.setEnvmapByProbeId=n,this.onBeforeRender=J,U.setViewport(e,j[0],j[1],j[2],j[3]);var w=this.fromTexture(Q.texture,!0);return Q.releaseTexture(),w},G.prototype._allocateTargets=function(){return new Mm(this.gv,3*c,3*c,{magFilter:qk.NEAREST,minFilter:qk.NEAREST})},G.prototype._textureToCubeUV=function(u,T,I){var w,U=this.gv;I?null==(w=this._cubemapShader)&&(this._cubemapShader=w=this.createShader(_())):null==(w=this._equirectShader)&&(this._equirectShader=w=this.createShader(b()));var P=U.getGL();T.bind(P),this._setViewport(T,0,0,3*c,2*c);var v=U.getRenderState();v.useProgram(w);var M=v.directUniforms(),d=v.directAttribs();M.envMap=u,I||(M.texelSize=this.rectSize);var j=A[0];d.position=dg(P,null,j.vs,F,3),d.uv=dg(P,null,j.uv,F,2),d.faceIndex=dg(P,null,j.faceIs,F,1),Rf(P,0,j.vs.length/3)},G.prototype._applyPMREM=function(H){for(var k,s,Z,k=1;e>k;k++)s=Math.sqrt(q[k]*q[k]-q[k-1]*q[k-1]),Z=w[(k-1)%w.length],this._blur(H,k-1,k,s,Z)},G.prototype._setViewport=function(T,$,y,D,I){var o=this.gv;o.setViewport(o.getGL(),$,y,D,I),o.getRenderState().directState().scissor.box=[$,y,D,I]},G.prototype._blur=function(t,w,v,M,i){var T=this._pingPongRenderTarget;this._halfBlur(t,T,w,v,M,"latitudinal",i),this._halfBlur(T,t,v,v,M,"longitudinal",i)},G.prototype.createShader=function(d){var S=this.gv;return S.getPostProcessing().createShader(S.getGL(),d).program},G.prototype._halfBlur=function(Z,o,M,X,v,h,z){var E=this.gv,Y=this._blurMaterial;if("latitudinal"===h||"longitudinal"===h){Y||(this._blurMaterial=Y=this.createShader(H(a)));var p=E.getGL();o.bind(p);var i=3,e=E.getRenderState();e.useProgram(Y);var k,s,O,T=e.directUniforms(),x=e.directAttribs(),R=N[M]-1,_=isFinite(v)?Math.PI/(2*R):2*Math.PI/(2*a-1),L=v/_,y=isFinite(v)?1+Math.floor(i*L):a,J=[],D=0;for(k=0;a>k;++k)s=k/L,O=Math.exp(-s*s/2),J.push(O),0==k?D+=O:y>k&&(D+=2*O);for(k=0;k<J.length;k++)J[k]=J[k]/D;T.envMap=Z.texture,T.samples=y,T.weights=J,T.latitudinal="latitudinal"===h,z&&(T.poleAxis=z),T.dTheta=_,T.mipInt=V-M;var j=N[X],s=3*Math.max(0,c-2*j),f=(0===X?0:2*c)+2*j*(X>V-t?X-V+t:0);this._setViewport(o,s,f,3*j,2*j);var b=A[X];x.position=dg(p,null,b.vs,F,3),x.uv=dg(p,null,b.uv,F,2),x.faceIndex=dg(p,null,b.faceIs,F,1),Rf(p,0,b.vs.length/3),o.unbind(p)}};var t=4,V=8,c=Math.pow(2,V),p=[.125,.215,.35,.446,.526,.582],e=V-t+1+p.length,a=20,X=(1+Math.sqrt(5))/2,u=1/X,w=[new Pf(1,1,1),new Pf(-1,1,1),new Pf(1,1,-1),new Pf(-1,1,-1),new Pf(0,X,u),new Pf(0,X,-u),new Pf(u,0,X),new Pf(-u,0,X),new Pf(X,u,0),new Pf(-X,u,0)],z=function(){for(var u=[],$=[],d=[],y=V,v=0;e>v;v++){var c=Math.pow(2,y);$.push(c);var f=1/c;v>V-t?f=p[v-V+t-1]:0==v&&(f=0),d.push(f);for(var j=1/(c-1),n=-j/2,G=1+j/2,l=6,Y=[],M=[],q=[],r=0;l>r;r++){var B=2*(r%3)/3-1,K=r>2?0:-1;Y.push(B,K,0,B+2/3,K,0,B+2/3,K+1,0,B,K,0,B+2/3,K+1,0,B,K+1,0),M.push(n,n,G,n,G,G,n,n,G,G,n,G),q.push(r,r,r,r,r,r)}u.push({vs:new Oh(Y),uv:new Oh(M),faceIs:new Oh(q)}),y>t&&y--}return{_lodPlanes:u,_sizeLods:$,_sigmas:d}}(),A=z._lodPlanes,N=z._sizeLods,q=z._sigmas,D=x.EnvmapTextureSize}();var lq=["left","front","right","back","top","bottom"],Ik=Km._RenderList=function(){function H(){N.length=0,F.length=0,T={}}function B(X){var t,G,z,F,Q=X.gv,u=X.data,d=X.shapeModel;if(d){var j,D,S,L=u.s("shape3d.transparent")||u.s("points.transparent");for(Ub(d)||(j=ur(d.transparent,u,Q),d=[d]),z=0,F=d.length;F>z;z++)S=d[z],D=ur(S.transparent,u,Q),D===Y&&(D=j),D===Y&&(D=L),D?G=!0:t=!0}for(z=0,F=lq.length;F>z;z++){var U=X[lq[z]];U&&(U.transparent?G=!0:t=!0)}Q.isLabelVisible(u)&&(X.labelInfo&&(u.s(Vq+".transparent")?G=!0:t=!0),X.label2Info&&(u.s(el+".transparent")?G=!0:t=!0)),Q.isNoteVisible(u)&&(X.noteInfo&&(u.s(Jk+".transparent")?G=!0:t=!0),X.note2Info&&(u.s(vs+".transparent")?G=!0:t=!0)),X._38o&&(G=t=!0),G||(t=!0),X._renderParams={opaque:t,transparent:G}}function x(H,s){s&&B(H);var X=H.data,K=X._id;if(!T[K]){T[K]=!0;var J=H._renderParams;J&&J.visible!==!1&&(H={ui:H,data:X,z:0,id:K},J.opaque&&N.push(H),J.transparent&&F.push(H))}}function $(E,M){if(F.length>1){for(var x,$,B=[0,0,0,0],T=0,W=F.length;W>T;T++)x=F[T].data,($=x._position)?(B[0]=$.x,B[1]=x._54O,B[2]=$.y,B[3]=1,xc(B,M),F[T].z=B[2]/B[3]):F[T].z=0;F.sort(E||p)}}function E(K){K?(Xc(t,P,K),Xc(u,n,K),Xc(s,G,K)):(t=this.batchModelMap={},P=this.batchIndexMap={},u=this.polylineModelMap={},n=this.polylineIndexMap={},s=this.wireframeModelMap={},G=this.wireframeIndexMap={}),this.markBatchInvalid()}function c(F){F?Xc(t,P,F):(t=this.batchModelMap={},P=this.batchIndexMap={}),this.markBatchInvalid()}function D(Z){Z?Xc(u,n,Z):(u=this.polylineModelMap={},n=this.polylineIndexMap={}),this.markBatchInvalid()}function S(f){f?Xc(s,G,f):(s=this.wireframeModelMap={},G=this.wireframeIndexMap={}),this.markBatchInvalid()}function Q(){return this._batchInvalid}function q(){this._batchInvalid=!0}function I(){this._batchInvalid=null}var N=[],F=[],t={},P={},u={},n={},s={},G={},T={};return{opaque:N,transparent:F,init:H,push:x,batchModelMap:t,batchIndexMap:P,polylineModelMap:u,polylineIndexMap:n,wireframeModelMap:s,wireframeIndexMap:G,ivBatch:E,ivModelBatch:c,ivPolylineBatch:D,ivWireframeBatch:S,markBatchInvalid:q,isBatchInvalid:Q,onUpdated:I,sort:$}},ss=Km._RenderLists=function(){function N(){for(var G in h)h[G].init()}function z(){for(var s in h)h[s].onUpdated()}function K(b,W){b=b||"main";var T=h[b];return!T&&W&&(T=h[b]=new Ik),T}function g(E,Q){var S=E.data.getRenderLayer(),c=K(S,!0);c.push(E,Q)}function X(j){for(var _ in h)j(h[_])}var h={};return{init:N,onUpdated:z,get:K,push:g,each:X,lists:h}},Mm=Km.RenderTarget=function(g,A,F,U){var b,P=this;null!=A&&A.canvas?(b=A,A=F,F=U,U=arguments[4]):b=g.getGL(),U=U||{},U.cube===!!U.cube,U.samples=U.cube?0:Math.min(g._glCapabilities.maxSamples,U.samples&&U.samples>1&&2===g._webGLVersion?U.samples:0),P.options=U,P.uuid=R.Math.generateUUID(),P.gv=g,P.init(g,b,U),P.format=U.format||qk.RGBA,P.generateMipmaps=!!U.generateMipmaps,U.samples&&!g._glCapabilities._maxSamplesChecked?P.setSize(b,A||1,F||1):P.setSize(b,A,F)};S.assign(Km.RenderTarget.prototype,{bind:function(V,M){var R=this.options;if(R.autoSize){var D=this.gv,H=D.getDevicePixelRatio(),s=D.getWidth()*H,g=D.getHeight()*H;this.setSize(V,s,g)}R.cube?Wh(V,this.frame[M]):Wh(V,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(u){gi(u),this.options.samples&&(u.bindFramebuffer(u.READ_FRAMEBUFFER,this._MSAAFbo),u.bindFramebuffer(u.DRAW_FRAMEBUFFER,this.frame),u.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,u.COLOR_BUFFER_BIT,u.NEAREST),u.bindFramebuffer(u.READ_FRAMEBUFFER,null),u.bindFramebuffer(u.DRAW_FRAMEBUFFER,null))},isCube:function(){return this.options.cube},init:function(A,F,J){var t=this,Z=J.samples,e=J.cube,Y=t.texture=F.createTexture(),h=e?qk.TEXTURE_CUBE_MAP:qk.TEXTURE_2D;F.activeTexture(F.TEXTURE0),F.bindTexture(h,Y),F.texParameteri(h,F.TEXTURE_WRAP_S,J.wrapS||F.CLAMP_TO_EDGE),F.texParameteri(h,F.TEXTURE_WRAP_T,J.wrapT||F.CLAMP_TO_EDGE);var P=Z?F.NEAREST:F.LINEAR;if(F.texParameteri(h,F.TEXTURE_MIN_FILTER,J.minFilter||P),F.texParameteri(h,F.TEXTURE_MAG_FILTER,J.magFilter||P),F.bindTexture(h,null),e){t.depth=[],t.frame=[];for(var S=0;6>S;S++)t.depth[S]=F.createRenderbuffer(),t.frame[S]=F.createFramebuffer()}else t.depth=F.createRenderbuffer(),t.frame=F.createFramebuffer();t.assureTexture()},assureTexture:function(){var A=this;A.gv._2Oi(A.uuid,A.texture,"default")},releaseTexture:function(){this.gv.deleteTexture(this.uuid)},setSize:function(A,c,o){var T=this;if(c=Math.round(c),o=Math.round(o),c&&o&&(T.width!==c||T.height!==o)){T.width=c,T.height=o;var g=A.RENDERBUFFER,I=A.FRAMEBUFFER,P=T.options.samples,p=T.options.cube,b=p?qk.TEXTURE_CUBE_MAP:qk.TEXTURE_2D;if(P){var u=T.gv._glCapabilities;if(!u._maxSamplesChecked){for(A.bindRenderbuffer(g,T.depth),A.getError();P>1&&(A.renderbufferStorageMultisample(g,P,A.DEPTH_COMPONENT16,c,o),A.getError());)P=Math.floor(P>>1);1>=P&&(P=0,A.texParameteri(b,A.TEXTURE_MIN_FILTER,T.options.minFilter||A.LINEAR),A.texParameteri(b,A.TEXTURE_MAG_FILTER,T.options.magFilter||A.LINEAR),A.renderbufferStorage(g,A.DEPTH_COMPONENT16,c,o)),u._maxSamplesChecked=!0,u.maxSamples=T.options.samples=P,A.bindRenderbuffer(g,F)}}if(P&&(T._MSAAFbo||(T._MSAAFbo=A.createFramebuffer(),T._MSAARbO=A.createRenderbuffer()),A.bindRenderbuffer(g,T._MSAARbO),A.renderbufferStorageMultisample(A.RENDERBUFFER,P,A.RGBA8,c,o),A.bindFramebuffer(I,T._MSAAFbo),A.framebufferRenderbuffer(I,A.COLOR_ATTACHMENT0,g,T._MSAARbO),A.framebufferRenderbuffer(I,A.DEPTH_ATTACHMENT,g,T.depth),A.bindFramebuffer(I,null),A.bindRenderbuffer(g,null)),A.activeTexture(A.TEXTURE0),A.bindTexture(b,T.texture),p)for(var H=A.TEXTURE_CUBE_MAP_POSITIVE_X,l=0;6>l;l++)T.setupFrameBufferTextureAndDepth(A,T.frame[l],T.depth[l],H+l);else T.setupFrameBufferTextureAndDepth(A,T.frame,T.depth,A.TEXTURE_2D);if(T.generateMipmaps&&(2===gv._webGLVersion||ze.isPOT(c)&&ze.isPOT(o))){A.generateMipmap(b);var i=T.options.minFilter||(P?A.NEAREST:A.LINEAR);A.texParameteri(b,A.TEXTURE_MIN_FILTER,i===A.NEAREST?A.NEAREST_MIPMAP_NEAREST:A.LINEAR_MIPMAP_LINEAR)}A.bindTexture(b,null)}},setupFrameBufferTextureAndDepth:function(M,u,p,C){var g=this,L=g.format;M.texImage2D(C,0,L,this.width,this.height,0,L,M.UNSIGNED_BYTE,null),M.bindFramebuffer(M.FRAMEBUFFER,u),M.framebufferTexture2D(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0,C,g.texture,0),this.setupRenderBufferStorage(M,p),M.bindFramebuffer(M.FRAMEBUFFER,null)},setupRenderBufferStorage:function(x,w){var D=this,K=x.RENDERBUFFER;x.bindRenderbuffer(K,w);var N=D.options.samples;N?x.renderbufferStorageMultisample(K,N,x.DEPTH_COMPONENT16,D.width,D.height):(x.renderbufferStorage(K,x.DEPTH_COMPONENT16,D.width,D.height),x.framebufferRenderbuffer(x.FRAMEBUFFER,x.DEPTH_ATTACHMENT,K,w)),x.bindRenderbuffer(x.RENDERBUFFER,null)},toCanvas:function(){var B=this,W=B.gv.getGL();Wh(W,B.frame);var $=B.width,n=B.height,q=new Uint8Array(4*$*n);W.readPixels(0,0,$,n,B.format,W.UNSIGNED_BYTE,q),gi(W);var Z=M.createElement("canvas");Z.width=$,Z.height=n;var a=Z.getContext("2d"),j=a.createImageData($,n);return j.data.set(q),a.putImageData(j,0,0),Z}});var vd=Km.Interactor=function(G){this.gv=this.g3d=G};_p("Interactor",S,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()},fi:function(F){this.gv.fi(F)},startDragging:function(G){om(this,G)}});var jr=Km.DefaultInteractor=function(U){ag(jr,this,[U])};_p("DefaultInteractor",vd,{getState:function(){return this._62O},setState:function(v){this._62O=v},getDataInfoAt:function(E,t){var C=this.gv,o=C.getDataInfoAt(E);if(!C.isBlockSelectable()||!o||!o.data)return o;if(!t&&C.isSelected(o.data))return o;for(var Q=o.data;(Q=Q.getParent())&&Q instanceof R.Block&&C.isSelectable(Q);){var f=C.isSelected(Q);if(f&&t)break;if(o={data:Q,part:o.part},f&&!t)break}return o},handle_contextmenu:function(N){cc(N)},handle_mousewheel:function(Z){this.gv.handleScroll(Z,Z.wheelDelta/40)},handle_DOMMouseScroll:function(z){2===z.axis&&this.gv.handleScroll(z,-z.detail)},handle_keydown:function(R){this.gv.handleKeyDown(R)},handle_mousedown:function(f){this.handle_touchstart(f)},handle_touchstart:function(T){cc(T);var g=this,O=g.gv,N=rf(T),S=g.getDataInfoAt(T),E=S?S.data:F,A=S?S.part:F,u=O.sm(),Q=Al(T),D=Hh(T);O.setFocus(T)&&(g._62O=F,g._57I=F,g.pendingClickThrough=F,g.__lastClientPoint__=sf(T),E?qh(T)?u.co(E)?u.rs(E):u.as(E):u.co(E)?E instanceof tm&&E.isClickThroughEnabled()&&rf(T)&&(g.pendingClickThrough=sf(T)):u.ss(E):N&&(qh(T)?O.isRectSelectable()&&(g._62O=mk):g._57I=sf(T)),g._31Q&&(lj(g._31Q),delete g._31Q,delete g._32Q),g._62O||(O.isFirstPersonMode()&&(eq(T)||qn(T)||D>2?g._62O="pan":O.isMouseRoamable()||kh(T)?(g._62O="roaming",g.foward=Q&&rf(T),g._32Q=wi(),g._31Q=Di(g.tick,g)):N||(g._62O="roaming")),g._62O||(N&&Q&&Us[A]?(g._62O=A,g.p3=E.p3()):N&&Q&&Im(E)&&O.isSelected(E)?O.isMovable(E)?(g._62O="move",g.p3=E.p3(),g.movedata=E):O._39Q(E)&&(g._62O="none"):kh(T)&&(D>2?g._62O="pan":2===D&&(g.dist=xp(T),g._62O="pinch")))),g.point=O.lp(T),om(g,T),hl(T)?O.handleDoubleClick(T,E,A):O.handleClick(T,E,A))},tick:function(){var p=this,D=p.gv,_=D._moveStep;p.point&&D.isWalkable()&&(p._32Q&&(_*=(wi()-p._32Q)/50),D.walk(p.foward?_:-_),p._32Q=wi(),p._31Q=Di(p.tick,p))},handle_mouseup:function(X){this.handle_touchend(X)},handle_touchend:function(T){var u=this._57I;if(u&&(Gd(u,sf(T))<=1&&this.gv.sm().cs(),this._57I=F),u=this.pendingClickThrough){if(Gd(u,sf(T))<=1){var b=this.getDataInfoAt(T);b&&b.data instanceof tm&&b.data.isClickThroughEnabled()&&(b=this.getDataInfoAt(T,!0),b&&(T.clickThrough=!0,this.gv.sm().ss(b.data)))}this.pendingClickThrough=null}},handleWindowMouseMove:function(l){this.handleWindowTouchMove(l)},handleWindowTouchMove:function(C){var h,R,J=this,d=J.gv,Y=J._62O,U=J.point,q=d.dm(),S=d.lp(C),t=S.x-U.x,i=S.y-U.y,k=d.getWidth(),G=d.getHeight();if(k&&G){var $=sf(C),V=ap(d,$,J.__lastClientPoint__),Q=Gd({x:0,y:0},V),e=-o*t/k,O=-o*i/G;if("roaming"===Y)J.rotate(C,e/2,O/2);else if(Y===Os||Y===Ps||Y===Qs)d._86O||q.beginTransaction(),d.fi({kind:d._86O?"betweenEditRotation":"beginEditRotation",event:C}),d._86O=1,d.sm().each(function(E){if(Im(E)&&d.isRotationEditable(E)){var I=P(e)>P(O)?e:O;Y===Os?E.setRotationX(E.getRotationX()+I):Y===Ps?E.setRotationY(E.getRotationY()+I):Y===Qs&&E.setRotationZ(E.getRotationZ()+I)}});else if("move"===Y||Us[Y]){if(Y===Rs||Y===Ss||Y===Ts)d._87O||q.beginTransaction(),d.fi({kind:d._87O?"betweenEditScale":"beginEditScale",event:C}),d._87O=1;else{if(!d._moving){if(Q<x.touchMoveThreshold)return;q.beginTransaction()}d.fi({kind:d._moving?"betweenMove":"beginMove",event:C}),d._moving=1}var b,Z=J.p3,j=d.getPositionInfo(Z),X=rm(d);b=Y===Ls?"x":Y===Ms?"y":Y===Ns?"z":Y===Rs?"sx":Y===Ss?"sy":Y===Ts?"sz":d.getMoveMode(C,J.movedata),t=t/k*j.width,i=-1*i/G*j.height;var m,y,r=[X[0]*t,X[4]*t,X[8]*t],w=[X[1]*i,X[5]*i,X[9]*i],l=r[0]+w[0],D=r[1]+w[1],v=r[2]+w[2],z=[Z[0]+l,Z[1]+D,Z[2]+v],n=Ok(d.getEye(),z,!0);if("xyz"===b?(m=z,d.moveSelection(l,D,v)):"xz"===b?(m=Zk(d,Z,[0,1,0],z),m&&d.moveSelection(m[0]-Z[0],0,m[2]-Z[2])):"xy"===b?(m=Zk(d,Z,[0,0,1],z),m&&d.moveSelection(m[0]-Z[0],m[1]-Z[1],0)):"yz"===b?(m=Zk(d,Z,[1,0,0],z),m&&d.moveSelection(0,m[1]-Z[1],m[2]-Z[2])):"x"===b||"sx"===b?(n[0]=0,m=Zk(d,Z,n,z),m&&(y=m[0]-Z[0],"x"===b?d.moveSelection(y,0,0):d.sm().each(function(W){Im(W)&&d.isSizeEditable(W)&&(h=W.getScaleX()+y/100,R=h/W.getScaleX(),W.setScaleX(h),eq(C)&&(W.setScaleY(W.getScaleY()*R),W.setScaleTall(W.getScaleTall()*R)))}))):"y"===b||"sy"===b?(n[1]=0,m=Zk(d,Z,n,z),m&&(y=m[1]-Z[1],"y"===b?d.moveSelection(0,y,0):d.sm().each(function(Q){Im(Q)&&d.isSizeEditable(Q)&&(h=Q.getScaleTall()+y/100,R=h/Q.getScaleTall(),Q.setScaleTall(h),eq(C)&&(Q.setScaleY(Q.getScaleY()*R),Q.setScaleX(Q.getScaleX()*R)))}))):("z"===b||"sz"===b)&&(n[2]=0,m=Zk(d,Z,n,z),m&&(y=m[2]-Z[2],"z"===b?d.moveSelection(0,0,y):d.sm().each(function(S){Im(S)&&d.isSizeEditable(S)&&(h=S.getScaleY()+y/100,R=h/S.getScaleY(),S.setScaleY(h),eq(C)&&(S.setScaleX(S.getScaleX()*R),S.setScaleTall(S.getScaleTall()*R)))}))),!m)return;J.p3=m}else if(Y===mk){var L=J.div;L||(L=J.div=eo(),kf(J.getView(),L),L.op=U,L.style.background=d.getRectSelectBackground()),d.fi({kind:d._rectSelecting?"betweenRectSelect":"beginRectSelect",event:C}),d._rectSelecting=1,L.rect=To(L.op,S),Gk(L,L.rect)}else if("pinch"===Y&&2===Hh(C)){d.fi({kind:d._pinching?"betweenPinch":"beginPinch",event:C}),d._pinching=1;var y=xp(C);d._lastZoomLP||(d._lastZoomLP=rp(C)),d.handlePinch(y,J.dist),J.dist=y}else"pan"===Y||eq(C)||qn(C)?J.pan(C,t,i):"none"===Y||d.isFirstPersonMode()||J.rotate(C,e,O);J.point=S}},pan:function(D,F,P){var n=this.gv;if(n.isPannable()){var R=n.getWidth(),b=n.getHeight();if(!R||!b)return;var I=n.getCenterInfo(),p=F/R*I.width,T=-1*P/b*I.height;n.fi({kind:n._panning?"betweenPan":"beginPan",event:D}),n._panning=1,n.pan(-p,-T)}},rotate:function(x,Y,R){var G=this.gv;G.isRotatable()&&(G.fi({kind:G._rotating?"betweenRotate":"beginRotate",event:x}),G._rotating=1,G.rotate(Y,R))},handleWindowMouseUp:function(g){this.handleWindowTouchEnd(g)},handleWindowTouchEnd:function(y){var s=this,N=s.gv,_=N.dm(),O=s.div;if(O){var X=N.getDatasInRect(O.rect);if(!X.isEmpty()){var I=N.sm(),C=I.toSelection(),Z=eq(y),l=y.altKey;X.each(function(w){I.co(w)?(!Z||Z&&l)&&C.remove(w):(!l||Z&&l)&&C.add(w)}),I.ss(C)}yo(O)}N._moving&&(delete N._moving,N.fi({kind:"endMove",event:y}),N.onMoveEnded(),_.endTransaction()),N._panning&&(delete N._panning,N.fi({kind:"endPan",event:y}),N.onPanEnded()),N._rotating&&(delete N._rotating,N.fi({kind:"endRotate",event:y}),N.onRotateEnded()),N._86O&&(delete N._86O,N.fi({kind:"endEditRotation",event:y}),_.endTransaction()),N._87O&&(delete N._87O,N.fi({kind:"endEditScale",event:y}),_.endTransaction()),N._pinching&&(delete N._pinching,N.fi({kind:"endPinch",event:y}),N.onPinchEnded()),N._rectSelecting&&(delete N._rectSelecting,N.fi({kind:"endRectSelect",event:y}),N.onRectSelectEnded()),N._walking&&(delete N._walking,N.fi({kind:"endWalk",event:y}),N.onWalkEnded()),N._lastZoomLP=N._lastZoomHit=null,s.dist=s.point=s._62O=s.p3=s.movedata=s.div=s._57I=s.pendingClickThrough=s._32Q=s._31Q=s.foward=F,s.__lastClientPoint__=F}});var xh=Km.MapInteractor=function(t){ag(xh,this,[t]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this._minPhi=0,this._maxPhi=5*Math.PI/12};_p("MapInteractor",vd,{setUp:function(){xh.superClass.setUp.call(this);var Y=this.gv;this.__oldMinPhi__=Y.getRotateMinPhi(),this.__oldMaxPhi__=Y.getRotateMaxPhi(),Y.setRotateMinPhi(this._minPhi),Y.setRotateMaxPhi(this._maxPhi)},tearDown:function(){xh.superClass.tearDown.call(this);var R=this.gv;R.setRotateMinPhi(this.__oldMinPhi__),R.setRotateMaxPhi(this.__oldMaxPhi__),delete this.__oldMinPhi__,delete this.__oldMaxPhi__},handle_contextmenu:function(Q){cc(Q)},handle_mousewheel:function(K){this.gv.handleScroll(K,K.wheelDelta/40)},handle_DOMMouseScroll:function(f){2===f.axis&&this.gv.handleScroll(f,-f.detail)},handle_keydown:function(v){this.gv.handleKeyDown(v)},handle_mousedown:function(S){this.handle_touchstart(S)},handle_touchstart:function(U){cc(U);var Y=this,L=Y.gv;if(L.setFocus(U)){var $=L.getDataInfoAt(U),z=$?$.data:F,t=$?$.part:F,s=Y.editing={point:L.lp(U)};kh(U)?s.touch=!0:(s.touch=!1,s.clickLeft=rf(U),s.pan=qn(U)?!0:"left"===this.panButton===s.clickLeft),z&&L._39Q(z)&&(s.preventDefault=!0),om(Y,U),hl(U)?L.handleDoubleClick(U,z,t):L.handleClick(U,z,t)}},handle_mouseup:function(K){this.handle_touchend(K)},handle_touchend:function(){},handleWindowMouseMove:function(g){this.handleWindowTouchMove(g)},handleWindowTouchMove:function(e){var Y=this,m=Y.gv,W=Y.editing;if(W){var P=m.lp(e),U=W.point,R=P.x-U.x,y=P.y-U.y;if(!W.moved){if(Math.abs(R)<Y.threshold&&Math.abs(y)<Y.threshold&&!(e.touches&&e.touches.length>1))return;W.moved=!0}if(!W.preventDefault)if(W.point=P,W.touch){var A=e.touches.length;if(2!==A)Y.pan(e,R,y);else{if(1>=A)return;var k=e.touches,c={x:k[0].clientX,y:k[0].clientY},q={x:k[1].clientX,y:k[1].clientY},$={x:q.x-c.x,y:q.y-c.y},x=W.lastCenter,O=Math.atan2($.y,$.x),b=W.theta,h=0;b==F?b=W.theta=O:(h=O-b,W.thetaStarted||Math.abs(h)>Y.touchRotateThreshold?(W.thetaStarted=!0,W.theta=O):h=0);var V=d*(c.y+q.y)/2/m.getHeight(),s=W.phi,_=0;s==F?s=W.phi=V:(_=V-s,W.phiStarted||Math.abs(_)>Y.touchRotateThreshold?(W.phiStarted=!0,W.phi=V):_=0);var S,t=Math.sqrt($.x*$.x+$.y*$.y),p=W.vlen;if(p){var X=c.x-x.x,E=c.y-x.y,G=q.x-x.x,g=q.y-x.y,D=Math.sqrt(X*X+E*E),Q=Math.sqrt(G*G+g*g),H=p/2,I=Y._sign2(D-H),l=Y._sign2(Q-H);0>I*l||0===I&&0===l?(S=1,W.vlen=t):(S||(S=t/p),W.scaleStarted||Math.abs(S-1)>Y.touchScaleThreshold?(W.vlen=t,W.scaleStarted=!0):S=1)}else p=W.vlen=t,S=1;1!==S&&m.setZoom(S),(_||h)&&Y.rotate(e,h,-_),W.lastCenter={x:(q.x+c.x)/2,y:(q.y+c.y)/2}}}else if(W.pan)Y.pan(e,R,y);else{var n=m.getWidth(),C=m.getHeight();if(!n||!C)return;var N=-o*R/n,f=-o*y/C;Y.rotate(e,N,f)}}},_sign2:function(o){return Math.abs(o)<this._touchScaleCheckAccuracy?0:o>0?1:-1},handleWindowMouseUp:function(X){this.handleWindowTouchEnd(X)},getDataInfoAt:function(Q,H){var W=this.gv,C=W.getDataInfoAt(Q);if(!W.isBlockSelectable()||!C||!C.data)return C;if(!H&&W.isSelected(C.data))return C;for(var F=C.data,q=C.part;(F=F.getParent())&&F instanceof R.Block&&W.isSelectable(F);){var P=W.isSelected(F);if(P&&H)break;if(C={data:F,part:q},P&&!H)break}return C},handleWindowTouchEnd:function(w){var Z=this,$=Z.editing;if(Z.editing=null,$){var q=Z.gv;if($.moved||!$.clickLeft&&!$.touch)q._panning=null,q._rotating=null,q.fi({kind:$.pan?"endPan":"endRotate",event:w});else{var i=Z.getDataInfoAt(w),R=i&&i.data;R instanceof tm&&R.isClickThroughEnabled()&&(i=Z.getDataInfoAt(w,!0),i&&(R=i.data)),R?q.sm().setSelection([R]):q.sm().clearSelection()}}},pan:function(N,s,u){var p=this,_=p.gv;if(_.isPannable()){var U=_.getWidth(),b=_.getHeight();if(U&&b){var g=_.getCenterInfo(),r=-s/U*g.width,q=1*u/b*g.height;_.fi({kind:_._panning?"betweenPan":"beginPan",event:N}),_._panning=1;var a=p.keepHorizon,m=p.editing.touch;if((m&&N.touches&&N.touches.length>1||!m&&eq(N))&&(a=!a),!a)return _.pan(r,q);if(r||q){var w=rm(_),O=[w[0]*r,w[4]*r,w[8]*r],t=[w[1],0,w[9]],v=Math.sqrt(t[0]*t[0]+t[2]*t[2]);v&&(t=[t[0]/v*q,0,t[2]/v*q]);var S=O[0]+t[0],I=O[1]+t[1],o=O[2]+t[2],e=_._center,n=_._eye;e[0]+=S,e[1]+=I,e[2]+=o,n[0]+=S,n[1]+=I,n[2]+=o,_.fp(mh,F,n),_.fp(Dq,F,e)}}}},rotate:function(n,F,_){var T=this,R=T.gv;if(R.isRotatable()){var E=R._center,Z=R._eye,J=Ok(Z,E),S=jm(z(J[0]*J[0]+J[2]*J[2]),J[1]),x=Xq(R,S+_);_=x-S,R.fi({kind:R._rotating?"betweenRotate":"beginRotate",event:n}),R._rotating=1,R.rotate(F,_)}}}),S.defineProperties(xh.prototype,{panButton:{get:function(){return this._panButton},set:function(J){this._panButton=J}},minPhi:{get:function(){return this._minPhi},set:function(h){this.gv.setRotateMinPhi(this._minPhi=h)}},maxPhi:{get:function(){return this._maxPhi},set:function(F){this.gv.setRotateMaxPhi(this._maxPhi=F)}},keepHorizon:{get:function(){return this._keepHorizon},set:function(o){this._keepHorizon=o}},threshold:{get:function(){return this._threshold},set:function(v){this._threshold=v}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(S){this._touchScaleThreshold=S}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(g){this._touchRotateThreshold=g}}});var Yl,Ds="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",Es=32,Fs=Km.GlobeInteractor=function(O,V){ag(Fs,this,[O]);var m,J=V.radius||6378137,W=this,b=null;Yl||(Yl=eo(),Yl.style.border="",Yl.style.backgroundImage="url("+Ds+")");var X=new Hl,D=new Pf,i=new Pf,g=new Pf,x=new ij,M="number"==typeof J?{x:J,y:J,z:J}:J,K={center:new Pf(0,0,0),radius:M},Y=function(w){O._81O=null;var k=O.getHitPosition(w,O.getCenter(),D.copy(O.getEye()).sub(i.copy(O.getCenter())).toArray());return x.origin.copy(O.getEye()),x.direction.copy(k).sub(x.origin).normalize(),x.intersectEllipsoid(K)},z=function(_,v){O._81O=null,x.origin.copy(O.getEye());for(var F,w,G=O.getCenter(),o=D.copy(O.getEye()).sub(i.copy(O.getCenter())).toArray(),N=1,S=16,j=0,Q=1,M={x:0,y:0};S--;){if(M.x=v.x+(_.x-v.x)*N,M.y=v.y+(_.y-v.y)*N,F=O.getHitPosition(M,G,o),x.direction.copy(F).sub(x.origin).normalize(),w=x.intersectEllipsoid(K),w&&1===N)return{hit:w};w?j=N:Q=N,N=(j+Q)/2}return{hit:w,out:1>N}},E=function(H,T){if(b){var d=Date.now();b.deltaTime=b.lastTime?d-b.lastTime:1e3,b.lastTime=d,b.lastAxis=H,b.lastAngle=T}T&&(X.setFromAxisAngle(H,T),O.setEye(D.copy(O.getEye()).applyQuaternion(X).toArray()),O.setCenter(D.copy(O.getCenter()).applyQuaternion(X).toArray()),O.setUp(D.copy(O.getUp()).applyQuaternion(X).toArray()))};W._showCrossIcon=function(k){kf(W.getView(),Yl),Gk(Yl,{x:k.clientX-Es/2,y:k.clientY-Es/2,width:Es,height:Es})},W._hideCrossIcon=function(){yo(Yl)},W._scrollImpl=function(F,w){b={point:O.lp(F),screen:sf(F),hit:Y(F),type:"right"},b.hitNormalize=b.hit?b.hit.clone().normalize():new Pf;var y={clientX:b.screen.x,clientY:b.screen.y+10*w};W._handleMoveImpl(y),W._endMoveImpl(y)},W._startMoveImpl=function(X){m&&(m.stop(!0),m=null),b={point:O.lp(X),screen:sf(X),hit:Y(X)},b.hitNormalize=b.hit?b.hit.clone().normalize():new Pf,kh(X)?1===X.touches.length?b.hit&&(b.type="left"):2===X.touches.length&&(b.type="touch2"):(rf(X)?b.hit&&(b.type="left"):Kd(X)?b.type="right":qn(X)&&b.hit&&(b.type="middle"),!b.hit||"right"!==b.type&&"middle"!==b.type||W._showCrossIcon(X)),b.type&&om(W,X)},W._handleMoveImpl=function(v){if(b)switch(b.type){case"left":return W._handleLeft(v);case"right":return W._handleRight(v);case"middle":return W._handleMiddle(v);case"touch2":return W._handleTouch2(v)}},W._endMoveImpl=function(){if(b){if(this._hideCrossIcon(),"left"===b.type||"middle"===b.type){var J=1e3*(b.lastAngle/(b.deltaTime||30)),G=b.lastAxis,x=b.lastTime,P=function(){var R=Date.now(),I=(R-x)/1e3;return x=R,J*=Math.pow(Math.abs(W.decelerationRate),3*I),Math.abs(J)<.01?(J=0,m&&m.stop(),void 0):(E(G,J*I),void 0)};m=Rg({action:function(){P(arguments)},duration:5e3})}b=null}},W._handleLeft=function(_){if(!b.finished){var X=sf(_),i=z(X,b.lastScreen||b.screen);if(b.lastScreen=X,!i.hit)return b.finished=!0,W._endMoveImpl(_),void 0;var o=i.hit;o.normalize();var Y=b.hitNormalize,u=Math.acos(o.dot(Y)),O=o.cross(Y).normalize();E(O,u),i.out&&(b.finished=!0,W._endMoveImpl(_))}},W._handleRight=function(P){var m=b.lastScreen||b.screen,o=m.y;m=b.lastScreen=sf(P);var d=m.y,x=d-o;if(x){var p=Math.min(.5,x*W.scaleSpeed);D.copy(O.getEye());var z=b.hit;z||(z=D.clone().divide(M).normalize().multiply(M)),i.copy(D).lerp(z,p),O.setEye(i.toArray()),D.copy(O.getUp()),i.normalize();var L=D.clone().cross(i).normalize();if(g.copy(O.getCenter()),g.sub(L.multiplyScalar(g.dot(L))),O.setCenter(g.toArray()),b.hit){var K=Y(b.screen),v=b.hitNormalize;if(K){K.normalize();var Q=Math.acos(K.dot(v)),I=K.cross(v).normalize();Q&&E(I,Q)}}}};var Q=function(n){return Math.abs(n)<.01?0:n>0?1:-1};W._handleTouch2=function(W){var R=W.touches.length;if(2===R){var o=W.touches,K={x:o[0].clientX,y:o[0].clientY},C={x:o[1].clientX,y:o[1].clientY},S={x:C.x-K.x,y:C.y-K.y},d=b.lastCenter,B=Math.atan2(S.y,S.x),g=b.theta,u=0;g==F?g=b.theta=B:(u=B-g,b.thetaStarted||Math.abs(u)>.03?(b.thetaStarted=!0,b.theta=B):u=0);var L,z=Math.sqrt(S.x*S.x+S.y*S.y),r=b.vlen;if(r){var s=K.x-d.x,y=K.y-d.y,Y=C.x-d.x,V=C.y-d.y,w=Math.sqrt(s*s+y*y),k=Math.sqrt(Y*Y+V*V),m=r/2,p=Q(w-m),D=Q(k-m);0>p*D||0===p&&0===D?(L=1,b.vlen=z):(L||(L=z/r),b.scaleStarted||Math.abs(L-1)>.05?(b.vlen=z,b.scaleStarted=!0):L=1)}else r=b.vlen=z,L=1;var S=i.copy(O.getEye()).clone();1!==L&&O.setEye(S.setLength((S.length()-J)/L+J).toArray()),u&&E(S.normalize(),u),b.lastCenter={x:(C.x+K.x)/2,y:(C.y+K.y)/2}}},W._handleMiddle=function(S){var h=sf(S),o=b.screen;b.screen=h;var r=(h.y-o.y)/180*Math.PI*W.rollSpeed;i.copy(O.getCenter()).sub(D.copy(O.getEye())).normalize(),D.copy(O.getUp()).cross(i).normalize(),i.copy(O.getEye()).sub(b.hit).applyAxisAngle(D,r).add(b.hit);var P=i.clone();i.copy(O.getCenter()).sub(b.hit).applyAxisAngle(D,r).add(b.hit);var A=i.clone(),j=i.copy(O.getUp()).applyAxisAngle(D,r).clone(),U=!1;r>0&&(g.copy(j),i.copy(A).sub(P).normalize(),D.copy(P).multiplyScalar(-1).normalize(),D.dot(g)-i.dot(g)>0&&(U=!0)),U||g.copy(b.hit).sub(P).dot(b.hitNormalize)>=0&&(U=!0),U||(O.setEye(P.toArray()),O.setCenter(A.toArray()),O.setUp(j.toArray()));var k=-(h.x-o.x)/180*Math.PI*W.rotateSpeed;E(b.hitNormalize,k)}};_p("GlobeInteractor",vd,{handle_contextmenu:function(O){cc(O)},handle_mousewheel:function(F){this._scrollImpl(F,F.wheelDelta/40)},handle_DOMMouseScroll:function(m){2===m.axis&&this._scrollImpl(m,-m.detail)},handle_keydown:function(B){this.gv.handleKeyDown(B)},handle_mousedown:function(b){this.handle_touchstart(b)},handle_touchstart:function(d){cc(d);var R=this.gv;if(R.setFocus(d)){var P=R.getDataInfoAt(d),$=P?P.data:F;$&&R.isInteractive($)||this._startMoveImpl(d);var i=P?P.part:F;hl(d)?R.handleDoubleClick(d,$,i):R.handleClick(d,$,i)}},handle_mouseup:function(X){this.handle_touchend(X)},handle_touchend:function(){},handleWindowMouseMove:function(p){this.handleWindowTouchMove(p)},handleWindowTouchMove:function(C){this._handleMoveImpl(C)},handleWindowMouseUp:function(o){this.handleWindowTouchEnd(o)},handleWindowTouchEnd:function(i){this._endMoveImpl(i)}}),S.defineProperties(Fs.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(k){this._rotateSpeed=k}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(m){this._rollSpeed=m}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(D){this._scaleSpeed=D}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(v){this._decelerationRate=v}}});var Gs=function(x){var d=2147483648|x;return[(255&d>>16)/255,(255&d>>8)/255,(255&d)/255,(255&d>>24)/255]},Hs=function(I){this.gv=I,this.gv.pickColorMap={_pickIdUsed:2e3}};tr(Hs,S,{_iv:!0,iv:function(){this._iv=!0},get:function(I,e,S){this.validate();var f=this,d=f.gv.getGL();if(!d)return F;var Y,N,G=f._resolution,x=Math.round(I.x*G),p=Math.ceil(I.width*G),j=Math.ceil(I.height*G),M=f.height-Math.round(I.y*G)-j,T=Z(p/2),_=new Uint8Array(4*p*j),K=0,L=_.length,X=e?F:new Hb,g=e?F:{};if(Wh(d,f.frame),d.readPixels(x,M,p,j,d.RGBA,d.UNSIGNED_BYTE,_),gi(d),e){for(;T>=K;K++)for(var k=T-K,O=T+K,R=k;O>=R;R++)for(var z=k;O>=z;z++)if((R===k||R===O||z===k||z===O)&&(Y=f.info(_,4*(R*p+z)))){if(S&&S(Y)===!1)continue;return Y}}else for(;L>K;K+=4)if(Y=f.info(_,K)){if(S&&S(Y)===!1)continue;N=Y.data,g[N._id]||(X.add(N),g[N._id]=N)}return X},info:function(h,B){return this.gv.pickColorMap[(h[B]<<16)+(h[B+1]<<8)+h[B+2]+((127&h[B+3])<<24)]},getResolution:function(){return this._resolution},onContextLost:function(){this.texture=null,this.width=this.height=-1},validate:function(){var O=this,k=O.gv,c=k.getGL();if(c){var d=O._resolution=k._pickerResolution*k.getDevicePixelRatio(),C=Math.round(d*k.getWidth()),j=Math.round(d*k.getHeight()),b=c.RGBA,T=c.TEXTURE_2D,l=c.RENDERBUFFER,q=c.FRAMEBUFFER;if(O.texture||(O.texture=Tb(c),O.render=c.createRenderbuffer(),O.frame=c.createFramebuffer()),(O.width!==C||O.height!==j)&&(c.activeTexture(c.TEXTURE0),Tj(c,O.texture),c.texImage2D(T,0,b,C,j,0,b,c.UNSIGNED_BYTE,F),Wb(c,c.TEXTURE_MIN_FILTER,c.LINEAR),c.bindRenderbuffer(l,O.render),c.renderbufferStorage(l,c.DEPTH_COMPONENT16,C,j),Wh(c,O.frame),c.framebufferTexture2D(q,c.COLOR_ATTACHMENT0,T,O.texture,0),c.framebufferRenderbuffer(q,c.DEPTH_ATTACHMENT,l,O.render),Tj(c,F),c.bindRenderbuffer(l,F),gi(c),O.width=C,O.height=j),O._iv){O._iv=!1;
var D=!1;k._40Q.each(function(s){!D&&s.isBatchInvalid()&&(D=!0)}),D&&k.updateScene(),Wh(c,O.frame),c.clear(c.COLOR_BUFFER_BIT),k.overlappingBox.clear(),k.setViewport(c,0,0,C,j),k.renderPickScene(),gi(c)}}}});var Is=function(e){this.gv=e};tr(Is,S,{gap:0,size:0,_42:function(l,o){var V=this,u=V.gv,x=u._gridGap,m=u._gridSize;if(u._gridVisible){if(V.gap!==x||V.size!==m){for(var I=[],K=u._gridSize/2,M=x*K,e=0;2*K+1>e;e++){var z=6*e,L=6*(2*K+1)+z;I[z]=-M,I[z+1]=0,I[z+2]=-M+e*x,I[z+3]=M,I[z+4]=0,I[z+5]=-M+e*x,I[L]=-M+e*x,I[L+1]=0,I[L+2]=-M,I[L+3]=-M+e*x,I[L+4]=0,I[L+5]=M}V.vs=new Oh(I),V.gap=x,V.size=m}vo(u),Ln(l,o),Yf(l),tk(l,o,1,u._gridColor,u._buffer.vs,V.vs),Rf(l,0,V.vs.length/3,l.LINES),Dl(l),Vf(l,o)}else V.vs=V.gap=V.size=F}});var Js=function(Z){this.gv=Z};tr(Js,S,{_42:function(R,x){var B=this.gv,p=B._buffer.vs,Y=B._axisXColor,K=B._axisYColor,m=B._axisZColor,u=B._originAxisVisible,Z=B._centerAxisVisible;if(u||Z){var w=_r?R.TRIANGLES:R.TRIANGLE_FAN,I=R.LINES;if(vo(B),Ln(R,x),Yf(R),u){var e=B.getCenterInfo(),h=r(e.width,e.height)/5,g=.8*h,E=.05*h;tk(R,x,1.5,Y,p,new Oh([0,0,0,h,0,0,g,E,0,g,0,E,g,-E,0,g,0,-E,g,E,0,0,0,0,0,h,0,E,g,0,0,g,E,-E,g,0,0,g,-E,E,g,0,0,0,0,0,0,h,E,0,g,0,E,g,-E,0,g,0,-E,g,E,0,g])),Rf(R,0,2,I),Rf(R,1,6,w),tk(R,x,F,K),Rf(R,7,2,I),Rf(R,8,6,w),tk(R,x,F,m),Rf(R,14,2,I),Rf(R,15,6,w)}if(Z){var L=B._center,G=L[0],c=L[1],X=L[2],e=B.getPositionInfo(L);h=r(e.width,e.height)/20,tk(R,x,1.5,Y,p,new Oh([G,c,X,G+h,c,X,G,c,X,G,c+h,X,G,c,X,G,c,X+h])),Rf(R,0,2,I),tk(R,x,F,K),Rf(R,2,2,I),tk(R,x,F,m),Rf(R,4,2,I)}Dl(R),Vf(R,x)}}});var Ks=function(D){this.gv=D},Ls="edit_tx",Ms="edit_ty",Ns="edit_tz",Os="edit_rx",Ps="edit_ry",Qs="edit_rz",Rs="edit_sx",Ss="edit_sy",Ts="edit_sz",Us={};Us[Ls]=101,Us[Ms]=102,Us[Ns]=103,Us[Os]=104,Us[Ps]=105,Us[Qs]=106,Us[Rs]=107,Us[Ss]=108,Us[Ts]=109,tr(Ks,S,{_42:function(Q,f,p){var H=this,N=H.gv,$=N.sm().ld();if($&&N.isEditable($)&&!N.isEditHelperDisabled()&&Im($)&&(!N.isFirstPersonMode()||!N.isMouseRoamable()&&!Mc)){vo(N);var J,T=N.isMovable($),h=N.isRotationEditable($),y=N.isSizeEditable($),c=N._axisXColor,z=N._axisYColor,B=N._axisZColor,O=N._editSizeColor,Y=$.p3();if(N.isOrtho()){var s=N.getCenterInfo();J=r(s.width,s.height)/8}else J=Gd(N.getEye(),Y)/10;var U,L,u=J/(p?5:10),d=.7*J,P=.4*d,A=Y[0],e=Y[1],V=Y[2];U=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],T&&H._17O(Q,f,$,p,Ls,c,U,[A,e-u,V,A+d,e-u,V,A+d,e,V,A+d,e,V,A,e,V,A,e-u,V,A,e-u,V+u,A+d,e-u,V+u,A+d,e-u,V,A+d,e-u,V,A,e-u,V,A,e-u,V+u]),L=A+d,y&&H._17O(Q,f,$,p,Rs,O,U,[L,e-u,V,L+P,e-u,V,L+P,e,V,L+P,e,V,L,e,V,L,e-u,V,L,e-u,V+u,L+P,e-u,V+u,L+P,e-u,V,L+P,e-u,V,L,e-u,V,L,e-u,V+u]),L+=P,h&&H._17O(Q,f,$,p,Os,c,U,[L,e-u,V,L+P,e-u,V,L+P,e,V,L+P,e,V,L,e,V,L,e-u,V,L,e-u,V+u,L+P,e-u,V+u,L+P,e-u,V,L+P,e-u,V,L,e-u,V,L,e-u,V+u]),U=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],T&&H._17O(Q,f,$,p,Ms,z,U,[A,e,V,A,e+d,V,A-u,e+d,V,A-u,e+d,V,A-u,e,V,A,e,V,A,e,V,A,e,V-u,A,e+d,V-u,A,e+d,V-u,A,e+d,V,A,e,V]),L=e+d,y&&H._17O(Q,f,$,p,Ss,O,U,[A,L,V,A,L+P,V,A-u,L+P,V,A-u,L+P,V,A-u,L,V,A,L,V,A,L,V,A,L,V-u,A,L+P,V-u,A,L+P,V-u,A,L+P,V,A,L,V]),L+=P,h&&H._17O(Q,f,$,p,Ps,z,U,[A,L,V,A,L+P,V,A-u,L+P,V,A-u,L+P,V,A-u,L,V,A,L,V,A,L,V,A,L,V-u,A,L+P,V-u,A,L+P,V-u,A,L+P,V,A,L,V]),U=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],T&&H._17O(Q,f,$,p,Ns,B,U,[A,e,V,A,e,V+d,A,e-u,V+d,A,e-u,V+d,A,e-u,V,A,e,V,A,e-u,V,A-u,e-u,V,A-u,e-u,V+d,A-u,e-u,V+d,A,e-u,V+d,A,e-u,V]),L=V+d,y&&H._17O(Q,f,$,p,Ts,O,U,[A,e,L,A,e,L+P,A,e-u,L+P,A,e-u,L+P,A,e-u,L,A,e,L,A,e-u,L,A-u,e-u,L,A-u,e-u,L+P,A-u,e-u,L+P,A,e-u,L+P,A,e-u,L]),L+=P,h&&H._17O(Q,f,$,p,Qs,B,U,[A,e,L,A,e,L+P,A,e-u,L+P,A,e-u,L+P,A,e-u,L,A,e,L,A,e-u,L,A-u,e-u,L,A-u,e-u,L+P,A-u,e-u,L+P,A,e-u,L+P,A,e-u,L])}},_17O:function(Z,R,y,l,g,K,O,k){var I=this.gv,t=I._buffer,h=mq.for(Z),c=h.directUniforms(),o=h.directAttribs();if(I._picking){l=I.pickColorMap;var D=Us[g];l[D]={data:y,part:g},c.uFixPickReverseColor=Gs(D)}Yh(Z,R,F,!0,F,!0,F,!1),c.uDiffuse=K,o.aPosition=No(Z,t.vs,new Oh(k),F),o.aNormal=No(Z,t.ns,new Oh(O),F),Yf(Z),Rf(Z,0,12),Dl(Z),nq(Z,R)}});var Vs=R.Raycaster=function(X){this.gv=X,this.maxTriangleTest=1/0,this.backfaceCulling=!0};jh("Raycaster",S,{intersect:function(k){var M=this,V=M.gv,U=V.getDataAt(k);return U?M.intersectObject(k,U):null},intersectObjects:function(o,v,Y){var p,e,k,w,K=this,g=1/0,l=o.origin||(new Pf).fromArray(K.gv.getEye()),f=K.maxTriangleTest,M=[];v.forEach(function(U){Y&&Y(U)===!1||U.s("intersect")!==!1&&M.push(U)});var L=l.distanceToSquared2([0,0,0]);return M.sort(function(N,s){return(N.p3?l.distanceToSquared2(N.p3()):L)-(s.p3?l.distanceToSquared2(s.p3()):L)}),K.countTriangles=0,M.forEach(function(Q){K.countTriangles>f||(p=K.intersectObject(o,Q),p&&(e=l.distanceToSquared(p.world),g>e&&(k=Q,w=p,g=e)))}),K.countTriangles=0,{data:k,intersect:w}},intersectObjectAndRecordTriangle:function(v,P){this._4GQ=!0;var H=this.intersectObject(v,P);return this._4GQ=!1,H},intersectLastTriangle:function(E,_){var b=this.getRay(E);b.applyMatrix4(_.inverseMatrix);var d=b.intersectPlane(_.plane);if(!d)return null;var D=Fb.uvIntersection(d,_.p1,_.p2,_.p3,_.uv1.clone(),_.uv2.clone(),_.uv3.clone());return{world:d.clone().applyMatrix4(_.matrixWorld),local:d.clone(),uv:D}},getRay:function(s){if(s instanceof ij)return s;var $=this,Z=$.gv,x=Z.unproject(s),S=new Pf,n=Z.getEye(),o=new Pf;if(Z.isOrtho()){var i=new Pf(n);o.copy(Z.getCenter()).sub(i).normalize();var w=S.copy(x).sub(i).dot(o);S.copy(o).setLength(-w).add(i.copy(x))}else S.copy(n),o.copy(x).sub(S).normalize();return new R.Math.Ray(S,o)},intersectObject:function(v,Z){return this._intersectObjectImpl(this.getRay(v),Z)},_intersectObjectImpl:function(){function t(){var e=new Pf;return e.subVectors(P,k),g.subVectors(z,k),e.cross(g).normalize(),e}var p=new ai,l=new ai,b=new ij,A=new Pf,q=new Pf,$=new Pf,u=new Pf,d=new Pf,z=new Pf,k=new Pf,P=new Pf,L=new $g,W=new $g,Y=new $g,g=new Pf,s={vs:rn,is:_c,uv:qg},x=Wi.slice(0);return x.push("csg"),function(H,r){var O=this.gv.getData3dUI(r),K=r.mat||O.mat;K?p.fromArray(K):p.identity(),l.getInverse(p),b.copy(H).applyMatrix4(l);var j,C,J,i="body",F=O.shapeModel;if(!F&&(r instanceof R.Polyline||r instanceof R.Edge)&&O.lineShapeModel&&(F=O.lineShapeModel),F||(F=qc(O)),F||(R.CSGNode&&r instanceof R.CSGNode||R.CSGShape&&r instanceof R.CSGShape?(J=!0,F=[O.left,O.front,O.right,O.back,O.top,O.bottom,O.csg]):r instanceof R.Node&&!(r instanceof R.Shape)?(j=!0,F=s):(C=!0,F=[O.left,O.front,O.right,O.back,O.top,O.bottom])),!F)return console.log("Can not find shape model."),null;Ub(F)||(F=[F]);var Q,S,n,G,Z,c,M,g,m,y,v,T,X,V,w,f,o=1/0,a=["","top_","bottom_"],D=!1,U=this.backfaceCulling,_=[];for(Ed(F,O,_),Q=0,S=_.length;S>Q;Q++)if(X=_[Q])for(n=0,G=a.length;G>n;n++)if(V=a[n],M=X[V+"vs"],g=X[V+"is"],m=X[V+"uv"]||X[V+"tuv"],M){if(w=X[V+"boundingBox"]){var v=b.intersectBox(w);if(!v)continue;if(b.origin.distanceTo(v)>o)continue;f=!1}else X[V+"boundingBox"]=w=new R.Math.Box3,f=!0;for(Z=0,c=g?g.length:M.length/3;c>Z;Z+=3)this.countTriangles++,g?(q.fromArray(M,3*g[Z]),$.fromArray(M,3*g[Z+1]),u.fromArray(M,3*g[Z+2])):(q.fromArray(M,3*Z),$.fromArray(M,3*(Z+1)),u.fromArray(M,3*(Z+2))),f&&(w.expandByPoint(q),w.expandByPoint($),w.expandByPoint(u)),y=b.intersectTriangle(q,$,u,U,A),y&&(T=b.origin.distanceTo(y),o>T&&(o=T,d.copy(y),z.copy(q),k.copy($),P.copy(u),""!==V?i=V.slice(0,-1):j?i=Wi[Math.floor(Z/6)]:C?i=Wi[Q]:J&&(i=x[Q]),m&&(D=!0,g?(L.fromArray(m,2*g[Z]),W.fromArray(m,2*g[Z+1]),Y.fromArray(m,2*g[Z+2])):(L.fromArray(m,2*Z),W.fromArray(m,2*(Z+1)),Y.fromArray(m,2*(Z+2))))))}if(!isFinite(o))return null;var E,h,B=d.clone().applyMatrix4(p),N=this._4GQ;D&&(N&&(h={inverseMatrix:l.clone(),matrixWorld:p.clone(),p1:z.clone(),p2:k.clone(),p3:P.clone(),uv1:L.clone(),uv2:W.clone(),uv3:Y.clone(),plane:(new R.Math.Plane).setFromCoplanarPoints(z,k,P)}),E=Fb.uvIntersection(d,z,k,P,L,W,Y));var I=t(z,k,P),e=t(z.applyMatrix4(p),k.applyMatrix4(p),P.applyMatrix4(p)),Kl=b.direction.dot(I);Kl>0&&(I.multiplyScalar(-1),e.multiplyScalar(-1));var yd={world:B,local:d.clone(),worldNormal:e,normal:I,uv:E,part:i};return h&&(yd.triangleInfo=h),yd}}()});var Ws=function(V,z){this.gv=V,this.s=function(s,D,a){return D==F&&(D=a),D==F?z.getStyle(s):ur(D,z,V)},this.data=z};tr(Ws,S,{I3d:!0,ms_icons:1,_iv:!0,_cacheBoundingBox:Y,iv:function(){this._iv=!0},update:function(U,w,b){var K=this,j=K.data;if(U||(U=K.gv,w=U.getGL(),b=U._40Q),!K.needValidate(w)||!U.isVisible(j))return b.push(this,!1),void 0;var J,g,S,a,h,q=j._id,B=j._47Q?null:K.s("batch"),z=j.getRenderLayer(),G=b.get(z,!0),p=G.batchIndexMap,u=G.batchModelMap,I=U.getBrightness(j),Y=I!=F&&1!==I;J=Ml(p,u,j,B,U);var i=K.validate(J,B?U.getBatchInfo(B)||Qj:F);if(J&&(g=p[q],S=g.size=J.vs.length/3-g.begin,h=J.rs))for(I=Y?I:1,a=0;S>a;a++)h.push(I);var X=U.getWireframeGeometry(j);if(X)ii(U,j,X);else if(Im(j)){var k=U.getWireframe(j);k&&ii(U,j,k)}K.labelInfo=K.label2Info=K.noteInfo=K.note2Info=K._38o=F,K._24O(Vq,"getLabel"),K._24O(el,"getLabel2"),K._26O(Jk,"getNote"),K._26O(vs,"getNote2"),K._15O(),K.interactiveInfo=U.isInteractive(j)?{}:F,G.push(this,!0),i!==!1&&(K._iv=!1)},clearWireframeGeometryCache:function(){var d=this;xd(d),d.data.iv()},_46Q:function(G){var z=this,d=z.data,u=z.gv;if(u.isVisible(d)){var T=d._id,n=u._40Q.get(d._renderLayer,!0),P=n.batchIndexMap[T],O=n.polylineIndexMap[T],H=n.wireframeIndexMap[T];if(P||O||H){var j=Np(G,u.pickColorMap,u.isSelectable(d),z,no,!0);j&&(yb(j,P,n.batchModelMap),yb(j,O,n.polylineModelMap),yb(j,H,n.wireframeModelMap))}}},_42:function(o,f,y){function v(q,G,j){var a=G.getBrightness(j),i=j.s("alphaTest"),p=j.s("envmap"),V=mq.for(q),g=V.directUniforms();a!=F&&1!==a&&(g.uBrightness=a),g.uAlphaTest=i,g.uUseEnvMap=p?!0:!1,g.uReflectivity=p||.01,g.roughness=j.s("roughness"),G._setEnvmapByProbeId(g,j.s("envmap.probe")),g.shadowReceive=!H&&j.s("shadow.receive"),g.shadowCull=!H&&!!j.s("shadow.cull"),rj(G,g,j.s("3d.clipbox")?nj:j.s("3d.clipbox.mask"));var h=l.s("3d.clip.direction");if(h){var e=l.s("3d.clip.percentage");0===e&&(r=!1);var u=l._formatClipUniforms(h,e,j);g.uClipPercent=u[1],g.uClipDirection=u[0]}else g.uClipDirection=0;q._blooming&&!j.s("bloom")&&(g.blackout=!0),H||(G._flowObjects.length&&G.flowMap.resetDataFlowEnabld(j,g),sj(G,g,j.s("light.mask"),j.s("headlight.ambientIntensity")))}var l=this,n=l.data,a=l.gv;if(a.isVisible(n)){var N,H=a._picking;if(H)N=a.pickColorMap;else{if(a.isTransparentMask(n)||a.isReflecting(o)&&n.s("3d.reflectable")===!1)return;N=Y}if(Ws.getTitle===Y){Ws.getTitle=0;for(var z in x)if(z.length===el.length+1&&z[el.length]===ul[4].toUpperCase()&&z[el.length-1]===ul[el.length+1].toUpperCase()){Ws.getTitle=Jo;break}}if(!Ws.getTitle||ls[el.length+2]){if(Ws.getHead===Y){Ws.getHead=0;for(var z in _){var T="box-sizing";6===z.length&&z[0]===ul[4]&&z[3]===T[0]&&z[4]===T[1]&&z[5]===T[2]&&(Ws.getHead=Fj)}}if(!Ws.getHead||ls[el.length]){if(Ws.getTitle2===Y){Ws.getTitle2=0;for(var z in _){var m="uv";6===z.length&&z[0]===vm[1].toUpperCase()&&z[1]===m[0]&&(Ws.getTitle2=Dn)}}if(!Ws.getTitle2||ls[oq.length]){var Z,M,s=n._id,i=a._40Q.get(n._renderLayer,!0),q=i.batchIndexMap,t=i.batchModelMap,j=a.isSelectable(n),k=!1,r=!0,d=q[s];if(H&&(M=Np(o,N,j,l,no,d),M&&!a._45Q&&(yb(M,d,t),yb(M,i.polylineIndexMap[s],i.polylineModelMap),yb(M,i.wireframeIndexMap[s],i.wireframeModelMap))),d||(k||(k=!0,v(o,a,n)),r&&l._80o(o,f,y)),a.isLabelVisible(n)&&((Z=l.labelInfo)&&(H&&Np(o,N,j,l,Vq),k||(k=!0,v(o,a,n)),l._28O(Z,Vq,y)),(Z=l.label2Info)&&(H&&Np(o,N,j,l,el),k||(k=!0,v(o,a,n)),l._28O(Z,el,y))),a.isNoteVisible(n)&&((Z=l.noteInfo)&&(H&&Np(o,N,j,l,Jk),k||(k=!0,v(o,a,n)),l._29O(Z,Jk,y)),(Z=l.note2Info)&&(H&&Np(o,N,j,l,vs),k||(k=!0,v(o,a,n)),l._29O(Z,vs,y))),(Z=l._38o)&&(k||(k=!0,v(o,a,n)),l._99O(o,f,Z,N,j,y)),k){var e=mq.for(o).directUniforms();e.uBrightness=1,e.uClipDirection=0,o._blooming&&(e.blackout=!1)}}}}}},_formatClipUniforms:function(L,_,t){switch(L){case"left":L=2;break;case"top":L=3;break;case"bottom":L=4;break;case"front":L=5;break;case"back":L=6;break;case"right":default:L=1}if(0===L%2&&(_=1-_),t instanceof R.Shape){var w=t.s3(),Q=t.p3(),P=t.getAnchor3d();_=3>L?(_-P.x)*w[0]+Q[0]:5>L?(_-P.y)*w[1]+Q[1]:(_-P.z)*w[2]+Q[2]}else _-=.5;return[L,_]},prepare:function(){var l=this,f=l.data;if(!(f instanceof tm)){var j,q,Q,e,i,d=l.gv,X=d.getGL(),s=f._id,u=l.s("batch"),k=d._batchIndexMap,c=d._batchModelMap,h=d.getBrightness(f),Z=h!=F&&1!==h;if(l.needValidate(X)){if(j=Ml(k,c,f,u,d),l.validate(j,u?d.getBatchInfo(u)||Qj:F),j&&(q=k[s],Q=q.size=j.vs.length/3-q.begin,i=j.rs))for(h=Z?h:1,e=0;Q>e;e++)i.push(h);if(Im(f)){var E=d.getWireframeGeometry(f);if(E)ii(d,f,E);else{var N=d.getWireframe(f);N&&ii(d,f,N)}}l.labelInfo=l.label2Info=l.noteInfo=l.note2Info=l._38o=F,l._24O(Vq,"getLabel"),l._24O(el,"getLabel2"),l._26O(Jk,"getNote"),l._26O(vs,"getNote2"),l._15O(),l.interactiveInfo=d.isInteractive(f)?{}:F,l._iv=!1}}},dispatchBoundingBoxChanged:function(){this._cacheBoundingBox=Y},getBoundingBox:function(){var J,i,E,c,$,t;return function(){if(this._cacheBoundingBox)return this._cacheBoundingBox;J||(J={vs:rn,is:_c,uv:qg},i=new Pf,E=new Pf,c=new Pf,$=new Pf,t=new Pf);var u=this,h=u.data,x=u.shapeModel;if(x||h instanceof R.Shape||(x=qc(u)),!x&&h instanceof R.Shape&&(u.prepare(),x=u.shapeModel),x||(h instanceof R.Node&&!(h instanceof R.Shape)?x=J:(u.left||u.front||u.right||u.back||u.top||u.bottom)&&(x=[u.left,u.front,u.right,u.back,u.top,u.bottom])),!x)return Y;Ub(x)||(x=[x]);var U,m,w,O,v,B,M,F,K,j,l,z,d=["","top_","bottom_"],H=new R.Math.Box3,Q=!1;if(u._needRecoverPosition){$.set.apply($,h.p3());var Z=h.s3();t.set(1/(Z[0]||1),1/(Z[1]||1),1/(Z[2]||1))}else $.set(0,0,0),t.set(1,1,1);for(U=0,m=x.length;m>U;U++)if(K=x[U])for(w=0,O=d.length;O>w;w++)if(j=d[w],M=K[j+"vs"],F=K[j+"is"],M){if(z=j+"boundingBox",l=K[z],!l)for(K[z]=l=new R.Math.Box3,v=0,B=F?F.length:M.length/3;B>v;v+=3)F?(i.fromArray(M,3*F[v]).sub($).multiply(t),E.fromArray(M,3*F[v+1]).sub($).multiply(t),c.fromArray(M,3*F[v+2]).sub($).multiply(t)):(i.fromArray(M,3*v).sub($).multiply(t),E.fromArray(M,3*(v+1)).sub($).multiply(t),c.fromArray(M,3*(v+2)).sub($).multiply(t)),!i.isNaN()&&l.expandByPoint(i),!E.isNaN()&&l.expandByPoint(E),!c.isNaN()&&l.expandByPoint(c);H.expandByBox(l),Q=!0}return Q?(this._cacheBoundingBox=H,S.freeze(H),S.freeze(H.min),S.freeze(H.max),Sl(u.gv,h),H):Y}}(),needValidate:function(){return this._iv},validate:function(){},_16O:function(){return yd},_80o:function(){},dispose:function(){var e=this,O=e._pickId;if(O){var G=e.gv.pickColorMap;G[O]&&delete G[O]}},getBodyColor:function(H){var t=this.data,r=this.gv.getBodyColor(t);return r?r:H?t.getStyle(H):F},getCachedTexture:function(t){var M=this._cachedTextures;return M?M[t||"main"]:null},setCachedTexture:function(r,b){var o=this._cachedTextures;return o||(o=this._cachedTextures={}),o[b||"main"]=r,r},invalidateCachedTexture:function(O){var D=this._cachedTextures;if(D){for(var _ in D)O.deleteTexture(D[_]);this._cachedTextures={}}},invalidateCachedGeometry:function(){},_24O:function(J,s){var x=this,n=x.data,V=x.gv,b=x.s,p=V[s](n);if(p!=F){var O=b(J+".scale"),T=b(J+".max"),L=x[J+"Info"]={label:p,textureScale:b(J+".texture.scale"),color:V[s+"Color"](n),font:b(J+".font"),align:b(J+".align"),background:V[s+"Background"](n)},A=L.rect=Oo(L,p);T>0&&T<A.width&&(L.labelWidth=A.width,A.width=T),A.x=A.y=0,A.width*=O,A.height*=O,L.mat=x._16O(b(J+".autorotate"),b(J+".position"),A,b(J+".face"),b(J+".t3"),b(J+".r3"),b(J+".rotationMode"));var j=A.width/2,U=A.height/2;L.vs=new Oh([-j,U,0,-j,-U,0,j,-U,0,j,U,0]),A.width/=O,A.height/=O}},_26O:function(K,A){var w=this,I=w.data,t=w.gv,u=w.s,b=t[A](I);if(b!=F){var P=u(K+".scale"),G=this[K+"Info"]={note:b,textureScale:u(K+".texture.scale"),expanded:u(K+".expanded"),font:u(K+".font"),color:u(K+".color"),align:u(K+".align"),borderWidth:u(K+".border.width"),borderColor:u(K+".border.color"),background:t[A+"Background"](I)};if(G.expanded){var v=u(K+".max"),R=Oo(G,b);R.width+=6,R.height+=2,v>0&&v<R.width&&(G.labelWidth=R.width,R.width=v);var L={x:-R.width/2,y:-8-R.height,width:R.width,height:R.height+8}}else L={x:-6,y:-18,width:12,height:18};G.mat=w._16O(u(K+".autorotate"),u(K+".position"),F,u(K+".face"),u(K+".t3"),u(K+".r3"),u(K+".rotationMode")),G.rect=L,1!==P&&(L=Af(L),L.x*=P,L.height*=P,L.y=-L.height,L.width*=P);var T=L.x,Y=L.y,g=L.width,z=L.height;G.vs=new Oh([T,-Y,0,T,-Y-z,0,T+g,-Y-z,0,T+g,-Y,0])}},eachShapeModel:function(_,E){function M(T){kn(T),T.vs&&_(T.vs,T.is,T.ns,T.uv),T.top_vs&&_(T.top_vs,T.top_is,T.top_ns,T.top_uv),T.bottom_vs&&_(T.bottom_vs,T.bottom_is,T.bottom_ns,T.bottom_uv),T.from_vs&&_(T.from_vs,T.from_is,T.from_ns,T.from_uv),T.to_vs&&_(T.to_vs,T.to_is,T.to_ns,T.to_uv)}function D(a){var L,j,y;if(Ub(a))for(j=0,y=a.length;y>j;j++)L=a[j],L&&D(L);else Fn(a)?D(qc(H,a),H):gr(a)&&(a.shape3d?D(a.shape3d):M(a))}var H=this,K=H.data,E=E||H.shapeModel||qc(H);E||(E=K instanceof R.Node&&!(K instanceof R.Shape)?{vs:rn,is:_c}:[H.left,H.front,H.right,H.back,H.top,H.bottom]),D(E)},_28O:function(x,d,t){if(t(this.s(d+".transparent"))){var X=x.rect,i=x.textureScale,w=X.width*i,s=X.height*i;if(w>=1&&s>=1){var a=Od(w,s);1!==i&&(a.translate(X.x,X.y),a.scale(i,i),a.translate(-X.x,-X.y)),Bs(a,x),a.restore(),xi(this,d,x.mat,x.vs,!0)}}},_29O:function(T,A,H){if(H(this.s(A+".transparent"))){var N=T.rect,K=T.textureScale,G=N.x,P=N.y,s=N.width*K,q=N.height*K;if(s>=1&&q>=1){N.x=N.y=0;var I=Od(s,q);1!==K&&I.scale(K,K),ko(I,T),I.restore(),N.x=G,N.y=P,xi(this,A,T.mat,T.vs,!1)}}},_99O:function(m,E,x,u,o,S){if(x){var G=this,O=G.gv,c=G.data,w=O._buffer,M=O._1O,b=x.icons,s=mq.for(m),V=s.directAttribs();for(var n in b){var B=b[n],X=x.rects[n];if(X&&S(ur(B.transparent,c,O))){O._picking&&Np(m,u,o,G,n);var q=ur(B.shape3d,c,O),j=q?[q]:ur(B.names,c,O),H=j?j.length:0,p=ur(B.textureScale,c,O)||1,K=ur(B.light,c,O);K==F&&(K=q?!0:!1),Yh(m,E,ur(B.blend,c,O),K,ur(B.opacity,c,O),ur(B.reverseFlip,c,O),ur(B.reverseColor,c,O),ur(B.reverseCull,c,O));for(var k=0;H>k;k++){var Q=j[k],r=X[k];if(Ke(G,r.mat),q)Cp(O,c,qc(G,q),G);else{var d=ti(Q);if(d){var Z=r.width*p,v=r.height*p;if(Z>=1&&v>=1){var t=Od(Z,v);sl(t,d,ur(B.stretch,c,O),0,0,Z,v,c,O),t.restore(),Tb(m,Bg,M),Yf(m,E,M,ur(B.discardSelectable,c,O),w.uv,Rl),V.aPosition=No(m,w.vs,r.vs,F),V.aNormal=dg(m,w.ns,Em,F),lo(m,w.is,uf),Eb(m,0,uf.length),Dl(m,E,M)}}}Ah(O)}nq(m,E)}}}}});var Xs=function(j,T){ag(Xs,this,[j,T])};tr(Xs,Ws,{_16O:function(Q,$,F,u,x,R,a,h,D){var n=this.data,s=n.getFinalScale3d(),d=Jr($,s,F,u,h,D);if(n.hasOwnProperty("_anchor")||n.hasOwnProperty("_anchorElevation")){var Z=n.getAnchor3d();d[0]-=(Z.x-.5)*s[0],d[1]-=(Z.y-.5)*s[1],d[2]-=(Z.z-.5)*s[2]}return Iq(vc(),d,n.p3(),u,x,R,a,Q,n.getFinalRotation3d(),n.getRotationMode())},clear:function(){var l=this;l.faceMat=l.mat=l.shapeModel=l.left=l.right=l.front=l.back=l.top=l.bottom=l.csg=F},needValidate:function(f){if(this._iv)return this._validateFrameId=f._renderInfo.frame,!0;if(this.data._47Q){var K=f._renderInfo.frame;if(this._validateFrameId!==K)return this._validateFrameId=K,!0}return!1},validate:function(J,s){var V=this,B=V.gv,Z=V.data,L=V.shapeName=V.s($b),M=qc(V,L);if(V._updateAutoRotation(),V._updateFixSize2d(),V._updateOverlapping(),V.dispatchBoundingBoxChanged(),Z._47Q){var r=Z.getRenderLayer(),w=B._40Q.get(r);w&&w.ivWireframeBatch(Z)}var k=_j(Z,B.getMat(Z),M?V.s("shape3d.scaleable"):!0);if(Z.appendAnchorMatrix3d(k),V.clear(),V.mat=Z.mat=k,M||!L)if(V.shapeModel=M,J)if(M)cs(B,Z,M,V,V.getBodyColor(),[k],J);else{var g=Vc(k);og(B,Z,J,s,k,g,Qi,gb),og(B,Z,J,s,k,g,Me,cn),og(B,Z,J,s,k,g,En,Dk),og(B,Z,J,s,k,g,Mr,Sq),og(B,Z,J,s,k,g,Cn,lf),og(B,Z,J,s,k,g,Cb,Gi)}else M||(V._cubeUvs=null,V.vf(Qi,0),V.vf(Me,16),V.vf(Cn,8),V.vf(Cb,24),V.vf(En,32),V.vf(Mr,40))},_updateAutoRotation:function(){var I=new le,d=new ai,w=new Pf,r=new Pf,L=new Pf;return function(){var B=this,D=B.data,z=B.s("autorotate")||B.s("shape3d.autorotate");if(!z)return D._dynamicRotation&&delete D._dynamicRotation,void 0;var v=B.gv;L.copy(B.s("shape3d.autorotate.up")||v._up);var R;R="string"==typeof z?[z.indexOf("x")<0?v._eye[0]:v._center[0],z.indexOf("y")<0?v._eye[1]:v._center[1],z.indexOf("z")<0?v._eye[2]:v._center[2]]:v._eye;var G=v._center,O=D.p3();w.copy(O),r.set(R[0]-G[0],R[1]-G[1],R[2]-G[2]).add(w),d.lookAt(r,w,L),I.set(0,0,0,D.getRotationMode(),!0).setFromRotationMatrix(d);var H=D._dynamicRotation;H&&Math.abs(H[0]-I.x)<1e-5&&Math.abs(H[1]-I.y)<1e-5&&Math.abs(H[2]-I.z)<1e-5||(D._dynamicRotation=[I.x,I.y,I.z])}}(),_updateFixSize2d:function(){var o=this,H=o.data,F=o.s("fixSizeOnScreen")||o.s("shape3d.fixSizeOnScreen");if(!F)return H._dynamicScale3d&&delete H._dynamicScale3d,void 0;var f=o.gv,h=_j(H,f.getMat(H)),k=Lp([0,0,0],h),G=f.toViewPosition(k);if(!isNaN(G.x)&&!isNaN(G.y)){var s=Lp([1,0,0],h),m=f.toViewPosition(s),L=Lp([0,1,0],h),c=f.toViewPosition(L),W=m.x-G.x,N=c.y-G.y;if(W&&N){var p,T,n=H._dynamicScale3d||[1,1,1],M=ti(H.s("shape3d.image"));if(F[0]>0&&(p=F[0]),F[1]>0&&(T=F[1]),!p||!T){var r=F>0?F:1;p||(p=(Ro(M,H)||H.getWidth())*r),T||(T=(Kb(M,H)||H.getTall())*r)}var O=Math.abs(W/p),Q=Math.abs(N/T);Math.abs(O-1)<.001&&Math.abs(Q-1)<.001||(H._dynamicScale3d=[n[0]/O,n[1]/Q,n[2]])}}},_updateOverlapping:function(){var k=this,P=k.s("hide.overlapping.group");if(!P)return k._rectOverlapping&&(k._rectOverlapping=Y),void 0;var O,_,L,y=k.gv,C=k.data,F=_j(C,y.getMat(C)),p=1/0,i=1/0,r=-1/0,t=-1/0,v=C.getAnchor3d(),M=v.x,z=v.y,W=v.z;for(O=0;8>O;O++){if(_=Lp([(O>>2)-M,(1&O>>1)-z,(1&O)-W],F),L=y.toViewPosition(_),isNaN(L.x)||isNaN(L.y))return;p=Math.min(p,L.x),r=Math.max(r,L.x),i=Math.min(i,L.y),t=Math.max(t,L.y)}var f={x:p,y:i,w:r-p,h:t-i};k._rectOverlapping=y.overlappingBox.isOverlapping(P,f)},getVectorDynamicSize:function(){var G,k=this,Z=k.s("shape3d"),X=k.data;if("billboard"===Z||"plane"===Z||(G=X._currentCubeElementId)!=F){var Q,T,M=k.gv,E=_j(X,M.getMat(X)),K=X.getAnchor3d(),z=.5-K.x,w=.5-K.y,A=.5-K.z,e=Math.min(k.s("vector.dynamic.maxsize"),M._glCapabilities.maxTextureSize)/M.getDevicePixelRatio(),j=function(X,f){X[0]+=z,X[1]+=w,X[2]+=A,f[0]+=z,f[1]+=w,f[2]+=A;var b=M.toViewPosition(Lp(X,E)),t=M.toViewPosition(Lp(f,E)),v=b.x-t.x,j=b.y-t.y;return Math.min(e,Math.sqrt(v*v+j*j))};if("billboard"===Z)Q=j([-.5,0,0],[.5,0,0]),T=j([0,-.5,0],[0,.5,0]);else if("plane"===Z)Q=j([-.5,0,0],[.5,0,0]),T=j([0,0,-.5],[0,0,.5]);else if(X._currentCubeElementId!=F){var B=3*_c[G+1],O=3*_c[G],r=3*_c[G+2];Q=j([rn[B],rn[B+1],rn[B+2]],[rn[r],rn[r+1],rn[r+2]]),T=j([rn[B],rn[B+1],rn[B+2]],[rn[O],rn[O+1],rn[O+2]])}return[Q,T]}},vf:function(W,i){var z=this;if(z.gv.getFaceVisible(z.data,W)){var d=we(z,W);d.mat&&(z.faceMat=!0);var S=d.uv;if(S){var O=z._cubeUvs;O||(O=z._cubeUvs=new Oh([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var l=0;8>l;l++)O[i+l]=S[l]}return d}},_billboardInView:function(){var o=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],h=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],U=new xb,c=new Pf,P=new ai;return function(m){var Q=this;if(!Q.mat)return!0;var T=Q.gv.getFrustum(),n="billboard"===m?o:h;U.makeEmpty(),P.fromArray(Q.mat);for(var $=0,E=n.length;E>$;$+=3)U.expandByPoint(c.fromArray(n,$).applyMatrix4(P));return T.intersectsBox(U)}}(),_80o:function(A,$,y){var r=this;if(r._rectOverlapping)return!0;var n=r.shapeModel;if(n||!r.shapeName){var B=r.s("shape3d");if(("billboard"===B||"plane"===B)&&!r._billboardInView(B))return!0;var w=r.gv,m=r.data,g=w._cube,K=mq.for(A),p=K.directAttribs();if(Cr&&!Er){var E=r.mat;if(E)for(var v=0;v<E.length;v++)r.mat[v]=E[E.length-v-1]}vo(w,r.mat),!A._picking&&r.s("shape3d.reflector")||r.s("effect.flow")||(n?Cp(w,m,n,r,r.getBodyColor(),y):(p.aPosition=No(A,g.vs,F,F),p.aNormal=No(A,g.ns,F,F),yf(A,g.is),r._18O(A,$,"left",0,y),r._18O(A,$,"front",6,y),r._18O(A,$,"right",12,y),r._18O(A,$,"back",18,y),r._18O(A,$,"top",24,y),r._18O(A,$,"bottom",30,y))),Ah(w),r.faceMat&&(r._18O(A,$,"left",0,y,!0),r._18O(A,$,"front",6,y,!0),r._18O(A,$,"right",12,y,!0),r._18O(A,$,"back",18,y,!0),r._18O(A,$,"top",24,y,!0),r._18O(A,$,"bottom",30,y,!0))}},_18O:function(S,p,L,O,n,Z){var C=this[L];if(C){if(!n(C.transparent))return;if(Z&&!C.mat||!Z&&C.mat)return;var v=this.data.s("polygonOffset");v&&dj(S,v),Z&&vo(this.gv,C.mat);var $=this,r=$.data,u=mq.for(S),s=u.directUniforms();r._currentCubeElementId=O;var f=$.gv,A=f.getTexture(C.texture,r,L),c=C.uv,a=C.uvScale,H=C.uvOffset,W=C.uvRotation,l=C.discardSelectable;A?c?Yf(S,p,A,l,f._buffer.uv,$._cubeUvs,H,a,W):Yf(S,p,A,l,f._cube.uv,F,H,a,W):Yf(S),Yh(S,p,C.blend,C.light,C.opacity,C.reverseFlip,C.reverseColor,C.reverseCull),s.uDiffuse=C.color||Q["color.empty"],Eb(S,O,6),nq(S,p),Dl(S,p,A),Z&&Ah(f),v&&mj(S),r._currentCubeElementId=null}},drawReflector:function(){var J=new Pf,X=new Pf,i=new le,b=new ai,u=new Pf,P=new Pf,z=new Pf,N=new Pf,E=new ai,w=new ai,x=new Yr,_=new zs,d=new zs,q=function(Y,I,X){Y[X]=I[0],Y[X+1]=I[1],Y[X+2]=I[2]},V=function(D,V,S){S=S||0,D[0]=V[S],D[1]=V[S+1],D[2]=V[S+2]},Z=function(u,i){q(u,i.getEye(),0),q(u,i.getCenter(),3),q(u,i.getUp(),6)},s=function(U,u){V(u._eye,U,0),V(u._center,U,3),V(u._up,U,6),u._18Q=F;var v=u._skybox;v&&(v.p3([U[0],U[1],U[2]]),u.getData3dUI(v).iv())};return function(h){var Q=this;Q._reflectorInfo=null;var y=Q.data;if(y._reflecting)return!1;var W=Q.gv;if(W._picking)return!1;var o=y instanceof Hq,G=Q._reflectorRenderTarget,S=W._canvas.width,D=W._canvas.height;if(G?G.setSize(h,S,D):G=Q._reflectorRenderTarget=new Km.RenderTarget(W,h,S,D),o){var I=y.getPointsMatrix3d().getElements(),L=y.p3();L[1]+=(1-y.getAnchorElevation())*y.getTall(),J.copy(Lp(L,I))}else J.copy(y.p3());if(X.copy(W.getEye()),b.makeRotationFromEuler(i.set(y.r3(),y.getRotationMode(),!0)),!Q._reflectNormal){var T;if(o&&y.getThickness()<0){if(!Q.shapeModel||!Q.shapeModel.top_vs)return!1;T={vs:Q.shapeModel.top_vs,ns:Q.shapeModel.top_ns}}else{if(T=qc(Q,Q.s("shape3d")),!T)return!1;!T.ns&&T.length&&(T=T[0])}if(!T.ns||!T.vs)return!1;Q._reflectNormal=[T.ns[0],T.ns[1],T.ns[2]],Q._reflectorVbuffer=$e.Buffer.createVertexBuffer(h,new Float32Array(T.vs))}if(u.copy(Q._reflectNormal),u.applyMatrix4(b),P.subVectors(J,X),P.dot(u)>0)return!1;P.reflect(u).negate(),P.add(J),z.copy(W.getCenter()).negate().add(J),z.reflect(u).negate(),z.add(J),N.copy(W.getUp()),N.reflect(u);var g=[0,0,0,0,0,0,0,0,0];Z(g,W),V(W._eye,P.toArray()),V(W._center,z.toArray()),V(W._up,N.toArray()),W._18Q=F;var R=W._skybox;R&&(R.p3(W._eye),W.getData3dUI(R).iv()),Wh(h,G.frame),W.setViewport(h,0,0,G.width,G.height);var r=y.s("shape3d.reflector.background");if(r){var B=h.getParameter(h.COLOR_CLEAR_VALUE);oh(h,r)}else oh(h,[0,0,0,1]);mq.for(h).glState.depth.mask=!0,h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT);var e=y.s("shape3d.reflector.clip"),k=e===Y?.003:e,n=Vk(W),O=rm(W);x.setFromNormalAndCoplanarPoint(u,J.add(u.clone().multiplyScalar(k))),x.applyMatrix4(w.fromArray(O)),_.set(x.normal.x,x.normal.y,x.normal.z,x.constant),w.fromArray(n).getInverse(w),d.set(Math.sign(_.x),Math.sign(_.y),1,1).applyMatrix4(w),_.multiplyScalar(2/_.dot(d)),n[2]=_.x-n[3],n[6]=_.y-n[7],n[10]=_.z-n[11],n[14]=_.w-n[15];var v=W._computedProjectMatrix;W._computedProjectMatrix=n,y._reflecting=!0;var m=y.s("shape3d.reflector.shadow"),j={renderAxis:!1,renderEdit:!1,renderGrid:!1};"disabled"===m?(j.createShadowMap=!1,j.renderShadow=!1):"scene"===m?j.createShadowMap=!1:j.useReflectorSelfShadowMap=!0,W.renderScene(j),W._computedProjectMatrix=v,E.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),E.multiply(w.fromArray(W._projectMatrix)),E.multiply(w.fromArray(W._viewMatrix)),r&&oh(h,B),gi(h),s(g,W);var t=y.s("shape3d.reflector.blur");if(t){var C=W.getPostProcessingModule("Blur");C&&C.drawImpl(h,G,t,t>=3,y.s("shape3d.reflector.blur.iterations"))}var c=W.getPostProcessingModule("Glitch");c&&c.enable&&c.onlyReflector&&(G=c._42(h,G));var K=h._compiledShader.reflector;K||(K=h._compiledShader.reflector=new $e.Shader(h,Uh.Reflector.vs,Uh.Reflector.fs)),K.bind(),h.activeTexture(h.TEXTURE0),Tj(h,G.texture),K.uniforms.tDiffuse=0,K.uniforms.color=yl(y.s("shape3d.reflector.color")||"rgb(128,128,128)"),K.uniforms.textureMatrix=E.toArray(),K.uniforms.modelMatrix=o?I:_j(y),K.uniforms.viewMatrix=rm(W),K.uniforms.projectionMatrix=Vk(W);var a=Q._reflectorVbuffer;a.upload(),K.attributes.pos.pointer(a);var A=this.s("shape3d.transparent");if(A){var U=mq.for(h).glState,H=U.depth.mask;U.depth.mask=!1}return h.drawArrays(h.TRIANGLES,0,a.data.length/3),A&&(U.depth.mask=H),y._reflecting=!1,h.useProgram(W._prg),Tj(h,F),!0}}()}),Uh.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), base.a );","}"].join("\n")};var Ys=function(C,Z){ag(Ys,this,[C,Z])};tr(Ys,Xs,{_80o:function(){}});var Zs=function(Q,P){ag(Zs,this,[Q,P])};tr(Zs,Ws,{_25Q:1,validate:function(g){var i=this;if(!i.s("geometry.cache")||!i.info){var h=i.gv,p=i.data,z=i.s,M=z("edge.width"),B=p._40I,s=p._41I;if(i.shapeModel=i.info=i.lineShapeModel=F,B&&s){var D,q,o,V,J,L,f,O,R,Z,t=p.isLooped(),k=z(Lf),l=x.getEdgeType(k);if(l){var C=l(p,rl(i,h,p,t,k),h,i._19Q);if(!C.points||C.points.isEmpty())return;L=i.info={},f=C.segments,J=C.points,O=J.size();for(var Q=B.getElevation(),w=s.getElevation(),I=0;O>I;I++){var b=J.get(I);b.e==F&&(b.e=Q+(w-Q)*I/(O-1))}R=fr(J.get(0)),Z=fr(J.get(O-1));var W=O%2;0===W?(L.c1=fr(J.get(O/2-1)),L.c2=fr(J.get(O/2))):L.p3=fr(J.get((O-W)/2)),L.s1=R,L.s2=fr(J.get(1)),L.t1=fr(J.get(O-2)),L.t2=Z}else{J=new Hb,L=i.info={};var e=z("edge.offset"),$=z("edge.center"),u=z("edge.source.t3"),S=z("edge.target.t3"),U=wk(h,p,"source"),P=wk(h,p,"target");if(!U||!P)return h.invalidateData(p),delete i.info,!1;if(u&&(U[0]+=u[0],U[1]+=u[1],U[2]+=u[2]),S&&(P[0]+=S[0],P[1]+=S[1],P[2]+=S[2]),k===Kn){f=z("edge.segments");var E=L.points=z(cm)||Df;if(O=E.size()){R=fr(E.get(0)),Z=fr(E.get(O-1)),!$&&e&&(o=Ok(R,U,!0),e=r(e,Gd(U,R)),U=[U[0]+o[0]*e,U[1]+o[1]*e,U[2]+o[2]*e],o=Ok(P,Z,!0),e=r(e,Gd(Z,P)),P=[P[0]-o[0]*e,P[1]-o[1]*e,P[2]-o[2]*e]);var W=O%2;0===W?(D=fr(E.get(O/2-1)),q=fr(E.get(O/2))):L.p3=fr(E.get((O-W)/2)),L.s1=U,L.s2=R,L.t1=Z,L.t2=P}else!$&&e&&(o=Ok(P,U,!0),V=Gd(U,P),e=dk(e,V),U=[U[0]+o[0]*e,U[1]+o[1]*e,U[2]+o[2]*e],P=[P[0]-o[0]*e,P[1]-o[1]*e,P[2]-o[2]*e]),D=U,q=P;J.add({x:U[0],y:U[2],e:U[1]}),J.addAll(E),J.add({x:P[0],y:P[2],e:P[1]})}else{var c=rl(i,h,p,t,k);if(i._19Q||(c=-c),t){var A=U[0],K=U[1],Y=U[2],N=B.getTall()/2+c;D=[A-c,K+N,Y],q=[A+c,K+N,Y],J.add({x:A-c,y:Y,e:K}),J.add({x:A-c,y:Y,e:K+N}),J.add({x:A+c,y:Y,e:K+N}),J.add({x:A+c,y:Y,e:K})}else{o=Ok(P,U,!0),V=Gd(U,P);var a={x:U[0],y:U[2]},y={x:P[0],y:P[2]},G=Jb(F,a,y,c),j=G.x-a.x,_=G.y-a.y;e=dk(e,V),o[0]*=e,o[1]*=e,o[2]*=e,D=[U[0]+o[0]+j,U[1]+o[1],U[2]+o[2]+_],q=[P[0]-o[0]+j,P[1]-o[1],P[2]-o[2]+_],$?(J.add({x:U[0],y:U[2],e:U[1]}),J.add({x:D[0],y:D[2],e:D[1]}),J.add({x:q[0],y:q[2],e:q[1]}),J.add({x:P[0],y:P[2],e:P[1]})):(J.add({x:D[0],y:D[2],e:D[1]}),J.add({x:q[0],y:q[2],e:q[1]}))}}L.c1=D,L.c2=q}L._lastPointsSegments={points:J,segments:f},L.list=z($b)===Nc?i.createTubeModel(J,f,M/2,g):i.createLineModel(J,f,M,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=F}});var $s=function(d,j){ag($s,this,[d,j]),this._needRecoverPosition=!0};tr($s,Xs,{_80o:function(Y,V,G){var N=this,z=N.mat;if(z&&(!N.s("shape3d.reflector")||Y._picking)){var s=N.gv,p=N.shapeModel;vo(s,z),p?Cp(s,N.data,p,N,N.getBodyColor(),G):(Zc(N,Y,V,"left",G),Zc(N,Y,V,"front",G),Zc(N,Y,V,"right",G),Zc(N,Y,V,"back",G),Zc(N,Y,V,"top",G),Zc(N,Y,V,"bottom",G)),Ah(s)
}},validate:function(i,D){var U,V,s=this,x=s.s,v=s.data,z=v._thickness/2,d=v.isClosePath(),h=v.getPoints(),X=v.getSegments(),n=x($q),m=i&&i.uv;if(s.clear(),s.dispatchBoundingBoxChanged(),0>z){s.s("shape3d.reflector")&&(s._reflectNormal=null);try{var r=x("shape3d.image.projection");if(r&&r[4]){var q=v.p3(),O=q[0],g=q[2];r=[O+r[0],r[1]-g,O+r[2],r[3]-g]}V=s.shapeModel=hb(h,X,x(Li),x(kl),n,x(nk),v.getTall(),v.getShapeElevation(),d,r)}catch(B){V=s.shapeModel={}}x(Nd)?x("shape3d.image")||delete V.uv:(delete V.vs,delete V.ns,delete V.uv),x("shape3d.top.image")||delete V.top_uv,x("shape3d.bottom.image")||delete V.bottom_uv}else if(x($b)===Nc)U=fq(h,X,n,d),V=s.shapeModel={vs:[]},x("shape3d.image")&&(V.uv=[],V.sum=x(nk)||fp(U)||1,V.len=0),x(Li)&&!d&&(V.top_vs=[],x("shape3d.top.image")&&(V.top_uv=[])),x(kl)&&!d&&(V.bottom_vs=[],x("shape3d.bottom.image")&&(V.bottom_uv=[])),s._12O(U,z);else{var t,P,p,Z,I,Y,b,Q,y,l;if(U=fq(h,X,n,d),I=s.vf(Cn,m,!1,D),z&&(Y=s.vf(Cb,m,!1,D),b=d?F:s.vf(Qi,m,!1,D),Q=d?F:s.vf(Me,m,!1,D),y=s.vf(En,m,!1,D),l=s.vf(Mr,m,!1,D)),z){for(var L=0,e=U.length;e>L;L++)U[L]=s._tryRemoveBezierPoints(U[L],z);s._12O(U,z)}else I&&U.forEach(function(l){if(Z=l.length,Z>0)for(t=l[0],p=1;Z>p;p++)P=l[p],s.addV(I.vs,t,P),t=P});s._20Q(U),i||(I&&(I.ns=Jd(I.vs),Ck(I,"vs"),Ck(I,ne)),z&&(Y&&(Y.ns=Jd(Y.vs),Ck(Y,"vs"),Ck(Y,ne)),b&&(b.ns=Jd(b.vs),Ck(b,"vs"),Ck(b,ne)),Q&&(Q.ns=Jd(Q.vs),Ck(Q,"vs"),Ck(Q,ne)),y&&(y.ns=Jd(y.vs),Ck(y,"vs"),Ck(y,ne)),l&&(l.ns=Jd(l.vs),Ck(l,"vs"),Ck(l,ne))))}var E=s.mat=v.getPointsMatrix3d().getElements();i&&(Fe(s,E,i,V),s.clear())},_20Q:function(P){var U,m,L,q,I,p,C,g=this,v=g.front,Z=g.back,E=g.top,B=g.bottom,Y=v?v.tuv:F,o=Z?Z.tuv:F,r=E?E.tuv:F,X=B?B.tuv:F,G=0;(Y||o||r||X)&&(U=g.s(nk)||fp(P)||1,P.forEach(function(j){if(m=j.length,m>0)for(p=j[0],L=1;m>L;L++)C=j[L],q=G/U,G+=Gd(p,C),I=G/U,g._14O(v,q,I),g._14O(Z,1-I,1-q),g._14O(E,q,I),g._14O(B,q,I),p=C}))},_14O:function(W,M,_){if(W){var p=W.uv,x=W.tuv;if(x){if(p)var z=p[0]+(p[6]-p[0])*M,l=p[1]+(p[7]-p[1])*M,q=p[2]+(p[4]-p[2])*M,J=p[3]+(p[5]-p[3])*M,L=p[2]+(p[4]-p[2])*_,t=p[3]+(p[5]-p[3])*_,c=p[0]+(p[6]-p[0])*_,y=p[1]+(p[7]-p[1])*_;else z=M,l=0,q=M,J=1,L=_,t=1,c=_,y=0;x.push(q,J,L,t,c,y,c,y,z,l,q,J)}}},_13O:function(I){var J=I.uv,K=I.tuv;K&&(J?K.push(J[2],J[3],J[4],J[5],J[6],J[7],J[6],J[7],J[0],J[1],J[2],J[3]):K.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(H,Q){var E=H.length;if(4>E)return H;var f,S,e,O,_,b,d=!1,J=function(p){return H[p]},k=function(K){return H[E-1-K]};for(_=0;1>=_;_++)for(b=_?k:J,S=b(0),e=b(1),f=2;E-1>f;f++)if(O=b(f),!O.remove)if(O.b){var U=Jb(S,e,O,Q);U.adjust?(O.remove=!0,d=!0):(S=e,e=O)}else S=e,e=O;if(!d)return H;var y=[];for(f=0;E>f;f++)H[f].remove||y.push(H[f]);return y},_12O:function(A,Q){var Z,n,s,K,O,N=this.s("shape3d.point.epsilon"),M=this;A.forEach(function(D){if(O=D.length,O>0)for(Z={p:D[0],n:!0},K=1;O>K;K++)n=D[K],s=O-1>K?D[K+1]:F,s&&Math.abs(n.x-s.x)<N&&Math.abs(n.y-s.y)<N||M.addPoint(Z,n,s,Q,D)})},addPoint:function(M,X,d,O,l){var k,Q,B,w,U,D,v,R,$,f=this,j=M.p,A=M.f,x=M.b,N=f.s("shape3d.side")||Dg,m=f.s("shape3d.start.angle"),T=f.s("shape3d.sweep.angle"),z=f.shapeModel,I=f.data.isClosePath();if(M.n&&(M.n=!1,A=I&&l.length>2?Jb(l[l.length-2],j,X,O):Jb(F,j,X,O),x=se(j,A),z?z.top_vs&&f._10O(x,A,N,m,T,z.top_vs,z.top_uv):(k=f.left)&&(f.addV(k.vs,x,A),f._13O(k))),Q=d?Jb(j,X,d,O):I&&l.length>2?Jb(j,X,l[1],O):Jb(j,X,F,O),B=se(X,Q),z){var e,p,h=z.vs,J=z.uv,P=z.sum;for(J&&(e=z.len/P,z.len+=Gd(j,X),p=z.len/P),D=f._9O(x,A,N,m,T),v=f._9O(B,Q,N,m,T),R=0;N>R;R++)$=R+1,eh(h,D[$]),eh(h,v[R]),eh(h,D[R]),eh(h,v[R]),eh(h,D[$]),eh(h,v[$]),J&&(w=R/N,U=$/N,J.push(e,U,p,w,e,w,p,w,e,U,p,U));!d&&z.bottom_vs&&f._10O(B,Q,N,m,T,z.bottom_vs,z.bottom_uv,!0)}else!d&&(k=f.right)&&(f.addV(k.vs,Q,B),f._13O(k)),(k=f.front)&&f.addV(k.vs,A,Q),(k=f.back)&&f.addV(k.vs,B,x),(k=f.top)&&f.addH(k.vs,A,Q,B,x,!0),(k=f.bottom)&&f.addH(k.vs,x,B,Q,A);M.p=X,M.f=Q,M.b=B},_10O:function(X,z,j,M,b,e,V,D){var S,p,x=this,m=x.data,K=x._9O(X,z,j,M,b),d=(X.x+z.x)/2,G=(X.y+z.y)/2,Z=m.getShapeElevation(),s=0;for(s=0;j>s;s++)D?(eh(e,K[s]),eh(e,K[s+1])):(eh(e,K[s+1]),eh(e,K[s])),eh(e,[d,Z,G]),V&&(D?(S=o*(s+1)/j+M,p=o*s/j+M):(S=o*s/j+M,p=o*(s+1)/j+M),V.push(.5-.5*a(p),.5-.5*A(p),.5-.5*a(S),.5-.5*A(S),.5,.5))},_9O:function(D,h,$,p,J){var O,V,X=this,_=X.data,W=[],r=(D.x+h.x)/2,N=(D.y+h.y)/2,f=_.getTall()/2,Z=_.getShapeElevation(),b=0;for(J==F&&(J=o);$>=b;b++)O=J*b/$+p,V=a(O),W.push([r+(D.x-r)*V,Z+f*A(O),N+(D.y-N)*V]);return W},addV:function(M,H,K){var X=H.x,Z=H.y,V=K.x,I=K.y,C=this.data,b=C.getShapeElevation(),Q=C.getTall()/2;M.push(X,b-Q,Z,V,b-Q,I,V,b+Q,I,V,b+Q,I,X,b+Q,Z,X,b-Q,Z)},addH:function(T,K,k,r,h,W){var l=this.data,G=l.getTall()/2,$=l.getShapeElevation()+(W?G:-G);T.push(K.x,$,K.y,k.x,$,k.y,r.x,$,r.y,r.x,$,r.y,h.x,$,h.y,K.x,$,K.y)},vf:function(u,$,I,K){var k,g=this,L=g.gv.getFaceVisible(g.data,u);return(I||L)&&(k=we(g,u,K),k.vs=[],k.tuv=L&&(k.texture||$)?[]:F,k.visible=L),k}});var _s=function(q,h){ag(_s,this,[q,h])},at={},bt=function(q){return/\.(png|jpg|gif|jpeg|bmp|svg)$/i.test(q)};tr(_s,Xs,{validate:function(){var _=this,B=_.gv,s=_.data,N=_.s,J=yl(N("points.color")),m=N("points.size"),S=N("points.uv.offset"),b=N("points.image");!b||bt(b)||Om.test(b)||(at[b]||(at[b]=_._createCachedImage(b)),b=at[b]);var u,r,Q=s._modelDirty,l=N("points.model");if(l){if(_._lastShapeModel!==l||!_.shapeModel){var F=qc(_,l);if(!F)return;var p=[],O={};_.eachShapeModel(function(c){for(var X=0,T=c.length;T>X;X+=3){var d=c[X],I=c[X+1],H=c[X+2],q=""+d+"_"+I+"_"+H;O[q]||(O[q]=!0,p.push(d,I,H))}},F),_._setShapeModelPoints(new Oh(p)),_._lastShapeModel=l,Q=!0}u=_.shapeModel.vs.length,r=u/3}else{var V=s.getPoints();if(r=u=V.length,Q||s._pointsDirty||!_.shapeModel){for(var g=[],y=0;r>y;y++){var k=V[y];k&&g.push(k.x,k.e,k.y)}_._setShapeModelPoints(new Oh(g)),s._pointsDirty=!1,_._lastShapeModel=null,Q=!0}}if(_.info={mat:_j(s),size:m,diffuse:J,opacity:N("points.opacity"),texture:b,alphaTest:N("points.transparent")?0:N("alphaTest"),uvScale:N("points.uv.scale"),uvOffset:S,discardSelectable:N("points.discard.selectable")},Q||s._colorsDirty){var q=!1,o=s.getColors();if(o&&o.length>0)for(var T=[],y=0;r>y;y++)for(var v=o[y],j=v?(q=!0,yl(v)):J,K=4*y,L=0;4>L;L++)T[K+L]=j[L];_.shapeModel.cs=q?new Oh(T):null,s._colorsDirty=!1}if(Q||s._sizesDirty){var H=!1,R=s.getSizes();if(R&&R.length>0)for(var x,X=[],y=0;r>y;y++)x=R[y],x>=0?(X.push(x),H=!0):X.push(m);_.shapeModel.ss=H?new Oh(X):null,s._sizesDirty=!1}if(Q||s._offsetsDirty){var E=!1,i=s.getUvoffsets();if(i&&i.length>0)for(var d,U,I,z=[],y=0;r>y;y++)d=2*y,U=i[d],I=i[d+1],U!=Y&&I!=Y?(z.push(U,I),E=!0):z.push(S[0],S[1]);_.shapeModel.os=E?new Oh(z):null,s._offsetsDirty=!1}if(Q||_._lastPointNumber!==r){this.dispose();var c=B.pickColorMap,f=_._startPickId=c._pickIdUsed;c._pickIdUsed=f+r;for(var g=[],y=0;r>y;y++){var M=f+y,W=Gs(M);g.push(W[0],W[1],W[2],W[3]),c[M]||(c[M]={data:s,part:y})}_.shapeModel.ps=new Oh(g),_._lastPointNumber=r}s._modelDirty=!1,this.dispatchBoundingBoxChanged()},_setShapeModelPoints:function(z){var L=this,P=L.shapeModel,a=L.shapeModel={vs:z};if(!P)return a;var m=z.length,H=Math.round(m/3);return P.cs&&P.cs.length==4*H&&(a.cs=P.cs),P.ss&&P.ss.length==H&&(a.ss=P.ss),P.os&&P.os.length==2*H&&(a.os=P.os),P.ps&&P.ps.length==4*H&&(a.ps=P.ps),a},_createCachedImage:function(l){var b=128,N=Vl(),C=N.getContext("2d");Bh(N,b,b,1),tp(C,{width:b,height:b,comps:[{type:l,background:"white",borderWidth:0,rect:[0,0,b,b]}]},0,0,b,b);var E=R.Math.generateUUID();return gj[E]=N,E},_80o:function(W,K){var $=this,c=$.gv,d=c._picking;if(!d||c.isSelectable($.data)){var b=$.shapeModel,i=$.info;if(b&&b.vs&&b.vs.length){var w=mq.for(W);w.useProgram($._asureProgram(W));var x=w.directUniforms(),S=w.directAttribs();x.modelMatrix=i.mat,x.modelViewMatrix=_i([],c._viewMatrix,i.mat),x.projectionMatrix=c._projectMatrix,x.viewMatrix=c._viewMatrix,x.scale=c.getHeight()/2,x.size=i.size,x.diffuse=i.diffuse,x.opacity=i.opacity,x.map=c.getTexture(i.texture,$.data),x.alphaTest=i.alphaTest,x.resolution=c.getDevicePixelRatio(),x.discardSelectable=i.discardSelectable,x.uvScale=i.uvScale,S.uvOffset=!d&&b.os?dg(W,c._buffer.os,b.os,F):i.uvOffset,x.blackout=W._blooming&&!$.data.s("bloom"),S.position=dg(W,c._buffer.vs,b.vs,F),d?(x.picking=!0,S.pickColor=dg(W,c._buffer.ps,b.ps,F),x.useColor=!1,S.color=null):(x.picking=!1,S.pickColor=null,b.cs?(x.useColor=!0,S.color=dg(W,c._buffer.cs,b.cs,F)):(x.useColor=!1,S.color=null)),b.ss?(x.useSizeArray=!0,S.sizeArray=dg(W,c._buffer.ss,b.ss,F)):(x.useSizeArray=!1,S.sizeArray=null),Rf(W,0,b.vs.length/3,W.POINTS),w.useProgram(K),S.disable(),c.shadowMap.enable&&c.shadowMap.createShadow(),c.flowMap.createFlow(x)}}},_asureProgram:function(s){return s._pointsShader||(s._pointsShader=this.gv._postProcessing.createShader(s,_s.shaderSrc)),s._pointsShader.program},dispose:function(){_s.superClass.dispose.call(this);var c=this._startPickId,H=this._lastPointNumber;if(c&&H){for(var P=this.gv.pickColorMap,v=0;H>v;v++){var l=c+v;P[l]&&delete P[l]}delete this._startPickId,delete this._lastPointNumber}}}),_s.shaderSrc="!!~v!oj<g*p!s{n/!onpbjuu5j!tnppQewfnm!N.b!u0s!jfym<bd!tv!o)j!g>p+s!nf!{njbTuu5o!jnppQe`fmmhW!j*f!xfNwbjuusdjfyq<ts!fvQotjjg!p)s!ng!jn!bu<5*!!q1s/p2k!f.d!u>j>p!o^N!b4u!s]j^y!<3!!]vyojjsgupbsNno!pnjbuud5f!kwpjsfqx!N)b!u>s!jfyw<ju!dvfoqjtgspfsQnt!jg!mmppbpuc!!tdbm~f!<<o!pbjuuuvsmjpctvfusf!!+w!ffd{4j!tq!p>t!jfu{jjpTou<ojp!Qv`omjhg!ps|n!!fctpmpfm!!~v!tf<Doppmjpusv<mp!tbfusu!s+j!czvbusfs!Bwff{dj5t!!d>p!mfp{sj<Tu!owjbpsQz`jmohh!!w|f!d*5z!bwsDspBmfp{sj<Tft!vb)u!ugsjj!cv<uofp!jwufjdt3p!QvwwnP!g+g!tyfjus<ub!Nwobpsjzujdofhk!pwsfqd!3>!!woPpgjgutjftup<Q`m!hv!oj<goppsjnu!jctpppQmw!nq!j+d!lyjjoshu<bN!xbfujuWsmjfcevpunf!!>w!fodp5j!uqjjtdplQDwpnm!ps<<*!1!/v2o!j-gepfsnns!pggmtpobbus!ut!j){5fd<fw!!v>o!jogppjsunj!tgpmQpwbnu!!5sdfftwp!mv<u*j!poop<ju!jvtopjqg!p)s4nd!fcwp!p>m!!evftnfsTpjg{tfoBbsssub!z4<df!wb!uu<s*jucfvtugfg!Pgwmvp)b3ud!ftwj!{>f!Busfstbgzg<Pw!!c~p!pm<!sjptmQpfds!t>q!fsdpumjpwDfwN!bu|s!j*ys)p!mnpbDuf5t!vn)!!*g!j|!f!tsmffu!vs~o!!n<]s!p3m!p^D]l!d4j!q^!!>>!>s!p.m!p2D/w1!<|!!~*ho!jwlpdjjeq!)n!bgjjo!)*|!^#!!~qs~f!dj<tsjppmop!Difjthvigqg!jgem!p>b!us<pm!p$DehfbgsjGo`fm!hV!TF|`!NfBtQmf!!v~o!jg<psspnm!pwDfwd!5>!!esjpgmgpvDthfb<sG!`vmohj!gp<sens!bgdmtpjbeu!!*p1q/b1d!j>u>z!<b/!svpomjpgDpfstnv!gggmjpeb)u!!gbjm!qi|b!U*fhtouj<ldj!qv)o!jggjp!sn<!ecspbpdmt!jvet!f*DuptmfpUsb<iq!mwbb!s=z!jbo/hs!pwmfpdD5f!twvDgpgmjpes)<!gj!!vogjjgeposfn$!!cp~p!m!<q*jwdvl!j-oqhb<n!!)vEo3jfgspvsuny!fcup!p>m+!!esjptmdpbDsfetTvfgmgfjdeu!bc<muff<tgg!Pvwo!j>g,p!swnv!!cp<pfmm!bcdmTbwdvl!p+v!ue<spp!DvuoojjgppQs`nm!hw!f>d!3w!vv!w3Tddfbwm!f<|!!*wfbmsczbjuodhf!mwffTde3s!bwdPtgjgetaf!u}<}!h$ojjgl!dejfqgaj)o!fgej)!!V*T!FQ`BNNB`QF!T*V!!)veofjogjpgsfne!!tgbjn$q!mf~s!3E<!*n!bzqu<jd$bfqope!j+g!b/wfptjveg!gnjbej!o-){*z!y|/f!tjvgg!g)jcem!b)d5ldpfvwu!*>!!|s!phmmp`DGfstbvhgDgpjmep!s!|>!!fwtfmdf5!)~1!/1<-*!!1z/u1j-d!b1q/p1!-+!!2b//1s*p<m!psDfwu!v-s{oz<y!/~spm!pwDfwd!5)!5edjfgwg!v>t!fsDppmmppDsf<tv!gjggj!e)!aq|j!d*lsjpomhp!D%f%t!v";var ct=function(A,N){ag(ct,this,[A,N]),this._needRecoverPosition=!0};tr(ct,Ws,{_25Q:1,validate:function(A){var n=this,y=n.data,k=n.s,v=y.getPoints(),P=v.size();n.dispatchBoundingBoxChanged();var Z=y.p3(),Q=n.mat=vc();gk(Q,Z),ih(Q,y.getFinalRotation3d(),y.getRotationMode());var S=y.getScale3d(),N=y._dynamicScale3d;if(N&&(S[0]*=N[0],S[1]*=N[1],S[2]*=N[2]),Ec(Q,S),gk(Q,vg(Z)),(!n.s("geometry.cache")||!n.shapeModel)&&(n.shapeModel=n.info=n.lineShapeModel=F,P>1)){var G=n.info={},c=y.getSegments(),U=y.getThickness(),K=fr(v.get(0)),g=fr(v.get(P-1)),o=P%2;0===o?(G.c1=fr(v.get(P/2-1)),G.c2=fr(v.get(P/2))):G.p3=fr(v.get((P-o)/2)),G.s1=K,G.s2=fr(v.get(1)),G.t1=fr(v.get(P-2)),G.t2=g,G.list=k($b)===Nc?n.createTubeModel(v,c,U/2,A):n.createLineModel(v,c,U,"shape.border","shape.dash")}},invalidateCachedGeometry:function(){this.shapeModel=this.info=this.lineShapeModel=F},_80o:function(D,o,Y){var r=this,T=r.shapeModel;if(T){var O=r.gv;vo(O,r.mat),Cp(O,r.data,T,r,r.getBodyColor(),Y),Ah(O)}}});var dt=R.graph3d.PostProcessing=function(x){function g(){if(!I){var N=x.getGL();I=new Km.RenderTarget(x,N,null,null,{samples:Q.renderTextureSamples||1,minFilter:N.LINEAR,magFilter:N.LINEAR}),f=new $e.Shader(N,q.vs,q.fs),X=$e.Buffer.createIndexBuffer(N,new Uint16Array([0,2,1,1,2,3])),t=$e.Buffer.createVertexBuffer(N,new Float32Array([0,0,1,0,0,1,1,1]))}}var I,f,X,t,H=this,V={},G=!1;!function(){S.keys(dt).forEach(function(W){V[W]=new dt[W](x)})}(),H.getModule=function($){return $?V[$]:H},H.getModuleList=function(){return S.keys(V)},H._serializable=!0,H.handleDataModleChange=function(q,m){q&&(H._serializable&&q.setPostProcessingData(H.serialize()),q.removeSerializeListener(H.onDataModelSerialize,H)),m&&(m.addSerializeListener(H.onDataModelSerialize,H),H.deserialize(m))},H.onDataModelSerialize=function(e){"serialize"===e.type?H._serializable&&(x.dm()._postProcessingData=H.serialize()):"deserialize"===e.type&&H.deserialize(x.dm())},H.isDeserializeDisabled=function(D){return!H._serializable||D.a("sceneBloom")!==Y},H.isSerializable=function(){return H._serializable},H.setSerializable=function(U){H._serializable=U,U||x.dm().setPostProcessingData(Y)},H.serialize=function(){var D,g,l,r,p={};for(g in V)if(l=V[g],r=l.serializeProperties){D={},l.enable&&(D.enable=!0);for(var u in r){var d=l[u];d!=r[u]&&(D[u]=d)}S.keys(D).length&&(p[g.toLowerCase()]=D)}return p},H.deserialize=function(z){var g,b,G,C,v,j={},n={};for(g in V){G=V[g],C=G.serializeProperties;var J={},o="scene"+g,Q=z.a(o);Q!==Y&&(J.enable=Q);for(var v in C)Q=z.a(o+v[0].toUpperCase()+v.slice(1)),Q!==Y&&Q!==C[v]&&(J[v]=Q);un(J)||(n[g[0].toLowerCase()+g.slice(1)]=J)}if(un(n)&&(n=z.getPostProcessingData()),n)for(b in n)if(b&&(g=b[0].toUpperCase()+b.slice(1),G=V[g])){j[g]=!0,C=n[b];var t=!!C.enable;H.enableModule(g,t),g="scene"+g,z.a(g,t),G.resetProperties&&G.resetProperties();for(v in C)if("enable"!==v){var Q=C[v];G[v]=Q,z.a(g+v[0].toUpperCase()+v.slice(1),Q)}}for(g in V)j[g]||(G=V[g],G.enable=!1,G.resetProperties&&G.resetProperties())},H.getRenderTarget=function(){return I},H.blitScreen=function(I,q,Q,Y,E){var C=x.getGL();if(C){I&&(I.bind(C),x.setViewport(C,0,0,I.width,I.height)),E&&E.clear===!1||C.clear(C.COLOR_BUFFER_BIT|C.DEPTH_BUFFER_BIT),g(),Q||(Q=f),Q.bind(),C.activeTexture(C.TEXTURE0+0),Tj(C,q||C._emptyTexture);var d=Q.uniforms;d.image=0;var D=1;if(Y)for(var c in Y){var w=Y[c];w instanceof WebGLTexture&&(C.activeTexture(C.TEXTURE0+D),Tj(C,w),w=D,D++),d[c]=w}if(X.upload(),t.upload(),Q.attributes.pos.pointer(t),C.drawElements(C.TRIANGLES,6,C.UNSIGNED_SHORT,0),D>1)for(;--D>=0;)C.activeTexture(C.TEXTURE0+D),Tj(C,null);else Tj(C,null);I&&I.unbind(C)}},H.decodeShader=function(S){var U,e,v,J="",i="";for(v=0;v<S.length;v++)U=S[v],"%"===U?U="'":"a"===U?U='"':"]"===U&&(U="\\"),e=String.fromCharCode(U.charCodeAt(0)-1),v%2?i+=e:J=e+J;return i+J},H.createShader=function(Y,u,b){var y,R;if("string"==typeof u){var w=u.indexOf("^#");y=H.decodeShader(u.substr(0,w)),R=H.decodeShader(u.substr(w+2))}else y=u.vs,R=u.fs;if(b){var l=b(y,R);l&&l.vs&&(y=l.vs),l&&l.fs&&(R=l.fs)}return new $e.Shader(Y,y,R)},H.enableModule=function(X,Q){var l,N,T,O=X.split(",");for(l=0,N=O.length;N>l;l++)T=O[l].trim(),V[T]&&(V[T].enable=Q);G=!1;for(T in V)if(V[T].enable){G=!0;break}G&&g()};var q=H.blitScreenShaderSrc={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};H.render=function(m,v,N,o){if(G){I.setSize(m,v,N),I.bind(m);var w=m.getParameter(m.COLOR_CLEAR_VALUE);w&&0===w[0]&&0===w[1]&&0===w[2]&&0===w[3]?w=null:oh(m,[0,0,0,0]),m.clear(m.COLOR_BUFFER_BIT|m.DEPTH_BUFFER_BIT),x.setViewport(m,0,0,v,N),o=o||{};var p=o.renderAxis!==!1,C=o.renderEdit!==!1;o.renderAxis=o.renderEdit=!1,x.renderScene(o),I.unbind(m);for(var g=0,R=x._glCapabilities.maxAttributes;R>g;g++)m.disableVertexAttribArray(g);var K,h=I;for(K in V)h=V[K]._42(m,h)||h;x.setViewport(m,0,0,v,N),w&&oh(m,w);var $=H.getModule("Fxaa");return $&&$.enable?H.blitScreen(null,h.texture,$.getShader(m),{resolution:[1/v,1/N]}):H.blitScreen(null,h.texture),m.useProgram(x._prg),x._renderAxisAndEditHelper(p,C),!0}}},et=R.graph3d.PostProcessing.HueSaturation=function(R){function a(){e=!0;var T=R.getGL();H=new Km.RenderTarget(R,T),c=R._postProcessing.createShader(T,et.hueSaturationShader),M=$e.Buffer.createIndexBuffer(T,new Uint16Array([0,2,1,1,2,3])),u=$e.Buffer.createVertexBuffer(T,new Float32Array([0,0,1,0,0,1,1,1]))}var M,u,c,H,T=this,b=!1,e=!1,o=[],X=[],L=[];this.serializeProperties={hue:[0,0,0,0,0,0,0],saturation:[0,0,0,0,0,0,0],lightness:[0,0,0,0,0,0,0]},this.resetProperties=function(){var W=this.serializeProperties;for(var Z in W)this[Z]=W[Z]},this.resetProperties(),S.defineProperties(T,{enable:{get:function(){return b},set:function(V){!!b!=!!V&&(b=V,V&&!e&&a(),R.iv())}},hue:{get:function(){return o.map(function(z){return Z(180*z)})},set:function(s){if(o!==s&&7===s.length){for(var i=0;7>i;i++)o[i]=s[i]/180;R.iv()}}},saturation:{get:function(){return X.map(function(t){return Z(100*t)})},set:function(g){if(X!==g&&7===g.length){for(var J=0;7>J;J++)X[J]=g[J]/100;R.iv()}}},lightness:{get:function(){return L.map(function(L){return Z(100*L)})},set:function(W){if(L!==W&&7===W.length){for(var d=0;7>d;d++)L[d]=W[d]/100;R.iv()}}}}),T._42=function(x,T){if(b){e||a();var W=T.width,t=T.height;if(W&&t){H.setSize(x,W,t),Wh(x,H.frame),R.setViewport(x,0,0,H.width,H.height),x.clear(x.COLOR_BUFFER_BIT|x.DEPTH_BUFFER_BIT),c.bind(),x.activeTexture(x.TEXTURE0+0),Tj(x,T.texture);var p=c.uniforms;return p.image=0,p.hue=o,p.saturation=X,p.lightness=L,M.upload(),u.upload(),c.attributes.pos.pointer(u),x.drawElements(x.TRIANGLES,6,x.UNSIGNED_SHORT,0),Tj(x,null),gi(x),H}}}};et.hueSaturationShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j*txj/psop!mipjdh!i-q*!mgtmip)bcuh<s3!mvtoij)g5pdsfnw!!t>b!nsqpmmfpsD3hEb!sjGn`bmhhf!<<!*w!bs*zfjhoohb!Swtftdf3o!uwiVhwj<m!-!^$1e]ftgtjfoofu!iNhBjYm`!S-B{O/HmFt!i8)t!t$feofugijhojfm!`SqBbOnH!F`-B*MfMh!o1bSo!pvjoujbgspvsunb!tg!m-p^b1u]!oipvjfu]bNsBvYu`bStB!O-HzF/^m<ti!)voopjjgupbssnv!ugbmtp`bqub!nt!bu-v*sfbhuojbpSof]vNiB!Y-`^S1B]OfHvFi^!<-y!/vmotjig)pfsvni!`gqmbpnb!u!)m4jdhfiwu!o>f!tmtt]iN!BY`~S!BO~H!F^<<lbf!sgcm!pb<u^!snfbuqo`vipvdf`)fgvmip]btut!fjoouWibhmjvmf!->!!gfmhpobbuS!titvffoBumimh-j!mg!mp<b^us!fiuvofvSpbdo`hffv*i!]|op!jgumbpsbvuu!bwtb!m>v!ff!h>o!bjSooWpbjmuvbfs!v,u!b)ti!vf<B^msmf!u,o!vipvdf`Sfbvoih]ff*v!i0!!>3!/f1h<obS!fjvgi!!)w|b!m*vffh!o=b!s1!/>1>*!!ssffuuovvspod!`wfbvmiv)f!!g,j!!2/|1!<*,!,fsmftufo!vjpgd!`)fwvbim!v<fF!H?O!B2S/`1Y*B!Ns!f=u!vssfou!owvbpmdv`ff!v.i!!2</11!<>!!sffmutofv!psdf`ufvvsio!!uwobjm)v!fs<pg!!~<!2g!m,p!bfuh!onbbsq!`>t!bfuhvosbbsu!jp<o1)!g>m!pfbhuo!bjso!W*b7m!v>f?-!!fghmopbbsu)!!tgbju!vs~b!uj~p!oB<mlmb-f!sgcm!pb<us!ftubouvvpsdb`ufjvpio!S>b!ofhhfo*b!s|!!|g!m*p6b/u1!!w,b!m*vsff!u>o!vjpodW`bfmvvif)!u+b!p)m2g/!1=!!,i!)t!bgujv!sb|u!j*p,o,Bsmfmu!o,v!ptdb`ufvvsib!u<jFpHoOSBbSo`hYfB*N<!=!!ssffuuvosvop!dd`mfbvniq!)<w1b!m>v!fs-f!u1o/v1p-d!`2f/v1i*!<uo!j~)!!sgpmgp!bu!<nfbhqo`bmSjthtifuooufithtj)mg!m-pfbhuo!bjSooWpbjmuvbfs-v!ugbmtp!b-uf!hmojbhSifuvoif!tutbBpmmmg-!!g<m1p!b>u!!fmhjohbisu!oufotjt!Sb<oehmfp*i!t|fs!igum`pfbvui!!wu!b>p!mmgj!hi<u1o/f7t!t+B!mym/!m,t!im!j>h!iiu!oufbtptmSgb!oh<f*<{z!yj/gs!p)mwp!d=)!m1t/i13*ch!ss!f>u!vmstoi!!j4odWfbwm!vf<!*+w!V)ww!!-,f!h2b/n1j*)<E3!ffsmvtufyf!us!f>u!vsspom!pjdo!W5bdmfvwf!!,|!!)*w)!o+j!b)n2!/e1j!p.w!!joW~b!mv<f**m*!<-t!!~-i!)g4mdpfbwu!!oisvvfu3fssh!c)~g!mp<b1u/!7g!20-!!ig!m>p!biu!!g~3!-!<g1m/p7b!u>!,i!vif!*!||!*!1j/g1!!)=i!vif)!!=g!j1!/1*~!!i<vbfu!m,f>E!d2!/01!<*h!!f.m!tsf)!!j,g!!1)/i5v!f>!!?i!!2/|1!*ft!mifv!f~!!.><!b2u/m1f<Ed!!g0m!p*bsu!!.s!fct)<!,!!j1g/!3)!)>7!/i1!!+|!!i*vyfb*N!d=!!>2>/!1h*)!!gsjf!tf!t>m!fg!2~!!,!<)bgu3m!f.E!dg!20*!!*+c!!7./!1h!)+!!>i!vif!<|!!f*mytbfN!dj!g>!>)!)s3)/!1g!j+!!iv<f***!o=j!N2d/!1,*!y!bsNfdt)!!>.!!g13/<3)!!f0m!tbfu!mjfgE!d)!);4!/*1o!j+N!di!v,f!*y!b=N!d3)/!10*!b!usmfftE!d>!!@g!26!/,1!!)=g!3m!!.>!!gt2!*!+<!o)j)N3d/!1.!!0y!b4N/d1!*>!!.b!uimvffE*d!!+u!b7p/m1g<!!|f!m*tofjN!ds!f?t!!y>b!Ngd2)<!g!js!fuv<s1o/!3s!f0t!<*o!j~Nd!!,w!fydb4N!di)t!m>3!smh!c)w<f*d*4c!!i-thm)*y!b|n!!-wsf)dy4b!ns!h>c!<ybN!dj!gu!b)pimtgm!/z<!*>*>c!!1-/h1)*o!j|n!!-ssh)co!j>n!!w>f!do4j)Nidt!mu/b{p*m<g!!~<!cf/mdt!f>!!|c!!ugbmppmbgu!!g<3h</d!!>j!gh!!)uibtpmm/g{!!=<!s1//d6!*>!!sg!3u!b>p!migt!m/<{1!/+1!!)>2!/m1!!u,b!pimtgm!/z<*1</1!!f>m!ttf!u!bgp3m!g>!!i<t1m//2{.!!,>!!iit!mu/bzp!m.g!!it|m!/*zd!!+4!diftwm)/m{t<i3c!hgsm!p4bduf!wg!2!>~!!3/<1c!h+s!!iotsmv/u{f!s.!!g~3!<<*!*s1h/c4/0s1!/>2!)i!v.f!3ys/hmct)ig!2--3!gg!3--2!gi)tcmh/sy3!f,v!i)!2>/!1c0/4c/h1s*!*<<*!ys/hmct/ih!!->3!gi!v-f23gs)hc";var ft=R.graph3d.PostProcessing.Bloom=function(H){function j(){var I=H.getGL();if(I)for(var L=H._postProcessing,f=0;s>f;f++)d[f]=L.createShader(I,ft._35Q,function(b,l){return{fs:l.replace(/DEFINE_VALUE/g,w[f]).replace("%OVERRIDE_ALPHA_DEFINE%",n?"#define OVERRIDE_ALPHA":"")}})}function X(){var A=H.getWidth(),b=H.getHeight();if(A&&b){p=[A,b],c=!0;var w,C=H.getGL(),W=Math.round(p[0]/2),L=Math.round(p[1]/2);for(E=new Km.RenderTarget(H,C,W,L),w=0;s>w;w++)Y.push(new Km.RenderTarget(H,C,W,L)),D.push(new Km.RenderTarget(H,C,W,L)),W=Math.round(W/2),L=Math.round(L/2);var I=H._postProcessing;t=I.createShader(C,ft._34Q),j(),x=I.createShader(C,ft._36Q,function(v,t){return{fs:t.replace(/NUM_MIPS/g,s)}}),T=I.createShader(C,ft.finalShader),$=$e.Buffer.createIndexBuffer(C,new Uint16Array([0,2,1,1,2,3])),k=$e.Buffer.createVertexBuffer(C,new Float32Array([0,0,1,0,0,1,1,1]))}}var v,h,W,n,u,$,k,C,r=this,z=!1,c=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0,selective:!1},this.resetProperties=function(){var q=this.serializeProperties;for(var D in q)this[D]=q[D]},S.defineProperties(r,{enable:{get:function(){return z},set:function(g){!!z!=!!g&&(z=g,g&&!c&&X(),H.iv())}},strength:{get:function(){return v},set:function(t){v!==t&&(v=t,H.iv())}},threshold:{get:function(){return h},set:function(L){h!==L&&(h=L,H.iv())}},radius:{get:function(){return W},set:function(j){W!==j&&(W=j,H.iv())}},overrideAlpha:{get:function(){return n},set:function(T){!!n!=!!T&&(n=T,c&&j(),H.iv())}},selective:{get:function(){return u},set:function(B){!!u!=!!B&&(u=!!B,H.iv())}}}),this.resetProperties();var E,t,x,T,p=[256,256],Y=[],D=[],s=5,w=[3,5,7,9,11],d=[];r._42=function(Z,B){function e(s,O,z,q){Wh(Z,O.frame),H.setViewport(Z,0,0,O.width,O.height),q?q(Z):Z.clear(Z.COLOR_BUFFER_BIT|Z.DEPTH_BUFFER_BIT),g!==s&&s.bind();var p=0;for(var y in z){var S=z[y];S instanceof WebGLTexture&&(Z.activeTexture(Z.TEXTURE0+p),Tj(Z,S),S=p,p++),s.uniforms[y]=S}for(g!==s&&($.upload(),k.upload(),s.attributes.pos.pointer(k),g=s),Z.drawElements(Z.TRIANGLES,6,Z.UNSIGNED_SHORT,0);p--;)Z.activeTexture(Z.TEXTURE0+p),Tj(Z,null);gi(Z)}if(z&&(c||(X(),c))){var g;if(u){C||(C=new Km.RenderTarget(H,Z)),C.setSize(Z,B.width,B.height),C.bind(Z);var L=Z.getParameter(Z.COLOR_CLEAR_VALUE);L&&0===L[0]&&0===L[1]&&0===L[2]&&1===L[3]?L=null:oh(Z,[0,0,0,1]),Z.clear(Z.COLOR_BUFFER_BIT|Z.DEPTH_BUFFER_BIT),H.setViewport(Z,0,0,B.width,B.height),Z._blooming=!0,H.syncRenderState(),H.renderScene({renderAxis:!1,renderGrid:!1,renderEdit:!1}),Z._blooming=!1,L&&oh(Z,L),C.unbind(Z)}e(t,E,{smoothWidth:.01,luminosityThreshold:h,tDiffuse:u?C.texture:B.texture});var l,b=E,w=Math.round(p[0]/2),f=Math.round(p[1]/2);for(l=0;s>l;l++)e(d[l],Y[l],{colorTexture:b.texture,direction:[1,0],texSize:[w,f]}),e(d[l],D[l],{colorTexture:Y[l].texture,direction:[0,1],texSize:[w,f]}),w=Math.round(w/2),f=Math.round(f/2),b=D[l];return e(x,Y[0],{blurTexture1:D[0].texture,blurTexture2:D[1].texture,blurTexture3:D[2].texture,blurTexture4:D[3].texture,blurTexture5:D[4].texture,bloomStrength:v,bloomRadius:W,bloomTintColor:[1,1,1]}),e(T,B,{image:Y[0].texture},function(R){mq.for(R).glState.blend.apply({enabled:!0,equation:R.FUNC_ADD,func:[R.SRC_ALPHA,R.ONE]})}),mq.for(Z).glState.blend.apply({equation:Z.FUNC_ADD,func:[Z.SRC_ALPHA,Z.ONE_MINUS_SRC_ALPHA,Z.ONE,Z.ONE_MINUS_SRC_ALPHA]}),B}}};ft._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",ft._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",ft._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",ft.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var gt=R.graph3d.PostProcessing.Dof=function(z){function D(){u=!0;var Z=z.getGL();g=new Km.RenderTarget(z,Z),A=z._postProcessing.createShader(Z,gt._38Q),U=$e.Buffer.createIndexBuffer(Z,new Uint16Array([0,2,1,1,2,3])),v=$e.Buffer.createVertexBuffer(Z,new Float32Array([0,0,1,0,0,1,1,1]))}function F(l,_,q,v){i=null;var V=l.getCanvas(),S=V.width,h=V.height;if(q=q||1024,S>q||h>q){var A=q/Math.max(S,h);S=Math.round(S*A),h=Math.round(h*A),O||(O=Vl()),V=x.resizeImage(V,S,h,O)}var G=z.getGL();if(w||(w=G.createTexture()),e=Tb(G,V,w),t=_||.01,a=!0,z.iv(),v--){if(i)return;i=x.callLater(function(){F(l,_,q,v)})}}var g,A,U,v,e,o,y,c,O,w,i,G=this,h=!1,u=!1,t=0,a=!1,J=ze.generateUUID();this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var W=this.serializeProperties;for(var y in W)this[y]=W[y]},S.defineProperties(G,{enable:{get:function(){return h},set:function(Y){!!h!=!!Y&&(h=Y,Y&&!u&&D(),Y||(a=!1),z.iv())}},image:{get:function(){return o},set:function(d){o!==d&&(o=d,a=!1,e&&(z.deleteTexture(J),e=null),z.iv())}},maxblur:{get:function(){return y},set:function(j){y!==j&&(y=j,z.iv())}},aperture:{get:function(){return c},set:function(m){c!==m&&(c=m,z.iv())}}}),this.resetProperties(),G.setImageFromGraphView=function(z,U,G){this.image=null,F(z,U,G,2)},G._42=function(I,G){function X($,x,Z,D){Wh(I,x.frame),z.setViewport(I,0,0,x.width,x.height),D?D(I):I.clear(I.COLOR_BUFFER_BIT|I.DEPTH_BUFFER_BIT),H!==$&&$.bind();var h=0;for(var V in Z){var A=Z[V];A instanceof WebGLTexture&&(I.activeTexture(I.TEXTURE0+h),Tj(I,A),A=h,h++),$.uniforms[V]=A}for(H!==$&&(U.upload(),v.upload(),$.attributes.pos.pointer(v),H=$),I.drawElements(I.TRIANGLES,6,I.UNSIGNED_SHORT,0);h--;)I.activeTexture(I.TEXTURE0+h),Tj(I,null);gi(I)}if(h){u||D();var H;if(!e){var B=ti(this.image);if(!B||!B.comps&&!B.tagName)return G;R.Default.setImage(J,B),e=z.getTexture(J)}var d=G.width,s=G.height;if(d&&s)return g.setSize(I,d,s),X(A,g,{tColor:G.texture,tDepth:e,aspect:d/s,aperture:this.aperture,maxblur:this.maxblur,useG2d:a,threshold:t}),g}}};gt._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vcupypfmu!!v>t,f!Hm3ped<<v*o!j5gspvsmnc!ggpmep!b+u!!*u!iusdfftsisppmdeu<dfvqotjbg!p+s!n*!!g:m3p/b1u.!!n-b:y3c/m1v.s!<)3vdofjwg!p)s!n,!!gzmyp/bwuV!wb!q-fsspumvpsDfu<!)vEo3jfgspvsuny!fgum!p>b,u!!mopfdbs<D*m!j5qs<vmvcogjpgep!s+n!!*g!mupdbfus!sgpbdsuDdmfjqqt<b!v+o!j*g!p1s/n1!!g-m5p/b1u.!!g)p3ddvftw<!)v!o,j!gzpys/nw!Vgwm!p-bsup!mbptDquf!d)uE<3fdspvoutyuf!ug!m>p,b!um!pVdoq<b*d!l5Espvxmoctgdpbem!f+!!>*!!3u6d6f/s!s0p!d3u6d7f/q<t!b0!0+!!1*/!/:23!/.1?!!-g:s3b/d1u.j!p)o3!d)ffwy!d)m!v,e!jzoyh/!w2V*w!d-psoptmup!Dwuf!d)4E!3QfbsdvluGybfduu!p>s,t!!m>p!dwf<d*4!)5!s3v6m7c/g!p+e!!3+6!7*/!!u+d!f3s6s7p/d-u!d3f6q7t/b!!++!!3*6!75//-1!.3!6-71//!1*!<)3ddpfowt!u)!!w,f!dz5y!/VwoVqwb!d-lsGpbmdpuDpus!t)!E>3!fVsovqubydfluE!p>x,o!tmdpbdmf<!*0!!5wsfvdm5c)g!pQeb!d+l!G*b!duudpfssts-p!d2u/d!f*q<tbg!m+p!b*u!!:v3o/q1b.d!l-S:H3C/B1U!p)E3fdqfuwi!))!!d,p!oztyu/!wjVow!!w-fsdp5m!pwD!u*!!)|E3!fssfvuuvysfou!!e>p,u!)m!pwd-!<V*o!q5bsdvlmGcbgdpuep!s+t!!**!<ud~fsgsmppdbuud!fhqftubE!f+q!u*i!)1!/d1p!o-t5u/!1j!o)!3wdffdw3!!)t!d,s!fzfyo/QwpVtwj!u-jsppom!p*D!u|!)\nEs3ffusvvsuoy!fvuo!q>b,d!lmSpHdCB<U*p!E5fsqvumic)g!puef!y+u!v*s!fu3dEf)s!supEdfuqdufiq-t!bt!d+s!f*f!o:Q3p/t1j!u-j:p3o/!1*!!)*3<df~w!g)m!p,b!uz!yq/fwsVtwq!f-dsupjmwpfDEuf!q)uEi3UfpsWvjufyxf[u)!!>d,p!omtpud!j<o*!!g8mspvbmuc!gjpoew!D+m!j*q![u-d!fdspsoptduu!djfoq!tgbm!p+b!u*!!o5f/b1s!--!1d/p1o!t)u3!djfow!!g)m!p,b!uz!yg/bwsV!w*!!-|sp!mspfDuuv!s)oE!3)f!sovfubysf!u+!!>g,b!sm!p*d!0<!*)!!8)s!vgmbcsg!p.e!!o+f!b*s!!u*d!f+s!sjpodwuDdmfjqqt[b!!.+!!g*b!s:!3*/<1.~!-g:m3p/b1u.!!h)f3udWfjwf!x)[!),!!dzpyo/twuV!wj!o-!sgpmmppbDuu!!e)fEq3ufis!v*u!y|fu\n!s>f,u!vmspod!q<f*s!t8qsfvdmucjgwpfeE!f+q!u*i!UupdWfjsfsxp[d)u!deffqqtubi!-+!!o*f!b1s/D1m!j-q5-/!1g.b!s)D3mdjfqw!!*)<!,~!zwyp/jweV!wn!b-jsop)m*p!D|u!w)fEd33f!sevpugycfmuv!s><,!wmfpdd3!<b*t!q8fsdvumdcpgspsef!d+u!!*>!!uwdffds3s)p!d2u/d1f-q!tbbt!q+f!d*u!!:*3</1j!g-!:)3v/t1f.E!f)q3udif*w!!|)!!,g!mzpyb/uw!Vwwj!f-xs[p!m>p!Dhuf!u)WEj3ffxs[v)u!yhffuu!E>f,q!umip)d!w<V*w!!8*s!v*m<cg!pgem!p+b!u*!!gubddfuspssp!d>u!d)f!qgtpbd!v+t!!*,!!5w/j1f.x![-!1*/<1!!)e3pdgfcwm!v)s!!,>!!zwyf/dw3V!w)!!-dsmpbmnpqD)u!!g)bEd3ufpssv!u+y!fbuq!f>s,u!vmspfd-!<.*n!b8yscvmmvcsg-p!en!b+y!c*m!vusd!f*s!s*p<du~dffqmttbf!!+|!*w!f:d35/!1u.f!y-f:m3!/>1!!u)f3ydufvws!f)3!E,)!!zuyE/fwqVuwi!--!swpfmdp3D)uw!V)wE/3yf-s!v2u/y1f!u.!!>w,V!wm/pzd*!<**<!8gsmvpmbcug!pbem!q+i!b*<!ujdgf!s)svptdfuHd3feq*t!b|!+b!m*q!i1b/!1>!!-t1n5p/p1u!i)t3udffqw)!!)u!i,s!fztyi/pwmVew-!!-usipsmfptDiup!m)eE!3,f!s1v/u1y2f-u!!u>f,y!fmmp/db!<**<!8~s!vfmmctgfp!e|!!+b!m*q!iubd!f>s!supfdyufdmf/qbt<b!!~+!!*e!p:g3c/m1v!s-!:>3!/w1f!d)33!d)f!wd!m)b!n,q!)z!yb/mwqViwb!!-+s!pbmqpfDsuu!v)sEf3-f!s.vnubyyfcum!v>s,-!!mnpbdyc<m*v!s:!s*v!m*c<gp~e!w+f!d*3!!uedpfgscsmpvdsu:d!f>q!tebp!g+c!m*v!s8!4+/!11./!:-<62w/f1d!3)!3edpfgwc!m)v!s,8!!z>y!/ewpVgwc!m-vssp!m+p!D1u/!8)<E3wffsdv3u!yefpug!c>m,v!sm5p!d>!<e*p!g:csmvvmsc!g+p!e1!/+5!<*!wufddf5s!sdppdmu!d>f!qwtfbd!5+)!!*1!/612!/*1<.!d-p8m4!/,1>.!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!16/25/!1*!!-+8!4b/t1q!f)d3uddfpws!s)f!d,u!!z*y!/+w!Vewp!g-csmpvmsp!D*u<!)dEp3mf!s,v>u!yuffuy!u>v,s!fm3pEd)!<u*D!p:mspvsm-c!gwpVew!/+y!z*!!,u!d)f!swsfpdd3u)d!f1q/t2b6!-+!!1*/!4884!/*1!!+-!6b2t/q1f.d!u)d3pdsfswf!d)u!!,*!!z+y!/ewpVgwc!m-vssp!m*p<Dud!p)mE!3,f>s!vuufyyfuuv!s>f,3!Em)p!duD<p*m!p:ss-v!mwcVgwp/ey!z+!!,*!!)u!dwffsds3p)d!u1d/f3q:t-b!!1+/!3*:!!8*4!/+1!.b!t-q6f2d/u1d.p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!6+2!/b1t.q!f-d8u4d/p1s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b6t2q/f1d!u-d8p4s/s1f.d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/:yszv!m,c!g)p!ew!f+d!3*)!!u1d/f4s8s-p!d.u1d/f2q6t!b*!!++!!*b!t8q4f/d1u!d-p6s2s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d1f/s3s:p-d!u.d1f/q3t:b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d.f1s/s2p6d-u!d.f1q/t4b8!!+*!!*+!!:b3t/q1f.d!u-d:p3s/s1f.d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d1f/s1s-p!d.u1d/f5q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!s,v!m)c!gwpfed!3+)!!*.!1u/d2f6s-s!p1d/u4d8f!q*t!b+!!+b!t*q!f1d/u1d!p-s5s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!yszv!m,c!g)p!ew!f+d!3*)!!u.d1f/s3s:p-d!u1d/f3q:t!b*!!++!!*b!t6q2f/d1u!d-p8s4s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfs";
var ht=R.graph3d.PostProcessing.Blur=function(y){function q(){A=!0;var e=y.getGL();B=new Km.RenderTarget(y,e),v=y._postProcessing.createShader(e,ht.hBlurShader),w=y._postProcessing.createShader(e,ht.vBlurShader)}var v,w,B,z,N,Q,m,W,V,s=this,J=!1,A=!1;this.serializeProperties={value:0,downSample:!1,iterations:1,layer:"main"},this.resetProperties=function(){var Q=this.serializeProperties;for(var u in Q)this[u]=Q[u]},S.defineProperties(s,{enable:{get:function(){return J},set:function(I){!!J!=!!I&&(J=I,I?y.addRenderLayerListener(n,this):y.removeRenderLayerListener(n,this),I&&!A&&q(),y.iv())}},downSample:{get:function(){return m},set:function(P){m!==P&&(m=P,y.iv)}},value:{get:function(){return Q},set:function(F){Q!==F&&(Q=F,y.iv())}},iterations:{get:function(){return W},set:function($){W!==$&&(W=$,y.iv())}},layer:{get:function(){return V},set:function(X){V!==X&&(V=X,y.iv())}}}),this.resetProperties();var n=function(H){if(J&&H.layer===V&&"post"===H.phase){var m=y.getGL();if(!y._picking&&!y.isReflecting(m)){var g=y._postProcessing.getRenderTarget();g.unbind(m);for(var X=0,Q=y._glCapabilities.maxAttributes;Q>X;X++)m.disableVertexAttribArray(X);s.drawImpl(m,g),g.bind(m),m.useProgram(y._prg)}}};s._42=function(){},s.drawImpl=function(V,E,C,L,P){A||q();var u,h;if(E?(u=E.width,h=E.height):(u=y._viewport[2],h=y._viewport[3]),u&&h){var n=y._postProcessing;"boolean"!=typeof L&&(L=m),C==F&&(C=Q),P==F&&(P=W),P=Math.max(1,Math.round(P));var X=mq.for(V).glState.depth,R=X.enabled;if(X.enabled=!1,L){C/=2;var K=[u,h];u/=2,h/=2,z||(z=new Km.RenderTarget(y,V),N=n.createShader(V,ht.downSampleShader)),z.setSize(V,u,h),n.blitScreen(z,E.texture,N,{texelSize:[1/K[0],1/K[1]]}),E.setSize(V,u,h)}else z&&z.setSize(0,0);B.setSize(V,u,h);for(var H=[],t=0;P>t;t++)H.push(C),C=Math.max(1,Math.floor(C/2));for(var t=0;P>t;t++){var U=H[P-t-1],s=L&&0===t?z.texture:E.texture;n.blitScreen(B,s,v,{value:U/u}),L&&t===P-1&&E.setSize(V,K[0],K[1]),n.blitScreen(E,B.texture,w,{value:U/h})}return X.enabled=R,E}}};ht.hBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sz3/Ew!Vjwn!b-hffv<mb!ww!b+s!z1j/o5h!!,w!fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!zt/vwnV!w>!!-wffvdm5b)w!!1+/!11!/*4<!,!!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!!.<!655/313!2+/!1w!b+m!v*f!-*!!wzV/ww/Vzw!!*-!f*v!m+b!w1!/+1!612/<3!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!4</214!6+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*f!v+m!b1w/!1+:!219/<2!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!3</414!7+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!!*.!!z2//w1V!w+!!-wfbvm",ht.vBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sf3vEm!bjwn!b+h!f1</5!!w,b!szz/jwoVhw!!w-fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!ftvvmnb!w>!!+w!f1d/54)!!,1!/z1/!w*V<w!-!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!-!<w6V5w3/3z2!/.1!!5+/!1*!!+*!!wfbvmmvbfw!!*+!!*1!/+3!!1,/!1z6/2w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w2/4z6!2./!14!/+1!!*+!!*w!bfmvvmfb!w*!!+*!!1+/!21!/,1!:z2/9w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w4/4z7!2./!13!/+1!!*+!!*w!bzm/vwfV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!-*!!wfVvwm/bzw!!.+!!21/",ht.downSampleShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j1t/j5p!o0!!i*j*h*i1q/!2g!m-p1b/u1<)3!dvfowj!g+p!sfn{!jtTbmnfqymffus!3,E!!wjVnwb!h-ff<hb!nwjb)sEz3jfoshv!uwyffdu3!!w,V!w*<*1!/v2o.j!g-p1s/n1!)w3fddf3w!!u+f!yff{mjTTjm{ffy<fu!!,w!pwjVew!!n-bfjhob)n*j)!E|3f!shvmu`yGfsub!hD,p!m*p*s1!/>1!!)-u1f/y2u.v)s3fd3fEw)!j+n!bfh{fj-T!mwfVywf!u,!!,u!fwyVfwm!T-jf{hfb!n+j!)wEf3df3s)v2u/y1f-u!!1/,1!**";var it=R.graph3d.PostProcessing.Glitch=function(l){function C(){if(A&&i){a=Date.now(),c=0,V=1e3*d(i[0],i[1]),Y=[];for(var Z=1,y=A.length;y>Z;Z+=2)Y.push((Z>1?Y[Y.length-1]:0)+V*A[Z]/K)}}function j(){l.redraw()}function Q(){u=!0;var _=l.getGL();X=new Km.RenderTarget(l,_),s=l._postProcessing.createShader(_,it.Shader);for(var Z=W*W,y=Od(W,W),g=y.getImageData(0,0,W,W),t=g.data,i=0;Z>i;i++)t[3*i+0]=P(256),t[3*i+1]=P(256),t[3*i+2]=P(256),t[3*i+3]=P(256);y.putImageData(g,0,0),v=Tb(_,Bg)}var X,s,V,a,c,Y,v,E,i,A,T=this,k=!1,u=!1,d=ze.randomFloat,P=ze.randomInt,K=0,W=64;this.serializeProperties={onlyReflector:!1,period:[2,3],intensity:[3,.3,1,.1,0,.4]},this.resetProperties=function(){var P=this.serializeProperties;for(var q in P)this[q]=P[q]},S.defineProperties(T,{enable:{get:function(){return k},set:function(L){!!k!=!!L&&(k=L,L&&(C(),u||Q()),l.iv())}},onlyReflector:{get:function(){return E},set:function(V){!!E!=!!V&&(E=V,l.iv())}},period:{get:function(){return i},set:function(U){i=U,C(),l.iv()}},intensity:{get:function(){return A},set:function(Y){Y||(Y=[1,1]),A=Y,K=0;for(var p=1,D=Y.length;D>p;p+=2)K+=Y[p];C(),l.iv()}}}),this.resetProperties(),T._42=function(L,g){if(k){u||Q();var D=!!l.isReflecting(L);if(D===!!E){var f=g.width,S=g.height;if(f&&S){var O=l._postProcessing,Z=mq.for(L).glState.depth,H=Z.enabled;Z.enabled=!1,X.setSize(L,f,S);var G,w=Date.now();w-a>Y[c]&&(c++,c>=Y.length&&C()),G=A[2*c];var W={seed:Math.random(),byp:G?0:1,tDisp:v};return G&&(W.angle=d(-Math.PI,Math.PI),W.distortion_x=d(0,1),W.distortion_y=d(0,1),W.amount=Math.random()/30*G,W.seed_x=d(-1,1)*G,W.seed_y=d(-1,1)*G),O.blitScreen(X,g.texture,s,W),Z.enabled=H,requestAnimationFrame(j),X}}}}};it.Shader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd~j!tj<p*ow!Viwj!h-ifqh!bgnmjp)b!uE<3f!svvoujygfpus>ns!pjmopuD!hcbzsqG<`m!hv!oj|g!pfstnm!ft!bn~q!mf<sx3pEo!tj!n,bshpfm<pD!hvbosjGg`pmshn!!>t!bsnpqmmpfDsh3bEs!Gu`Emjht!q<<*3!/v1o+j*g*p/s1n6!+gemfpfbtu!!+b!ntpzv-oeuf<ft!!v+o!jtgyp)s3nd!fgwm)peboub!sb)o5hdmffw<+u!ovvopjngbp+s/n1!1g3m!p>b!ux!ptoftf!e5<df!wv!ojfgtpjspno!!gemepbb0u0!!tf<f*eb`/yb<hd!!v-ocj/gcpds!n-!hg/mbphbdu!!-tsf/fsed`)z5<df!wv!o>j!gsppsmnp!DghmbpsbGu`!mehj!tu<p*suufjtpgog`py!<.!!qv!o-jfghpbsnnj!)gEm3pfbsuv!ueyjftuu!p>s!ucjdp!o5`dzf<w!!v<o*jqg!p-sfnh!bgnmjp)bEu3!fdspvmu`ytf<u!>!!wbbhsdz!j5odhf!ww!fd<3*!uwfVtwg<gp!!,d!pqo!t-uf!hgbmnpjb)uE!3VfosqvbudylfEup!x>o!tsddb!m5fd!f>w!!36<6*/*!f0m!h3o6b7)/o<jt!!d-p*oftmuh!owbf)dt4p!dQ)b3ddlfGwb!d+u!pusotv!p>n!bw!f>d!4u)f!t3g6g7p/!!3+d!f3w6!7/s!f+e!b3i6t7!/u-g!j3i6t7!/C!H+S!!3n6p7s/g-!!f3t6b7c/0!0*!<<!*d/p6o0teuf!fwtf)d+5z!`Veofqfbtd+lmGbbndsuppos>t,!z>/!qV!oq<b*d/l6E0pexfofttd)b+myf`!e0f!fwtf+dm5b)n!sQpbod>l,Gyb/dqu!ps~t!-!~2!/!<**<y`!ogpmjpubsup!uvtojqeb!d,l!SyH/CqB)U!p.E!f/q2u!i>)!!yd/pqo!tu|!!jfot!mwff!d5~!!w!<*y!`|op!jsufsupvustoj!ee>pyu/)q!!w-|!*V/o1q?bzd`leGfbfdtu)pgsjt!!*|<!*!e~fft!+gtm`pmbpud!.szb`ooep)jwufsdp3u!tdjpe*?|y/!qs!f%u%v!sto`!mgpsdb,dzu`)otpjjou)seppuut)jdep=/yy/zq!)-gwjf!d3~)!23~/!:9<:z9`-o8p9j/u3s4p4u*t*j*e!!+>!!5z4/8q6!9/|6!5f6t4m*f<!!~~!<!*wzp`joep!jnubsjpou)t*j!e|!,!!jzg/)qc)z!q.=!2/*2!!|>!!zw/fqd!3!|q*!/>1!?wyV`we<ff!tg)mgpjb!u!|y!t*!e>f!fgtm+ptp`sm)phdm.`yG`sobphjDupsppsuet/jye!?0z!/1q/!6%*%<!t!`gmmppdb,uy!`zotp!j>u!sgpmuptpjse)=hzm/`qG)sgbjh!Dp<p*s*ee/fzf!t0+!e1f/f6t*+<q!!-gqmtpjbEuu!)o!pEs3nfbsmv!u>y!fvuo)qibudqlfSEHpCUB";var jt=R.graph3d.PostProcessing.Fxaa=function(J){var A,g=this,E=!1;S.defineProperties(g,{enable:{get:function(){return E},set:function(p){!!E!=!!p&&(E=p,J.iv())}}}),g.getShader=function(K){if(A)return A;var d=J.getPostProcessingModule();return A=d.createShader(K,{vs:d.blitScreenShaderSrc.vs,fs:d.decodeShader(jt.ShaderSourceFs)})},g._42=function(){}};jt.ShaderSourceFs="~!!q<sbf/d*jwtVjwp!o-!fihjbhnijq)!Eg3mfpsbvuu<yf!uv>obj/gsppsmnp!DthbbnsqGm`fmsh3!E!<j*n!bh*f1</1!)v5odjfgwp!sn-!1w/f1d!3!-s1f/t1p!mv-u1j/p1o!<-!4w4b9s1z/j1o!h!-w7f7d23/!1w!Vw-<68/!1$!ef-g*j1o/f1!)G5YdBfBw`!RV-B*M1J/U1Z)`5Qd1f!w2!/1-*!1$/e1f)g5jdoffw!!GY-BoBp`jRuVvBmMpJtUfZs`!Q2-!f2h/b6nj!!$e-ffghjbonfj!!GY-BfBh`bRnVjB!MJ-U*Z1`/Q13)!53d/f1w!!$-ewfVgwj!of)!sGfYeBbBi`TRmVfByMjJQUbZb`yQG4>!s5p/m1pD!h$besfGg`jmohf!!G|Y!B*B)`oRjVbBnM!JeUjZp`wQ!5!~2!3/<1*N!b$nevfmg!j-o{fz!yG/y*bNbtCppqp!m-!ycfpup)mqpU!y$feUfbgbjyoGf)!5GuybbpbmGGmbpbbyuG!!gomspvbuufs!!$e<foghjjoTfi!uGhyobfbmG!m+p!byuj3q!cwvfTdu3ft!g$gePfmgfjyojfq!>G,yzb/bNGtmppqb!u*4o!bwqfTd{4sp!i$!e)fggjj!of<!oGhyjbTbiGumhpobfum5!!+w!fydj5qcv!T$uefftggjgoPfm!fGyyjbqb>T,byu/)Nyt*p!qd!m*bonbqq)Ty{-s!p1i/a1)-g!j2!/1<**I!y$jeqfcgvjto!f-!eGpypbHbuUfftyg!gtPbmnfqymjfqs)3yEbn!>$yejfqgcjvoTfu!fGtygbgbPUmffyyUjpqq!)uub-p!mqG*b!buyfGy!uv<s1f/31E!);u!-u!fqt-g!g1P/m1f*yj!q$!e@f!gojboqfT!eGpypbhb>UefpypPHgugf)tug-g!Pqm-f!ypj-q!!su*b!pumfGybubvysGf!3E<)yuj-q!cqv,T)zpu!j+m!bsv*R-b!b1y/g1!*+!!HGyyjbqbcGvmtp>bIuy!jGqycbvbtM!vunbbp)mGGybbbbyGGm!pb<u65/!1s,h*c*bq*d!S|i!ushfoufvMsoob!qsth.c)b!/+z!<u!t~e)!>GuyfbtbgGgmPpmbfuy5j!qG!yubbbpQmjGybfbmyTGi!be<fGsy)jq!cGvytb!b+G!mGpybjuq3c!vqtp>tH-yj!qGcyvbtb!GumbppbmuG5b!bgyyGb!bD<pQootbpqmTfeQpppthQ!p;t!-Oo!bGqyTbebpUpfhy!!@u!fOyo-pj!uGdyfbsbjUef>yo!bgqyTbebpDppho!tmppmpfC4b7b1yUGf!yF<y*qQCujtbet!O-fOhuPtoef)-oj!nG>yubtbeU!fuyb!pgmyGbbbbDypGo!tp<mQfu4t7e1!U=f!yOFuytqeC>jObotpOjfuhdUfxspj-e!!mGpypbCbbGbmypGb!u3<!iguyhbobfRMvobbmqjtu0z1S/d2q>GqsdbSnifu-ho!fGMyobbbqGtm!pubbup5m!GgbybbybGD!po<tppsmff[SUdMqNGbsnbvnmf!P>qau!-*1!/G1y!b=b!GQmepobFub5n!vgmy)b>bQDopboqtTpempfpShd!qmGpspbCnbfbPyqGu!3-<*!OGuytbeb,GQmuptbeu)5>!iguyhbobfDMpoobtqptm!fu4b7p1mSGdbqbGysGb!nf<Ppqsuf3[-UM!NGbynbvbmG!m>pab!u*!1g/y1b!b=R!vObemojFubznTvvmc)q>jOyo-bq!TGeypbpbhG!mmppbpuC!bgbyybGb!Rv<bzm/jNutzpFqe.hzf/UQitspfqt>iQpumtee-!*!oGbyqbTb{Gsmppibau)!ggjy!bb<Rzv/bOmtjpuqz.Fze/hNftUpiqs>fOtuitpem!e*Nojboq-T{!sGpyibab)Ggmjp!bu<!yg/yNbtbpDqp.oyt/pQmtfpFqe>hQfuTtieb!suqbopfmtGtb-by!GG!yb<byG/mOptbpuq!.gyy/bNbtDppqo>tOpumtfeF!euhbfpUmiGsbfbtyiGp!me~-!!~G!yb~b!Gm<p5bQu`!ZgUyJbMbBDVpRo`tBpBmYfGF!e+h!fzU/iQsOfgtgipp>m,ezN/jQot-pq!!G*yQbfboGpmepab)ug5j!!gy<b5bQD`pZoUtJpMmBfV4R7`1BDBpYoGt!u+E!jys/Q!O*g!g|p>!,Gyy/bQbtGpmqp!b*uQ3f!oqppetaN)<gj!!qp<t*NQ/fyo>pqepat)/!y}<}!!*qOpftoNp/eza>)q>pQtO/fzo<pe!!Gy<b5bQG`mZpUbJuM5B!VsRh`cBzBNY>GG!y+b!bzU/fQyOUgpgqp)>u.fzy/-O!tqppqt!N**O<fo!p$eeaf)ggjjo!f!<m5vQn`bZNU!JsMhBcVzRN`/BzBY!GG!y+b!byG/mQpObgug!pm>v.nyb/TO>tGpyqb!b*MOvfnobp)eGay)bgbjU!fy<Pegfgm)budfTyu-o!fqjpetbNs-h!!G>y?b!b*GQmepobFub3n)v!m1)/t1c-b!>2Q/f1o*p-e!!gy<bebfRmvbbdmTjuuozfSjdeqbGsshb!n>f?/!y*zO*e*o<Fb!nGvymb)btGcmbp>bOuf!ompven!bF<>6G/y1b!b+M!vOnObb)nGvymb.bQUefoyFPbgngv)mu>fQye-o!FqbpntvNm-!!*GQyfbobpGemap)bguj3!)!<26//11-!!+1!/O1O*b-n!vgmy.bObeRovFbbmnjvumz>SOdeqoGFsbbnnvfm/!y*zO*f*o<pe!aG)ygbjb!Gm<p*b*uz!ym/vQntbpOq>!G-yybfbuM)vqnpbU)yGfyUbbbbUyfGy)Pbgngv)Mubfbyy-G!>qQpetoNF-b!nGvymb!b*GQmfpobpue3a))!g1j/!1-<.*2*/z1y*/-O!tgpyqb!b-Ryvfbum)jqupzUSydfqUGbsbbynGf)/bynzv*M*b<by!GG>yObeboGFmbpnbvum!!m*vOnfboXp>eGay)bgbjM!vn|b!)*GQyObfboUpfey)Pggjg!)u<f4yQ-`!ZqUpJtMNB-V!RG`yBbBbYGGm!p+b!uz3/)Q.O2g/g1p->!,1z//1Q*t-p!qg!y*bQbfRovpbemaj)ugzjS!dq<G4sQb`nZfU/JyMzB*V*R<`B!BGYyGb!b+G!myp/bQuO!gngbpy>T,Ny>/nQbtyp)qm!v*nQbfTo-p!emav)ngbjN!*<<*!QGfyobpbeGam)p!b}u}!!n*jOofToNp>enaj)o>)QmOvfnobpTe-!!m<v4nQb`NZ*U<JM!BGVyRb`bBGBmYpGb!u+!!nzb/yQFOTgNg>pn>b.yz)/mOvtnpbqF!-*!OnfboypTeNa*)<gj!!Gy<b4bQG`mZpUbJuM!BnVjRo`FBTBNY>Gn!j+o!)ym/vQnObgFg-p!>n.jyo/TONt*p<q!!*GOyfbobpGemap)bguj!!nb<yeXfOm>bndbTyu)omfvjnebbOs-h!!m>v?n!b*XQ*e<oF!bGnyvbmb)Gtmcpbb>uQ!fnojpoeX!O><nejfom)bmdvTnuboOf-j!embvsnhb!X>*?<!*!OGeyobFbbGnmvpmb)ut!csbb>oOhffoNpbey!>n<b6y/)1n!b+y!XOOO-b!nnvbmy.FQTeNo*F<bn!vGmy>bQbeGomFpbbnuv!ms!b*oQhffoNpjeoa>)ngjjo!)n<j6o/X1O!-+!!nOjOobFnTvNm*.<Oe!oGFybbnbvGmm>pObeuo!Fsbbnovhmf!N*bOyfTodpbemaf)eg>js!bo<h*f*Nzbyy/!Q+t!pgqy!b-byRfvub)mqjpuUzyFfeUhbfbUyiGs)fbtnivpMmbeb<yG!>GQyebobFGbmnpvbmu!!*sQbfoohpfe>as)bgojh!fN<b*y*.zsyb/oOhtfpNqj!o-<yf!uG)yqbpbUGymfpUbbub!ysGb)obhnfvNMbbybDymGb>nOqefoeF>bnnbvym)!g*yObfboRpvebam)jgujz!Fe|h!f*UQiOsffotpiep)mgejN!jo<-3!Qs`bZoUhJfMNBbVyRT`dBbBmYfGe!*+<!z!/GQyObgbgCpp>p,mz!/fQbtspmqz!F*yQjfuo>psebao)hgfj!!=!<s3bQo`hZfUNJbMyBDVmRb`nBqBfYeG<!+!!jyg/)QfObgsgmpz>F,yyj/uQ*tp!qs!f*uQvfsoop!esah)cgzjN!<<!*GQyfbobpGemap)b!u}!}m!v*nObfOoXp>eGay)b>bQMOvfnobp)eG!yb<b3UQf`yZPUgJgM)BuVfRy`-B!BqYpGt!N+-!!zG/yQbObgGgmpp>b.uz3/)O.t2p/q1!-*.O2f/o1p*e-a!)ggyjb!bR<v3bQm`jZuUzJSMdBqVGRs`bBnBfY/Gy!z+*!*y</Q!OGgygbpb>G.myp/bOut!pmqv!n*bOTfFo>pGeyab)bgMjv!nb<)eGfymbbbdUTfuyoPfgjge)busfhy!->!?q!p*tQNe-o!FGbynbvbmG)mtpcbbu>3Q)f!o2p/e1!-!<2e/f1m*b-d!TguyobfbjRevbbsmhj!u>z?S!d*qOGesobFnbfn/vymz)*t*c<b>!OGfyobpbeG!mp<b6u/!1m!v+n!bOOOFb>nGvymb.bQMevonFbb)nGvymb>bQUefoyFPbgngv)mu!f*yQ-f!oqppetaN)-g!jG!yb<b6G/m1p!b+u!3O)O!b2n/v1m-..O2e/o1F*b-n!vgmy>bObeRovFbbmnjvumz!S*dOqfGospbenaf)/gyjz!**<<**!zGyy/bQbtGpmqp!b-uy!fmuv)nqbpTUXy>fGUybbbbyMGv)nbbn)vGMybbbbyUGf>yQPegogF)bunfvym-!!*qQpftoNp-e!aG)ygbjb!Gm<p*b*uz3y)/.O2t/p1q-!!-2y/f1u*)-q!pgUyybfbURbvbbymGj)ubznSvdMqbGbsybGn>fO/eyozF*b*n<vm!!G*yObfboGpmepab)ug!jm!vn|b!O*TQ>OmfvonpbeO),gmjv!nb<T2<Q`!ZGUyJbMbBGVmRp`bBuB!YmGv!n+b!XzF/>QmOvgngbpX>,,mzv/nQbtFp<q!!*GQyfbobpGemap)bguj!!tv<c2qQj`yZSUdJqMSBbVoRh`fB>B2Y/G1!0+s!byo/hQfO<gg!pG>y,byb/GQmtppbqu!!*tQvfcoqpjeyaO)TgXjF!>m<v*nQbfOoTp,emav)n!b}X}F!<*O!fGoypbebaG)m>pQbOuf!ofpeeh!fmIpppsC{b2b>y)G.!3/<12!Q+`!ZmUvJnMbBNV*R,`mBvBnYbGO!T+<!z!/GQyObgbgGpm>p.bzu/!Oftephqf!W*fOsfuo2p>e)a.)3g/j1!!+<!2mQv`nZbUNJ*M,BmVvRn`bBXBFY<G!!+G!yyb/bQGOmgpgbpu>!.myv/nObtOpFqT!F*>OmfvonpbeOaF),gmjv!nb<TeFf<mb!dGTyubobfGjmepbbsuh!!m>v?n!b*OQXeOoFF>bmnvvnmb)OtXc,bm>vQnfboOpFe<!m!pGpyCbbbbGymGp!bu<!effemhbfdITpuso{f3j>e)b.s3h/!1>!?+!!*mOvenobFFb*n,vmmv)ntbcObF>TOFf<op!eG!ymbpbpGCmbpbbyuG!!fe<h6f/W1f!s+u!3O>O)b.n3v/m1>!.+Q!emovFnbbnOv*m,!mv<n6b/O1X!O+F!<OO!bGnyvbmb>G.mOpebouF!bmnvvnmb!OX<T1X/>1m!v=n!bNONXb,nmvvmn>bpTsXf<[U!MGNybbnbvGmm!pmbpup!CmbvbnybGT!XT<FF>ymjvqncbvTtX!,+m!vEnybjTqFc<vt!>GGyybjbqGcmvptb!uu!bfpemhGfbIbpysG{!5><)6b/c1t!)+f!eOhOfbInpvsm{.2N*b!n+v!m3>/N1N*b,nbvcmt!)ufbephmfGIbpbsy{G3!*<<1!/G5y0b1b/G2m!p+b!uu!offejhefbWsfhs>ue5f>m)bbdcTtu)offejhefbWsfhs!uu2b*p!m+G!b3b/y1G*!,b<cTtT)bfnevhmf>WOfOsbun3v*m<!*!OGsyjbbbqGam)pgbju!!f<e*h*fQItppsq{!4->y)f.u3)/q1p!U+y!fmUvbnbbyXG*),bmnvvnMbbObXyTGX><Qe!oGFybbnbvGmm!pubbup!mfGebhbfyWGf!su<4D>y)j.q3c/v1t!!++!!mDvynjbqTc*v,tm>vFnybjTqXcTvFt<!u!bGpymbGbbGbmypGb!u!<f*e*hOftIppqs!{->ybfcut))qfpeUhyffIUpbsb{y4G*),bfnevhMfbIbpysG{>5O<eo!FGbynbvbmG!mupbbpum!GfbebhyfGW!fs<u1>/b4c,t*)DfyejhqfcWvfts+u*41*/,3f.e)h)f>WEfysjuq5c<vt!!GuybbpbmGGmbpbbyuG!!tv<c1qQj`yZOUXJTMXBOVFRT`FB>BmYvGn!b+O!XzT/XQ,Omgvgnpb,OzF/TCFt<pq!>Gzy/bQbtGpmqp!bu<!1mQf`oZhUuJiMTBjVhRo`>BgByYbGb!R+v!bym/jQuOzgSgdpq,Gys/bCntfp/qy><y/!QGtypbqb!Cp<pQmt!piqp!s3{uTbqpbmoG>bfbeyhGf!Ip<s1{Q!`?Z>U!JfMeBhVfRW`fBsBuY<G!!+G!yzb/bQGOmgpgbpu.!zt/vCctqpjqy>Bz>/tOvtcpqqj!yO<T1XQF`!Z+U!J3M/B1V,Rt`vBcBqYjGy!O+X!TyX/OQFOTgFg<p.!yj/gC)tapiqp>sy{/TOqtbpoq*!!m<vOntbpOq>!m3vunbbpXm<Gb!bjygG)!ai<p6s/{1T!q+b!oo*h!jmTvinubhTo>fmmv>n,bzF/<Ct!pjqg!)*iopbsq{TT{qsbpoi*!!)mgfjo!hu<i6T/j1h!o+>!goyhbjbTRivubhmojfumz>S,dyq/GCstbpnqf!/*zo<bq!TG{ysbpbiGam)pgbju!!t<vzc/qfjnybCs>G)qtdvSczqujjymBb!v+R!b)b2y/g1!0;2!31//11*!*@.!m*vonbbqNT<{s!pGiy!b)b>Gzm/pQbOug!ghps!be<jyf/ofunOb>smGvqndbSOz.umjvmnbbvNR<bb!yGgy!b;b!G1m/p1b!u@!!h*sobbeqjTf{osupTi>am)v>nyb/TQ.Omgvgnpb!N<<Q!OGgygbpb!G3mupbbpum!GmbvbnybGO!O><mzv/nNbtOp,qm>vzn/bCNt<pq!!Gy<byb/GNmtppbqu>!ym/vCntbpTqT!>m<vCntbpTq,!m3vunbbpNm<Gb!bGyyGb!bC<p*pfmh!oqbbSjqsdOS>ybjcqtc)vhts!b+e!j*fCoyujOq*c!v?t>)!tbccbt))uhbsTbbebjyfGo>uDTy*j<qc!vGty!bubbGpmmpGbbub!yhGs!be<jofhojuT>inubhyo)fbmc.t>)ohhsjbTeijufhooufOm*!-*!Obscjtb)qh)sgbje!jf<o*u*T",je(x,{accordionViewExpandIcon:Fj(on),accordionViewCollapseIcon:Fj(on,!0),accordionViewLabelColor:Je,accordionViewLabelFont:Pd,accordionViewTitleBackground:mb,accordionViewSelectBackground:Vb,accordionViewSelectWidth:3,accordionViewSeparatorColor:Y,splitViewDividerSize:1,splitViewDividerBackground:mb,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:Dj,rect:[2,2,12,12],background:on}]},propertyViewLabelColor:Wg,propertyViewLabelSelectColor:Je,propertyViewLabelFont:Pd,propertyViewExpandIcon:Fj(pl),propertyViewCollapseIcon:Fj(pl,!0),propertyViewBackground:jd,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:yc,propertyViewColumnLineColor:yc,propertyViewSelectBackground:Vb,listViewLabelColor:Wg,listViewLabelSelectColor:Je,listViewLabelFont:Pd,listViewRowLineVisible:!1,listViewRowLineColor:yc,listViewSelectBackground:Vb,treeViewLabelColor:Wg,treeViewLabelSelectColor:Je,treeViewLabelFont:Pd,treeViewExpandIcon:Fj(Jc),treeViewCollapseIcon:Fj(Jc,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:yc,treeViewSelectBackground:Vb,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Wg,tableViewLabelSelectColor:Je,tableViewLabelFont:Pd,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:yc,tableViewColumnLineColor:yc,tableViewSelectBackground:Vb,treeTableViewLabelColor:Wg,treeTableViewLabelSelectColor:Je,treeTableViewLabelFont:Pd,treeTableViewExpandIcon:Fj(Jc),treeTableViewCollapseIcon:Fj(Jc,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:yc,treeTableViewColumnLineColor:yc,treeTableViewSelectBackground:Vb,tableHeaderLabelColor:Wg,tableHeaderLabelFont:Pd,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:Dr,tableHeaderBackground:jd,tableHeaderMoveBackground:Ig,tableHeaderInsertColor:Vb,tableHeaderSortDescIcon:Xb(pl,!0),tableHeaderSortAscIcon:Xb(pl),tabViewTabGap:1,tabViewLabelColor:Je,tabViewLabelFont:Pd,tabViewTabBackground:mb,tabViewSelectWidth:3,tabViewSelectBackground:Vb,tabViewMoveBackground:Ig,tabViewInsertColor:Vb,toolbarLabelColor:Wg,toolbarLabelSelectColor:Je,toolbarLabelFont:Pd,toolbarBackground:jd,toolbarSelectBackground:Vb,toolbarItemGap:8,toolbarSeparatorColor:$f},!0);var kt={translateX:1,sortColumn:1},lt={sortable:1,sortOrder:1,sortFunc:1},mt={focusData:1},nt={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},ot={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},pt=function(y,P){P.add(y),y.hasChildren()&&y.eachChild(function(w){pt(w,P)})},qt=function(L,C,d,b,c,y,W,O,z,Z,l){var H,X=d.getValueType(Z),M=d.getAlign(Z);if(d.getEnumValues(Z)){var D=d.toEnumLabel(C,Z),t=Wf||0,Q=0,p=y,k=x.getTextSize(b,D).width;return H=ti(d.toEnumIcon(C,Z)),H&&(Q=y+Wf/2,"center"===M?Q+=(O-(t+k))/2:"right"===M&&(Q=Q+O-(t+k)),td(L,H,Q,W+z/2,Z,l),p=Q+Wf/2),D!=F&&(H?ke(L,D,b,c,p,W,O-(p-y),z):ke(L,D,b,c,y,W,O,z,M)),void 0}return C=d.formatValue(C),C!=F?X===cb?(ys(L,y,W,O,z,C),void 0):X===nn||!X&&Um(C)?(H=ti(C?$h:Ge),td(L,H,y+O/2,W+z/2,Z,l),void 0):(ke(L,C,b,c,y,W,O,z,M),void 0):void 0},rt=function(p,X){var v=X.view,r=pq(p),s=X.column||X.property;v.getDataModel().beginTransaction(),X.editor=p,p.info=X,v.setCurrentEditor(p),v.getView().insertBefore(r,v._79O),Gk(p,X.editorRect),p.setFocus?p.setFocus():Qk(p),p.commitValue=function(k,u){p._17Q&&(p=p._17Q),u||v.setValue(X.data,s,p.getValue?p.getValue():p.value),p.close&&p.close(),yo(r)},s.onEditorCreated&&s.onEditorCreated(X)},st=function(b,i,L,D,W){var Z=Ib(b,L),A=i.value,G=i.view,z=W.getValueType(i.data);return Z.onblur=Z.onchange=function(){G.endEditing()},"input"===b?(A=W.formatValue(A),A!=F&&(Z.value=A),Z.onkeydown=function(m){kj(m)?G.endEditing():Ei(m)&&G.endEditing(!0)},(z===ae||z===Kp)&&B(Z,wb,x.numberListener)):b===mk&&D.forEach(function(K){var J=M.createElement("option");J.innerHTML=W.toEnumLabel(K),J.value=K,W.isEnumEqual(A,K)&&(J.selected=!0),kf(Z,J)}),rt(Z,i),Z},tt=R.widget={},ut=function(O,o,d){tr(q+".widget."+O,o,d)};je(_g,{ms_value:function(i){i.getValue=function(J){var O=this.getItemById(J),g=O.element;return Fn(g)?g:g?g.getValue?g.getValue():g.value:O.selected},i.setValue=function(F,n){var B=this.getItemById(F);if(B){var Z=B.element;Z&&!Fn(Z)?Z.setValue?Z.setValue(n):Z.value=n:Um(n)?(B.selected=n,this.iv()):(B.element=n,this.iv())}},i.v=function(l,y){var Z=this;if(2===arguments.length)Z.setValue(l,y);else{if(!gr(l))return Z.getValue(l);for(var A in l)Z.setValue(A,l[A])}return Z}},_46o:function(Z){Z._icon=F,Z._accessType=F,Z._valueType=F,Z._editable=!1,Z._batchEditable=!0,Z._align=Qi,Z._nullable=!0,Z._emptiable=!1,Z.setParent=fn,Z.formatValue=function(l){var s=this,u=s._valueType;return s.getEnumValues()?s.toEnumLabel(l):u===nn?!!l:l!=F&&u===ae?m(l):l},Z.setEnum=function(h,o,S,A,C,w,z){var v=this;h&&!Ub(h)&&h.values&&(A=h.editable,S=h.icons,o=h.labels,C=h.strict,w=h.maxHeight,z=h.dropDownWidth,h=h.values),ic(h)&&(h=h._as),ic(o)&&(o=o._as),ic(S)&&(S=S._as),v._enumValues=h,v._enumLabels=o,v._enumIcons=S,v._enumEditable=A,v._enumStrict=C==F?!0:C,v._enumMaxHeight=w,v._enumDropDownWidth=z,h&&h.length&&bs(h[0])&&(v._valueType=Kp),v.fp("enum",!1,!0)},Z.getEnumDropDownWidth=function(){return this._enumDropDownWidth},Z.getEnumMaxHeight=function(){return this._enumMaxHeight},Z.isEnumEditable=function(){return this._enumEditable},Z.getEnumValues=function(){return this._enumValues},Z.getEnumLabels=function(){return this._enumLabels},Z.getEnumIcons=function(){return this._enumIcons},Z.isEnumStrict=function(){return this._enumStrict},Z.isEnumEqual=function(Y,p){return this._enumStrict?Y===p:Y==p},Z.toEnumLabel=function(b,H){var x=this,p=x.getEnumValues(H),c=x.getEnumLabels(H);if(p&&c)for(var N=0;N<p.length;N++)if(x.isEnumEqual(b,p[N]))return c[N];return b},Z.toEnumIcon=function(v,i){var m=this,k=m.getEnumValues(i),r=m.getEnumIcons(i);if(k&&r)for(var g=0;g<k.length;g++)if(m.isEnumEqual(v,k[g]))return r[g];return Y}},_45o:function(Z){Z._87o=function(e,E,n,N,r,h){if(e){var J=this,R=J._90I,U=eo(1);J._columnLineVisible&&(r-=1),J._rowLineVisible&&(h-=1),0>=r||0>=h||(J._90I||(R=J._90I={}),R[E]||(R[E]=new Hb),Gk(U,J.tx()+n,J.ty()+N,r,h),kf(U,e),J._view.insertBefore(U,J._79O),e.onParentAdded&&e.onParentAdded(U),R[E].add(U))}},Z._76o=function(){var i=this,H=i._90I;if(H){for(var j in H)H[j].each(function(K){yo(K)});delete i._90I}},Z._77o=function(S){var N=this;if(N._90I){var k=N._90I[S];k&&(k.each(function(m){yo(m)}),delete N._90I[S])}}},_47o:function(K){K.getValue=function(O,G){return G.getValue?G.getValue(O,G,this):Jo(O,G.getAccessType(),G.getName())},K.setValue=function(B,W,r){if(W.isEmptiable(B)||""!==r||(r=Y),W.isNullable(B)||r!=F){var f=this,P=W.getName(B),p=W.getAccessType(B),y=W.getValueType(B);y===ae&&Fn(r)?r=Ld(r):y===Kp&&Fn(r)?r=parseFloat(r):y===nn&&Fn(r)&&(r="true"===r),f._batchEditable&&W._batchEditable&&f.isSelected(B)?f.sm().each(function(x){W.setValue?W.setValue(x,W,r,f):bo(x,p,P,r)}):W.setValue?W.setValue(B,W,r,f):bo(B,p,P,r)}},K.setCurrentEditor=function(L){this.endEditing(),this._currentEditor=L,this.redraw()},K.isEditing=function(y,i){var p=this,X=p._currentEditor;if(!X)return!1;if(i){var a=X.info;return a?(a.column||a.property)===i&&a.data===y:!1}return!0},K.endEditing=function(m){var s=this,H=s._currentEditor;H&&(delete s._currentEditor,H.commitValue&&H.commitValue(H.info,m),s.redraw(),s.getDataModel().endTransaction())},K.beginEditing=function(A){this.endEditing();var l=this,w=A.column||A.property;if(w.beginEditing)w.beginEditing(A);else{var Z=A.data,o=A.value,G=l.getSelectBackground(Z),r=w.getEnumValues(Z),E=w.getSlider(Z),H=w.getColorPicker(Z);if(E){var N=bj(tt.Slider,E);return N.setValue(o),N.getView().onblur=function(){l.endEditing()},N.isInstant()&&(N.onValueChanged=function(){l.setValue(Z,w,N.getValue())}),rt(N,A),void 0}if(H||w.getValueType(Z)===cb){var C=bj(tt.ColorPicker,H);return C.setValue(o),C.onClosed=function(){l.endEditing()},C.isInstant()&&(C.onValueChanged=function(v,C){l.setValue(Z,w,C)}),rt(C,A),C.open(),void 0}if(r){if(tt.ComboBox){var Q=new tt.ComboBox;Q.setValue(o),Q.setValues(r),Q.setLabels(w.getEnumLabels(Z)),Q.setIcons(w.getEnumIcons(Z)),Q.setEditable(w.isEnumEditable(Z)),Q.setStrict(w.isEnumStrict(Z)),Q.setMaxHeight(w.getEnumMaxHeight(Z)),Q.setDropDownWidth(w.getEnumDropDownWidth(Z)),Q.onClosed=function(){l.endEditing()},rt(Q,A),Q.open()}else st(mk,A,G,r,w);return}var O=w.getValueType(Z);if(O===nn||Um(o))return l.setValue(Z,w,!o),void 0;if(w.getItemEditor(Z)){var L=nr(w.getItemEditor(Z)),M=new L(Z,w,l,A),D=M.getView();return D._17Q=M,M.setValue(o),Kg(D),rt(D,A),M.editBeginning&&M.editBeginning(),void 0}st("input",A,G,F,w)}}},_44o:function(j){j.init=function(W){var i=this,v=i.th=new Jt(W),V=i._view=jb(1,i);i.tv=i._tableView=W,kf(V,v.getView()),kf(V,W.getView()),v.mp(function(y){y.property===xn&&i.iv()}),i.iv()},j.getTableView=function(){return this.tv},j.getTableHeader=function(){return this.th},j.getDataModel=function(){return this.tv.dm()},j.getColumnModel=function(){return this.tv.getColumnModel()},j.setColumns=function(Y){this.tv.setColumns(Y)},j.addColumns=function(o){this.tv.addColumns(o)},j.endEditing=function(){this.tv.endEditing()},j.validateImpl=function(){var i=this,r=i.th,v=Sp(r),m={x:0,y:0,width:i.getWidth(),height:v};Gk(r,m),m.y=v,m.height=O(0,i.getHeight()-v),Gk(i.tv,m)}},ms_vs:function(k){k._41o=function(){return this._29I.height<this._59I},k._43o=function(){var h=this;h._41o()&&(h._58I||(bg(function(){h._94O()},Vh),h.iv()),h._58I=new Date)},k._94O=function(){var f=this;if(f._58I){var r=new Date;r.getTime()-f._58I.getTime()>=Vh?(delete f._58I,f.iv()):bg(function(){f._94O()},Vh)}},k._93I=function(){var y=this,K=y._27I;if(y._58I||!y._autoHideScrollBar){K||kf(y._79O,K=y._27I=eo());var D=y._29I,w=D.height,j=y._59I,u=y.getScrollBarSize(),G=D.width-u-2,s=w*(-y.ty()/j),h=w*(w/j),b=K.style;j>w?(ws>h&&(s=s+h/2-ws/2,0>s&&(s=0),s+ws>w&&(s=w-ws),h=ws),b.visibility=Fi,b.background=y.getScrollBarColor(),b.borderRadius=u/2+Oq,Gk(K,G,s,u,h)):b.visibility=Ff}else K&&(K.style.visibility=Ff)}},ms_hs:function(u){u._40o=function(){return this._29I.width<this._91I},u._42o=function(){var C=this;C._40o()&&(C._95O||(bg(function(){C._94I()},Vh),C.iv()),C._95O=new Date)},u._94I=function(){var t=this;if(t._95O){var w=new Date;w.getTime()-t._95O.getTime()>=Vh?(delete t._95O,t.iv()):bg(function(){t._94I()},Vh)}},u._92I=function(){var j=this,B=j._28I;if(j._95O||!j._autoHideScrollBar){B||kf(j._79O,B=j._28I=eo());var n=j._29I,N=n.width,p=j._91I,h=j.getScrollBarSize(),o=n.height-h-2,i=N*(-j.tx()/p),z=N*(N/p),Y=B.style;p>N?(ws>z&&(i=i+z/2-ws/2,0>i&&(i=0),i+ws>N&&(i=N-ws),z=ws),Y.visibility=Fi,Y.background=j.getScrollBarColor(),Y.borderRadius=h/2+Oq,Gk(B,i,o,z,h)):Y.visibility=Ff}else B&&(B.style.visibility=Ff)}}}),We($h,Bj(16,16,[{type:Gj,rect:[1,1,14,14],background:Vb},{type:ej,rect:[1,1,14,14],width:1,color:Wc},{type:ad,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),We(Ge,Bj(16,16,{type:ej,rect:[1,1,14,14],width:1,color:Wc})),We(Xe,Bj(16,16,[{type:Tc,rect:[2,2,12,12],borderWidth:1,borderColor:Wc,background:"#FFF"},{type:Tc,rect:[4,4,8,8],background:Vb}])),We(dr,Bj(16,16,{type:Tc,rect:[2,2,12,12],borderWidth:1,borderColor:Wc})),_g._15Q=function(w){w._29I=be,w._59I=0,w._91I=0,w._5o=function(c){var j=this;j._30I=new Hb,j._rows=new Hb,j._rowMap={},j._31I=0,j._14I=0,j._view=jb(1,j),j._canvas=Vl(j._view),kf(j._view,j._79O=eo()),j.dm(c?c:new dl)},w.getCheckIcon=function(H){var R=this.sm(),i=R.co(H);return R.sg()?ti(i?Xe:dr):ti(i?$h:Ge)},w.checkData=function(W){var y=this.sm(),r=y.co(W);y.sg()&&r||(this._32o=1,r?y.rs(W):y.as(W),delete this._32o)},w.getDataAt=function(c){c.target&&(c=this.lp(c));var n=Z(c.y/this._rowHeight),R=this._rows;return 0>n||n>=R.size()?F:R.get(n)},w.onDataDoubleClicked=function(){},w.onDataClicked=function(){},w.adjustTranslateX=function(){return 0},w.adjustTranslateY=function(T){var j=this.getHeight()-this._59I;return j>T&&(T=j),T>0?0:m(T)},w.onPropertyChanged=function(D){var i=this,o=D.property;nt[o]?i.ivm():mt[o]||i.redraw(),o===Nl?i._42o():o===Tk&&i._43o()},w.getLabel=function(D){return D.toLabel()},w.getLabelFont=function(){return this._labelFont},w.getLabelColor=function(s){var z=this;if(z.isCheckMode()){if(z._focusData===s)return z._labelSelectColor}else if(z.isSelected(s))return z._labelSelectColor;return z._labelColor},w.getStartRowIndex=function(){return this._31I},w.getEndRowIndex=function(){return this._14I},w.getRowDatas=function(){return this._rows},w.getRowIndex=function(U){return this._rowMap[U._id]},w.getRowSize=function(){return this._rows.size()},w.getViewRect=function(){return Af(this._29I)},w.isVisible=function(s){return this._visibleFunc?this._visibleFunc(s):!0},w.getCurrentSortFunc=function(){return this._sortFunc},w.setDataModel=function(b){var x=this,r=x._dataModel,i=x._selectionModel;r!==b&&(r&&(r.umm(x.handleDataModelChange,x),r.umd(x.handleDataPropertyChange,x),r.umh(x.handleHierarchyChange,x),i||r.sm().ums(x.handleSelectionChange,x)),x._dataModel=b,b.mm(x.handleDataModelChange,x),b.md(x.handleDataPropertyChange,x),b.mh(x.handleHierarchyChange,x),i?i._21I(b):b.sm().ms(x.handleSelectionChange,x),x.fp("dataModel",r,b))},w.validateModel=function(){var r=this;r._rows.clear(),r._rowMap={},r.buildChildren(r._dataModel._roots);var Y=r._rows=r._rows.toList(r.isVisible,r),S=0,b=r.getCurrentSortFunc(),U=Y.size();for(b&&Y.sort(b);U>S;S++)r._rowMap[Y.get(S)._id]=S},w.buildChildren=function(J){var E=this;J.each(function(i){E._rows.add(i),E.buildChildren(i._children)})},w.handleDataModelChange=function(){this.ivm()},w.handleDataPropertyChange=function(T){"parent"===T.property?this.ivm():this.invalidateData(T.data)},w.handleHierarchyChange=function(){this.ivm()},w.handleSelectionChange=function(c){c.datas.each(this.invalidateData,this),this.onSelectionChanged(c)},w.onSelectionChanged=function(f){var O=this,L=O.sm();!O.isAutoMakeVisible()||1!==L.size()||"set"!==f.kind&&"append"!==f.kind||O._32o||O.makeVisible(L.ld())},w.handleBackgroundClick=function(c){rf(c)&&!this.isCheckMode()&&this.sm().cs()},w.makeVisible=function(D){D&&(this._23I=D,this.iv())},w.scrollToIndex=function(P){var F=this,b=F._29I,a=b.height,g=F._rowHeight,T=g*P;P>=0&&P<F._rows.size()&&a>0&&(T+g>b.y+a?F.ty(-T+a-g):T<b.y&&F.ty(-T))},w.autoScroll=function(L,H){var c=this,u=c._rowHeight,Y=u,W=u/4,i=c._29I,Z=c.lp(L),$={x:c.tx(),y:c.ty()};return u>0&&i&&(Z.x-i.x<Y?c.translate(W,0):i.x+i.width-Z.x<Y&&c.translate(-W,0),Z.y-i.y<Y?c.translate(0,W):i.y+i.height-Z.y<Y&&c.translate(0,-W)),$.x=c.tx()-$.x,$.y=c.ty()-$.y,H&&(H.x+=$.x,H.y+=$.y),$},w.getTopRowOrderSelection=function(){var U=this.sm().getTopSelection(),E={},d=new Hb;return U.each(function($){E[$._id]=$}),this._rows.each(function(r){E[r._id]&&d.add(r)}),d},w.getRowOrderSelection=function(){var U=new Hb;return this._rows.each(function(R){this.isSelected(R)&&U.add(R)},this),U},w.ivm=function(){this.invalidateModel()},w.invalidateModel=function(){var d=this;d._96I||(d._96I=1,d._32I=1,delete d._24I),d.iv()},w.redraw=function(){var V=this;V._32I||(V._32I=1,delete V._24I,V.iv())},w.invalidateData=function(i){var C=this;_k?C.redraw():C._32I||(C._24I||(C._24I={}),C._24I[i._id]=i,C.iv())},w.getFocusData=function(){return this._focusData},w.setFocusDataById=function(X){this.setFocusData(this.dm().getDataById(X))},w.setFocusData=function(M){var l=this,v=l._focusData;v!==M&&(l._focusData=M,l.fp("focusData",v,M),v&&l.invalidateData(v),M&&(l.invalidateData(M),l.isAutoMakeVisible()&&l.makeVisible(M)))},w.drawRowBackground=function(V,y,g,H,t,E,A){var Z=this,I=Z.isCheckMode();(y===Z._focusData&&I||g&&!I)&&ys(V,H,t,E,A,Z.getSelectBackground(y))},w.drawData=function(Q,N,J){var y=this,E=y._rowHeight,u=E*J,T=y._29I,F=T.x,I=T.width;Q.save(),Q.beginPath(),Q.rect(F,u,I,E),Q.clip(),y._87o(y.drawRow(Q,N,y.isSelected(N),F,u,I,E),J,F,u,I,E),Q.restore(),y._rowLineVisible&&ys(Q,F,u+E-1,I,1,y._rowLineColor)
},w._12I=function(v){var X=this,a=X._31I,A=X._29I,c=A.x,k=A.y,t=A.width,h=A.height;for(v.beginPath(),v.rect(c,k,t,h),v.clip(),v.clearRect(c,k,t,h),X._76o(),X._93db(v);a<X._14I;a++)X.drawData(v,X._rows.get(a),a);X._92db(v)},w._13I=function(i){for(var J,f=this,h=f._rowHeight,Z=f._29I,j=Z.x,I=Z.width,E=f._31I,S=f._30I;E<f._14I;E++)J=f._rows.get(E),f._24I[J._id]&&S.add({data:J,index:E});S.isEmpty()||(i.beginPath(),S.each(function(O){i.rect(j,O.index*h,I,h)}),i.clip(),S.each(function(s){i.clearRect(j,s.index*h,I,h)}),S.each(function(h){f._77o(h.index)}),f._93db(i),S.each(function(q){f.drawData(i,q.data,q.index)}),f._92db(i),S.clear())},w.preValidateModel=function(){this.endEditing&&this.endEditing()},w.validateImpl=function(){var K=this,G=K._canvas,I=K.getWidth(),L=K.getHeight(),t=K._rowHeight,S=K._32I;(I!==G.clientWidth||L!==G.clientHeight)&&(Bh(G,I,L),S=1),K._96I&&(K.preValidateModel(),K.validateModel());var b=K._29I,E={x:-K.tx(),y:-K.ty(),width:I,height:L},v=K._rows.size(),g=Se(G),m=K._23I;S||uc(E,b)||(S=1),K._29I=E,K._59I=v*t,K._31I=Z(E.y/t),K._14I=N((E.y+E.height)/t),K._31I<0&&(K._31I=0),K._14I>v&&(K._14I=v),K._99I&&S&&K._99I();var R=K.tx(),U=K.ty();(K._40o()||K._41o())&&(K._59I+=K.getScrollBarSize(),K._99I&&S&&(K._91I+=K.getScrollBarSize())),Cr&&!Er&&(g.save(),zg(g,I/Nc.length,L/Nc.length,1)),zg(g,R,U,1),S?K._12I(g):K._24I&&K._13I(g),K._93I(),K._92I(),g.restore(),K._32I=K._24I=K._96I=F,m&&(K.scrollToIndex(K.getRowIndex(m)),delete K._23I),K.tx(K.tx()),K.ty(K.ty())},w.canHandleSelectMode=function(){return!0}},_g._48o=function(_){_._rootVisible=!0,_._rootData=F,_._35o=function(){this._expandMap={},this._levelMap={}},_.validateModel=function(){var w=this,P=w._rootData;w._rows.clear(),w._levelMap={},w._rowMap={},w._currentLevel=0,P?w._rootVisible?w.isVisible(P)&&w.buildData(P):w.buildChildren(P):w.buildChildren(),delete w._currentLevel},_.buildData=function(t){var g=this,v=t._id,w=g._rows;g._rowMap[v]=w.size(),w.add(t),g._levelMap[v]=g._currentLevel,g.isExpanded(t)&&(g._currentLevel++,g.buildChildren(t),g._currentLevel--)},_.buildChildren=function(i){var O=this,q=i?i._children:O._dataModel._roots,z=O.getCurrentSortFunc();z&&O.isChildrenSortable(i)?q.toList(O.isVisible,O).sort(z).each(O.buildData,O):q.each(function(T){O.isVisible(T)&&O.buildData(T)})},_.getLevel=function(I){return this._levelMap[I._id]},_.getToggleIcon=function(S){var s=this,P=s._loader,o=s._collapseIcon;return P&&!P.isLoaded(S)?o:S.hasChildren()?s.isExpanded(S)?s._expandIcon:o:F},_.isCheckMode=function(){return this._checkMode!=F},_.isChildrenSortable=function(){return!0},_.handleDataModelChange=function(d){var E=this;d.kind===Pq?delete E._expandMap[d.data._id]:d.kind===Wk&&(E._expandMap={}),E.ivm()},_.toggle=function(O){var o=this;o.isExpanded(O)?o.collapse(O):o.expand(O)},_.isExpanded=function(V){return 1===this._expandMap[V._id]},_.expand=function(S){var P=this,v=P._loader;P.isExpanded(S)||(v&&!v.isLoaded(S)&&v.load(S),P._expandMap[S._id]=1,P.ivm(),P.onExpanded(S))},_.onExpanded=function(){},_.collapse=function(A){var G=this;G.isExpanded(A)&&(delete G._expandMap[A._id],G.ivm(),G.onCollapsed(A))},_.onCollapsed=function(){},_.expandAll=function(A){if(A)this.expand(A),A.eachChild(function(t){this.expandAll(t)},this);else{var N=this;N._dataModel.each(function(p){p.hasChildren()&&(N._expandMap[p._id]=1)}),N.ivm()}},_.collapseAll=function(){this._expandMap={},this.ivm()},_.makeVisible=function(Z){if(Z){var g=this;if(!g._rootData||Z.isDescendantOf(g._rootData)){for(var $=Z._parent;$;)g.expand($),$=$._parent;g._23I=Z,g.iv()}}},_.checkData=function(Q){var h,d=this,$=d._checkMode,R=d.sm(),C=R.co(Q);if(!R.sg()||!C){if(d._32o=1,$===vb)C?R.rs(Q):R.as(Q);else if($===ui)h=new Hb(Q),h.addAll(Q._children);else if("descendant"===$)h=new Hb,pt(Q,h);else if("all"===$&&(h=new Hb,pt(Q,h),!C))for(var n=Q._parent;n;)h.add(n),n=n._parent;h&&(C?R.rs(h):R.as(h)),delete d._32o}},_.drawTree=function(e,j,J,Q,g,o,i){var B=this,R=B._indent,d=B._levelMap[j._id],n=B.getIconWidth(j),C=ti(B.getToggleIcon(j));C?(Q+=R*d,td(e,C,Q+R/2,g+i/2,j,B),Q+=R):Q+=R*(d+1),B._checkMode&&(td(e,B.getCheckIcon(j),Q+R/2,g+i/2,j,B),Q+=R),B.drawIcon(e,j,Q,g,n,i),B.drawLabel(e,j,Q+n,g,i)}},_g._14Q=function(A){A.getIcon=function(V){return V.getIcon()},A.getIconWidth=function(S){return this.getIcon(S)?this._indent:0},A.drawIcon=function(b,B,y,a,v,N){if(v){var l=this,z=l.getBodyColor(B),x=ti(l.getIcon(B),z);x&&(N-=l.isRowLineVisible()?1:0,sl(b,x,op,y,a,v,N,B,l,z),lp(b,l.getBorderColor(B),y,a,v,N))}},A.drawLabel=function(L,c,G,w,M){var R=this;ke(L,R.getLabel(c),R.getLabelFont(c),R.getLabelColor(c),G,w,0,M)}},_g._50o=function(X){X._98I=function(){var Z=this,o=Z._39o=new dl;Z._60I=new Hb,o.mm(Z._17o,Z),o.md(Z._18o,Z),o.mh(Z._19o,Z)},X.setColumns=function(S){this._39o.clear(),this.addColumns(S)},X.addColumns=function(z){var T=this._39o;z.forEach(function(v){if(!(v instanceof wt)){var A=nr(v.className);v=bj(A?A:wt,v)}T.add(v)})},X.onColumnClicked=function(){},X.onCheckColumnClicked=function(){},X._3Q=function(b){for(var w,g=0,p=this._60I,L=p.size();L>g;g++)if(w=p.get(g),w.column===b)return w;return F},X.getColumnAt=function(v){var C=this._4Q(v);return C?C.column:F},X._4Q=function(b){for(var $=this,q=b.target?$.lp(b).x:b.x,g=$._60I,r=0;r<g.size();r++){var W=g.get(r),S=W.startX;if(q>=S&&q<S+W.column.getWidth())return W}return F},X.getToolTip=function(B){var m=this,A=m.getDataAt(B),G=m.getColumnAt(B);return A&&G?G.getToolTip(A,m):F},X.adjustTranslateX=function(U){var s=this.getWidth()-this._91I;return s>U&&(U=s),U>0?0:m(U)},X._99I=function(){var M=this,A=M._29I,B=M._60I;B.clear(),M._91I=0,M._39o._roots.each(function(h){if(h.isVisible()){var T=M._91I+h.getWidth();M._91I<=A.x+A.width&&T>=A.x&&B.add({column:h,startX:M._91I}),M._91I=T}})},X.drawData=function(l,T,G){var X=this,g=X._rowHeight,a=g*G,V=X.isSelected(T),H=X._29I,F=H.x,r=H.width;X.drawRowBackground(l,T,V,F,a,r,g),X._60I.each(function(s){var I=s.column,O=s.startX,t=I.getWidth();t>0&&!X.isEditing(T,I)&&(l.save(),l.beginPath(),l.rect(O,a,t,g),l.clip(),X._87o(X.drawCell(l,T,V,I,O,a,t,g),G,O,a,t,g),X._columnLineVisible&&ys(l,O+t-1,a,1,g,X._columnLineColor),l.restore())}),X._rowLineVisible&&ys(l,F,a+g-1,r,1,X._rowLineColor)},X.drawCell=function(i,k,F,W,J,f,z,n){var Z=this;if(W.drawCell)return W.drawCell(i,k,F,W,J,f,z,n,Z);var d=Z.getValue(k,W);qt(i,d,W,Z.getLabelFont(k,W,d),Z.getLabelColor(k,W,d),J,f,z,n,k,Z)},X.getColumnModel=function(){return this._39o},X._17o=function(){this.redraw()},X._18o=function(A){var T=this;A.data===T._sortColumn&&lt[A.property]?T.ivm():(T._42o(),T.redraw())},X._19o=function(){this.redraw()},X.getCurrentSortFunc=function(){var Q=this,G=Q._sortColumn;if(G&&G.isSortable()){var S=G.getSortFunc(),W=dm===G.getSortOrder()?1:-1;return S||(S=Gc),function(F,T){return S.call(Q,Q.getValue(F,G),Q.getValue(T,G),F,T)*W}}return Q._sortFunc},X.isCellEditable=function(d,k,Z){return k.isEditable()&&this.isEditable()?k.isCellEditable?k.isCellEditable(d,k,Z,this):!0:!1},X._37O=function(F,j){if(rf(j))for(var r=this,M=r.lp(j),E=r._60I,g=r._rowHeight,b=r._29I,K=b.x,y=b.y,H=b.width,L=b.height,f=0;f<E.size();f++){var D=E.get(f),Y=D.startX,w=D.column,T=w.getWidth();if(w!==r._31o&&w!==r._4o&&M.x>=Y&&M.x<Y+T&&r.isCellEditable(F,w,j)){var C={x:Y,y:r.getRowIndex(F)*g,width:T,height:g},I={x:C.x+r.tx(),y:C.y+r.ty(),width:C.width,height:C.height},u=0,n=0;return C.x<K?u=C.x-K:C.x+C.width>K+H&&(u=C.x+C.width-K-H),u&&(r.tx(r.tx()-u),I.x-=u),C.y<y?n=C.y-y:C.y+g>y+L&&(n=C.y+g-y-L),n&&(r.ty(r.ty()-n),I.y-=n),r.beginEditing({data:F,column:w,value:r.getValue(F,w),event:j,rect:C,editorRect:I,view:r}),void 0}}}},tt.BaseItemEditor=function(_,W,G,y){this._data=_,this._column=W,this._master=G,this._editInfo=y},ut("BaseItemEditor",S,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var vt=R.Tab=function(){ag(vt,this)};jh("Tab",Yk,{ms_ac:["view","closable","disabled","visible"],_icon:F,_closable:!1,_disabled:!1,_visible:!0,setParent:fn});var wt=R.Column=function(){ag(wt,this)};jh("Column",Yk,{_46o:1,ms_ac:["accessType","valueType",Fi,Te,yk,jf,"align",cb,"sortOrder",Kl,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:dm,_sortFunc:F,_sortable:!0,_clickable:!0,setWidth:function(Y){16>Y&&(Y=16);var F=this._width;this._width=Y,this.fp(jf,F,Y)},getToolTip:function(K,$){return this.formatValue($.getValue(K,this))}});var xt=R.Property=function(){ag(xt,this)};jh("Property",Yk,{_46o:1,ms_ac:["accessType","valueType",Te,yk,"categoryName",cb,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:F,getToolTip:function(h,F,n){var N=this;return F?N.formatValue(n.getValue(h,N)):n.getPropertyName(N)}}),tt.AccordionView=function(){var l=this;l._20o={},l._21o=new Hb,l._10o=F,l._9o=F,l._11o=F,l._view=jb(0,l),l.iv()},ut("AccordionView",S,{ms_v:1,ms_fire:1,ms_ac:[sm,mf,"titleHeight",kq,gp,"titleBackground","selectWidth",ji,"orientation","separatorColor"],_expandIcon:x.accordionViewExpandIcon,_collapseIcon:x.accordionViewCollapseIcon,_titleHeight:$p,_labelColor:x.accordionViewLabelColor,_labelFont:x.accordionViewLabelFont,_titleBackground:x.accordionViewTitleBackground,_selectBackground:x.accordionViewSelectBackground,_selectWidth:x.accordionViewSelectWidth,_orientation:"v",_separatorColor:x.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(v,z,t,j){var X=this,p=eo(),r={content:z,div:p,canvas:Vl(p),icon:j};if(X._20o[v])throw v+" already exists";var h=r.downEventFunc=function(m){cc(m)},d=r.upEventFunc=function(s){cc(s),rf(s)&&(X._10o===v?X.collapse():X.expand(v))};[mg,Pc].forEach(function(F){B(p,F,h)}),[xq,uh].forEach(function(i){B(p,i,d)}),p.style.cursor=fj,kf(X._view,p),X._20o[v]=r,X._21o.add(v),t&&X.expand(v),X.iv()},remove:function(A){var Y=this,S=Y._20o[A];if(S){var W=S.div;yo(W),[mg,Pc].forEach(function(w){V(W,w,S.downEventFunc)}),[xq,uh].forEach(function(p){V(W,p,S.upEventFunc)}),delete Y._20o[A],Y._21o.remove(A),Y.iv()}},clear:function(){var z=this;z._21o.toArray().forEach(z.remove,z),z._20o={},z._21o.clear(),z.iv()},isExpanded:function(q){return this._10o===q},expand:function(T){var X=this;X._20o[T]&&X._10o!==T&&(X._10o=T,X.onExpanded(T),X.iv())},onExpanded:function(){},collapse:function(){var P=this;P._10o&&(P.onCollapsed(P._10o),delete P._10o,P.iv())},onCollapsed:function(){},initCanvas:function(X,e,p){Bh(X,e,p);var q=Se(X);return zg(q,0,0,1),q.clearRect(0,0,e,p),q},drawTitle:function(J,d,Y,r,M){var L=this,u=ti(M.icon),v=L.isExpanded(d),V=L._titleHeight,G=L._titleBackground,h=L._selectWidth,P=L._separatorColor,T=ti(v?L._expandIcon:L._collapseIcon),l=h+4;ys(J,0,0,Y,r,G),v&&h&&ys(J,0,0,h,r,L._selectBackground),(v||L._21o.get(L._21o.size()-1)!==d)&&ys(J,0,r-1,Y,1,P?P:Aq(G)),u&&(td(J,u,l+Ro(u)/2,V/2),l+=Ro(u)+2),ke(J,d,L.getLabelFont(d),L.getLabelColor(d),l,0,0,V),T&&td(J,T,Y-Ro(T)/2-4,V/2)},validateImpl:function(){var b=this,Y=b._view,P=0,Q=0,l=b.getWidth(),M=b.getHeight(),A=b._titleHeight,p=b._21o.size()*A,g=b._11o,E=b._9o;delete b._11o,delete b._9o,b._21o.each(function(x){var C,G,g=b._20o[x],u=g.content,n=b._10o===x;Ep(b)?(Gk(g.div,P,0,A,M),C=b.initCanvas(g.canvas,A,M),Yp(C,0,M),Cq(C,-Ie),b.drawTitle(C,x,M,A,g),C.restore(),n?(G=O(0,l-p),u&&(b._11o=u,b._9o=pq(u),Gk(u,P+A,0,G,M)),P+=A+G):P+=A):(Gk(g.div,0,Q,l,A),C=b.initCanvas(g.canvas,l,A),b.drawTitle(C,x,l,A,g),C.restore(),n?(G=O(0,M-p),u&&(b._11o=u,b._9o=pq(u),Gk(u,0,Q+A,l,G)),Q+=A+G):Q+=A)});var m=b._9o;g&&g!==b._11o&&g.endEditing&&g.endEditing(),m&&m!==E&&kf(Y,m),E&&E!==m&&yo(E)}}),tt.SplitView=function(N,j,V,a){var l=this,v=l._dividerDiv=eo(),z=l._60O=Vl(),U=l._61O=Vl(),c=z.style,d=U.style;l._view=jb(1,l),kf(l._view,v),c.msTouchAction=Nf,c.pointerEvents=Nf,c.cursor=fj,d.msTouchAction=Nf,d.pointerEvents=Nf,d.cursor=fj,N&&l.setLeftView(N),j&&l.setRightView(j),V&&l.setOrientation(V),a!=F&&l.setPosition(a),l.setStatus(of),new yt(l)},ut("SplitView",S,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:x.splitViewDividerSize,_dividerBackground:x.splitViewDividerBackground,_dragOpacity:x.splitViewDragOpacity,_toggleIcon:x.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(h,t){var D=this,c=D._position;isNaN(h)||(t||(D._82O=0>h?-1:h>1?1:0),D._position=h,D.fp(Pl,c,h))},getLeftView:function(){return this._leftView},setLeftView:function(B){var z=this,k=z._leftView,P=z._view;if(z._leftView!==B){if(k&&k!==z._rightView){var $=pq(k);$.parentNode===P&&yo($)}if(z._leftView=B,B){var I=pq(B);I.parentNode!==P&&P.insertBefore(I,z._dividerDiv)}z.fp("leftView",k,B)}},getRightView:function(){return this._rightView},setRightView:function(P){var p=this,Y=p._rightView,R=p._view;if(p._rightView!==P){if(Y&&Y!==p._leftView){var y=pq(Y);y.parentNode===R&&yo(y)}if(p._rightView=P,P){var U=pq(P);U.parentNode!==R&&R.insertBefore(U,p._dividerDiv)}p.fp("rightView",Y,P)}},validateImpl:function(){var q=this,p=q._draggable,R=q._position,M=q.getWidth(),e=q.getHeight(),$=q._dividerSize,W=q._dividerBackground,J=Mc?18:8,V=q._dividerDiv,u=q._82O,L=q._60O,t=q._61O,x=q._toggleIcon,P=q._status,G=V.style,F=null,C=Mc?20:4,o=x.comps[0];$>=J||0===$?q._coverDiv&&(yo(q._coverDiv),delete q._coverDiv):q._coverDiv||(q._coverDiv=eo(),_r&&(q._coverDiv.style.background=Ab),kf(V,q._coverDiv)),q._togglable?L.parentNode||(kf(V,L),kf(V,t)):(yo(L),yo(t));var B=q._coverDiv,j=q._leftView,Z=q._rightView;if(Ep(q)){if($>M&&($=M),P===of)if(1===u)var h=r(R,M),a=O(0,M-$-h);else-1===u?(a=r(-R,M),h=O(0,M-$-a)):(h=m((M-$)*R),a=O(0,M-$-h));else"cl"===P?(h=0,a=O(0,M-$)):"cr"===P&&(a=0,h=O(0,M-$));j&&Gk(j,0,0,h,e),Z&&Gk(Z,h+$,0,a,e),Gk(V,h,0,$,e),q._22o=h,B&&(Gk(B,$/2-J/2,0,J,e),B.style.cursor=p?Tr:""),V.style.cursor=p?Tr:"";var f=V.clientHeight/2,w=V.clientWidth;Bh(L,w,w),Gk(L,0,f-w-C,w,w),F=Se(L),zg(F,0,0,1),o.rotation=-Ie,tp(F,x,0,0,w,w),F.restore(),Bh(t,w,w),Gk(t,0,f+C,w,w),F=Se(t),zg(F,0,0,1),o.rotation=Ie,tp(F,x,0,0,w,w),F.restore()}else{if($>e&&($=e),P===of)if(1===u)var n=r(R,e),z=O(0,e-$-n);else-1===u?(z=r(-R,e),n=O(0,e-$-z)):(n=m((e-$)*R),z=O(0,e-$-n));else"cl"===P?(n=0,z=O(0,e-$)):"cr"===P&&(z=0,n=O(0,e-$));j&&Gk(j,0,0,M,n),Z&&Gk(Z,0,n+$,M,z),Gk(V,0,n,M,$),q._22o=n,B&&(Gk(B,0,$/2-J/2,M,J),B.style.cursor=p?rk:""),G.cursor=p?rk:"";var s=V.clientWidth/2,w=V.clientHeight;Bh(L,w,w),Gk(L,s-w-C,0,w,w),F=Se(L),zg(F,0,0,1),o.rotation=0,tp(F,x,0,0,w,w),F.restore(),Bh(t,w,w),Gk(t,s+C,0,w,w),F=Se(t),zg(F,0,0,1),o.rotation=d,tp(F,x,0,0,w,w),F.restore()}G.background=W}});var yt=function(t){this.sv=t,this.addListeners()};tr(yt,S,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(P){var D=this,T=D.sv,x=T._dividerDiv,L=T._60O,R=T._61O,l=T._status,y=P.target;if(y===L)l===of?T.setStatus("cl"):"cr"===l&&T.setStatus(of);else if(y===R)l===of?T.setStatus("cr"):"cl"===l&&T.setStatus(of);else if(Al(P)&&(y===x||y===T._coverDiv)&&(cc(P),T.isDraggable())){T.getLeftView(),T.getRightView();var B=D.maskDiv=eo();if(B.style.left=0,B.style.top=0,B.style.width=T.getWidth()+"px",B.style.height=T.getHeight()+"px",T.getView().appendChild(B),!T.isContinuousLayout()){var g=D.resizeDiv=eo();g.style.left=x.style.left,g.style.top=x.style.top,g.style.width=x.style.width,g.style.height=x.style.height,g.style.opacity=T.getDragOpacity(),g.style.background=T.getDividerBackground(),kf(D.getView(),g)}D._lastAbsPosition=T._22o,D._86o=Ep(T)?sf(P).x:sf(P).y,om(D,P)}},handleWindowTouchMove:function(s){Al(s)&&this.update(s,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(V){var g=this;g.update(V,!0),g.sv.setStatus(of),g.maskDiv&&yo(g.maskDiv),g.resizeDiv&&yo(g.resizeDiv),g.maskDiv=g.resizeDiv=F},handle_mousedown:function(y){rf(y)&&this.handle_touchstart(y)},handleWindowMouseMove:function(d){this.handleWindowTouchMove(d)},handleWindowMouseUp:function(j){this.handleWindowTouchEnd(j)},update:function(l,i){var R=this,_=R.sv,N=Ep(_)?_.getWidth():_.getHeight(),U=_._dividerSize,H=R._lastAbsPosition-R._86o;Ep(_)?(H+=sf(l).x,H>N-U&&(H=N-U),0>H&&(H=0),R.resizeDiv&&(R.resizeDiv.style.left=H+Oq)):(H+=sf(l).y,H>N-U&&(H=N-U),0>H&&(H=0),R.resizeDiv&&(R.resizeDiv.style.top=H+Oq)),i&&N!==U&&(1===_._82O?_.setPosition(H,1):-1===_._82O?_.setPosition(H-N+U,1):_.setPosition(H/(N-U),1))}}),tt.TabView=function(){var W=this,l=W._view=jb(1,W),t=W._91O=eo(1),c=W._tabModel=new dl,k=c.sm(),K=W.invalidate;W._7o=new Hb,W._canvas=Vl(t),kf(l,t),kf(l,W._92O=eo(1)),k.setSelectionMode(Xf),k.ms(W.handleSelectionChange,W),c.mm(K,W),c.mh(K,W),c.md(K,W),W._interactor=new zt(W),W.iv()},ut("TabView",S,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",kq,gp,"tabHPadding","tabBackground","selectWidth",ji,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:En,_tabHeight:$p,_tabGap:x.tabViewTabGap,_labelColor:x.tabViewLabelColor,_labelFont:x.tabViewLabelFont,_tabBackground:x.tabViewTabBackground,_selectWidth:x.tabViewSelectWidth,_selectBackground:x.tabViewSelectBackground,_moveBackground:x.tabViewMoveBackground,_insertColor:x.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(m,c,C){var d,l=this._tabModel;return m instanceof vt?(d=m,c&&d.setView(c)):(d=new vt,d.setName(m),d.setView(c)),l.add(d),C&&l.sm().ss(d),d},getLabel:function(C){return C.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(K){this._23o=K,this.iv()},get:function(Y){var J=this,i=J._tabModel;if(bs(Y))return i._roots.get(Y);if(Fn(Y)){var y;return i.each(function(Q){Y===J.getLabel(Q)&&(y=Q)}),y}return Y instanceof vt?Y:F},select:function(k){this._tabModel.sm().ss(this.get(k))},remove:function(H){var o=this;if(H=o.get(H)){var X=o._tabModel,K=X._roots.indexOf(H);o._tabModel.remove(H),o.selectByIndex(--K)}},getCurrentTab:function(){return this._8o},hideTabView:function(a,T){T.parentNode===this._92O&&(Nk(T)?(T.style.display=wo,T._tab_=a):yo(T),Qf())},showTabView:function(H,i){Nk(i)&&(i.style.display="block",i._tab_=H),i.parentNode!==this._92O&&(kf(this._92O,i),Qf())},_24o:function(){var P,I=this,t=I._8o,g=I._9o,o=I._tabModel.sm().ld();o&&(P=pq(o.getView())),P!==g&&(g&&(t.getView()&&t.getView().endEditing&&t.getView().endEditing(),I.hideTabView(t,g)),P&&I.showTabView(o,P)),I._8o=o,I._9o=P,t!==o&&I.onTabChanged(t,o)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(r,x){this.selectByIndex(--x)},selectByIndex:function(c){var P=this,v=P._tabModel,I=v.size();if(I&&!v.sm().ld()){c==F&&(c=0),c>=I&&(c=I-1),0>c&&(c=0);for(var i=c;i>=0;i--){var y=P.get(i);if(!y.isDisabled())return P.select(y),y}for(i=c+1;I>i;i++)if(y=P.get(i),!y.isDisabled())return P.select(y),y}},getTabWidth:function(w){var R=this.getTabHPadding(),y=4+2*R,W=ti(w.getIcon());W&&(y+=Ro(W,w)+4);var X=this.getLabel(w);return X&&(y+=gn(this.getLabelFont(w),X).width+4),w.isClosable()&&(y+=10),y},drawTab:function(N,h,l,M,s,O,x){var W,U=this,P=U._tabPosition,K=this.getTabHPadding(),Y=l+4+K,Z=U._selectWidth,H=ti(h.getIcon()),j=h.isDisabled(),S=U.getLabelColor(h),i=U.getLabelFont(h),F=U.getLabel(h),f=U._selectBackground,k=P===Qi+"-vertical",$=P===Me+"-vertical";(k||$)&&(Y=M+4+K),j&&(N.globalAlpha=ni),ys(N,l,M,s,O,x),h===U._8o&&Z&&(P===En?ys(N,l,M+O-Z,s,Z,f):P===Qi?ys(N,l+s-Z,M,Z,O,f):P===Me?ys(N,l,M,Z,O,f):k?ys(N,l+s-Z,M,Z,O,f):$?ys(N,l,M,Z,O,f):ys(N,l,M,s,Z,f));var o=s/2;if(k&&(Yp(N,o,M+O/2),Cq(N,d),Yp(N,-o,-M-O/2)),H){var r=Kb(H,h),A=Ro(H,h);if(k||$){var E=l+s/2,V=Y+r/2;Yp(N,E,V),Cq(N,Ie),Yp(N,-E,-V),td(N,H,l+s/2,Y+r/2,h,U),Yp(N,E,V),Cq(N,-Ie),Yp(N,-E,-V),Y+=r+4}else td(N,H,Y+A/2,M+O/2,h,U),Y+=A+4}return k||$?(Yp(N,s/2,Y+s/2),Cq(N,Ie),Yp(N,-s/2,-Y-s/2),ke(N,F,i,S,l,Y,O,s),Yp(N,s/2,Y+s/2),Cq(N,-Ie),Yp(N,-s/2,-Y-s/2)):ke(N,F,i,S,Y,M,s,O),k&&(Yp(N,o,M+O/2),Cq(N,-d),Yp(N,-o,-M-O/2)),h.isClosable()&&(W=$?{x:l+s-12,y:M+O-12,width:12,height:12}:{x:l+s-12,y:M+2,width:12,height:12},this.drawCloseIcon(h,N,S,W)),j&&(N.globalAlpha=1),W},drawCloseIcon:function(f,U,F,a){var v=a.x,x=a.y;U.strokeStyle=F,U.lineWidth=1,U.beginPath(),U.moveTo(v+2,x+8),U.lineTo(v+8,x+2),U.moveTo(v+8,x+8),U.lineTo(v+2,x+2),U.stroke()},getTabAt:function(D){var H=this._interactor._8Q(D);return H?H.tab:null},validateImpl:function(){var j=this;j._24o();var T,S=j._canvas,h=j._tabPosition,v=j._91O,_=j._92O,f=j._tabModel,D=j.getWidth(),x=j.getHeight(),A=j._tabHeight,r=j._7o,l=j._tabGap,n=h===En,i=h===Qi,Y=h===Me,e=h===Qi+"-vertical",g=h===Me+"-vertical",M=j._23o,U=0;if((i||Y)&&f._roots.each(function(A){U=O(j.getTabWidth(A),U)}),n?(Gk(v,0,0,D,A),T={x:0,y:A,width:D,height:O(0,x-A)}):i?(Gk(v,0,0,U,x),T={x:U,y:0,width:O(0,D-U),height:x}):Y?(Gk(v,D-U,0,U,x),T={x:0,y:0,width:O(0,D-U),height:x}):e?(Gk(v,0,0,A,x),T={x:A,y:0,width:O(0,D-A),height:x}):g?(Gk(v,D-A,0,A,x),T={x:0,y:0,width:O(0,D-A),height:x}):(Gk(v,0,x-A,D,A),T={x:0,y:0,width:D,height:O(0,x-A)}),Gk(_,T),e||g){j._9o&&(T.x=0,Gk(j._8o.getView(),T)),Bh(S,A,x);var z=Se(S),V=0;if(zg(z,0,j.ty(),1),z.clearRect(0,0,A,x),r.clear(),f._roots.each(function(X){if(X.isVisible()){var T,m=j.getTabWidth(X);if(!M||M.tab!==X){var D=j.getTabBackground(X);T=j.drawTab(z,X,0,V,A,m,D)}r.add({_75o:T,tab:X,startY:V,endY:V+m,height:m}),V+=m+l}}),j._23Q=O(0,V-l),M){var o=M.position;j.drawTab(z,M.tab,0,M.startY,A,M.height,j._moveBackground),ys(z,0,o,A,1,j._insertColor)}if(z.restore(),j._selectionChanged){j._selectionChanged=!1;for(var I=j.ty(),Q=0;Q<r.size();Q++){var C=r.get(Q);if(C.tab===j._8o){if(C.endY+I<0){j.ty(-C.startY);break}if(C.startY+I>x){j.ty(x-C.endY);break}}}}j.ty(j.ty())}else if(i||Y){j._9o&&(T.x=0,Gk(j._8o.getView(),T)),Bh(S,U,x);var z=Se(S),V=0;if(zg(z,0,j.ty(),1),z.clearRect(0,0,U,x),r.clear(),f._roots.each(function(E){if(E.isVisible()){var Y;if(!M||M.tab!==E){var s=j.getTabBackground(E);Y=j.drawTab(z,E,0,V,U,A,s)}r.add({_75o:Y,tab:E,startY:V,endY:V+A,height:A}),V+=A+l}}),j._23Q=O(0,V-l),M){var o=M.position;j.drawTab(z,M.tab,0,M.startY,U,M.height,j._moveBackground),ys(z,0,o,U,1,j._insertColor)}if(z.restore(),j._selectionChanged){j._selectionChanged=!1;for(var I=j.ty(),Q=0;Q<r.size();Q++){var C=r.get(Q);if(C.tab===j._8o){if(C.endY+I<0){j.ty(-C.startY);break}if(C.startY+I>x){j.ty(x-C.endY);break}}}}j.ty(j.ty())}else{j._9o&&(T.y=0,Gk(j._8o.getView(),T)),Bh(S,D,A);var z=Se(S),u=0;if(zg(z,j.tx(),0,1),z.clearRect(0,0,D,A),r.clear(),f._roots.each(function(Z){if(Z.isVisible()){var U,L=j.getTabWidth(Z);if(!M||M.tab!==Z){var o=j.getTabBackground(Z);U=j.drawTab(z,Z,u,0,L,A,o)}r.add({_75o:U,tab:Z,startX:u,endX:u+L,width:L}),u+=L+l}}),j._64I=O(0,u-l),M){var o=M.position;j.drawTab(z,M.tab,M.startX,0,M.width,A,j._moveBackground),Kc(z,j._insertColor,o,0,A)}if(z.restore(),j._selectionChanged){j._selectionChanged=!1;for(var H=j.tx(),Q=0;Q<r.size();Q++){var C=r.get(Q);if(C.tab===j._8o){if(C.endX+H<0){j.tx(-C.startX);break}if(C.startX+H>D){j.tx(D-C.endX);break}}}}j.tx(j.tx())}for(var k=[],t=_.children,Q=0;Q<t.length;Q++){var y=t[Q],W=y._tab_;W&&!f.contains(W)&&k.push(y)}k.forEach(function(y){_.removeChild(y)})}});var zt=function(d){this.tv=d,this.addListeners()};tr(zt,S,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(e){this.handleScroll(e,10*(e.wheelDelta/40))},handle_DOMMouseScroll:function(u){this.handleScroll(u,10*-u.detail)},handleScroll:function(U,b){cc(U);var n=this.tv,C=n._tabPosition;!n._40o()||C!==En&&C!==Mr||n.tx(this.tv.tx()+b),!n._41o()||C!==Qi&&C!==Me&&C!==Qi+"-vertical"&&C!==Me+"-vertical"||n.ty(this.tv.ty()+b)},_8Q:function(u){var y,U,G=this.tv,o=G._tabPosition,k=G._7o;if(o===En||o===Mr){var j=G.lp(u).x;for(y=0;y<k.size();y++)if(U=k.get(y),U.startX<=j&&j<=U.endX)return U}else if(o===Qi||o===Me||o===Qi+"-vertical"||o===Me+"-vertical"){var P=G.lp(u).y;for(y=0;y<k.size();y++)if(U=k.get(y),U.startY<=P&&P<=U.endY)return U}return F},isClickable:function(K){var C=this.tv,k=C._tabPosition,Q=this._73o=this._8Q(K);return!C._40o()||k!==En&&k!==Mr?!C._41o()||k!==Qi&&k!==Me&&k!==Qi+"-vertical"&&k!==Me+"-vertical"?Q&&(!Q.tab.isDisabled()||C.isMovable()):!0:!0},handle_mousemove:function(j){var X=this;Lh?X._74o=X._8Q(j):X.getView().style.cursor=X.isClickable(j)?fj:""},handle_mousedown:function(s){this.handle_mousemove(s),this.handle_touchstart(s)},handle_touchstart:function(w){var G=this,P=G.tv,p=P._tabPosition;cc(w),rf(w)&&G.isClickable(w)&&(p===En||p===Mr?(G.x=sf(w).x,G.lp=P.lp(w),G.tx=P.tx()):(G.y=sf(w).y,G.lp=P.lp(w),G.ty=P.ty()),om(G,w))},handle_mouseup:function(L){this.handle_touchend(L)},handle_touchend:function(a){if(qn(a)){var x=this._73o;if(!x)return;var B=this.tv,q=B.getTabModel(),T=x.tab;if(!T.isDisabled()&&T.isClosable()){var I=function(){var d=q._roots.indexOf(T);q.remove(T),B.onTabClosed(T,d)};B.onTabClosing(T,I)&&I()}}},handleWindowMouseMove:function(i){this.handleWindowTouchMove(i)},handleWindowTouchMove:function(a){var h,K=this,e=K.tv,W=e._tabPosition,I=K._73o;if(W===En||W===Mr){if(h=sf(a).x-K.x,!K._25o&&!K.moving&&P(h)>2&&(e._40o()&&!qh(a)?K._25o=1:I&&e.isMovable()&&(K.moving=1)),K._25o)e.tx(K.tx+h);else if(K.moving){var k=K.lp.x+h,p=e._tabGap/2;e._7o.each(function(S){var x=S.endX,z=k-S.startX<x-k;k>=S.startX&&x>=k&&e._7Q({tab:I.tab,startX:I.startX+h,width:I.width,front:z,insertTab:S.tab,position:z?O(0,S.startX-p):r(e._64I,x+p)})})}}else if(h=sf(a).y-K.y,!K._25o&&!K.moving&&P(h)>2&&(e._41o()&&!qh(a)?K._25o=1:I&&e.isMovable()&&(K.moving=1)),K._25o)e.ty(K.ty+h);else if(K.moving){var T=K.lp.y+h,p=e._tabGap/2;e._7o.each(function(t){var u=t.endY,x=T-t.startY<u-T;T>=t.startY&&u>=T&&e._7Q({tab:I.tab,startY:I.startY+h,height:I.height,front:x,insertTab:t.tab,position:x?O(0,t.startY-p):r(e._23Q,u+p)})})}},handleWindowMouseUp:function(t){this.handleWindowTouchEnd(t)},handleWindowTouchEnd:function(){var v=this,j=v.tv,b=j._tabPosition,f=j.getTabModel(),n=f._roots,T=v._73o;if(v.moving){var t=j._23o;if(t&&t.insertTab!==t.tab){var o=t.tab,P=n.remove(o),A=n.indexOf(t.insertTab);A>=0&&(t.front||A++,A<=n.size()&&(n.add(o,A),f._38I(o,P,A)))}j._7Q(F),delete v.moving}else if(!v._25o&&T){o=T.tab;var g=v._74o;if(!g||g.tab===o)if(!o.isDisabled()&&Kk(T._75o,v.lp)){var D=function(){var P=n.indexOf(o);f.remove(o),j.onTabClosed(o,P)};j.onTabClosing(o,D)&&D()}else o.isDisabled()||j._8o===o||f.sm().ss(o)}v._25o=v._73o=v._74o=b===En||b===Mr?v.x=v.lp=v.tx=F:v.y=v.lp=v.ty=F}}),tt.PropertyView=function(w){var f=this;f._view=jb(1,f),f._canvas=Vl(f._view),kf(f._view,f._79O=eo()),f._rows=new Hb,f._28o=new Hb,f._26o={},f._26Q={};var Y=f._propertyModel=new dl,l=f.ivm;Y.mm(l,f),Y.md(l,f),Y.mh(l,f),f.dm(w?w:new dl),new At(f)},ut("PropertyView",S,{ms_ac:[kq,Sb,gp,Te,yk,"categorizable",Zp,Kl,Ue,sm,mf,pi,_l,af,"selectRowIndex",ji,"background",$l,Mb,am,Ob,ul],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:be,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Wf,_background:x.propertyViewBackground,_expandIcon:x.propertyViewExpandIcon,_collapseIcon:x.propertyViewCollapseIcon,_scrollBarColor:Jj,_scrollBarSize:xr,_autoHideScrollBar:yr,_selectBackground:x.propertyViewSelectBackground,_rowHeight:ec,_rowLineVisible:x.propertyViewRowLineVisible,_rowLineColor:x.propertyViewRowLineColor,_10I:.5,_columnLineVisible:x.propertyViewColumnLineVisible,_columnLineColor:x.propertyViewColumnLineColor,_labelColor:x.propertyViewLabelColor,_labelSelectColor:x.propertyViewLabelSelectColor,_labelFont:x.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(y){0>y&&(y=0),y>1&&(y=1);var h=this,Z=h._10I;h._10I=y,h.fp("columnPosition",Z,y)},getPropertyName:function(B){return B.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(X,r,Z){return Z===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(M,W){return W===this._selectRowIndex?this._labelSelectColor:M.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(f){var e=this.getHeight()-this._59I;return e>f&&(f=e),f>0?0:m(f)},isExpanded:function(g){if(!g)return!0;var m=this._26o[g];return m?m.isExpanded:!(this._26Q[g]===!1)},toggle:function(p){var W=this;W.isExpanded(p)?W.collapse(p):W.expand(p)},expandAll:function(){this.validate();for(var n in this._26o)this.expand(n)},expand:function(G){if(G&&G!==wo){var I=this,u=I._26o[G];u&&!u.isExpanded&&(u.isExpanded=!0,I.onExpanded(G),I.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var Y in this._26o)this.collapse(Y)},collapse:function(l){if(l&&l!==wo){var w=this,L=w._26o[l];L&&L.isExpanded&&(L.isExpanded=!1,w.onCollapsed(l),w.ivm())}},onCollapsed:function(){},getCategoryName:function(N){if(!this.isCategorizable())return wo;var o=N.getCategoryName();return o?o:wo},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(f){var U=this,N=U._dataModel;N!==f&&(N&&(N.umd(U.handlePropertyChange,U),U._selectionModel||N.sm().ums(U.handleSelectionChange,U)),U._dataModel=f,f.md(U.handlePropertyChange,U),U._selectionModel?U._selectionModel._21I(f):f.sm().ms(U.handleSelectionChange,U),U.fp(Br,N,f))},isVisible:function(M){return this._visibleFunc?this._visibleFunc(M):!0},onPropertyChanged:function(L){var l=this,e=L.property;ot[e]?l.ivm():l.iv(),e===Tk&&l._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:Df},handlePropertyChange:function(O){this._27o===O.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var h=this;h._96I||(h.setSelectRowIndex(-1),h._96I=1,h.iv())},redraw:function(){this.iv()},validateModel:function(){var I=this,r=I._rows,a=I._28o,l={},s=new Hb,m=I._27o;I.updateCurrentData(),m!==I._27o&&I.endEditing(),r.clear(),a.clear(),I.getRawProperties().each(function(w){if(I.isVisible(w)){s.add(w);var q=I.getCategoryName(w);l[q]||(a.add(q,q===wo?0:Y),l[q]={isExpanded:I.isExpanded(q),properties:new Hb})}}),I._sortFunc&&s.sort(I._sortFunc);for(var R in I._26o)I._26Q[R]=I.isExpanded(R);I._26o=l,a.each(function(L){L!==wo&&r.add(L);var Q=l[L];Q.isExpanded&&s.each(function(n){I.getCategoryName(n)===L&&(Q.properties.add(n),r.add({property:n,data:I._27o}))},I)})},validateImpl:function(){var l=this;l._76o(),l._96I&&(l.validateModel(),delete l._96I);var U=l._canvas,w=l.getWidth(),k=l.getHeight(),D=-l.ty(),y=l._rowHeight,c=l._indent,Y=w-c,g=l._rows,i=g.size(),h=l._9I=c+Y*l._10I,b=l._59I=i*y;Bh(U,w,k),l._29I={x:0,y:D,width:w,height:k},l._31I=Z(D/y),l._14I=N((D+k)/y),l._31I<0&&(l._31I=0),l._14I>i&&(l._14I=i);var e,s=Se(U),o=l._background;zg(s,0,-D,1),s.beginPath(),s.rect(0,D,w,k),s.clip(),s.clearRect(0,D,w,k),l._93db(s),o&&ys(s,0,0,c,b,o);for(var E=l._31I;E<l._14I;E++){var j=g.get(E),D=y*E;if(Fn(j))o&&ys(s,c,D,Y,y,o),e=ti(l.isExpanded(j)?l._expandIcon:l._collapseIcon),e&&sl(s,e,op,0,D,c,y),s.save(),s.beginPath(),s.rect(c,D,Y,y),s.clip(),l.drawCategoryName(s,j,E,c,D,Y,y),s.restore();else{var m=j.property,z=j.data,e=ti(m.getIcon()),B=l._selectRowIndex===E?l.getSelectBackground():F;if(e&&sl(s,e,op,0,D,c,y),B&&ys(s,c,D,Y,y,B),s.save(),s.beginPath(),s.rect(c,D,h-c,y),s.clip(),l.drawPropertyName(s,m,E,c,D,h-c,y),s.restore(),!l.isEditing(z,m)){var p=h+1,G=w-h-1;s.save(),s.beginPath(),s.rect(p,D,G,y),s.clip(),l._87o(l.drawPropertyValue(s,m,l.getValue(z,m),E,p,D,G,y,z),E,p,D,G,y),s.restore()}}l._rowLineVisible&&ys(s,c,D+y-1,Y,1,l._rowLineColor)
}l._columnLineVisible&&(ys(s,h,0,1,b,l._columnLineColor),ys(s,w-1,0,1,b)),l._92db(s),l._93I(),s.restore(),l.ty(l.ty())},drawCategoryName:function(P,R,$,v,W,M,g){ke(P,R,this.getCategoryFont(R),this.getCategoryColor(R),v,W,M,g)},drawPropertyName:function(S,n,H,U,d,b,$){return n.drawPropertyName?(n.drawPropertyName(S,n,H,U,d,b,$,this),void 0):(ke(S,this.getPropertyName(n),this.getPropertyFont(n,H),this.getPropertyColor(n,H),U,d,b,$),void 0)},drawPropertyValue:function(l,F,h,M,d,K,J,I,P){return F.drawPropertyValue?F.drawPropertyValue(l,F,h,M,d,K,J,I,P,this):(qt(l,h,F,this.getLabelFont(F,h,M),this.getLabelColor(F,h,M),d,K,J,I,P,this),void 0)},isPropertyEditable:function(V){return V.isEditable()&&this.isEditable()},setProperties:function(m){this._propertyModel.clear(),this.addProperties(m)},addProperties:function(N){if(N){var l=this._propertyModel;N.forEach(function(F){if(!(F instanceof xt)){var N=nr(F.className);F=bj(N?N:xt,F)}l.add(F)})}},getRowIndexAt:function(e){var w=this,m=Z(w.lp(e).y/w._rowHeight);return m>=0&&m<w._rows.size()?m:-1},getPropertyAt:function(N){var S=this,A=S.getRowIndexAt(N);return A>=0?S._rows.get(A).property:F},getToolTip:function(v){var j=this,O=j.getPropertyAt(v),q=j._27o;return O&&q?O.getToolTip(q,j._9I<j.lp(v).x,j):F}});var At=function(i){this.pv=i,this.addListeners()};tr(At,S,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(F){this.getView().style.cursor=F},clear:function(){var r=this;r._62O=r.cp=r.ty=r.p=F,r.setCursor(vb)},handle_mousedown:function(c){this.handle_touchstart(c)},handle_touchstart:function(n){var t=this,i=t.pv;cc(n),i.setFocus(n)&&(rf(n)?(t.cp=sf(n),t.ty=i.ty(),t.p=i.getColumnPosition(),t.handle_touchmove(n)):i.setSelectRowIndex(i.getRowIndexAt(n)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(D){this.handle_touchend(D)},handle_touchend:function(j){var b=this;if(b.cp&&!b._62O){var x=b.pv,V=x.lp(j),F=V.x,P=V.y,Q=x._indent,i=x.getRowIndexAt(j),T=x._9I;if(i>=0){var o=x._rowHeight,p=o*i,A=x._rows.get(i),g=A.property;if(Fn(A))ti(x.isExpanded(A)?x._expandIcon:x._collapseIcon)&&F>=0&&Q>=F&&P>=p&&p+o>=P?x.toggle(A):hl(j)&&x.toggle(A);else if(F>T&&x.isPropertyEditable(g,j)){var U={x:T+1,y:p,width:x.getWidth()-T-1,height:o},G={x:U.x+x.tx(),y:U.y+x.ty(),width:U.width,height:U.height},_=0,M=x._29I;U.y<M.y?_=U.y-M.y:U.y+o>M.y+M.height&&(_=U.y+o-M.y-M.height),_&&(x.ty(x.ty()-_),G.y-=_),x.beginEditing({data:A.data,property:g,value:x.getValue(A.data,g),event:j,rect:U,editorRect:G,view:x})}}x.setSelectRowIndex(i)}b.clear()},handleWindowMouseMove:function(C){this.handleWindowTouchMove(C)},handleWindowTouchMove:function(i){var X=this,c=X.pv,B=X.ty,f=X.cp,r=sf(i),A=X._62O;if("p"===A)c.setTranslateY(B+r.y-f.y);else if("c"===A){var Y=c.getWidth()-c._indent;if(Y>16){var w=X.p-(f.x-r.x)/Y,S=16/Y;S>w&&(w=S),w>1-S&&(w=1-S),c.setColumnPosition(w)}}else"s"===A&&c.setTranslateY(B+(f.y-r.y)*c._59I/c._29I.height)},handle_mousemove:function(Y){this.handle_touchmove(Y)},handle_touchmove:function(o){if(!Lh&&rf(o)){var B=this,V=B.pv,$=P(V.lp(o).x-V._9I)<=(Mc?8:3);B.cp?B._62O||($?(B._62O="c",om(B,o)):P(sf(o).y-B.cp.y)>=2&&(B._62O=B.isV(o)?"s":"p",om(B,o))):($?B.setCursor(Tr):B.setCursor(vb),B.isV(o)&&V._43o())}},isV:function(m){var O=this.pv,R=O._29I;return O._41o()&&R.x+R.width-O.lp(m).x<kd},handle_mousewheel:function($){this.handleScroll($,$.wheelDelta/40)},handle_DOMMouseScroll:function(v){2===v.axis&&this.handleScroll(v,-v.detail)},handleScroll:function(N,G){var h=this.pv;cc(N),h.endEditing(),h.translate(0,G*h.getRowHeight())},handle_keydown:function(s){var p=this.pv,H=p._rows.size(),G=p._selectRowIndex+(ce(s)?-1:1);(ce(s)||Hr(s))&&(0>G&&(G=0),G>=H&&(G=H-1),p.setSelectRowIndex(G))}}),tt.ListView=function(t){this._5o(t),new Bt(this)},ut("ListView",S,{ms_ac:[kq,Sb,gp,$l,Zp,Mb,am,Kl,Ue,pi,_l,af,Re,ji],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Wf,_rowHeight:ec,_rowLineVisible:x.listViewRowLineVisible,_rowLineColor:x.listViewRowLineColor,_scrollBarColor:Jj,_scrollBarSize:xr,_autoMakeVisible:mc,_autoHideScrollBar:yr,_selectBackground:x.listViewSelectBackground,_labelColor:x.listViewLabelColor,_labelSelectColor:x.listViewLabelSelectColor,_labelFont:x.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(_){var A=this,Q=A._checkMode;A._checkMode=_,A.fp(oq,Q,_)},drawRow:function(Q,E,L,X,b,m,k){var v=this,G=0,T=v._indent,u=v.getIconWidth(E);v.drawRowBackground(Q,E,L,X,b,m,k),v._checkMode&&(td(Q,ti(v.getCheckIcon(E)),G+T/2,b+k/2,E,v),G+=T),v.drawIcon(Q,E,G,b,u,k),v.drawLabel(Q,E,G+u,b,k)}});var Bt=function(g){this.list=g,this.addListeners()};tr(Bt,S,{ms_listener:1,getView:function(){return this.list._view},clear:function(w){var G=this,f=G.list;w&&"d"===G._62O&&!G.dragCancel&&f.handleDragAndDrop(w,"end"),f.draggingData&&(f.draggingData=null,f.redraw()),G.dragCancel=G._62O=G._isV=G._isH=G.cp=G.tx=G.ty=F},handle_mousedown:function(e){this.handle_touchstart(e)},handle_touchstart:function(P){var n=this,Q=n.list;if(cc(P),Q.setFocus(P)){var z=Q.getDataAt(P);n.cp=sf(P),n.tx=Q.tx(),n.ty=Q.ty(),rf(P)?z&&Q.handleDragAndDrop&&!n.isV(P)&&!n.isH(P)&&(Q.draggingData=z,Q.redraw(),Q.handleDragAndDrop(P,"prepare")):(z?n._33o(P,z):this._cancelDataDoubleSelect(),n.clear(P))}},handleWindowMouseUp:function(a){this.clear(a)},handleWindowTouchEnd:function(f){this.clear(f)},handle_mouseup:function(o){this.handle_touchend(o)},handle_touchend:function(M){var l=this,i=l.list;if(!l._isV&&!l._isH&&l.cp&&!l._62O){var j=i.getDataAt(M);j?(i.isCheckMode()?l._34o(M,j):l._33o(M,j),hl(M)?i.onDataDoubleClicked(j,M):i.onDataClicked(j,M)):(l._cancelDataDoubleSelect(),i.handleBackgroundClick(M))}l.clear(M)},handleWindowMouseMove:function(P){this.handleWindowTouchMove(P)},handleWindowTouchMove:function(c){var k=this,e=k.list,L=k._62O,S=k.tx,D=k.ty,T=k.cp,N=sf(c),O=e._29I;"p"===L?e.setTranslate(S+N.x-T.x,D+N.y-T.y):"v"===L?e.ty(D+(T.y-N.y)*e._59I/O.height):"h"===L?e.tx(S+(T.x-N.x)*e._91I/O.width):"d"===L&&(k.dragCancel||e.handleDragAndDrop(c,"between"))},handle_mousemove:function(o){this.handle_touchmove(o)},handle_touchmove:function(F){if(!Lh&&rf(F)){var B=this,E=B.list;if(B._isV=B.isV(F),B._isH=B.isH(F),B.cp){if(!B._62O){if(Gd(sf(F),B.cp)<2)return;B._isV?B._62O="v":B._isH?B._62O="h":E.draggingData&&!this.dragCancel?(B._62O="d",E.handleDragAndDrop(F,"begin")):B._62O="p",B._62O&&"d"!==B._62O&&E.draggingData&&(E.draggingData=null,E.redraw()),om(B,F)}}else B._isV&&E._43o(),B._isH&&E._42o()}},isV:function(r){var g=this.list,m=g._29I;return g._41o()&&m.x+m.width-g.lp(r).x<kd},isH:function($){var y=this.list,V=y._29I;return y._40o()&&V.y+V.height-y.lp($).y<kd},handle_mousewheel:function(K){this.handleScroll(K,K.wheelDelta/40,K.wheelDelta!==K.wheelDeltaX)},handle_DOMMouseScroll:function(R){this.handleScroll(R,-R.detail,1)},handleScroll:function(n,M,O){var N=this.list;cc(n),N.endEditing&&N.endEditing(),O&&N._41o()?N.translate(0,M*N.getRowHeight()):N._40o()&&N.translate(10*M,0)},handle_keydown:function(o){if(!x.isInput(o.target)){var D,P=this.list,f=P.sm(),F=P._rows,z=F.size();if(fe(o))P.selectAll();else if(Nb(o))P.handleDelete&&P.handleDelete(o);else if(Ei(o))"d"!==this._62O||this.dragCancel||(P.handleDragAndDrop(o,"cancel"),this.dragCancel=!0);else if(an(o))P.isCheckMode()&&(D=P.getFocusData(),D&&P.checkData(D));else if(ce(o)||Hr(o)){var R=P.isCheckMode();if(D=R?P.getFocusData():f.ld()){var J=P.getRowIndex(D);J>=0&&(ce(o)?0!==J&&(D=F.get(J-1),R?P.setFocusData(D):f.ss(D)):J!==z-1&&(D=F.get(J+1),R?P.setFocusData(D):f.ss(D)))}else z>0&&(D=F.get(0),R?P.setFocusData(D):f.ss(D))}}},_34o:function(X,N){var I=this.list,m=I.lp(X).x;return m>=0&&m<=I._indent?(I.checkData(N),void 0):(I.setFocusData(N),void 0)},_33o:function(c,R){var F=this.list,r=F.sm(),M=r.ld();if(!F.canHandleSelectMode(c,R))return this._cancelDataDoubleSelect(),void 0;if(qh(c))F.isSelected(R)?r.rs(R):r.as(R);else if(eq(c))if(M)for(var L=F.getRowIndex(M),X=F.getRowIndex(R);L!==X;)L+=X>L?1:-1,r.as(F._rows.get(L));else r.ss(R);else rf(c)?(r.contains(R)?F.handleDataDoubleSelect&&(this._handleDataDoubleSelect(c,R),hl(c)&&this._cancelDataDoubleSelect()):this._cancelDataDoubleSelect(),r.ss(R)):r.contains(R)||r.ss(R)},_handleDataDoubleSelect:function(q,O){this._cancelDataDoubleSelect(),this._doubleSelectTimer=bg(function(){this.list.handleDataDoubleSelect(q,O),this._doubleSelectTimer=Y}.bind(this),x.doubleClickSpeed)},_cancelDataDoubleSelect:function(){this._doubleSelectTimer&&(ee(this._doubleSelectTimer),this._doubleSelectTimer=Y)}}),tt.TreeView=function(F){var c=this;c._35o(),c._5o(F),new Ct(c)},ut("TreeView",S,{ms_ac:[kq,Sb,gp,"rootVisible",oq,"rootData",Kl,Ue,pi,_l,af,Zp,$l,Mb,am,sm,mf,Re,ji,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:F,_indent:Wf,_rowHeight:ec,_rowLineVisible:x.treeViewRowLineVisible,_rowLineColor:x.treeViewRowLineColor,_scrollBarColor:Jj,_scrollBarSize:xr,_autoHideScrollBar:yr,_expandIcon:x.treeViewExpandIcon,_collapseIcon:x.treeViewCollapseIcon,_autoMakeVisible:mc,_selectBackground:x.treeViewSelectBackground,_labelColor:x.treeViewLabelColor,_labelSelectColor:x.treeViewLabelSelectColor,_labelFont:x.treeViewLabelFont,_doubleClickToToggle:x.treeViewDoubleClickToToggle,drawRow:function(q,c,b,f,v,$,y){var e=this;e.drawRowBackground(q,c,b,f,v,$,y),e.drawTree(q,c,b,0,v,$,y)},isOnToggleIcon:function(V){var E=this.getDataAt(V);if(E){var J=this.getIndent(),m=this.lp(V).x;if(ti(this.getToggleIcon(E))){var r=J*this.getLevel(E);if(m>=r&&r+J>=m)return!0}}return!1}});var Ct=function(f){ag(Ct,this,[f])};tr(Ct,Bt,{toggle:function(m,U,S,M){var D=this.list,l=D.lp(m).x;if(ti(D.getToggleIcon(U))){var F=S*M;if(l>=F&&F+S>=l)return D.toggle(U),!0}return D.isDoubleClickToToggle()&&hl(m)?(D.toggle(U),!0):!1},_34o:function(L,p){var C=this.list,k=C.lp(L).x,$=C._levelMap[p._id],d=C._indent,U=d*($+1);return k>=U&&U+d>=k?(C.checkData(p),void 0):(this.toggle(L,p,d,$)||C.setFocusData(p),void 0)},_33o:function(Z,E){var u=this,r=u.list;if(!u.toggle(Z,E,r._indent,r.getLevel(E)))if(eq(Z)){var s=r.sm();if(s.size()>0){for(var n=r._rows,t=null,K=0,I=n.size();I>K;K++)if(r.isSelected(n.get(K))){t=K;break}for(var F=null,K=n.size()-1;K>=0;K--)if(r.isSelected(n.get(K))){F=K;break}var d,G,x=r.getRowIndex(E);for(t>x?(d=x-1,G=t):x>F?(d=F,G=x):(d=t,G=F);d!==G;)d++,s.as(r._rows.get(d))}else s.ss(E)}else Ct.superClass._33o.call(u,Z,E)},handle_keydown:function(y){if(pm(y)||hj(y)){var U=this.list,M=U._rows,I=U.isCheckMode(),r=U.sm(),v=I?U.getFocusData():r.ld();v?v.hasChildren()&&(pm(y)?U.collapse(v):U.expand(v)):M.size()>0&&(v=M.get(0),I?U.setFocusData(v):r.ss(v))}else Ct.superClass.handle_keydown.call(this,y)}});var Dt=tt.TableView=function(K){this._98I(),this._5o(K),new Et(this)};ut("TableView",S,{ms_ac:[kq,Sb,gp,"sortMode",Te,yk,$l,Mb,am,Ob,ul,"sortColumn",Kl,Ue,pi,_l,af,Re,ji],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:go,_editable:!0,_batchEditable:!1,_rowHeight:ec,_rowLineVisible:x.tableViewRowLineVisible,_rowLineColor:x.tableViewRowLineColor,_columnLineVisible:x.tableViewColumnLineVisible,_columnLineColor:x.tableViewColumnLineColor,_scrollBarColor:Jj,_scrollBarSize:xr,_autoHideScrollBar:yr,_autoMakeVisible:mc,_selectBackground:x.tableViewSelectBackground,_labelColor:x.tableViewLabelColor,_labelSelectColor:x.tableViewLabelSelectColor,_labelFont:x.tableViewLabelFont,getCheckColumn:function(){var R=this;if(!R._31o){var p=R._31o=new wt;p.setEditable(!0),p.setWidth(40),p.getValue=R.getCheckColumValue,p.drawCell=R.drawCheckColumnCell}return R._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(s){var P=this,M=P._39o,f=P.getCheckColumn();s!==P.isCheckMode()&&(s?M.add(f,0):M.remove(f),P.fp(oq,!s,s))},getCheckColumValue:function(N,R,M){return M.isSelected(N)},drawCheckColumnCell:function(y,v,e,D,X,B,j,u,C){td(y,C.getCheckIcon(v),X+j/2,B+u/2,v,C)}});var Et=function(C){ag(Et,this,[C])};tr(Et,Bt,{_34o:function(L,O){var i=this.list,k=i._31o;if(i.isCellEditable(O,k,L)){var b=i._3Q(k),I=i.lp(L).x;if(b&&I>=b.startX&&I<b.startX+k.getWidth())return i.checkData(O),void 0}i._37O(O,L),i.setFocusData(O)},_33o:function(_,v){this.list._37O(v,_),Et.superClass._33o.apply(this,arguments)}});var Ft=tt.TreeTableView=function(q){var m=this,A=m._4o=new wt;m._35o(),m._98I(),m._5o(q),A.setDisplayName("Name"),A.setEditable(!0),A.setWidth(180),A.drawCell=Gt,A.getValue=Ht,m._39o.add(A),new It(m)},Gt=function(l,m,R,I,h,U,Q,o,M){M.drawTree(l,m,R,h,U,Q,o)},Ht=function(a,d,e){return e.getLabel(a)};ut("TreeTableView",S,{ms_ac:[kq,Sb,gp,"sortMode",Te,yk,Zp,oq,"rootData","rootVisible",Kl,Ue,"sortColumn",sm,mf,pi,_l,af,Re,am,$l,Mb,Ob,ul,ji,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:go,_checkMode:F,_editable:!0,_batchEditable:!1,_indent:Wf,_rowHeight:ec,_rowLineVisible:x.treeTableViewRowLineVisible,_rowLineColor:x.treeTableViewRowLineColor,_columnLineVisible:x.treeTableViewColumnLineVisible,_columnLineColor:x.treeTableViewColumnLineColor,_expandIcon:x.treeTableViewExpandIcon,_collapseIcon:x.treeTableViewCollapseIcon,_scrollBarColor:Jj,_scrollBarSize:xr,_autoHideScrollBar:yr,_autoMakeVisible:mc,_selectBackground:x.treeTableViewSelectBackground,_labelColor:x.treeTableViewLabelColor,_labelSelectColor:x.treeTableViewLabelSelectColor,_labelFont:x.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var It=function(Y){ag(It,this,[Y])};tr(It,Bt,{_34o:function(D,$){var Z=this.list,K=Z._4o,m=Z._3Q(K),U=Z.lp(D).x;if(m){var Q=Z._indent,w=m.startX+Q*Z.getLevel($);if(ti(Z.getToggleIcon($))&&U>=w&&w+Q>=U)return Z.toggle($),void 0;if(Z.isCellEditable($,K)&&(w+=Q,U>=w&&w+Q>=U))return Z.checkData($),void 0}Z._37O($,D),Z.setFocusData($)},_33o:function(u,Z){var I=this.list,P=I.lp(u).x;if(ti(I.getToggleIcon(Z))){var h=I._3Q(I._4o);if(h){var g=I._indent,t=h.startX+g*I.getLevel(Z);if(P>=t&&t+g>=P)return I.toggle(Z),void 0}}I._37O(Z,u),It.superClass._33o.apply(this,arguments)}});var Jt=tt.TableHeader=function(X){var n=this,E=n._view=jb(1,n),I=n._39o=X.getColumnModel(),m=n.iv;n.tv=n._tableView=X,n._60I=new Hb,n._canvas=Vl(E),E.style.background=x.tableHeaderBackground||"",E.style.height=cg+Oq,I.mm(m,n),I.md(m,n),I.mh(m,n),X.mp(function(i){kt[i.property]&&n.iv()},n),new Kt(n),n.iv()};ut("TableHeader",S,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",kq,gp,Zp,"moveBackground","insertColor",Ob,ul,"resizable","movable"],_checkIcon:Ge,_movable:!0,_resizable:!0,_labelColor:x.tableHeaderLabelColor,_labelFont:x.tableHeaderLabelFont,_columnLineColor:x.tableHeaderColumnLineColor,_columnLineVisible:x.tableHeaderColumnLineVisible,_sortDescIcon:x.tableHeaderSortDescIcon,_sortAscIcon:x.tableHeaderSortAscIcon,_moveBackground:x.tableHeaderMoveBackground,_insertColor:x.tableHeaderInsertColor,_indent:Wf,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(k){return k.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(o){return o.getColor()||this._labelColor},getLabelAlign:function(S){return S._align},onPropertyChanged:function(){this.iv()},_5Q:function(f){this._61I=f,this.iv()},getLogicalPoint:function(e){return Oj(e,this._canvas,this.tv.tx())},validateImpl:function(){var c=this,M=c._canvas,R=c.getWidth(),K=c.getHeight(),J=c.tv,g=c._60I,r=c._61I,i=-J.tx(),V=0;(R!==M.clientWidth||K!==M.clientHeight)&&Bh(M,R,K),g.clear(),c._39o._roots.each(function(H){if(H.isVisible()){var F=V+H.getWidth();i+R>=V&&F>=i&&g.add({column:H,startX:V}),V=F}});var N=Se(M);if(zg(N,-i,0,1),N.beginPath(),N.rect(i,0,R,K),N.clip(),N.clearRect(i,0,R,K),g.each(function(b){var o=b.column,M=b.startX,D=o.getWidth();D>0&&(N.save(),N.beginPath(),N.rect(M,0,D,K),N.clip(),r&&r.column===o||c.drawColumn(N,o,M,0,D,K),c._columnLineVisible&&ys(N,M+D-1,0,1,K,c._columnLineColor),N.restore())}),r){var f=r.column,V=r.startX,S=r.position,P=f.getWidth();N.save(),N.beginPath(),N.rect(V,0,P,K),N.clip(),N.fillStyle=c._moveBackground,N.fill(),c.drawColumn(N,f,V,0,P,K),N.restore(),Kc(N,c._insertColor,S,0,K)}N.restore()},_6Q:function(v){var E=this.tv;return E._31o===v&&E.sm().getSelectionMode()===Xp},drawColumn:function(G,X,g,f,o,t){var n=this,R=n.tv,B=ti(X.getIcon()),Y=n.getLabelAlign(X);if(n._6Q(X)){var H=ti(n._checkIcon);td(G,H,g+o/2,f+t/2,X,n)}else{var z=n.getLabel(X),L=n.getLabelFont(X),M=n.getLabelColor(X),d=gn(L,z).width,k=B?n._indent:0;Y===Qi?(B&&sl(G,B,op,g,f,k,t),ke(G,z,L,M,g+k,f,o,t,Qi)):Y===Me?(B&&sl(G,B,op,g+o-d-k,f,k,t),ke(G,z,L,M,g,f,o,t,Me)):(B&&sl(G,B,op,g+(o-d-k)/2,f,k,t),ke(G,z,L,M,g+(o-d+k)/2,f,0,t,Qi))}if(X.isSortable()&&R.getSortColumn()===X&&(B=ti(X.getSortOrder()===dm?n._sortAscIcon:n._sortDescIcon))){var u=Ro(B,X)/2+2;td(G,B,Y===Me?g+u:g+o-u,f+t/2,X,R)}}});var Kt=function(m){var I=this;I.th=m,I.tv=m._tableView,I.addListeners()};tr(Kt,S,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(L){this.getView().style.cursor=L},handle_mousemove:function(S){if(!Lh){var m=this;delete m._29o,m.setCursor(vb);for(var d=m.th,g=d._60I,L=d.lp(S).x,y=g.size()-1;y>=0;y--){var J=g.get(y),t=J.column,K=J.startX+t.getWidth();if(d.isResizable()&&P(K-L)<=(Mc?10:3))return m._29o=J,m.setCursor(Tr),void 0;L>J.startX&&K>L&&(m._29o=J),(t.isClickable()||t.isSortable()||d.isMovable()||m.tv.getCheckColumn&&t===m.tv.getCheckColumn())&&L>J.startX&&K>L&&m.setCursor(fj)}}},handle_mousedown:function(f){this.handle_touchstart(f)},handle_touchstart:function(e){var z=this;cc(e),z.tv.endEditing(),z.handle_mousemove(e),z._29o&&(z.x=sf(e).x,z.lx=z.th.lp(e).x,z.w=z._29o.column.getWidth(),om(z,e))},handleWindowMouseMove:function(t){this.handleWindowTouchMove(t)},handleWindowTouchMove:function(q){var S=this,R=S.th,V=S.getView().style.cursor,l=S._29o,x=sf(q).x-S.x;if(S.resizing||S.moving||(V===Tr?S.resizing=1:R.isMovable()&&V===fj&&P(x)>2&&(S.moving=1)),S.resizing)l.column.setWidth(S.w+x);else if(S.moving){var Q=S.lx+x;R._60I.each(function(f){var o=f.startX,s=o+f.column.getWidth();if(Q>=o&&s>=Q){var $={column:l.column,startX:l.startX+x,front:s-Q>Q-o,insertColumn:f.column};$.position=$.front?o:s,R._5Q($)}})}},_16Q:function(H,P){var W=this,Z=W.tv,O=W.th,j=O._checkIcon;if(O._6Q(H)){var f=ti(j),M=W.lx,q=H.getWidth(),D=Ro(f,H);if(M>=P+q/2-D&&P+q/2+D>=M){O.setCheckIcon(j===$h?Ge:$h);var U=Z.sm(),s=Z._rows;return j===$h?U.rs(s):U.ss(s),Z.onCheckColumnClicked(H),!0}}return!1},handleWindowMouseUp:function(Z){this.handleWindowTouchEnd(Z)},handleWindowTouchEnd:function(N){var f=this,D=f.tv,P=f.th,m=f._29o;if(f.moving){var t=P._61I;if(t&&t.insertColumn!==t.column){var X=t.column,u=D.getColumnModel()._roots,G=u.remove(X),s=u.indexOf(t.insertColumn);s>=0&&(t.front||s++,s<=u.size()&&(u.add(X,s),D.getColumnModel()._38I(X,G,s)))}P._5Q(F),delete f.moving}else if(!f.resizing&&m){X=m.column;var W=P.lp(N).x,b=m.startX,E=!0;if(P.onColumnClicked){var l=P.onColumnClicked(X,N,b);l===!1&&(E=!1)}if(E&&W>=b&&W<=b+X.getWidth()&&!f._16Q(X,b)){if(X.isSortable()){var K=D.getSortMode(),Z=X.getSortOrder();K===go?D.getSortColumn()===X?(Z===Vg&&D.setSortColumn(F),X.setSortOrder(Z===dm?Vg:dm)):D.setSortColumn(X):"bistate"===K&&(D.getSortColumn()===X?X.setSortOrder(Z===dm?Vg:dm):D.setSortColumn(X))}D.onColumnClicked(X,N,b)}}f._29o=f.resizing=f.x=f.lx=f.w=F}}),tt.TablePane=function(P){this.init(new Dt(P))},ut("TablePane",S,{ms_v:1,_44o:1}),tt.TreeTablePane=function(K){this.init(new Ft(K))},ut("TreeTablePane",S,{ms_v:1,_44o:1}),tt.Toolbar=function(g){var n=this,q=n._view=jb(1,n),k=q.style;k.background=x.toolbarBackground||"",k.height=$p+Oq,n._canvas=Vl(q),n._30o=new Hb,n._90I=new Hb,n.setItems(g||[]),q.handleGroupSelectedChanged=function(Z){if(Z.isSelected()){var x=Z.getGroupId();null!=x&&n._items.forEach(function(e){var G=e.element;G&&G!==Z&&G.setSelected&&G.getGroupId&&G.getGroupId()===x&&G.setSelected(!1)})}},new Lt(n)},ut("Toolbar",S,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[wg,kq,gp,Sb,ji,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:x.toolbarLabelColor,_labelSelectColor:x.toolbarLabelSelectColor,_labelFont:x.toolbarLabelFont,_selectBackground:x.toolbarSelectBackground,_itemGap:x.toolbarItemGap,_separatorColor:x.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(W){var P=this.getItemInfoAt(W);return P?P.item.toolTip:F},getLabelColor:function(Q){return Q&&Q.selected&&Q.type!==$h&&Q.type!==Vd?this._labelSelectColor:this._labelColor},onPropertyChanged:function(S){this.iv(),S.property===wg&&this._items.forEach(function(k){Kf(k)})},redraw:function(){this.iv()},addItem:function(c,_){var P=this._items;_==F?P.push(c):P.splice(_,0,c),this.fp(wg,F,P)},removeItem:function(O){if(O)for(var i=this._items,x=0;x<i.length;x++)O===i[x]&&(i.splice(x,1),this.fp(wg,F,i))},removeItemById:function(O){if(O!=F)for(var G=this._items,i=0;i<G.length;i++)if(O===G[i].id){var j=G.splice(i,1)[0];return this.fp(wg,F,G),j}},getItemById:function(c){if(c!=F)for(var r=this._items,g=0;g<r.length;g++){var C=r[g];if(c===C.id)return C}},setItemVisible:function(C,l){var D=this.getItemById(C);D&&(D.visible=l)},getItemInfos:function(){return this._30o},getItemInfoAt:function(B){var w=this,_=0,L=w._30o,Q=w.lp(B),g=Q.x,n=Q.y;if(n>=0&&n<=w.getHeight())for(;_<L.size();_++){var s=L.get(_);if(s.startX<=g&&g<=s.endX)return s}return F},drawItem:function(r,J,e,M,k){if(J.visible===!1)return 0;if(nf(J.visible)&&!J.visible())return 0;var x=this,H=J.disabled;H&&(r.globalAlpha=ni);var Y=x.drawItemImpl(r,J,e,M,k),l=x._itemGap;return H&&(r.globalAlpha=1),this._currentItem!==J||"separator"===J||J.separator===!0||J.unfocusable||lp(r,x._separatorColor,e-l/2,0,Y+l,M),Y},drawItemImpl:function(K,L,l,c,H){var k=this,I=k._view,W=k._itemGap,f=c/2,d=L.type,Z=L.element,D=L.label;Fn(Z)&&(D=Z,Z=F);var t,Y=k.getLabelFont(L),Q=k.getLabelColor(L),m=L.selected,u=ti(L.icon),C=Ro(u,L),O=0,x=C+(D?gn(Y,D).width:0);if("separator"===L||L.separator===!0)return Kc(K,k._separatorColor,l,c/4,f),1;if(Z){u&&td(K,u,l+C/2,f,L,k),ke(K,D,Y,Q,l+C,0,0,c);var N=pq(Z);H||k._90I.add(N),N.parentNode!==I&&kf(I,N),Z.iv&&Z.iv(),Z.validate&&Z.validate();var e=N.getBoundingClientRect(),r=e.width,y=N.style;return Kg(N),y.left=k.tx()+l+x+Oq,y.top=(c-e.height)/2+Oq,x+r}return d===Vd?t=ti(m?Xe:dr):d===$h&&(t=ti(m?$h:Ge)),t?(O=Ro(t,L),td(K,t,l+O/2,f,L,k),l+=O,x+=O):m&&ys(K,l-W/2,0,x+W,c,k.getSelectBackground(L)),u&&td(K,u,l+C/2,f,L,k),ke(K,D,Y,Q,l+C,0,0,c),x},validateImpl:function(){var D=this,h=D._canvas,a=D.getWidth(),G=D.getHeight(),y=D._30o,L=D._items;Bh(h,a,G);var l=Se(h),K=D._itemGap,T=K/2;zg(l,D.tx(),0,1),l.clearRect(0,0,a,G);var x=D._90I;D._90I=new Hb,y.clear(),L.forEach(function(O){var a=D.drawItem(l,O,T,G);y.add({item:O,startX:T,endX:T+a,width:a}),a&&(T+=a+K)}),x.each(function(i){D._90I.contains(i)||yo(i)});var e=D._64I;D._64I=O(0,T-K/2),l.restore(),D._stickToRight?(D._65O=0,l=Se(h),T=a-D._64I+K/2,zg(l,0,0,1),l.clearRect(0,0,a,G),y.clear(),L.forEach(function(x){var s=D.drawItem(l,x,T,G,!0);y.add({item:x,startX:T,endX:T+s,width:s}),s&&(T+=s+K)}),l.restore()):D.tx(D.tx()),e!==D._64I&&D.onSumWidthChanged(e,D._64I)},onSumWidthChanged:function(){},handleClick:function(w,X){var O=this,v=w.type,M=w.action,f=w.groupId,A=w.selected;w.disabled||(f!=F?A||(w.selected=!0,this._items.forEach(function(L){L.groupId===f&&w!==L&&(L.selected=!1)}),M&&w.action(w,O,X)):v===$h||"toggle"===v?(w.selected=!A,M&&w.action(w,O,X)):M&&w.action(w,O,X)),Qf(),O.iv()}});var Lt=function(e){this.tb=e,this.addListeners()};tr(Lt,S,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(h){this.handleScroll(h,10*(h.wheelDelta/40))},handle_DOMMouseScroll:function($){this.handleScroll($,10*-$.detail)},handleScroll:function(t,R){cc(t);var i=this.tb;i.isScrollable()&&!i._stickToRight&&(i.tx(i.tx()+R),fi())},handle_mousemove:function(o){var z=this;Lh||z.setItem(o)},handle_mouseout:function(Q){var o=this;Q.target===o.getView()?o.tb.setCurrentItem(F):o.handle_mousemove(Q)},handle_mousedown:function(x){this.handle_mousemove(x),this.handle_touchstart(x)},handle_touchstart:function(a){var M=this,G=M.tb,I=a.target;rf(a)&&(I===M.getView()||I===G._canvas)&&(cc(a),G.setFocus(a)&&(this.setItem(a,!0),(G.isScrollable()||M.info&&!M.info.item.disabled)&&(M.x=sf(a).x,M.tx=G.tx(),om(M,a))))},handleWindowMouseMove:function(x){this.handleWindowTouchMove(x)},handleWindowTouchMove:function(p){var H=this,W=H.tb;if(!W._stickToRight){var Y=sf(p).x-H.x;!H._25o&&P(Y)>2&&W.isScrollable()&&(H._25o=1),H._25o&&W.tx(H.tx+Y)}},handleWindowMouseUp:function(m){this.handleWindowTouchEnd(m)},handleWindowTouchEnd:function(y){var $=this,l=$.tb,I=$.info,J=$.tb.getItemInfoAt(y);if(!$._25o&&I){var D=I.item;J&&J.item===D&&l.handleClick(D,y)}$._25o=$.x=$.tx=F,$.setItem()},setItem:function(E,n){var K=this,T=K.tb,j=K.info=E?T.getItemInfoAt(E):F,J=j?j.item:F;T.setCurrentItem(J),n&&J&&nf(J.onDown)&&J.onDown(E)}}),tt.BorderPane=function(){this._view=jb(1,this),this.iv()},ut("BorderPane",S,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(g,X){this._12o("leftView",g),X!=F&&this.setLeftWidth(X)},getRightView:function(){return this._rightView},setRightView:function(I,A){this._12o("rightView",I),A!=F&&this.setRightWidth(A)},getTopView:function(){return this._topView},setTopView:function(k,v){this._12o("topView",k),v!=F&&this.setTopHeight(v)},getBottomView:function(){return this._bottomView},setBottomView:function(T,m){this._12o("bottomView",T),m!=F&&this.setBottomHeight(m)},getCenterView:function(){return this._centerView},setCenterView:function(Y){this._12o("centerView",Y)},_12o:function(e,X){var y=this,v="_"+e,i=y._view,M=y[v];M!==X&&(M&&(M.getView?yo(M.getView()):yo(M)),y[v]=X,X&&(X.getView?kf(i,X.getView(),1):kf(i,X,1)),y.fp(e,M,X))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var X=this,V=X._topView,s=X._bottomView,z=X._leftView,K=X._rightView,U=X._centerView,G=X.getWidth(),u=X.getHeight(),m=0,A=0,p=G,M=u,h=0,P=0,Q=0,i=0;V&&(h=X._topHeight==F?Sp(V):X._topHeight,A=h),s&&(P=X._bottomHeight==F?Sp(s):X._bottomHeight,M=u-P),z&&(Q=X._leftWidth==F?Qq(z):X._leftWidth,m=Q),K&&(i=X._rightWidth==F?Qq(K):X._rightWidth,p=G-i);var N=O(0,p-m),D=O(0,M-A);V&&Gk(V,0,0,G,h),s&&Gk(s,0,M,G,P),z&&Gk(z,0,A,Q,D),K&&Gk(K,p,A,i,D),U&&Gk(U,m,A,N,D)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);